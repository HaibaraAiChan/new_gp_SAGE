[05:42:30] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 510562 edges into 16 parts and get 26770 edge cuts
main start at this time 1651556534.8766258
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025266170501708984
global_2_local spend time (sec) 0.03662729263305664
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004552364349365234
A = g.adjacency_matrix() spent  0.007611274719238281
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07815432548522949
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2840428352355957
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1608552932739258

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 0.021 seconds
Metis partitioning: 0.093 seconds
Split the graph: 0.040 seconds
Construct subgraphs: 0.070 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.2242143154144287
5642
5801
5620
5854
5686
5685
5671
5647
5663
5680
5667
5660
5661
5671
5667
5666
total k batches seeds list generation spend  10.703075408935547
after graph partition
graph partition algorithm spend time 10.795789957046509
5642
5801
5620
5854
5686
5685
5671
5647
5663
5680
5667
5660
5661
5671
5667
5666
partition_len_list
[23946, 28802, 31554, 29708, 22078, 20177, 24646, 25522, 25247, 24720, 25691, 25481, 25210, 24838, 25452, 25160]
shared_neighbor_graph_partition_s0 selection method  spend 10.879725217819214
time for parepare:  0.018069982528686523
local_output_nid generation:  0.0011034011840820312
local_in_edges_tensor generation:  0.001420736312866211
mini_batch_src_global generation:  0.0018527507781982422
r_  generation:  0.01609182357788086
local_output_nid generation:  0.0013382434844970703
local_in_edges_tensor generation:  0.0015113353729248047
mini_batch_src_global generation:  0.0024318695068359375
r_  generation:  0.021530628204345703
local_output_nid generation:  0.0014510154724121094
local_in_edges_tensor generation:  0.0013957023620605469
mini_batch_src_global generation:  0.0020821094512939453
r_  generation:  0.02187037467956543
local_output_nid generation:  0.001619577407836914
local_in_edges_tensor generation:  0.0014655590057373047
mini_batch_src_global generation:  0.0022537708282470703
r_  generation:  0.02406477928161621
local_output_nid generation:  0.001649618148803711
local_in_edges_tensor generation:  0.0013833045959472656
mini_batch_src_global generation:  0.0018153190612792969
r_  generation:  0.018615007400512695
local_output_nid generation:  0.0016942024230957031
local_in_edges_tensor generation:  0.0013751983642578125
mini_batch_src_global generation:  0.0017402172088623047
r_  generation:  0.018274307250976562
local_output_nid generation:  0.0015289783477783203
local_in_edges_tensor generation:  0.0011751651763916016
mini_batch_src_global generation:  0.0012767314910888672
r_  generation:  0.011937141418457031
local_output_nid generation:  0.0014624595642089844
local_in_edges_tensor generation:  0.0011665821075439453
mini_batch_src_global generation:  0.0009377002716064453
r_  generation:  0.011411905288696289
local_output_nid generation:  0.0014812946319580078
local_in_edges_tensor generation:  0.0012814998626708984
mini_batch_src_global generation:  0.001463174819946289
r_  generation:  0.018393993377685547
local_output_nid generation:  0.001486063003540039
local_in_edges_tensor generation:  0.0012996196746826172
mini_batch_src_global generation:  0.001369476318359375
r_  generation:  0.013637542724609375
local_output_nid generation:  0.0014581680297851562
local_in_edges_tensor generation:  0.0012302398681640625
mini_batch_src_global generation:  0.0011143684387207031
r_  generation:  0.0116119384765625
local_output_nid generation:  0.0014503002166748047
local_in_edges_tensor generation:  0.001180410385131836
mini_batch_src_global generation:  0.001055002212524414
r_  generation:  0.01163792610168457
local_output_nid generation:  0.001371622085571289
local_in_edges_tensor generation:  0.0011487007141113281
mini_batch_src_global generation:  0.001247406005859375
r_  generation:  0.010061502456665039
local_output_nid generation:  0.0013515949249267578
local_in_edges_tensor generation:  0.0010800361633300781
mini_batch_src_global generation:  0.0012183189392089844
r_  generation:  0.01006007194519043
local_output_nid generation:  0.0013294219970703125
local_in_edges_tensor generation:  0.0010764598846435547
mini_batch_src_global generation:  0.0012669563293457031
r_  generation:  0.010231256484985352
local_output_nid generation:  0.0013303756713867188
local_in_edges_tensor generation:  0.0010836124420166016
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.00989985466003418
----------------------check_connections_block total spend ----------------------------- 0.39515137672424316
generate_one_block  0.026785612106323242
generate_one_block  0.03298687934875488
generate_one_block  0.03291153907775879
generate_one_block  0.03556251525878906
generate_one_block  0.031052589416503906
generate_one_block  0.026598691940307617
generate_one_block  0.018685579299926758
generate_one_block  0.01753997802734375
generate_one_block  0.025204181671142578
generate_one_block  0.020380735397338867
generate_one_block  0.017646074295043945
generate_one_block  0.018050432205200195
generate_one_block  0.01708245277404785
generate_one_block  0.015523195266723633
generate_one_block  0.015985488891601562
generate_one_block  0.01575922966003418
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03732633590698242
gen group dst list time:  0.01157522201538086
time for parepare:  0.020935773849487305
local_output_nid generation:  0.0045015811920166016
local_in_edges_tensor generation:  0.009579181671142578
mini_batch_src_global generation:  0.006335258483886719
r_  generation:  0.05718827247619629
local_output_nid generation:  0.00786137580871582
local_in_edges_tensor generation:  0.008469343185424805
mini_batch_src_global generation:  0.008387088775634766
r_  generation:  0.07813072204589844
local_output_nid generation:  0.008701801300048828
local_in_edges_tensor generation:  0.008231878280639648
mini_batch_src_global generation:  0.008702754974365234
r_  generation:  0.09477376937866211
local_output_nid generation:  0.01042938232421875
local_in_edges_tensor generation:  0.0073642730712890625
mini_batch_src_global generation:  0.013750553131103516
r_  generation:  0.0854339599609375
local_output_nid generation:  0.0064394474029541016
local_in_edges_tensor generation:  0.005392551422119141
mini_batch_src_global generation:  0.006792783737182617
r_  generation:  0.060831308364868164
local_output_nid generation:  0.005936145782470703
local_in_edges_tensor generation:  0.004808187484741211
mini_batch_src_global generation:  0.005825996398925781
r_  generation:  0.05367231369018555
local_output_nid generation:  0.0070302486419677734
local_in_edges_tensor generation:  0.005839109420776367
mini_batch_src_global generation:  0.006425142288208008
r_  generation:  0.062441349029541016
local_output_nid generation:  0.007286548614501953
local_in_edges_tensor generation:  0.006211757659912109
mini_batch_src_global generation:  0.0072917938232421875
r_  generation:  0.06624054908752441
local_output_nid generation:  0.007253170013427734
local_in_edges_tensor generation:  0.00575566291809082
mini_batch_src_global generation:  0.0072078704833984375
r_  generation:  0.06918501853942871
local_output_nid generation:  0.007127523422241211
local_in_edges_tensor generation:  0.005841970443725586
mini_batch_src_global generation:  0.007132291793823242
r_  generation:  0.06618952751159668
local_output_nid generation:  0.007435321807861328
local_in_edges_tensor generation:  0.005921840667724609
mini_batch_src_global generation:  0.007009029388427734
r_  generation:  0.06831645965576172
local_output_nid generation:  0.007387638092041016
local_in_edges_tensor generation:  0.009958505630493164
mini_batch_src_global generation:  0.0078582763671875
r_  generation:  0.06892871856689453
local_output_nid generation:  0.008196115493774414
local_in_edges_tensor generation:  0.00571441650390625
mini_batch_src_global generation:  0.0070438385009765625
r_  generation:  0.06731462478637695
local_output_nid generation:  0.009232521057128906
local_in_edges_tensor generation:  0.009791851043701172
mini_batch_src_global generation:  0.008245468139648438
r_  generation:  0.06516194343566895
local_output_nid generation:  0.00742340087890625
local_in_edges_tensor generation:  0.006283283233642578
mini_batch_src_global generation:  0.007040500640869141
r_  generation:  0.0694727897644043
local_output_nid generation:  0.007308244705200195
local_in_edges_tensor generation:  0.006038665771484375
mini_batch_src_global generation:  0.007215023040771484
r_  generation:  0.06551384925842285
----------------------check_connections_block total spend ----------------------------- 1.7767746448516846
generate_one_block  0.0884861946105957
generate_one_block  0.10634160041809082
generate_one_block  0.12261438369750977
generate_one_block  0.13396310806274414
generate_one_block  0.07523131370544434
generate_one_block  0.06799435615539551
generate_one_block  0.09406805038452148
generate_one_block  0.0861046314239502
generate_one_block  0.0870676040649414
generate_one_block  0.08125686645507812
generate_one_block  0.08402276039123535
generate_one_block  0.09561848640441895
generate_one_block  0.08125853538513184
generate_one_block  0.08006739616394043
generate_one_block  0.08341813087463379
generate_one_block  0.08057093620300293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.7767746448516846
block generation total time  1.4480843544006348
average batch blocks generation time:  0.09050527215003967
pseudo mini batch 0 input nodes size: 69532
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.0359807014465332  GigaBytes
Max Memory Allocated: 0.0359807014465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.03602313995361328  GigaBytes
Max Memory Allocated: 0.03602313995361328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.03602313995361328  GigaBytes
Max Memory Allocated: 0.03602313995361328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03766155242919922  GigaBytes
Max Memory Allocated: 0.03766155242919922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03766155242919922  GigaBytes
Max Memory Allocated: 0.03766155242919922  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03766155242919922  GigaBytes
Max Memory Allocated: 0.03766155242919922  GigaBytes

torch.Size([69532, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03766155242919922  GigaBytes
Max Memory Allocated: 0.03766155242919922  GigaBytes

m.shape torch.Size([1454, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.12058019638061523  GigaBytes
Max Memory Allocated: 0.12237071990966797  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.12058019638061523  GigaBytes
Max Memory Allocated: 0.12237071990966797  GigaBytes

 h.shape torch.Size([1, 1454, 128]), torch.Size([1, 1454, 128])
----------------------------------------3
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.12196683883666992  GigaBytes
Max Memory Allocated: 0.12237071990966797  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.13305997848510742  GigaBytes
Max Memory Allocated: 0.13375329971313477  GigaBytes

rst.shape  torch.Size([1, 1454, 128])
m.shape torch.Size([1841, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.13412237167358398  GigaBytes
Max Memory Allocated: 0.13416385650634766  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.13412237167358398  GigaBytes
Max Memory Allocated: 0.13416385650634766  GigaBytes

 h.shape torch.Size([1, 1841, 128]), torch.Size([1, 1841, 128])
----------------------------------------3
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.1358780860900879  GigaBytes
Max Memory Allocated: 0.1358780860900879  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.16221380233764648  GigaBytes
Max Memory Allocated: 0.16464662551879883  GigaBytes

rst.shape  torch.Size([1, 1841, 128])
m.shape torch.Size([1893, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.16404390335083008  GigaBytes
Max Memory Allocated: 0.16464662551879883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.16404390335083008  GigaBytes
Max Memory Allocated: 0.16464662551879883  GigaBytes

 h.shape torch.Size([1, 1893, 128]), torch.Size([1, 1893, 128])
----------------------------------------3
 Nvidia-smi: 1.3592529296875 GB
    Memory Allocated: 0.1658492088317871  GigaBytes
Max Memory Allocated: 0.1658492088317871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.2055659294128418  GigaBytes
Max Memory Allocated: 0.208343505859375  GigaBytes

rst.shape  torch.Size([1, 1893, 128])
m.shape torch.Size([1782, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.20806217193603516  GigaBytes
Max Memory Allocated: 0.208343505859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.20806217193603516  GigaBytes
Max Memory Allocated: 0.208343505859375  GigaBytes

 h.shape torch.Size([1, 1782, 128]), torch.Size([1, 1782, 128])
----------------------------------------3
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.2097616195678711  GigaBytes
Max Memory Allocated: 0.2097616195678711  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.2590456008911133  GigaBytes
Max Memory Allocated: 0.26244449615478516  GigaBytes

rst.shape  torch.Size([1, 1782, 128])
m.shape torch.Size([1673, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.26218461990356445  GigaBytes
Max Memory Allocated: 0.26244449615478516  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.26218461990356445  GigaBytes
Max Memory Allocated: 0.26244449615478516  GigaBytes

 h.shape torch.Size([1, 1673, 128]), torch.Size([1, 1673, 128])
----------------------------------------3
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.2637801170349121  GigaBytes
Max Memory Allocated: 0.2637801170349121  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.321988582611084  GigaBytes
Max Memory Allocated: 0.3259773254394531  GigaBytes

rst.shape  torch.Size([1, 1673, 128])
m.shape torch.Size([1321, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.3249702453613281  GigaBytes
Max Memory Allocated: 0.3259773254394531  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.3249702453613281  GigaBytes
Max Memory Allocated: 0.3259773254394531  GigaBytes

 h.shape torch.Size([1, 1321, 128]), torch.Size([1, 1321, 128])
----------------------------------------3
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.3262300491333008  GigaBytes
Max Memory Allocated: 0.3262300491333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.3806939125061035  GigaBytes
Max Memory Allocated: 0.3844733238220215  GigaBytes

rst.shape  torch.Size([1, 1321, 128])
m.shape torch.Size([1222, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.3841428756713867  GigaBytes
Max Memory Allocated: 0.3844733238220215  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.3841428756713867  GigaBytes
Max Memory Allocated: 0.3844733238220215  GigaBytes

 h.shape torch.Size([1, 1222, 128]), torch.Size([1, 1222, 128])
----------------------------------------3
 Nvidia-smi: 1.5975341796875 GB
    Memory Allocated: 0.38530826568603516  GigaBytes
Max Memory Allocated: 0.38530826568603516  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.44634580612182617  GigaBytes
Max Memory Allocated: 0.4504246711730957  GigaBytes

rst.shape  torch.Size([1, 1222, 128])
m.shape torch.Size([1097, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.4499478340148926  GigaBytes
Max Memory Allocated: 0.4504246711730957  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.4499478340148926  GigaBytes
Max Memory Allocated: 0.4504246711730957  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.45099401473999023  GigaBytes
Max Memory Allocated: 0.45099401473999023  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.512026309967041  GigaBytes
Max Memory Allocated: 0.5162110328674316  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([947, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5155673027038574  GigaBytes
Max Memory Allocated: 0.5162110328674316  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5155673027038574  GigaBytes
Max Memory Allocated: 0.5162110328674316  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5164704322814941  GigaBytes
Max Memory Allocated: 0.5164704322814941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.5743584632873535  GigaBytes
Max Memory Allocated: 0.5784225463867188  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([10716, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.625004768371582  GigaBytes
Max Memory Allocated: 0.6262030601501465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.625004768371582  GigaBytes
Max Memory Allocated: 0.6262030601501465  GigaBytes

 h.shape torch.Size([1, 10716, 128]), torch.Size([1, 10716, 128])
----------------------------------------3
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.6352243423461914  GigaBytes
Max Memory Allocated: 0.6352243423461914  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.360814094543457  GigaBytes
Max Memory Allocated: 1.411911964416504  GigaBytes

rst.shape  torch.Size([1, 10716, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.2865910530090332  GigaBytes
Max Memory Allocated: 1.411911964416504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.3094277381896973  GigaBytes
Max Memory Allocated: 1.411911964416504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.3322644233703613  GigaBytes
Max Memory Allocated: 1.411911964416504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.309248924255371  GigaBytes
Max Memory Allocated: 1.411911964416504  GigaBytes

torch.Size([23946, 256])
first layer input nodes number: 69532
first layer output nodes number: 23946
edges number: 167247
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.332784652709961  GigaBytes
Max Memory Allocated: 1.411911964416504  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.355621337890625  GigaBytes
Max Memory Allocated: 1.411911964416504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7147216796875 GB
    Memory Allocated: 1.361931324005127  GigaBytes
Max Memory Allocated: 1.411911964416504  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7147216796875 GB
    Memory Allocated: 1.361931324005127  GigaBytes
Max Memory Allocated: 1.411911964416504  GigaBytes

m.shape torch.Size([661, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.4139680862426758  GigaBytes
Max Memory Allocated: 1.4141483306884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.4139680862426758  GigaBytes
Max Memory Allocated: 1.4141483306884766  GigaBytes

 h.shape torch.Size([1, 661, 256]), torch.Size([1, 661, 256])
----------------------------------------3
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.4152288436889648  GigaBytes
Max Memory Allocated: 1.4152288436889648  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.4253149032592773  GigaBytes
Max Memory Allocated: 1.4259452819824219  GigaBytes

rst.shape  torch.Size([1, 661, 256])
m.shape torch.Size([568, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.426161766052246  GigaBytes
Max Memory Allocated: 1.42616605758667  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.426161766052246  GigaBytes
Max Memory Allocated: 1.42616605758667  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.4272451400756836  GigaBytes
Max Memory Allocated: 1.4272451400756836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.443495750427246  GigaBytes
Max Memory Allocated: 1.444871425628662  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([471, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.444340705871582  GigaBytes
Max Memory Allocated: 1.444871425628662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 1.444340705871582  GigaBytes
Max Memory Allocated: 1.444871425628662  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 2.7674560546875 GB
    Memory Allocated: 1.4452390670776367  GigaBytes
Max Memory Allocated: 1.4452390670776367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7713623046875 GB
    Memory Allocated: 1.465956687927246  GigaBytes
Max Memory Allocated: 1.4674348831176758  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([382, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.7713623046875 GB
    Memory Allocated: 1.4669971466064453  GigaBytes
Max Memory Allocated: 1.4674348831176758  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7713623046875 GB
    Memory Allocated: 1.4669971466064453  GigaBytes
Max Memory Allocated: 1.4674348831176758  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 2.7713623046875 GB
    Memory Allocated: 1.4677257537841797  GigaBytes
Max Memory Allocated: 1.4677257537841797  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.4902572631835938  GigaBytes
Max Memory Allocated: 1.4917144775390625  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([365, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.4916472434997559  GigaBytes
Max Memory Allocated: 1.4917144775390625  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.4916472434997559  GigaBytes
Max Memory Allocated: 1.4917144775390625  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.4923434257507324  GigaBytes
Max Memory Allocated: 1.4923434257507324  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.5174059867858887  GigaBytes
Max Memory Allocated: 1.51914644241333  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([296, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.5187649726867676  GigaBytes
Max Memory Allocated: 1.51914644241333  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.5187649726867676  GigaBytes
Max Memory Allocated: 1.51914644241333  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.51932954788208  GigaBytes
Max Memory Allocated: 1.51932954788208  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 1.544395923614502  GigaBytes
Max Memory Allocated: 1.5460896492004395  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([271, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 1.5459370613098145  GigaBytes
Max Memory Allocated: 1.5460896492004395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 1.5459370613098145  GigaBytes
Max Memory Allocated: 1.5460896492004395  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 1.5464539527893066  GigaBytes
Max Memory Allocated: 1.5464539527893066  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7830810546875 GB
    Memory Allocated: 1.5725388526916504  GigaBytes
Max Memory Allocated: 1.574347972869873  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([262, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.7830810546875 GB
    Memory Allocated: 1.5742950439453125  GigaBytes
Max Memory Allocated: 1.574347972869873  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7830810546875 GB
    Memory Allocated: 1.5742950439453125  GigaBytes
Max Memory Allocated: 1.574347972869873  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 2.7830810546875 GB
    Memory Allocated: 1.5747947692871094  GigaBytes
Max Memory Allocated: 1.5747947692871094  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.6041579246520996  GigaBytes
Max Memory Allocated: 1.606156826019287  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([246, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.6060361862182617  GigaBytes
Max Memory Allocated: 1.606156826019287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.6060361862182617  GigaBytes
Max Memory Allocated: 1.606156826019287  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.6065053939819336  GigaBytes
Max Memory Allocated: 1.6065053939819336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8377685546875 GB
    Memory Allocated: 1.6365346908569336  GigaBytes
Max Memory Allocated: 1.638646125793457  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([200, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8377685546875 GB
    Memory Allocated: 1.6382226943969727  GigaBytes
Max Memory Allocated: 1.638646125793457  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8377685546875 GB
    Memory Allocated: 1.6382226943969727  GigaBytes
Max Memory Allocated: 1.638646125793457  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 2.8377685546875 GB
    Memory Allocated: 1.6386041641235352  GigaBytes
Max Memory Allocated: 1.638646125793457  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 1.6656885147094727  GigaBytes
Max Memory Allocated: 1.6675958633422852  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([173, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 1.6673269271850586  GigaBytes
Max Memory Allocated: 1.6675958633422852  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 1.6673269271850586  GigaBytes
Max Memory Allocated: 1.6675958633422852  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 1.6676568984985352  GigaBytes
Max Memory Allocated: 1.6676568984985352  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 1.693394660949707  GigaBytes
Max Memory Allocated: 1.6952095031738281  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([178, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 1.6952829360961914  GigaBytes
Max Memory Allocated: 1.6952910423278809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 1.6952829360961914  GigaBytes
Max Memory Allocated: 1.6952910423278809  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 1.695622444152832  GigaBytes
Max Memory Allocated: 1.695622444152832  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9354248046875 GB
    Memory Allocated: 1.7244806289672852  GigaBytes
Max Memory Allocated: 1.7271461486816406  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([154, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9354248046875 GB
    Memory Allocated: 1.7269916534423828  GigaBytes
Max Memory Allocated: 1.7271461486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9354248046875 GB
    Memory Allocated: 1.7269916534423828  GigaBytes
Max Memory Allocated: 1.7271461486816406  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 2.9354248046875 GB
    Memory Allocated: 1.727285385131836  GigaBytes
Max Memory Allocated: 1.727285385131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.7543087005615234  GigaBytes
Max Memory Allocated: 1.7562179565429688  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([110, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.7556424140930176  GigaBytes
Max Memory Allocated: 1.7562179565429688  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.7556424140930176  GigaBytes
Max Memory Allocated: 1.7562179565429688  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.755852222442627  GigaBytes
Max Memory Allocated: 1.7562179565429688  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.776623249053955  GigaBytes
Max Memory Allocated: 1.7780919075012207  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([99, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.7779459953308105  GigaBytes
Max Memory Allocated: 1.7780919075012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.7779459953308105  GigaBytes
Max Memory Allocated: 1.7780919075012207  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 2.9881591796875 GB
    Memory Allocated: 1.778134822845459  GigaBytes
Max Memory Allocated: 1.778134822845459  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0076904296875 GB
    Memory Allocated: 1.7981505393981934  GigaBytes
Max Memory Allocated: 1.7995667457580566  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([84, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0076904296875 GB
    Memory Allocated: 1.7993478775024414  GigaBytes
Max Memory Allocated: 1.7995667457580566  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0076904296875 GB
    Memory Allocated: 1.7993478775024414  GigaBytes
Max Memory Allocated: 1.7995667457580566  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.0076904296875 GB
    Memory Allocated: 1.7995080947875977  GigaBytes
Max Memory Allocated: 1.7995667457580566  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 1.817612648010254  GigaBytes
Max Memory Allocated: 1.818894386291504  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 1.8190522193908691  GigaBytes
Max Memory Allocated: 1.8190584182739258  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 1.8190522193908691  GigaBytes
Max Memory Allocated: 1.8190584182739258  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 1.8192296028137207  GigaBytes
Max Memory Allocated: 1.8192296028137207  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0467529296875 GB
    Memory Allocated: 1.8405156135559082  GigaBytes
Max Memory Allocated: 1.8420233726501465  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([70, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0467529296875 GB
    Memory Allocated: 1.8416380882263184  GigaBytes
Max Memory Allocated: 1.8420233726501465  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0467529296875 GB
    Memory Allocated: 1.8416380882263184  GigaBytes
Max Memory Allocated: 1.8420233726501465  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.0467529296875 GB
    Memory Allocated: 1.8417716026306152  GigaBytes
Max Memory Allocated: 1.8420233726501465  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.8587279319763184  GigaBytes
Max Memory Allocated: 1.8599295616149902  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([73, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.8599944114685059  GigaBytes
Max Memory Allocated: 1.859999656677246  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.8599944114685059  GigaBytes
Max Memory Allocated: 1.859999656677246  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.8601336479187012  GigaBytes
Max Memory Allocated: 1.8601336479187012  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0819091796875 GB
    Memory Allocated: 1.878791332244873  GigaBytes
Max Memory Allocated: 1.8801140785217285  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0819091796875 GB
    Memory Allocated: 1.879894733428955  GigaBytes
Max Memory Allocated: 1.8801140785217285  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0819091796875 GB
    Memory Allocated: 1.879894733428955  GigaBytes
Max Memory Allocated: 1.8801140785217285  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.0819091796875 GB
    Memory Allocated: 1.8800110816955566  GigaBytes
Max Memory Allocated: 1.8801140785217285  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 1.896416187286377  GigaBytes
Max Memory Allocated: 1.8975796699523926  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 1.8974080085754395  GigaBytes
Max Memory Allocated: 1.8975796699523926  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 1.8974080085754395  GigaBytes
Max Memory Allocated: 1.8975796699523926  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 1.8975071907043457  GigaBytes
Max Memory Allocated: 1.8975796699523926  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 1.9121861457824707  GigaBytes
Max Memory Allocated: 1.9132275581359863  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 1.913088321685791  GigaBytes
Max Memory Allocated: 1.9132275581359863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 1.913088321685791  GigaBytes
Max Memory Allocated: 1.9132275581359863  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.1131591796875 GB
    Memory Allocated: 1.9131741523742676  GigaBytes
Max Memory Allocated: 1.9132275581359863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1268310546875 GB
    Memory Allocated: 1.9264779090881348  GigaBytes
Max Memory Allocated: 1.927422046661377  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.1268310546875 GB
    Memory Allocated: 1.9271869659423828  GigaBytes
Max Memory Allocated: 1.927422046661377  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1268310546875 GB
    Memory Allocated: 1.9271869659423828  GigaBytes
Max Memory Allocated: 1.927422046661377  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.1268310546875 GB
    Memory Allocated: 1.9272518157958984  GigaBytes
Max Memory Allocated: 1.927422046661377  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 1.9377574920654297  GigaBytes
Max Memory Allocated: 1.9385032653808594  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([56, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 1.9390168190002441  GigaBytes
Max Memory Allocated: 1.9390220642089844  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 1.9390168190002441  GigaBytes
Max Memory Allocated: 1.9390220642089844  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.1365966796875 GB
    Memory Allocated: 1.9391236305236816  GigaBytes
Max Memory Allocated: 1.9391236305236816  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1541748046875 GB
    Memory Allocated: 1.9571747779846191  GigaBytes
Max Memory Allocated: 1.9584565162658691  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([638, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 1.9728655815124512  GigaBytes
Max Memory Allocated: 1.9729251861572266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 1.9728655815124512  GigaBytes
Max Memory Allocated: 1.9729251861572266  GigaBytes

 h.shape torch.Size([1, 638, 256]), torch.Size([1, 638, 256])
----------------------------------------3
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 1.9740824699401855  GigaBytes
Max Memory Allocated: 1.9740824699401855  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3963623046875 GB
    Memory Allocated: 2.1893486976623535  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 638, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 2.1432180404663086  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.4158935546875 GB
    Memory Allocated: 2.144059181213379  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.4178466796875 GB
    Memory Allocated: 2.144900321960449  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.4178466796875 GB
    Memory Allocated: 2.144016742706299  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

torch.Size([5642, 40])
input nodes number: 23946
output nodes number: 5642
edges number: 52562
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4178466796875 GB
    Memory Allocated: 2.1450791358947754  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4178466796875 GB
    Memory Allocated: 2.145080089569092  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.044428348541259766  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

pseudo mini batch 1 input nodes size: 74511
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.03964042663574219  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.03964042663574219  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.07517004013061523  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.07521343231201172  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.04196786880493164  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.04417276382446289  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.04417276382446289  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.04417276382446289  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

torch.Size([74511, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.04417276382446289  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

m.shape torch.Size([1189, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.15530157089233398  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.15530157089233398  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 1189, 128]), torch.Size([1, 1189, 128])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.15643548965454102  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.16550683975219727  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 1189, 128])
m.shape torch.Size([1528, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.1665191650390625  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.1665191650390625  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 1528, 128]), torch.Size([1, 1528, 128])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.16797637939453125  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.1898345947265625  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 1528, 128])
m.shape torch.Size([1589, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.1917252540588379  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.1917252540588379  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 1589, 128]), torch.Size([1, 1589, 128])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.19324064254760742  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.22798681259155273  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 1589, 128])
m.shape torch.Size([1465, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.23002338409423828  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.23002338409423828  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 1465, 128]), torch.Size([1, 1465, 128])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.23142051696777344  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.27193737030029297  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 1465, 128])
m.shape torch.Size([1424, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.27463388442993164  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.27463388442993164  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 1424, 128]), torch.Size([1, 1424, 128])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.27599191665649414  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.32544946670532227  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 1424, 128])
m.shape torch.Size([1261, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.32837820053100586  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.32837820053100586  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 1261, 128]), torch.Size([1, 1261, 128])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.32958078384399414  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.38241147994995117  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 1261, 128])
m.shape torch.Size([1224, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.3858957290649414  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.3858957290649414  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 1224, 128]), torch.Size([1, 1224, 128])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.38706302642822266  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.44713687896728516  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 1224, 128])
m.shape torch.Size([1115, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.4508066177368164  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.4508066177368164  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.4518699645996094  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.5133790969848633  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1052, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.517362117767334  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.517362117767334  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.5183653831481934  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6307373046875 GB
    Memory Allocated: 0.5835700035095215  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([16955, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 0.6639161109924316  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 0.6639161109924316  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 16955, 128]), torch.Size([1, 16955, 128])
----------------------------------------3
 Nvidia-smi: 3.7127685546875 GB
    Memory Allocated: 0.6800856590270996  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 1.848860263824463  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 16955, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 1.7461705207824707  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 1.7736382484436035  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 1.8011059761047363  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 1.773423194885254  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

torch.Size([28802, 256])
first layer input nodes number: 74511
first layer output nodes number: 28802
edges number: 226064
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 1.8016633987426758  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 1.8291311264038086  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 1.8364462852478027  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 1.8364462852478027  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

m.shape torch.Size([570, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9042129516601562  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9042129516601562  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9053001403808594  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.914194107055664  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([519, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.914842128753662  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.914842128753662  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9158320426940918  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.930680751800537  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([367, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9313817024230957  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9313817024230957  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.932081699371338  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9484105110168457  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([305, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.949296474456787  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.949296474456787  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.949878215789795  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9691576957702637  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([287, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9702463150024414  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9702463150024414  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9707937240600586  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9905877113342285  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([240, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9916982650756836  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9916982650756836  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 1.9921560287475586  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.0118398666381836  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([199, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.0129499435424805  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.0129499435424805  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.01332950592041  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.0323076248168945  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([185, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.033540725708008  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.033540725708008  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.033893585205078  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.054006576538086  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([176, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.0553526878356934  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.0553526878356934  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.0556883811950684  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.0771727561950684  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([174, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.0786776542663574  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.0786776542663574  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.079009532928467  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1025729179382324  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([174, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1042466163635254  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1042466163635254  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1045784950256348  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.130465030670166  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([153, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.132063865661621  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.132063865661621  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1323556900024414  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.157160758972168  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([144, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1588144302368164  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1588144302368164  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1590890884399414  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1843576431274414  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([122, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1858973503112793  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1858973503112793  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.1861300468444824  GigaBytes
Max Memory Allocated: 2.2049736976623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.209167003631592  GigaBytes
Max Memory Allocated: 2.2107958793640137  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([118, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.210752010345459  GigaBytes
Max Memory Allocated: 2.2107958793640137  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.210752010345459  GigaBytes
Max Memory Allocated: 2.2107958793640137  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.210977077484131  GigaBytes
Max Memory Allocated: 2.210977077484131  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.2348341941833496  GigaBytes
Max Memory Allocated: 2.2365221977233887  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([102, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.236290454864502  GigaBytes
Max Memory Allocated: 2.2365221977233887  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.236290454864502  GigaBytes
Max Memory Allocated: 2.2365221977233887  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.236485004425049  GigaBytes
Max Memory Allocated: 2.2365221977233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.2584691047668457  GigaBytes
Max Memory Allocated: 2.2600255012512207  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([89, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.259826183319092  GigaBytes
Max Memory Allocated: 2.2600255012512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.259826183319092  GigaBytes
Max Memory Allocated: 2.2600255012512207  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.259995937347412  GigaBytes
Max Memory Allocated: 2.2600255012512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.2803664207458496  GigaBytes
Max Memory Allocated: 2.2818093299865723  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([103, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.2820634841918945  GigaBytes
Max Memory Allocated: 2.2820706367492676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.2820634841918945  GigaBytes
Max Memory Allocated: 2.2820706367492676  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.282259941101074  GigaBytes
Max Memory Allocated: 2.282259941101074  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3072099685668945  GigaBytes
Max Memory Allocated: 2.3089780807495117  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([102, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3089747428894043  GigaBytes
Max Memory Allocated: 2.3089823722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3089747428894043  GigaBytes
Max Memory Allocated: 2.3089823722839355  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.309169292449951  GigaBytes
Max Memory Allocated: 2.309169292449951  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3352389335632324  GigaBytes
Max Memory Allocated: 2.3370871543884277  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([88, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3368334770202637  GigaBytes
Max Memory Allocated: 2.3370871543884277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3368334770202637  GigaBytes
Max Memory Allocated: 2.3370871543884277  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.337001323699951  GigaBytes
Max Memory Allocated: 2.3370871543884277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3606677055358887  GigaBytes
Max Memory Allocated: 2.3623461723327637  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([81, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3622188568115234  GigaBytes
Max Memory Allocated: 2.3623461723327637  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3622188568115234  GigaBytes
Max Memory Allocated: 2.3623461723327637  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3623733520507812  GigaBytes
Max Memory Allocated: 2.3623733520507812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3852386474609375  GigaBytes
Max Memory Allocated: 2.3868608474731445  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3865785598754883  GigaBytes
Max Memory Allocated: 2.3868608474731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3865785598754883  GigaBytes
Max Memory Allocated: 2.3868608474731445  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.6268310546875 GB
    Memory Allocated: 2.3867063522338867  GigaBytes
Max Memory Allocated: 2.3868608474731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6326904296875 GB
    Memory Allocated: 2.4065141677856445  GigaBytes
Max Memory Allocated: 2.4079198837280273  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([53, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.6326904296875 GB
    Memory Allocated: 2.4076223373413086  GigaBytes
Max Memory Allocated: 2.4079198837280273  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6326904296875 GB
    Memory Allocated: 2.4076223373413086  GigaBytes
Max Memory Allocated: 2.4079198837280273  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.6326904296875 GB
    Memory Allocated: 2.4077234268188477  GigaBytes
Max Memory Allocated: 2.4079198837280273  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6483154296875 GB
    Memory Allocated: 2.424099922180176  GigaBytes
Max Memory Allocated: 2.425922393798828  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([73, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.6483154296875 GB
    Memory Allocated: 2.4258852005004883  GigaBytes
Max Memory Allocated: 2.425922393798828  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6483154296875 GB
    Memory Allocated: 2.4258852005004883  GigaBytes
Max Memory Allocated: 2.425922393798828  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.6483154296875 GB
    Memory Allocated: 2.4260244369506836  GigaBytes
Max Memory Allocated: 2.4260244369506836  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6717529296875 GB
    Memory Allocated: 2.4495553970336914  GigaBytes
Max Memory Allocated: 2.451226234436035  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([1310, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.6717529296875 GB
    Memory Allocated: 2.4809627532958984  GigaBytes
Max Memory Allocated: 2.4810848236083984  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6717529296875 GB
    Memory Allocated: 2.4809627532958984  GigaBytes
Max Memory Allocated: 2.4810848236083984  GigaBytes

 h.shape torch.Size([1, 1310, 256]), torch.Size([1, 1310, 256])
----------------------------------------3
 Nvidia-smi: 4.6717529296875 GB
    Memory Allocated: 2.483461380004883  GigaBytes
Max Memory Allocated: 2.483461380004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6717529296875 GB
    Memory Allocated: 2.9349536895751953  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 1310, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6717529296875 GB
    Memory Allocated: 2.8726463317871094  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6737060546875 GB
    Memory Allocated: 2.8735108375549316  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.6756591796875 GB
    Memory Allocated: 2.874375343322754  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.6756591796875 GB
    Memory Allocated: 2.873467445373535  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

torch.Size([5801, 40])
input nodes number: 28802
output nodes number: 5801
edges number: 69694
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6756591796875 GB
    Memory Allocated: 2.873749256134033  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.6756591796875 GB
    Memory Allocated: 2.8737497329711914  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7459716796875 GB
    Memory Allocated: 0.048187255859375  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

pseudo mini batch 2 input nodes size: 78534
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7459716796875 GB
    Memory Allocated: 0.041991233825683594  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7459716796875 GB
    Memory Allocated: 0.041991233825683594  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7459716796875 GB
    Memory Allocated: 0.07943916320800781  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7459716796875 GB
    Memory Allocated: 0.07948112487792969  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7459716796875 GB
    Memory Allocated: 0.043908119201660156  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7459716796875 GB
    Memory Allocated: 0.04632568359375  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7459716796875 GB
    Memory Allocated: 0.04632568359375  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7459716796875 GB
    Memory Allocated: 0.04632568359375  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

torch.Size([78534, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7459716796875 GB
    Memory Allocated: 0.04632568359375  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

m.shape torch.Size([1137, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.1719508171081543  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.1719508171081543  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.1730351448059082  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.18170976638793945  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1455, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.1825551986694336  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.1825551986694336  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 1455, 128]), torch.Size([1, 1455, 128])
----------------------------------------3
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.1839427947998047  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.2047567367553711  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 1455, 128])
m.shape torch.Size([1533, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.2067275047302246  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.2067275047302246  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 1533, 128]), torch.Size([1, 1533, 128])
----------------------------------------3
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.2081894874572754  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.24035310745239258  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 1533, 128])
m.shape torch.Size([1450, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.2423877716064453  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.2423877716064453  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 1450, 128]), torch.Size([1, 1450, 128])
----------------------------------------3
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.24377059936523438  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.2840442657470703  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 1450, 128])
m.shape torch.Size([1381, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.28664541244506836  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.28664541244506836  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 1381, 128]), torch.Size([1, 1381, 128])
----------------------------------------3
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.2879624366760254  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.3353753089904785  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 1381, 128])
m.shape torch.Size([1190, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.3381214141845703  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.3381214141845703  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 1190, 128]), torch.Size([1, 1190, 128])
----------------------------------------3
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.33925628662109375  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.38860082626342773  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 1190, 128])
m.shape torch.Size([1134, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.3918185234069824  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.3918185234069824  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.3928999900817871  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.4475369453430176  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([1127, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.4512953758239746  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.4512953758239746  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.45237016677856445  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.5141081809997559  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1072, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.5181713104248047  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.5181713104248047  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 1072, 128]), torch.Size([1, 1072, 128])
----------------------------------------3
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.5191936492919922  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.584716796875  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 1072, 128])
m.shape torch.Size([20075, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.6799306869506836  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.6799306869506836  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 20075, 128]), torch.Size([1, 20075, 128])
----------------------------------------3
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 0.6990756988525391  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.0757522583007812  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 20075, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 1.958251953125  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 1.9883441925048828  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.0184364318847656  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 1.9881086349487305  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

torch.Size([31554, 256])
first layer input nodes number: 78534
first layer output nodes number: 31554
edges number: 255843
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.019023895263672  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.0491161346435547  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.0566391944885254  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.0566391944885254  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

m.shape torch.Size([580, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.123337745666504  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.123337745666504  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.124444007873535  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.134929656982422  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([497, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.1353321075439453  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.1353321075439453  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.136280059814453  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.150784969329834  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([398, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.1515350341796875  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.1515350341796875  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.152294158935547  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.1696267127990723  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([322, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.17063045501709  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.17063045501709  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.1712446212768555  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.1898012161254883  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([267, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.191270351409912  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.191270351409912  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.191779613494873  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2114028930664062  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([196, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2122788429260254  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2122788429260254  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2126526832580566  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2287278175354004  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([179, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.229745388031006  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.229745388031006  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2300868034362793  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.247157573699951  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([167, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2482709884643555  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2482709884643555  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.248589515686035  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2667455673217773  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([172, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2680745124816895  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2680745124816895  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.268402576446533  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.289398670196533  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([142, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.290599822998047  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.290599822998047  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.2908706665039062  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.310100555419922  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.311339855194092  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.311339855194092  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.3115878105163574  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.330928325653076  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.332188606262207  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.332188606262207  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.3324174880981445  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.351872444152832  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([120, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.353257656097412  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.353257656097412  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.3534865379333496  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.3745436668395996  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.3756675720214844  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.3756675720214844  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.375843048095703  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.3932151794433594  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([114, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.394771099090576  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.394771099090576  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.394988536834717  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.418036937713623  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([115, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.419696807861328  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.419696807861328  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4199161529541016  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4447021484375  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([97, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4461774826049805  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4461774826049805  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4463624954223633  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.468564033508301  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([105, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4702882766723633  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4702882766723633  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4704885482788086  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4959230422973633  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([88, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4974303245544434  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.4974303245544434  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.497598171234131  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.520089626312256  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.521313190460205  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.521313190460205  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.5214428901672363  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.5397305488586426  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([74, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.5411596298217773  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.5411596298217773  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.5413007736206055  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.562190055847168  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.563344955444336  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.563344955444336  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.5634536743164062  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.5803050994873047  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([69, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.5817761421203613  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.5817761421203613  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.5819077491760254  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.6032280921936035  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([54, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.6044082641601562  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.6044082641601562  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.604511260986328  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.621917724609375  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([1397, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.6554336547851562  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.6554336547851562  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

 h.shape torch.Size([1, 1397, 256]), torch.Size([1, 1397, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 2.6580982208251953  GigaBytes
Max Memory Allocated: 2.9661865234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 3.1387481689453125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1397, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 3.0772509574890137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 3.0780887603759766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 3.0789265632629395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 3.0780467987060547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5620, 40])
input nodes number: 31554
output nodes number: 5620
edges number: 68579
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 3.0782976150512695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 3.0782980918884277  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0505828857421875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 3 input nodes size: 73036
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.04388141632080078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.04388141632080078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.07870769500732422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0787515640258789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.04126167297363281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.04363727569580078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.04363727569580078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.04363727569580078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([73036, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.04363727569580078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1045, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.16262292861938477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.16262292861938477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.1636195182800293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.17184209823608398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([1331, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.17261314392089844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.17261314392089844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.17388248443603516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.19292259216308594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([1322, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.19417905807495117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.19417905807495117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1322, 128]), torch.Size([1, 1322, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.19543981552124023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22367238998413086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1322, 128])
m.shape torch.Size([1349, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2256150245666504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2256150245666504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1349, 128]), torch.Size([1, 1349, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22690153121948242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.26421022415161133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1349, 128])
m.shape torch.Size([1254, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2665567398071289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2665567398071289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1254, 128]), torch.Size([1, 1254, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.26775264739990234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3112020492553711  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1254, 128])
m.shape torch.Size([1194, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.31402015686035156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.31402015686035156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1194, 128]), torch.Size([1, 1194, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3151588439941406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3641223907470703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1194, 128])
m.shape torch.Size([1127, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.36731481552124023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.36731481552124023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3683896064758301  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4230365753173828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([988, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4262681007385254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4262681007385254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.42721033096313477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4825139045715332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([917, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4859781265258789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4859781265258789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.48685264587402344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5431928634643555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([19181, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6342177391052246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6342177391052246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 19181, 128]), torch.Size([1, 19181, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6525101661682129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 1.9512724876403809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 19181, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 1.840165615081787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 1.868497371673584  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 1.8968291282653809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 1.8682756423950195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([29708, 256])
first layer input nodes number: 73036
first layer output nodes number: 29708
edges number: 242359
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 1.8973755836486816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 1.9257073402404785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 1.932995319366455  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 1.932995319366455  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([516, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0070672035217285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0070672035217285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0080513954162598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0174527168273926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([459, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.017843246459961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.017843246459961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.018718719482422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0362110137939453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([376, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.037020683288574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.037020683288574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0377378463745117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.054393768310547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([335, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0553574562072754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0553574562072754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0559964179992676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.075413227081299  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([238, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0763025283813477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0763025283813477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.076756477355957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0930986404418945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([220, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0941405296325684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.0941405296325684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.094560146331787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1126036643981934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([196, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.113712787628174  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.113712787628174  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.114086627960205  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1327786445617676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1338000297546387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1338000297546387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1340670585632324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.149287700653076  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1505298614501953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1505298614501953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1508331298828125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1702423095703125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([158, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.171609401702881  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.171609401702881  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1719107627868652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.193307399749756  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([129, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1953463554382324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1953463554382324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.1955924034118652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2147841453552246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([138, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2162528038024902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2162528038024902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2165160179138184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.238889217376709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([138, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2404823303222656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2404823303222656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2407455444335938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2649612426757812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([118, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.266602039337158  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.266602039337158  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.26682710647583  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2891087532043457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([114, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.290639877319336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.290639877319336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2908573150634766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.313905715942383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([93, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.315227508544922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.315227508544922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3154048919677734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.33544921875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([107, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3376898765563965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3376898765563965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3378939628601074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.36238431930542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([107, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.364133834838867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.364133834838867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.364337921142578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.390256881713867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([90, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.391798496246338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.391798496246338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.391970157623291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4149727821350098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([104, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.416886329650879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.416886329650879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4170846939086914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.445054054260254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([106, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.447094440460205  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.447094440460205  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.447296619415283  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4772191047668457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([73, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4790282249450684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4790282249450684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4791674613952637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.500749111175537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.502777576446533  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.502777576446533  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5028939247131348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.521742343902588  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([76, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5235824584960938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5480804443359375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([1603, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5865254402160645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5865254402160645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1603, 256]), torch.Size([1, 1603, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.589582920074463  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1309609413146973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1603, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0621185302734375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.062991142272949  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.063863754272461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0629472732543945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5854, 40])
input nodes number: 29708
output nodes number: 5854
edges number: 76303
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0632476806640625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0632481575012207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.04789304733276367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 4 input nodes size: 61686
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.04129648208618164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.04129648208618164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.07071065902709961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.07075309753417969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.03588294982910156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.037484169006347656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.037484169006347656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.037484169006347656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([61686, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.037484169006347656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1219, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.11456775665283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.11456775665283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1219, 128]), torch.Size([1, 1219, 128])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.11573028564453125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.12595081329345703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1219, 128])
m.shape torch.Size([1665, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.12695741653442383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.12695741653442383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1665, 128]), torch.Size([1, 1665, 128])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.12854528427124023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.15236330032348633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1665, 128])
m.shape torch.Size([1720, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.15402984619140625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.15402984619140625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1720, 128]), torch.Size([1, 1720, 128])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.155670166015625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.19200897216796875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1720, 128])
m.shape torch.Size([1558, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.19431686401367188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.19431686401367188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1558, 128]), torch.Size([1, 1558, 128])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.1958026885986328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.2388916015625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1558, 128])
m.shape torch.Size([1497, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.24171781539916992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.24171781539916992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1497, 128]), torch.Size([1, 1497, 128])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.24314546585083008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.2945408821105957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1497, 128])
m.shape torch.Size([1254, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.29741477966308594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.29741477966308594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1254, 128]), torch.Size([1, 1254, 128])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.2986106872558594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.3504467010498047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1254, 128])
m.shape torch.Size([1151, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.35369062423706055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.35369062423706055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1151, 128]), torch.Size([1, 1151, 128])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.35478830337524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.40967226028442383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1151, 128])
m.shape torch.Size([1006, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.4129610061645508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.4129610061645508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1006, 128]), torch.Size([1, 1006, 128])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.41392040252685547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.46932077407836914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1006, 128])
m.shape torch.Size([881, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.4726219177246094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.4726219177246094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 881, 128]), torch.Size([1, 881, 128])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.4734621047973633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.5272550582885742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 881, 128])
m.shape torch.Size([10127, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.5751242637634277  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.5751242637634277  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10127, 128]), torch.Size([1, 10127, 128])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 0.5847821235656738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.275662899017334  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10127, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.206435203552246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.227919578552246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.249403953552246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.227755069732666  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([22078, 256])
first layer input nodes number: 61686
first layer output nodes number: 22078
edges number: 156254
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.2498655319213867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.2713499069213867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.276613712310791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.276613712310791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([590, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3336491584777832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3336491584777832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3347744941711426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3440184593200684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([541, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3445110321044922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3445110321044922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3455429077148438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3616504669189453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([437, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3624787330627441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3624787330627441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3633122444152832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.384157657623291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([341, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3851051330566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3851051330566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.3857555389404297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4052605628967285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([303, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4063916206359863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4063916206359863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4069695472717285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4286298751831055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([265, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4298691749572754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4298691749572754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4303746223449707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4525437355041504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([268, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.454094409942627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.454094409942627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4546055793762207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4804348945617676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([257, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4821557998657227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4821557998657227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.4826459884643555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.511399269104004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([231, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.5131525993347168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.5131525993347168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.5135931968688965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.5417914390563965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([200, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.5434937477111816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.5434937477111816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.5438752174377441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.5709595680236816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([192, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.572798728942871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.572798728942871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.573164939880371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.601729393005371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([174, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.603553295135498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.603553295135498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6038851737976074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6320948600769043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([137, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6336407661437988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6336407661437988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6339020729064941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.657942295074463  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([145, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6597628593444824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6597628593444824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6600394248962402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6874194145202637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([124, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6890692710876465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6890692710876465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.6893057823181152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7143759727478027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([92, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.715672492980957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.715672492980957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7158479690551758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7356767654418945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([109, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7373700141906738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7373700141906738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7375779151916504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.762526035308838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([87, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7639274597167969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7639274597167969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7640933990478516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7851676940917969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([73, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7864179611206055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7864179611206055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.7865571975708008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8052148818969727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([94, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8069524765014648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8069524765014648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8071317672729492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.832411766052246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([82, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.833977222442627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.833977222442627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8341336250305176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.85728120803833  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8585290908813477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8585290908813477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8586206436157227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8728113174438477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([50, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.873870849609375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.873870849609375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8739662170410156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8894157409667969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8907523155212402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.8907523155212402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.890866756439209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.9102072715759277  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([786, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.9290366172790527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.9290366172790527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 786, 256]), torch.Size([1, 786, 256])
----------------------------------------3
 Nvidia-smi: 5.8104248046875 GB
    Memory Allocated: 1.9305357933044434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 2.1986804008483887  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 786, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 2.147428512573242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 2.148275852203369  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 2.149123191833496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 2.148233413696289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5686, 40])
input nodes number: 22078
output nodes number: 5686
edges number: 58510
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 2.1484150886535645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 2.1484155654907227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.040514469146728516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 5 input nodes size: 58514
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.0358576774597168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.0358576774597168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.06375932693481445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.06380176544189453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.034345149993896484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.03583955764770508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.03583955764770508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.03583955764770508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([58514, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.03583955764770508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1241, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.10660648345947266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.10660648345947266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1241, 128]), torch.Size([1, 1241, 128])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.10778999328613281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.11782550811767578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1241, 128])
m.shape torch.Size([1561, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.11872243881225586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.11872243881225586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1561, 128]), torch.Size([1, 1561, 128])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.12021112442016602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.14254140853881836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1561, 128])
m.shape torch.Size([1602, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.14463424682617188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.14463424682617188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1602, 128]), torch.Size([1, 1602, 128])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.1461620330810547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.18035507202148438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1602, 128])
m.shape torch.Size([1411, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.1822824478149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.1822824478149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1411, 128]), torch.Size([1, 1411, 128])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.18362808227539062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.22367191314697266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1411, 128])
m.shape torch.Size([1326, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.22616052627563477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.22616052627563477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1326, 128]), torch.Size([1, 1326, 128])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.22742509841918945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.2729496955871582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1326, 128])
m.shape torch.Size([1164, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.2756476402282715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.2756476402282715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1164, 128]), torch.Size([1, 1164, 128])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.27675771713256836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.32453298568725586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1164, 128])
m.shape torch.Size([1047, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.3274726867675781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.3274726867675781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.32847118377685547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.37933778762817383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([910, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.3823099136352539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.3823099136352539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.3831777572631836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.43338680267333984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([759, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.43621015548706055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.43621015548706055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 759, 128]), torch.Size([1, 759, 128])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.4369339942932129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.4851255416870117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 759, 128])
m.shape torch.Size([9156, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.5284228324890137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.5284228324890137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9156, 128]), torch.Size([1, 9156, 128])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 0.5371546745300293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.1571154594421387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9156, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.0936260223388672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.112868309020996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.132110595703125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.112717628479004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([20177, 256])
first layer input nodes number: 58514
first layer output nodes number: 20177
edges number: 141427
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.1325488090515137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.1517910957336426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.156601905822754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.156601905822754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([607, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2141456604003906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2141456604003906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 607, 256]), torch.Size([1, 607, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2153034210205078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.225006103515625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 607, 256])
m.shape torch.Size([487, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2253637313842773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2253637313842773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.226292610168457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2414846420288086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([434, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2422757148742676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2422757148742676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2431035041809082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2650227546691895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([330, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2658791542053223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2658791542053223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2665085792541504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.292849063873291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([297, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.294787883758545  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.294787883758545  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.2953543663024902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.318361759185791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([301, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.319814682006836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.319814682006836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.3203887939453125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.3473968505859375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([266, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.3488998413085938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.3488998413085938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.3494071960449219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.3760466575622559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([234, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.3775925636291504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.3775925636291504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.3780388832092285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.4034790992736816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([207, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.4052305221557617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.4052305221557617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.405625343322754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.430893898010254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([224, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.432849407196045  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.432849407196045  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.433276653289795  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.463611125946045  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([209, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.4656071662902832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.4656071662902832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.466005802154541  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.4970993995666504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([155, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.4986882209777832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.4986882209777832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.4989838600158691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5241131782531738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([160, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5259647369384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5259647369384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5262699127197266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5543460845947266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([147, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5561718940734863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5561718940734863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5564522743225098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.58420991897583  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([104, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5855693817138672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5855693817138672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.5857677459716797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.6067943572998047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([111, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.6084022521972656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.6084022521972656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.6086139678955078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.632537841796875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([118, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.6343603134155273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.6343603134155273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.6345853805541992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.6615934371948242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([107, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.663332462310791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.663332462310791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.663536548614502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.689455509185791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([75, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.6907234191894531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.6907234191894531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.690866470336914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7100353240966797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([91, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7117133140563965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7117133140563965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7118868827819824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7363600730895996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([75, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7377872467041016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7377872467041016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7379302978515625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7591018676757812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7604498863220215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7604498863220215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7605643272399902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7783026695251465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([57, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.779505729675293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.779505729675293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7796144485473633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.797226905822754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7982797622680664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7982797622680664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.7983713150024414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.8138437271118164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([781, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.832564353942871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.832564353942871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 781, 256]), torch.Size([1, 781, 256])
----------------------------------------3
 Nvidia-smi: 5.8123779296875 GB
    Memory Allocated: 1.8340539932250977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8397216796875 GB
    Memory Allocated: 2.102524757385254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 781, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8397216796875 GB
    Memory Allocated: 2.050788402557373  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8397216796875 GB
    Memory Allocated: 2.0516357421875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.052483081817627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.05159330368042  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5685, 40])
input nodes number: 20177
output nodes number: 5685
edges number: 59024
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.051786422729492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0517868995666504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.038726806640625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 6 input nodes size: 74166
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.034345149993896484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.034345149993896484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.06971025466918945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.06975269317626953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0418086051940918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04327058792114258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04327058792114258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04327058792114258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([74166, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04327058792114258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1993, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12298965454101562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12298965454101562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1993, 128]), torch.Size([1, 1993, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12489032745361328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14009571075439453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1993, 128])
m.shape torch.Size([2384, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1414189338684082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1414189338684082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2384, 128]), torch.Size([1, 2384, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14371490478515625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17895221710205078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2384, 128])
m.shape torch.Size([2252, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18143177032470703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18143177032470703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2252, 128]), torch.Size([1, 2252, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18364238739013672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23223209381103516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2252, 128])
m.shape torch.Size([1995, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23545360565185547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23545360565185547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1995, 128]), torch.Size([1, 1995, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23735618591308594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.29354190826416016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1995, 128])
m.shape torch.Size([1765, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2967987060546875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2967987060546875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1765, 128]), torch.Size([1, 1765, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.29848194122314453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.35907840728759766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1765, 128])
m.shape torch.Size([1397, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36223363876342773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36223363876342773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1397, 128]), torch.Size([1, 1397, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36356592178344727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4218020439147949  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1397, 128])
m.shape torch.Size([1203, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.42515134811401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.42515134811401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4262986183166504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.48366212844848633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([1016, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.48696422576904297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.48696422576904297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4879331588745117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.544029712677002  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([926, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5475192070007324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5475192070007324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 926, 128]), torch.Size([1, 926, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5484023094177246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6051149368286133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 926, 128])
m.shape torch.Size([9715, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6509981155395508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6509981155395508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9715, 128]), torch.Size([1, 9715, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6610321998596191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3188433647155762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9715, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.248852252960205  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2723565101623535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.295860767364502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.272172451019287  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([24646, 256])
first layer input nodes number: 74166
first layer output nodes number: 24646
edges number: 160737
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2964153289794922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3199195861816406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3257956504821777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3257956504821777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1023, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3610100746154785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3610100746154785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1023, 256]), torch.Size([1, 1023, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3629612922668457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3791251182556152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1023, 256])
m.shape torch.Size([882, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.379845142364502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.379845142364502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 882, 256]), torch.Size([1, 882, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3815274238586426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4072198867797852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 882, 256])
m.shape torch.Size([684, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4088263511657715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4088263511657715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 684, 256]), torch.Size([1, 684, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4101309776306152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4419398307800293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 684, 256])
m.shape torch.Size([531, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.444258213043213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.444258213043213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 531, 256]), torch.Size([1, 531, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4452710151672363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.479301929473877  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 531, 256])
m.shape torch.Size([446, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4809389114379883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4809389114379883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4817895889282227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5128798484802246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5143060684204102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5143060684204102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.514918327331543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5428762435913086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([256, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5442924499511719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5442924499511719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5447807312011719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5691947937011719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([194, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5704426765441895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5704426765441895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.570812702178955  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5919041633605957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([207, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5935101509094238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5935101509094238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.593904972076416  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.619173526763916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([156, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6204757690429688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6204757690429688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6207733154296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6418991088867188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([125, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6430721282958984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6430721282958984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.643310546875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6619071960449219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6629338264465332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6629338264465332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6631207466125488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.679008960723877  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([76, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6798653602600098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6798653602600098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6800103187561035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6933465003967285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([69, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6942028999328613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6942028999328613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6943345069885254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7073636054992676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7080621719360352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7080621719360352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7081632614135742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7188787460327148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7195358276367188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7195358276367188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7196235656738281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7295379638671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7300500869750977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7300500869750977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7301149368286133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7378969192504883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7385568618774414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7385568618774414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.738633155822754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7483224868774414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.748887062072754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.748887062072754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7489500045776367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7573843002319336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7580256462097168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7580256462097168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7580924034118652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.767505168914795  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7680168151855469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7680168151855469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7680683135986328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7756900787353516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.776045322418213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.776045322418213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7760796546936035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7814011573791504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7818703651428223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7818703651428223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7819123268127441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.788710117340088  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7890582084655762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7890582084655762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7890887260437012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7942461967468262  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([279, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8009347915649414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8009347915649414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.801466941833496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8962812423706055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 279, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8675627708435059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.868408203125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8692536354064941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.86836576461792  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5671, 40])
input nodes number: 24646
output nodes number: 5671
edges number: 35375
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8685903549194336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8685908317565918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04616355895996094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 7 input nodes size: 76683
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.041806697845458984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.041806697845458984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07837200164794922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0784144401550293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04300689697265625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.044503211975097656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.044503211975097656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.044503211975097656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([76683, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.044503211975097656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1951, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12772035598754883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12772035598754883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1951, 128]), torch.Size([1, 1951, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12958097457885742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14446592330932617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1951, 128])
m.shape torch.Size([2369, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14603281021118164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14603281021118164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2369, 128]), torch.Size([1, 2369, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14829206466674805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18344831466674805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2369, 128])
m.shape torch.Size([2308, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18570756912231445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18570756912231445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2308, 128]), torch.Size([1, 2308, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18790864944458008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2379474639892578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2308, 128])
m.shape torch.Size([2123, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24007415771484375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24007415771484375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2123, 128]), torch.Size([1, 2123, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24306917190551758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30355310440063477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2123, 128])
m.shape torch.Size([1833, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30691099166870117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30691099166870117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1833, 128]), torch.Size([1, 1833, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30865907669067383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37221336364746094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1833, 128])
m.shape torch.Size([1509, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3756566047668457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3756566047668457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1509, 128]), torch.Size([1, 1509, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37709569931030273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.43943262100219727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1509, 128])
m.shape torch.Size([1311, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44308900833129883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44308900833129883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1311, 128]), torch.Size([1, 1311, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4443392753601074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5068526268005371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1311, 128])
m.shape torch.Size([1071, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5103130340576172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5103130340576172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5113344192504883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5713300704956055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([946, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5748791694641113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5748791694641113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 946, 128]), torch.Size([1, 946, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5757813453674316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6339669227600098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 946, 128])
m.shape torch.Size([10101, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6816811561584473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6816811561584473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10101, 128]), torch.Size([1, 10101, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6913142204284668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3800339698791504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10101, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3065285682678223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3308682441711426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.355207920074463  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3306779861450195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25522, 256])
first layer input nodes number: 76683
first layer output nodes number: 25522
edges number: 167593
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3557815551757812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3801212310791016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3862061500549316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3862061500549316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1060, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.419337272644043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.419337272644043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1060, 256]), torch.Size([1, 1060, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.421567440032959  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4398841857910156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1060, 256])
m.shape torch.Size([902, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.440462589263916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.440462589263916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 902, 256]), torch.Size([1, 902, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.442183017730713  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.467989444732666  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 902, 256])
m.shape torch.Size([705, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4693636894226074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4693636894226074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 705, 256]), torch.Size([1, 705, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4707083702087402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.500380516052246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 705, 256])
m.shape torch.Size([566, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.501943588256836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.501943588256836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5030231475830078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5350399017333984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([439, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5367350578308105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5367350578308105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5375723838806152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5733819007873535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([348, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5749702453613281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5749702453613281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5756340026855469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6047930717468262  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([270, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6062779426574707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6062779426574707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.60679292678833  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6327919960021973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([196, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6340417861938477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6340417861938477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.634415626525879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6557245254516602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([165, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6569652557373047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6569652557373047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6572799682617188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6774215698242188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([134, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6785521507263184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6785521507263184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6788077354431152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6969542503356934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([109, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6979789733886719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6979789733886719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6981868743896484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7144031524658203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7154297828674316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7154297828674316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7156167030334473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7315049171447754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.732274055480957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.732274055480957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.732405662536621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7445135116577148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7453227043151855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7453227043151855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7454466819763184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7577204704284668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7583508491516113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7583508491516113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7584424018859863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7681469917297363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7688393592834473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7688393592834473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7689309120178223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7792763710021973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.77994966506958  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.77994966506958  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7800335884094238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7901043891906738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7905125617980957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7905125617980957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7905621528625488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7968602180480957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.797274112701416  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.797274112701416  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7973198890686035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8034539222717285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8039889335632324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8039889335632324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.804044246673584  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8118433952331543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.812098503112793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.812098503112793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8121252059936523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8160772323608398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8163599967956543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8163599967956543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8163866996765137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8205256462097168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8207998275756836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8207998275756836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8208246231079102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8248414993286133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8251981735229492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8251981735229492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8252286911010742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8303861618041992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([245, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8362579345703125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8362579345703125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8367252349853516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9189701080322266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 245, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8918023109436035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.892643928527832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8934855461120605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.892601490020752  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5647, 40])
input nodes number: 25522
output nodes number: 5647
edges number: 33141
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8928303718566895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8928308486938477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.047449588775634766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 8 input nodes size: 70886
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.043003082275390625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.043003082275390625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07680416107177734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07684659957885742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04023885726928711  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04198122024536133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04198122024536133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04198122024536133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([70886, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04198122024536133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1419, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13019323348999023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13019323348999023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1419, 128]), torch.Size([1, 1419, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1315464973449707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14237260818481445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1419, 128])
m.shape torch.Size([1902, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14425086975097656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14425086975097656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1902, 128]), torch.Size([1, 1902, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14606475830078125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17327308654785156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1902, 128])
m.shape torch.Size([1900, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17572784423828125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17572784423828125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1900, 128]), torch.Size([1, 1900, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17753982543945312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21740341186523438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1900, 128])
m.shape torch.Size([1801, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21993255615234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21993255615234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1801, 128]), torch.Size([1, 1801, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2216501235961914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.27145957946777344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1801, 128])
m.shape torch.Size([1661, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.27456092834472656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.27456092834472656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.27614498138427734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3342161178588867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
m.shape torch.Size([1482, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3376641273498535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3376641273498535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1482, 128]), torch.Size([1, 1482, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3390774726867676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.39998483657836914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1482, 128])
m.shape torch.Size([1292, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.40359067916870117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.40359067916870117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1292, 128]), torch.Size([1, 1292, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.40482282638549805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4666438102722168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1292, 128])
m.shape torch.Size([1178, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4705214500427246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4705214500427246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1178, 128]), torch.Size([1, 1178, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.47164487838745117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5365443229675293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1178, 128])
m.shape torch.Size([1122, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5407977104187012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5407977104187012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.541867733001709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6109175682067871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([11490, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6651711463928223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6651711463928223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 11490, 128]), torch.Size([1, 11490, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6761288642883301  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4580864906311035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 11490, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.378584384918213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4026618003845215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.42673921585083  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4024734497070312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25247, 256])
first layer input nodes number: 70886
first layer output nodes number: 25247
edges number: 178790
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.427269458770752  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4513468742370605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4573664665222168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4573664665222168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([634, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5113482475280762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5113482475280762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5125575065612793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5234365463256836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([602, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5242524147033691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5242524147033691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5254006385803223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5438146591186523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([431, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5446982383728027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5446982383728027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.545520305633545  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5637922286987305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([357, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5648150444030762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5648150444030762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5654959678649902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5859856605529785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([366, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5874042510986328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5874042510986328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5881023406982422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.613351821899414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([265, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6145310401916504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6145310401916504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6150364875793457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.637773036956787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([257, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.639723777770996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.639723777770996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.640213966369629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.665226936340332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([242, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6668429374694824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6668429374694824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.667304515838623  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6936144828796387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([241, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6954684257507324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6954684257507324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6959280967712402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7253470420837402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([209, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.727126121520996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.727126121520996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.727524757385254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7558279037475586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([157, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7572884559631348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7572884559631348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7575879096984863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7809453010559082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([171, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7827682495117188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7827682495117188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7830944061279297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8108177185058594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([133, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.812443733215332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.812443733215332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.812697410583496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8360357284545898  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([137, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.837752342224121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.837752342224121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8380136489868164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8638830184936523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([124, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8655405044555664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8655405044555664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8657770156860352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8908472061157227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([111, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8924360275268555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8924360275268555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8926477432250977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9165716171264648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([95, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9180183410644531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9180183410644531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9181995391845703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9399433135986328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([83, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9413480758666992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9413480758666992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9415063858032227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9616117477416992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([80, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9629936218261719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9629936218261719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9631462097167969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9835929870605469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.984574317932129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.984574317932129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9846792221069336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9994707107543945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.00137996673584  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.00137996673584  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.001490592956543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0178632736206055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([62, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0191192626953125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0191192626953125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.019237518310547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.037567138671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0386576652526855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0386576652526855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.038756847381592  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0548243522644043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.05574369430542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.05574369430542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.055823802947998  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.069362163543701  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([699, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.086599826812744  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.086599826812744  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.08793306350708  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.329002857208252  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 699, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.280880928039551  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2817249298095703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.28256893157959  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2816824913024902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5663, 40])
input nodes number: 25247
output nodes number: 5663
edges number: 55025
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2819156646728516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2819161415100098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04529380798339844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 9 input nodes size: 72905
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.040241241455078125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.040241241455078125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07500505447387695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07504749298095703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.041203975677490234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042737483978271484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042737483978271484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042737483978271484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([72905, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042737483978271484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1786, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1243753433227539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1243753433227539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1786, 128]), torch.Size([1, 1786, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12607860565185547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14059686660766602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1786, 128])
m.shape torch.Size([2252, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1418929100036621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1418929100036621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2252, 128]), torch.Size([1, 2252, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14441537857055664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1774430274963379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2252, 128])
m.shape torch.Size([2148, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17959070205688477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17959070205688477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2148, 128]), torch.Size([1, 2148, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1816391944885254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.22722673416137695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2148, 128])
m.shape torch.Size([1919, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.22986268997192383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.22986268997192383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1919, 128]), torch.Size([1, 1919, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23169279098510742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.28476572036743164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1919, 128])
m.shape torch.Size([1762, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2880516052246094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2880516052246094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1762, 128]), torch.Size([1, 1762, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2897319793701172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.35022544860839844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1762, 128])
m.shape torch.Size([1463, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.35357093811035156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.35357093811035156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1463, 128]), torch.Size([1, 1463, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3549661636352539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4161367416381836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1463, 128])
m.shape torch.Size([1249, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.41960811614990234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.41960811614990234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1249, 128]), torch.Size([1, 1249, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.42079925537109375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4830155372619629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1249, 128])
m.shape torch.Size([1133, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4867420196533203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4867420196533203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4878225326538086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5495758056640625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([987, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5532712936401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5532712936401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5542125701904297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.615870475769043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([10021, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6631836891174316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6631836891174316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10021, 128]), torch.Size([1, 10021, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6727404594421387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3592076301574707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10021, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.287121295928955  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3106961250305176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.33427095413208  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.310511589050293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([24720, 256])
first layer input nodes number: 72905
first layer output nodes number: 24720
edges number: 164898
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3348164558410645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.358391284942627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3642849922180176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3642849922180176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([912, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4047608375549316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4047608375549316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 912, 256]), torch.Size([1, 912, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4065003395080566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4204163551330566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 912, 256])
m.shape torch.Size([812, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4211382865905762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4211382865905762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 812, 256]), torch.Size([1, 812, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.42268705368042  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4462542533874512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 812, 256])
m.shape torch.Size([624, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.447542667388916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.447542667388916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.448732852935791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4763808250427246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.478170394897461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.478170394897461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4790496826171875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5118961334228516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([409, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5138425827026367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5138425827026367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.514622688293457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5435171127319336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([336, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.545064926147461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.545064926147461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.545705795288086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.574091911315918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([270, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5755882263183594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5755882263183594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5761032104492188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6027722358703613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([232, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6042985916137695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6042985916137695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.604741096496582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6299638748168945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([186, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6313519477844238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6313519477844238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.631706714630127  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.654411792755127  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([167, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6558399200439453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6558399200439453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.656158447265625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6787738800048828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6799893379211426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6799893379211426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6802372932434082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.699577808380127  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7008609771728516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7008609771728516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7010936737060547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7208728790283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([97, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.721968650817871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.721968650817871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.722153663635254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7391748428344727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([66, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7399706840515137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7399706840515137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7400965690612793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7525591850280762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7535920143127441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7535920143127441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.753736972808838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7691025733947754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7701835632324219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7701835632324219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7703266143798828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7864913940429688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7872209548950195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7872209548950195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7873144149780273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7985296249389648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7994866371154785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7994866371154785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7995972633361816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8136467933654785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8144865036010742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8144865036010742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.814579963684082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.827103614807129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.82796049118042  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.82796049118042  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.828050136566162  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8406901359558105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8413519859313965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8413519859313965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.841418743133545  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8512988090515137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8519210815429688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8519210815429688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.851980209350586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.86114501953125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.861778736114502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.861778736114502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8618359565734863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.871105670928955  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8715615272521973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8715615272521973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8716015815734863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.878370761871338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([385, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8876018524169922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8876018524169922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.888336181640625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0227890014648438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 385, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9886503219604492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9894967079162598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9903430938720703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9894542694091797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5680, 40])
input nodes number: 24720
output nodes number: 5680
edges number: 40806
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9896836280822754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9896841049194336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.045739173889160156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 10 input nodes size: 77158
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04120635986328125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04120635986328125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07799816131591797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07804059982299805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04323434829711914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04474496841430664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04474496841430664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04474496841430664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([77158, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04474496841430664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1865, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12847328186035156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12847328186035156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1865, 128]), torch.Size([1, 1865, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13025188446044922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14448070526123047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1865, 128])
m.shape torch.Size([2366, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14586210250854492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14586210250854492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2366, 128]), torch.Size([1, 2366, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1484055519104004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18365049362182617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2366, 128])
m.shape torch.Size([2402, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1859583854675293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1859583854675293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2402, 128]), torch.Size([1, 2402, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1885838508605957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23909997940063477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2402, 128])
m.shape torch.Size([2076, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24253606796264648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24253606796264648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2076, 128]), torch.Size([1, 2076, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24461984634399414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30457448959350586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2076, 128])
m.shape torch.Size([1904, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3081240653991699  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3081240653991699  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1904, 128]), torch.Size([1, 1904, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3099398612976074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37577390670776367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1904, 128])
m.shape torch.Size([1574, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37936925888061523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37936925888061523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1574, 128]), torch.Size([1, 1574, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38087034225463867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4454169273376465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1574, 128])
m.shape torch.Size([1276, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4489254951477051  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4489254951477051  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1276, 128]), torch.Size([1, 1276, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.45014238357543945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5111088752746582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1276, 128])
m.shape torch.Size([1144, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.514864444732666  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.514864444732666  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1144, 128]), torch.Size([1, 1144, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5159554481506348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5783505439758301  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1144, 128])
m.shape torch.Size([931, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5818004608154297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5818004608154297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5826883316040039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.640110969543457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([10153, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6880803108215332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6880803108215332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10153, 128]), torch.Size([1, 10153, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6977629661560059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3880524635314941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10153, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.313638687133789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.338139533996582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.362640380859375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3379478454589844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25691, 256])
first layer input nodes number: 77158
first layer output nodes number: 25691
edges number: 169064
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3632173538208008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3877182006835938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3946785926818848  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3946785926818848  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([992, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.428138256072998  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.428138256072998  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 992, 256]), torch.Size([1, 992, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.430030345916748  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4457755088806152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 992, 256])
m.shape torch.Size([872, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4466166496276855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4466166496276855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 872, 256]), torch.Size([1, 872, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.448279857635498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4732279777526855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 872, 256])
m.shape torch.Size([735, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.474532127380371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.474532127380371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 735, 256]), torch.Size([1, 735, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4759340286254883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5070757865905762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 735, 256])
m.shape torch.Size([552, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5085105895996094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5085105895996094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5095634460449219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5402565002441406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([489, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.542116641998291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.542116641998291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5430493354797363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5785927772521973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([379, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5803122520446777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5803122520446777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5810351371765137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6131949424743652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([263, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.614603042602539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.614603042602539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6151046752929688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.642467975616455  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([242, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.644078254699707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.644078254699707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6445398330688477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6708498001098633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([170, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6720895767211914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6720895767211914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6724138259887695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6931657791137695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([142, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.694368839263916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.694368839263916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6946396827697754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.713869571685791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([105, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7148447036743164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7148447036743164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7150449752807617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.730666160583496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([79, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7314772605895996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7314772605895996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7316279411315918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7444357872009277  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7451729774475098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7451729774475098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7452969551086426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7567028999328613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7575159072875977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7575159072875977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7576398849487305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.769913673400879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7706446647644043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7706446647644043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.770749568939209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7818694114685059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7823553085327148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7823553085327148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7824220657348633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7899656295776367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7904062271118164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7904062271118164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.790461540222168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7970991134643555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7975735664367676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7975735664367676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7976288795471191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8046536445617676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8052287101745605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8052287101745605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8052916526794434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8137259483337402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8142328262329102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8142328262329102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.814286231994629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8218164443969727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8222541809082031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8222541809082031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8222980499267578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8287906646728516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8290014266967773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8290014266967773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8290224075317383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8322744369506836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8325514793395996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8325514793395996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8325762748718262  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8365931510925293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8368115425109863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8368115425109863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8368306159973145  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8400540351867676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([251, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8460760116577148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8460760116577148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8465547561645508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9308137893676758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 251, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9038300514221191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9046745300292969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9055190086364746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9046320915222168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5667, 40])
input nodes number: 25691
output nodes number: 5667
edges number: 33579
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9048643112182617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.90486478805542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04771852493286133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 11 input nodes size: 76924
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04323244094848633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04323244094848633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07991266250610352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0799551010131836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0431208610534668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0446324348449707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0446324348449707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0446324348449707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([76924, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0446324348449707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1912, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12823963165283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12823963165283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1912, 128]), torch.Size([1, 1912, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13006305694580078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14465045928955078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1912, 128])
m.shape torch.Size([2376, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14612102508544922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14612102508544922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2376, 128]), torch.Size([1, 2376, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14880609512329102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18384408950805664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2376, 128])
m.shape torch.Size([2262, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1861100196838379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1861100196838379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2262, 128]), torch.Size([1, 2262, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18859243392944336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2362837791442871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2262, 128])
m.shape torch.Size([1995, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23889398574829102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23889398574829102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1995, 128]), torch.Size([1, 1995, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24079656600952148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2969822883605957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1995, 128])
m.shape torch.Size([1800, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3003225326538086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3003225326538086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1800, 128]), torch.Size([1, 1800, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30203914642333984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36460018157958984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1800, 128])
m.shape torch.Size([1516, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36807918548583984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36807918548583984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1516, 128]), torch.Size([1, 1516, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3695249557495117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.432037353515625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1516, 128])
m.shape torch.Size([1254, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4355001449584961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4355001449584961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1254, 128]), torch.Size([1, 1254, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.43669605255126953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.49767589569091797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1254, 128])
m.shape torch.Size([1135, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5014076232910156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5014076232910156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5024900436401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5646705627441406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([917, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5680646896362305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5680646896362305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.568939208984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6259174346923828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([10314, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6746611595153809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6746611595153809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10314, 128]), torch.Size([1, 10314, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6844973564147949  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3828673362731934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10314, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3091378211975098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3334383964538574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.357738971710205  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3332481384277344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25481, 256])
first layer input nodes number: 76924
first layer output nodes number: 25481
edges number: 168777
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.358314037322998  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3826146125793457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3886899948120117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3886899948120117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1041, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.423466682434082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.423466682434082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1041, 256]), torch.Size([1, 1041, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4257946014404297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4453644752502441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1041, 256])
m.shape torch.Size([885, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.445589542388916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.445589542388916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 885, 256]), torch.Size([1, 885, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.447277545928955  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.472597599029541  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 885, 256])
m.shape torch.Size([727, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4738502502441406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4738502502441406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4752368927001953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.507491111755371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([522, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5088047981262207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5088047981262207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5098004341125488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5386738777160645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([460, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.54038667678833  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.54038667678833  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5412640571594238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5737080574035645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([331, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.575209617614746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.575209617614746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.575840950012207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6101264953613281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([259, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6116366386413574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6116366386413574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6121306419372559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6397833824157715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([225, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6412668228149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6412668228149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6416959762573242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6661577224731445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6673188209533691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6673188209533691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6676220893859863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6870312690734863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([133, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6881580352783203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6881580352783203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6884117126464844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7064228057861328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([123, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.707596778869629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.707596778869629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7078313827514648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.726130485534668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([85, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7269935607910156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7269935607910156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7271556854248047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.740936279296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([80, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7418551445007324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7418551445007324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7420077323913574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7560458183288574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([71, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.756925106048584  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.756925106048584  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7570605278015137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7704672813415527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7712650299072266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7712650299072266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7713794708251953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7835102081298828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7841911315917969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7841911315917969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7842826843261719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7946281433105469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7952361106872559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7952361106872559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7953124046325684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8044676780700684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.80503511428833  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.80503511428833  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8051018714904785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.81358003616333  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.814040184020996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.814040184020996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.814091682434082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8209924697875977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8215436935424805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8215436935424805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8216009140014648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8296689987182617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8300848007202148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8300848007202148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8301267623901367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8363370895385742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8366756439208984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8366756439208984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8367080688476562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8417339324951172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8420052528381348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8420052528381348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8420300483703613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8460469245910645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8463115692138672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8463115692138672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.846334457397461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8502025604248047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([255, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.856318473815918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.856318473815918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8568048477172852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9424066543579102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 255, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9136204719543457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.914463996887207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9153075218200684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.914421558380127  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5660, 40])
input nodes number: 25481
output nodes number: 5660
edges number: 34036
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9146533012390137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9146537780761719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.047605037689208984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 12 input nodes size: 76335
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04311990737915039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04311990737915039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07951927185058594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07956171035766602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04283905029296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04430961608886719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04430961608886719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04430961608886719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([76335, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04430961608886719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1914, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1262822151184082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1262822151184082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1914, 128]), torch.Size([1, 1914, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12810754776000977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14271020889282227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1914, 128])
m.shape torch.Size([2265, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14446067810058594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14446067810058594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2265, 128]), torch.Size([1, 2265, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14673709869384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17999553680419922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2265, 128])
m.shape torch.Size([2344, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1819157600402832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1819157600402832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2344, 128]), torch.Size([1, 2344, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18446636199951172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23470592498779297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2344, 128])
m.shape torch.Size([2091, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23805904388427734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23805904388427734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24019670486450195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3000926971435547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([1883, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30299806594848633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30299806594848633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1883, 128]), torch.Size([1, 1883, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3047938346862793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3701171875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1883, 128])
m.shape torch.Size([1501, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37351369857788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37351369857788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1501, 128]), torch.Size([1, 1501, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37494516372680664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4366917610168457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1501, 128])
m.shape torch.Size([1239, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4401116371154785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4401116371154785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1239, 128]), torch.Size([1, 1239, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44129323959350586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5020594596862793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1239, 128])
m.shape torch.Size([1145, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5058364868164062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5058364868164062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1145, 128]), torch.Size([1, 1145, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5069284439086914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5695095062255859  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1145, 128])
m.shape torch.Size([947, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5730276107788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5730276107788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5739307403564453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6324920654296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([9881, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6791567802429199  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6791567802429199  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9881, 128]), torch.Size([1, 9881, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6885800361633301  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3699564933776855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9881, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2979087829589844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.321950912475586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3459930419921875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.321763038635254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25210, 256])
first layer input nodes number: 76335
first layer output nodes number: 25210
edges number: 165427
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3465638160705566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3706059455871582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3766164779663086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3766164779663086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1033, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4084429740905762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4084429740905762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1033, 256]), torch.Size([1, 1033, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4105401039123535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.427947998046875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1033, 256])
m.shape torch.Size([896, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.429025650024414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.429025650024414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 896, 256]), torch.Size([1, 896, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.430734634399414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4566164016723633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 896, 256])
m.shape torch.Size([741, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4581036567687988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4581036567687988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 741, 256]), torch.Size([1, 741, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.459517002105713  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4913520812988281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 741, 256])
m.shape torch.Size([605, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.493290901184082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.493290901184082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 605, 256]), torch.Size([1, 605, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4944448471069336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5318689346313477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 605, 256])
m.shape torch.Size([480, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5339479446411133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5339479446411133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5348634719848633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5710511207580566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([359, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5726637840270996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5726637840270996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5733485221862793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6035676002502441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([272, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.605055332183838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.605055332183838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.605574131011963  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.632479190826416  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([227, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6339654922485352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6339654922485352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6343984603881836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6590776443481445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([160, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.660245418548584  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.660245418548584  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.660550594329834  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.680081844329834  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([133, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6812076568603516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6812076568603516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6814613342285156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.699472427368164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([105, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.700456142425537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.700456142425537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7006564140319824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7162775993347168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([81, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7171120643615723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7171120643615723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.71726655960083  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7303986549377441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7311840057373047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7311840057373047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7313156127929688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7434234619140625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7441248893737793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7441248893737793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7442336082458496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7549967765808105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7556633949279785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7556633949279785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7557587623596191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7658677101135254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7664508819580078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7664508819580078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7665290832519531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7753658294677734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7758007049560547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7758007049560547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7758560180664062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7824935913085938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.782881259918213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.782881259918213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7829270362854004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.788740634918213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7891016006469727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7891016006469727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7891416549682617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.794508934020996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7948541641235352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7948541641235352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7948904037475586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8000001907348633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.800163745880127  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.800163745880127  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8001809120178223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8027215003967285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8029670715332031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8029670715332031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8029899597167969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8065376281738281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8066811561584473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8066811561584473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.806694507598877  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8088574409484863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.809035301208496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.809035301208496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8090505599975586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.811629295349121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([223, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8169803619384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8169803619384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8174057006835938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8922653198242188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 223, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8663854598999023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8672294616699219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8680734634399414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8671870231628418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5661, 40])
input nodes number: 25210
output nodes number: 5661
edges number: 31825
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.867417812347412  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8674182891845703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.047214508056640625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 13 input nodes size: 75504
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04283952713012695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04283952713012695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0788426399230957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07888507843017578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042443275451660156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04388236999511719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04388236999511719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04388236999511719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([75504, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04388236999511719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([2015, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12386369705200195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12386369705200195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2015, 128]), torch.Size([1, 2015, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12578535079956055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1411585807800293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2015, 128])
m.shape torch.Size([2351, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14325714111328125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14325714111328125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2351, 128]), torch.Size([1, 2351, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14645051956176758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18081378936767578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2351, 128])
m.shape torch.Size([2320, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18305587768554688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18305587768554688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2320, 128]), torch.Size([1, 2320, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18575668334960938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23588180541992188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2320, 128])
m.shape torch.Size([2064, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23881912231445312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23881912231445312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2064, 128]), torch.Size([1, 2064, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24085474014282227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30008935928344727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2064, 128])
m.shape torch.Size([1781, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3025197982788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3025197982788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1781, 128]), torch.Size([1, 1781, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3042182922363281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36536407470703125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1781, 128])
m.shape torch.Size([1440, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3686347007751465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3686347007751465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1440, 128]), torch.Size([1, 1440, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3700079917907715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.42941808700561523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1440, 128])
m.shape torch.Size([1272, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.43297719955444336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.43297719955444336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1272, 128]), torch.Size([1, 1272, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4341902732849121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.49656057357788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1272, 128])
m.shape torch.Size([1103, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5001616477966309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5001616477966309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.501213550567627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5623660087585449  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([887, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5656466484069824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5656466484069824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5664925575256348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6222233772277832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([9605, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6676006317138672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6676006317138672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9605, 128]), torch.Size([1, 9605, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.677161693572998  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.327925682067871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9605, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2579140663146973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2816014289855957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3052887916564941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2814159393310547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([24838, 256])
first layer input nodes number: 75504
first layer output nodes number: 24838
edges number: 161239
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3058533668518066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.329540729522705  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3354625701904297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3354625701904297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1102, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3673524856567383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3673524856567383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1102, 256]), torch.Size([1, 1102, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3696846961975098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3874139785766602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1102, 256])
m.shape torch.Size([921, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3888297080993652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3888297080993652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 921, 256]), torch.Size([1, 921, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3905863761901855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4170169830322266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 921, 256])
m.shape torch.Size([713, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4186439514160156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4186439514160156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 713, 256]), torch.Size([1, 713, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.420003890991211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4536571502685547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 713, 256])
m.shape torch.Size([556, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4556078910827637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4556078910827637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4566683769226074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4874224662780762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([454, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4890742301940918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4890742301940918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4899401664733887  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5215086936950684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([332, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5235247611999512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5235247611999512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.524158000946045  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.55153226852417  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([281, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5531063079833984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5531063079833984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5536422729492188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5828170776367188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([231, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5843253135681152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5843253135681152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.584765911102295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.609879970550537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([167, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6111044883728027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6111044883728027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6114230155944824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6318087577819824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([141, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.633005142211914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.633005142211914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6332740783691406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6523685455322266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([111, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6534080505371094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6534080505371094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6536197662353516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6701335906982422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6712737083435059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6712737083435059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6714797019958496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6889891624450684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.689598560333252  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.689598560333252  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6897072792053223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.699709415435791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7003817558288574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7003817558288574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7004847526550293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.710681438446045  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7114086151123047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7114086151123047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7115116119384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7224292755126953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7229008674621582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7229008674621582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7229657173156738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7302937507629395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7308335304260254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7308335304260254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7309002876281738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7389111518859863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7392067909240723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7392067909240723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7392430305480957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7438454627990723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7441926002502441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7441926002502441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7442307472229004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.749342441558838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.749650478363037  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.749650478363037  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.749682903289795  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7542548179626465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7546019554138184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7546019554138184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.754636287689209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7597174644470215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7599544525146484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7599544525146484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7599773406982422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7635250091552734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.763801097869873  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.763801097869873  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7638258934020996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7678427696228027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7681074142456055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7681074142456055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7681303024291992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.771998405456543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([209, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7770090103149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7770090103149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7774076461791992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8475675582885742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 209, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8221850395202637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8230304718017578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.823875904083252  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8229880332946777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5671, 40])
input nodes number: 24838
output nodes number: 5671
edges number: 31776
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8232173919677734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8232178688049316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04674386978149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 14 input nodes size: 76729
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042444705963134766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042444705963134766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07903194427490234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07907438278198242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.043028831481933594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04451942443847656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04451942443847656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04451942443847656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([76729, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04451942443847656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1924, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12771892547607422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12771892547607422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1924, 128]), torch.Size([1, 1924, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12955379486083984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14423274993896484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1924, 128])
m.shape torch.Size([2395, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14579057693481445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14579057693481445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2395, 128]), torch.Size([1, 2395, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14807462692260742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18327856063842773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2395, 128])
m.shape torch.Size([2311, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1855626106262207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1855626106262207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2311, 128]), torch.Size([1, 2311, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18776655197143555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23784875869750977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2311, 128])
m.shape torch.Size([2133, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24115467071533203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24115467071533203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2133, 128]), torch.Size([1, 2133, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2441563606262207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30376720428466797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2133, 128])
m.shape torch.Size([1831, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30690908432006836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30690908432006836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1831, 128]), torch.Size([1, 1831, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3086552619934082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37209367752075195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1831, 128])
m.shape torch.Size([1451, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37537193298339844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37537193298339844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1451, 128]), torch.Size([1, 1451, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3767557144165039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4369955062866211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1451, 128])
m.shape torch.Size([1204, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4403223991394043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4403223991394043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1204, 128]), torch.Size([1, 1204, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4414706230163574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.49888181686401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1204, 128])
m.shape torch.Size([1120, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5025801658630371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5025801658630371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5036482810974121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5651412010192871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([953, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5691847801208496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5691847801208496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5700936317443848  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6287636756896973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([10130, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6766128540039062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6766128540039062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10130, 128]), torch.Size([1, 10130, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6870555877685547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3767433166503906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10130, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3033723831176758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3276453018188477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3519182205200195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3274555206298828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25452, 256])
first layer input nodes number: 76729
first layer output nodes number: 25452
edges number: 167305
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.352491855621338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3767647743225098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3828330039978027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3828330039978027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1020, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4153375625610352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4153375625610352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1020, 256]), torch.Size([1, 1020, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.417283058166504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.432847023010254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1020, 256])
m.shape torch.Size([943, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4340438842773438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4340438842773438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 943, 256]), torch.Size([1, 943, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.435842514038086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4628219604492188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 943, 256])
m.shape torch.Size([688, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4640917778015137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4640917778015137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4654040336608887  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4945111274719238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([589, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4963502883911133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4963502883911133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4974737167358398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5305604934692383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 589, 256])
m.shape torch.Size([468, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5322480201721191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5322480201721191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5331406593322754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5709080696105957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([333, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5726399421691895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5726399421691895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.573275089263916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6045136451721191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([272, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6060261726379395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6060261726379395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6065449714660645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6332502365112305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([236, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.634805679321289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.634805679321289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6352558135986328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6609134674072266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6620640754699707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6620640754699707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.662367343902588  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.681776523590088  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([136, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6829323768615723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6829323768615723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6831917762756348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7016091346740723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([126, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7028117179870605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7028117179870605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.703052043914795  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7217974662780762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([79, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7225885391235352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7225885391235352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7227392196655273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7355470657348633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([80, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.736496925354004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.736496925354004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.736649513244629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.750687599182129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7515802383422852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7515802383422852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7517175674438477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7653131484985352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7660088539123535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7660088539123535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7661099433898926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7768254280090332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.77728271484375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.77728271484375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7773456573486328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7844581604003906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.784949779510498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.784949779510498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.785010814666748  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.792335033416748  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7927374839782715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7927374839782715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7927851676940918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7988409996032715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.799346923828125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.799346923828125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7994022369384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.806814193725586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8072481155395508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8072481155395508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8072938919067383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8137483596801758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8141493797302246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8141493797302246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8141894340515137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.820117473602295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8204360008239746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8204360008239746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8204665184020996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8251967430114746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8255133628845215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8255133628845215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8255419731140137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.830176830291748  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8303704261779785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8303704261779785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8303875923156738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8332886695861816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([209, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8383021354675293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8383021354675293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.838700771331787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.908860683441162  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 209, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8828911781311035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8837356567382812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.884580135345459  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8836932182312012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5667, 40])
input nodes number: 25452
output nodes number: 5667
edges number: 32556
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8839244842529297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.883924961090088  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.047457218170166016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 15 input nodes size: 76014
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04302787780761719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04302787780761719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07927417755126953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07931661605834961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04268693923950195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04413461685180664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04413461685180664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04413461685180664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([76014, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04413461685180664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([2045, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12485027313232422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12485027313232422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2045, 128]), torch.Size([1, 2045, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.126800537109375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14240264892578125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2045, 128])
m.shape torch.Size([2460, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14392375946044922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14392375946044922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2460, 128]), torch.Size([1, 2460, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14673995971679688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1834735870361328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2460, 128])
m.shape torch.Size([2315, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1858196258544922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1858196258544922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2315, 128]), torch.Size([1, 2315, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18802738189697266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.238128662109375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2315, 128])
m.shape torch.Size([2104, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2414402961730957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2414402961730957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2104, 128]), torch.Size([1, 2104, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2444133758544922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30401039123535156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2104, 128])
m.shape torch.Size([1850, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3069486618041992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3069486618041992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1850, 128]), torch.Size([1, 1850, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3087129592895508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3727121353149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1850, 128])
m.shape torch.Size([1493, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3761014938354492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3761014938354492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1493, 128]), torch.Size([1, 1493, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37752532958984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4389495849609375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1493, 128])
m.shape torch.Size([1217, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44229984283447266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44229984283447266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1217, 128]), torch.Size([1, 1217, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44346046447753906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5038480758666992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1217, 128])
m.shape torch.Size([1069, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5073456764221191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5073456764221191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5083651542663574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5667200088500977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([974, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5703902244567871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5703902244567871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5713191032409668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6327357292175293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([9633, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6782050132751465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6782050132751465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9633, 128]), torch.Size([1, 9633, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6876459121704102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3401589393615723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9633, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2684879302978516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2924823760986328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.316476821899414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2922945022583008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25160, 256])
first layer input nodes number: 76014
first layer output nodes number: 25160
edges number: 162701
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3170452117919922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3410396575927734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3470382690429688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3470382690429688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1087, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3785710334777832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3785710334777832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1087, 256]), torch.Size([1, 1087, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.380753517150879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3987398147583008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1087, 256])
m.shape torch.Size([920, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3995318412780762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3995318412780762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 920, 256]), torch.Size([1, 920, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4012866020202637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4276080131530762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 920, 256])
m.shape torch.Size([746, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4289369583129883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4289369583129883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 746, 256]), torch.Size([1, 746, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4303598403930664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4640493392944336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 746, 256])
m.shape torch.Size([566, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4658231735229492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4658231735229492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.466902732849121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5048723220825195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([454, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.506514549255371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.506514549255371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.507380485534668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5385541915893555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([346, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.540116786956787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.540116786956787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5407767295837402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5710468292236328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([266, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5725069046020508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5725069046020508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.573014259338379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6010189056396484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([202, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6023187637329102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6023187637329102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6027040481567383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6246652603149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([171, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6259522438049316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6259522438049316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6262784004211426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6471524238586426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6484313011169434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6484313011169434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6487174034118652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6690306663513184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([105, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.670257568359375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.670257568359375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6704578399658203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6860790252685547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6871094703674316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6871094703674316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6872963905334473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7031846046447754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([77, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7040534019470215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7040534019470215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.704200267791748  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7177119255065918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7182307243347168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7182307243347168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7183146476745605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7266230583190918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7272014617919922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7272014617919922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7272834777832031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7359771728515625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7365975379943848  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7365975379943848  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7366795539855957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7459473609924316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.746396541595459  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.746396541595459  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7464537620544434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7533202171325684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7538108825683594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7538108825683594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7538681030273438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7611351013183594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.761453628540039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.761453628540039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7614898681640625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7663459777832031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7666549682617188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7666549682617188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7666873931884766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7712593078613281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7716469764709473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7716469764709473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7716851234436035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7773308753967285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7775869369506836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7775869369506836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7776117324829102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7814550399780273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7818188667297363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7818188667297363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7818512916564941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7871041297912598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7873649597167969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7873649597167969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7873878479003906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7912559509277344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([190, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7958102226257324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7958102226257324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7961726188659668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8599543571472168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 190, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8349275588989258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8357720375061035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8366165161132812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8357295989990234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5666, 40])
input nodes number: 25160
output nodes number: 5666
edges number: 31459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8359599113464355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8359603881835938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04701089859008789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.052561283111572266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.052561283111572266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020241260528564453 |0.02374929189682007 |0.148854598402977 |0.00010222196578979492 |0.07559189200401306 |0.005719900131225586 |[05:42:49] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 512748 edges into 16 parts and get 26320 edge cuts

----------------------------------------------------------pseudo_mini_loss sum 5.306455135345459
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1577349
Number of first layer input nodes during this epoch:  1169117
Number of first layer output nodes during this epoch:  408232
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05256080627441406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01929640769958496
global_2_local spend time (sec) 0.04512953758239746
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004505634307861328
A = g.adjacency_matrix() spent  0.010463237762451172
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09337115287780762
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3063971996307373
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.238067626953125

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 0.026 seconds
Metis partitioning: 0.085 seconds
Split the graph: 0.042 seconds
Construct subgraphs: 0.085 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.2384507656097412
5781
5686
5775
5729
5854
5628
5827
5633
5642
5640
5594
5633
5622
5712
5625
5560
total k batches seeds list generation spend  10.921709299087524
after graph partition
graph partition algorithm spend time 11.01504898071289
5781
5686
5775
5729
5854
5628
5827
5633
5642
5640
5594
5633
5622
5712
5625
5560
partition_len_list
[21788, 21438, 22269, 24688, 30351, 30705, 28471, 25908, 24247, 24979, 25719, 25567, 24901, 24891, 25209, 25459]
shared_neighbor_graph_partition_s0 selection method  spend 11.112369537353516
time for parepare:  0.01715707778930664
local_output_nid generation:  0.0013625621795654297
local_in_edges_tensor generation:  0.0015625953674316406
mini_batch_src_global generation:  0.00196075439453125
r_  generation:  0.01710367202758789
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0014221668243408203
mini_batch_src_global generation:  0.002176523208618164
r_  generation:  0.01786637306213379
local_output_nid generation:  0.001657247543334961
local_in_edges_tensor generation:  0.0013616085052490234
mini_batch_src_global generation:  0.0016977787017822266
r_  generation:  0.018470048904418945
local_output_nid generation:  0.0016293525695800781
local_in_edges_tensor generation:  0.0013213157653808594
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.017709732055664062
local_output_nid generation:  0.0017600059509277344
local_in_edges_tensor generation:  0.0014281272888183594
mini_batch_src_global generation:  0.0020766258239746094
r_  generation:  0.022420167922973633
local_output_nid generation:  0.0017352104187011719
local_in_edges_tensor generation:  0.0014569759368896484
mini_batch_src_global generation:  0.002138853073120117
r_  generation:  0.022979259490966797
local_output_nid generation:  0.0018396377563476562
local_in_edges_tensor generation:  0.0014781951904296875
mini_batch_src_global generation:  0.0020952224731445312
r_  generation:  0.023409366607666016
local_output_nid generation:  0.0017428398132324219
local_in_edges_tensor generation:  0.0012984275817871094
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.01490640640258789
local_output_nid generation:  0.0017518997192382812
local_in_edges_tensor generation:  0.0014374256134033203
mini_batch_src_global generation:  0.009323596954345703
r_  generation:  0.012787103652954102
local_output_nid generation:  0.0016796588897705078
local_in_edges_tensor generation:  0.0013933181762695312
mini_batch_src_global generation:  0.0010504722595214844
r_  generation:  0.011472225189208984
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.00115966796875
mini_batch_src_global generation:  0.001245737075805664
r_  generation:  0.009949445724487305
local_output_nid generation:  0.0015184879302978516
local_in_edges_tensor generation:  0.001138448715209961
mini_batch_src_global generation:  0.0010204315185546875
r_  generation:  0.011560916900634766
local_output_nid generation:  0.001497030258178711
local_in_edges_tensor generation:  0.0011513233184814453
mini_batch_src_global generation:  0.001306772232055664
r_  generation:  0.010393857955932617
local_output_nid generation:  0.0015277862548828125
local_in_edges_tensor generation:  0.0011057853698730469
mini_batch_src_global generation:  0.0012259483337402344
r_  generation:  0.010176420211791992
local_output_nid generation:  0.0015020370483398438
local_in_edges_tensor generation:  0.0011081695556640625
mini_batch_src_global generation:  0.0010485649108886719
r_  generation:  0.011560678482055664
local_output_nid generation:  0.0014858245849609375
local_in_edges_tensor generation:  0.0011401176452636719
mini_batch_src_global generation:  0.0012738704681396484
r_  generation:  0.009609222412109375
----------------------check_connections_block total spend ----------------------------- 0.41074466705322266
generate_one_block  0.032268524169921875
generate_one_block  0.027859210968017578
generate_one_block  0.02727222442626953
generate_one_block  0.026012659072875977
generate_one_block  0.03505349159240723
generate_one_block  0.03420209884643555
generate_one_block  0.03360605239868164
generate_one_block  0.025127887725830078
generate_one_block  0.019475460052490234
generate_one_block  0.017830848693847656
generate_one_block  0.01720142364501953
generate_one_block  0.016336679458618164
generate_one_block  0.017785310745239258
generate_one_block  0.01968550682067871
generate_one_block  0.016705989837646484
generate_one_block  0.016923189163208008
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03932523727416992
gen group dst list time:  0.011918306350708008
time for parepare:  0.021825790405273438
local_output_nid generation:  0.004491090774536133
local_in_edges_tensor generation:  0.008486509323120117
mini_batch_src_global generation:  0.00512242317199707
r_  generation:  0.053607940673828125
local_output_nid generation:  0.006421089172363281
local_in_edges_tensor generation:  0.0057065486907958984
mini_batch_src_global generation:  0.005919218063354492
r_  generation:  0.05598187446594238
local_output_nid generation:  0.006648063659667969
local_in_edges_tensor generation:  0.005284309387207031
mini_batch_src_global generation:  0.005321979522705078
r_  generation:  0.05903291702270508
local_output_nid generation:  0.007204532623291016
local_in_edges_tensor generation:  0.005494832992553711
mini_batch_src_global generation:  0.006385087966918945
r_  generation:  0.06450748443603516
local_output_nid generation:  0.008232593536376953
local_in_edges_tensor generation:  0.007293224334716797
mini_batch_src_global generation:  0.009165048599243164
r_  generation:  0.08890628814697266
local_output_nid generation:  0.008507490158081055
local_in_edges_tensor generation:  0.006933927536010742
mini_batch_src_global generation:  0.010154008865356445
r_  generation:  0.09012103080749512
local_output_nid generation:  0.008165597915649414
local_in_edges_tensor generation:  0.006713390350341797
mini_batch_src_global generation:  0.009516000747680664
r_  generation:  0.08261656761169434
local_output_nid generation:  0.007536411285400391
local_in_edges_tensor generation:  0.005988121032714844
mini_batch_src_global generation:  0.007970094680786133
r_  generation:  0.06760740280151367
local_output_nid generation:  0.007175922393798828
local_in_edges_tensor generation:  0.005586385726928711
mini_batch_src_global generation:  0.006740570068359375
r_  generation:  0.06405925750732422
local_output_nid generation:  0.007340192794799805
local_in_edges_tensor generation:  0.005784034729003906
mini_batch_src_global generation:  0.007015705108642578
r_  generation:  0.06554794311523438
local_output_nid generation:  0.007526874542236328
local_in_edges_tensor generation:  0.006294727325439453
mini_batch_src_global generation:  0.007143974304199219
r_  generation:  0.06844711303710938
local_output_nid generation:  0.007537841796875
local_in_edges_tensor generation:  0.0061604976654052734
mini_batch_src_global generation:  0.0074689388275146484
r_  generation:  0.06883525848388672
local_output_nid generation:  0.0072574615478515625
local_in_edges_tensor generation:  0.005903720855712891
mini_batch_src_global generation:  0.0069997310638427734
r_  generation:  0.06570792198181152
local_output_nid generation:  0.007230520248413086
local_in_edges_tensor generation:  0.005608320236206055
mini_batch_src_global generation:  0.007060050964355469
r_  generation:  0.06562066078186035
local_output_nid generation:  0.007456064224243164
local_in_edges_tensor generation:  0.005835533142089844
mini_batch_src_global generation:  0.007066249847412109
r_  generation:  0.06763720512390137
local_output_nid generation:  0.007514238357543945
local_in_edges_tensor generation:  0.005781888961791992
mini_batch_src_global generation:  0.007320880889892578
r_  generation:  0.06767392158508301
----------------------check_connections_block total spend ----------------------------- 1.7302446365356445
generate_one_block  0.08805370330810547
generate_one_block  0.07474756240844727
generate_one_block  0.08068346977233887
generate_one_block  0.0868682861328125
generate_one_block  0.1175987720489502
generate_one_block  0.11934399604797363
generate_one_block  0.10751032829284668
generate_one_block  0.08840632438659668
generate_one_block  0.0821073055267334
generate_one_block  0.08447432518005371
generate_one_block  0.08626937866210938
generate_one_block  0.0931847095489502
generate_one_block  0.08684062957763672
generate_one_block  0.08310079574584961
generate_one_block  0.08461999893188477
generate_one_block  0.08803725242614746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05256080627441406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

connection checking time:  1.7302446365356445
block generation total time  1.4518468379974365
average batch blocks generation time:  0.09074042737483978
block dataloader generation time/epoch 15.318583965301514
pseudo mini batch 0 input nodes size: 64048
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04823637008666992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04823637008666992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07877683639526367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07882022857666016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042531490325927734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04409170150756836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04409170150756836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04409170150756836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([64048, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04409170150756836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1275, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.11958169937133789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.11958169937133789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1275, 128]), torch.Size([1, 1275, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12079763412475586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13075590133666992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1275, 128])
m.shape torch.Size([1699, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13176822662353516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13176822662353516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1699, 128]), torch.Size([1, 1699, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13338851928710938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15769290924072266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1699, 128])
m.shape torch.Size([1721, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15954256057739258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15954256057739258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1721, 128]), torch.Size([1, 1721, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.16118383407592773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19729185104370117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1721, 128])
m.shape torch.Size([1576, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19958972930908203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19958972930908203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1576, 128]), torch.Size([1, 1576, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.20109272003173828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24506855010986328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1576, 128])
m.shape torch.Size([1429, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24772405624389648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24772405624389648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1429, 128]), torch.Size([1, 1429, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24908685684204102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.29905176162719727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1429, 128])
m.shape torch.Size([1288, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30205535888671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30205535888671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1288, 128]), torch.Size([1, 1288, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30328369140625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3563079833984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1288, 128])
m.shape torch.Size([1092, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.35933876037597656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.35933876037597656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3603801727294922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4142742156982422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([992, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4175376892089844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4175376892089844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4184837341308594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4736309051513672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([824, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.47669410705566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.47669410705566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4774799346923828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5286922454833984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([9892, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5754680633544922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5754680633544922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9892, 128]), torch.Size([1, 9892, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5849018096923828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2706279754638672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9892, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2029647827148438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2244491577148438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2459335327148438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2242865562438965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([21788, 256])
first layer input nodes number: 64048
first layer output nodes number: 21788
edges number: 152929
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.246412754058838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.267897129058838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2730917930603027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2730917930603027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([634, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3280682563781738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3280682563781738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.329277515411377  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3395466804504395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([567, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3400568962097168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3400568962097168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3411383628845215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3597102165222168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([496, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3606762886047363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3606762886047363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3616223335266113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.384833812713623  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([374, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3860926628112793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3860926628112793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3868060111999512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.407670497894287  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([323, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4093899726867676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4093899726867676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.410006046295166  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4326963424682617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([307, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4341588020324707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4341588020324707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4347443580627441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4606690406799316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([292, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4623408317565918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4623408317565918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.462897777557373  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4910006523132324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([241, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4925756454467773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4925756454467773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4930353164672852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5192365646362305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([226, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5209617614746094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5209617614746094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.521392822265625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.548980712890625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([233, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5510048866271973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5510048866271973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5514492988586426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5830025672912598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([171, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5845885276794434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5845885276794434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5849146842956543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6103549003601074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([166, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6127581596374512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6127581596374512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.613074779510498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6399874687194824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([146, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6416535377502441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6416535377502441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6419320106506348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6675515174865723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([117, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6689867973327637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6689867973327637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6692099571228027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.69130277633667  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6925034523010254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6925034523010254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6926770210266113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7110753059387207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.712587833404541  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.712587833404541  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7127861976623535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.735201358795166  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([111, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7369160652160645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7369160652160645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7371277809143066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7625336647033691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([88, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7639503479003906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7639503479003906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7641181945800781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7854347229003906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([78, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7867755889892578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7867755889892578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7869243621826172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8068599700927734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([78, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8082852363586426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8082852363586426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.808434009552002  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8294110298156738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([73, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8308100700378418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8308100700378418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.830949306488037  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8515563011169434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([53, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8526077270507812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8526077270507812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8527088165283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.868377685546875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([59, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8696317672729492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8696317672729492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8697443008422852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.887974739074707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([52, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8891181945800781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8891181945800781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8892173767089844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9059791564941406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([701, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9227733612060547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9227733612060547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9241104125976562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1601638793945312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 701, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.111170768737793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.112032413482666  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.112894058227539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1119890213012695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5781, 40])
input nodes number: 21788
output nodes number: 5781
edges number: 56325
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1122121810913086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.112213134765625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.047121524810791016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 1 input nodes size: 59994
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04254961013793945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04254961013793945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07115697860717773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07119941711425781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04061555862426758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042188167572021484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042188167572021484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042188167572021484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([59994, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.042188167572021484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1198, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.11717557907104492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.11717557907104492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1198, 128]), torch.Size([1, 1198, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.11831808090209961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12748384475708008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1198, 128])
m.shape torch.Size([1534, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12865209579467773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12865209579467773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1534, 128]), torch.Size([1, 1534, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13011503219604492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15205907821655273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1534, 128])
m.shape torch.Size([1600, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15361642837524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15361642837524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1600, 128]), torch.Size([1, 1600, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15514230728149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18871164321899414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1600, 128])
m.shape torch.Size([1580, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1909623146057129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1909623146057129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1580, 128]), torch.Size([1, 1580, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19246912002563477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23616647720336914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1580, 128])
m.shape torch.Size([1458, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23888921737670898  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23888921737670898  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1458, 128]), torch.Size([1, 1458, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2402796745300293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.29040098190307617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1458, 128])
m.shape torch.Size([1276, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.29335641860961914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.29335641860961914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1276, 128]), torch.Size([1, 1276, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2945733070373535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.34702157974243164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1276, 128])
m.shape torch.Size([1138, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.35021162033081055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.35021162033081055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.35129690170288086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.40557336807250977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([996, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4088301658630371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4088301658630371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 996, 128]), torch.Size([1, 996, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.40978002548217773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.46560049057006836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 996, 128])
m.shape torch.Size([846, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.46875619888305664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.46875619888305664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.46956300735473633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5219807624816895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([9812, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5683646202087402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5683646202087402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9812, 128]), torch.Size([1, 9812, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5777220726013184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2616934776306152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9812, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.1943535804748535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2147984504699707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.235243320465088  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2146387100219727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([21438, 256])
first layer input nodes number: 59994
first layer output nodes number: 21438
edges number: 152000
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2356925010681152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2561373710632324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2612485885620117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2612485885620117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([568, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.31868314743042  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.31868314743042  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3197665214538574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3302416801452637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([495, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3306517601013184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3306517601013184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3315958976745605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3510451316833496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([388, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3518028259277344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3518028259277344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3525428771972656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3694210052490234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([348, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3704423904418945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3704423904418945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3711061477661133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3918414115905762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([331, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3931002616882324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3931002616882324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3937315940856934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4172282218933105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([271, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.41847562789917  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.41847562789917  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.418992519378662  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4412360191345215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([278, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4428482055664062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4428482055664062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4433784484863281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4706974029541016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([263, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.47245454788208  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.47245454788208  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4729561805725098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.50223970413208  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([232, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5039958953857422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5039958953857422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5044384002685547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5327587127685547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([211, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5345654487609863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5345654487609863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5349678993225098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5635418891906738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([216, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.565624713897705  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.565624713897705  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5660367012023926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5981717109680176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([189, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6001458168029785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6001458168029785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.60050630569458  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.631147861480713  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([155, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6329045295715332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6329045295715332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6332001686096191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6603989601135254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([148, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6622428894042969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6622428894042969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6625251770019531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6904716491699219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([131, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6922192573547363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6922192573547363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6924691200256348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7189545631408691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([106, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7204599380493164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7204599380493164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7206621170043945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7435083389282227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([112, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7452373504638672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7452373504638672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7454509735107422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7710857391357422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([87, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.772484302520752  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.772484302520752  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7726502418518066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.793724536895752  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([73, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.79508638381958  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.79508638381958  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7952256202697754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8138833045959473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([86, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8154668807983398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8154668807983398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8156309127807617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.838759422302246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([80, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8402924537658691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8402924537658691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8404450416564941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8630280494689941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.864062786102295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.864062786102295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8641600608825684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8792376518249512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8801841735839844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8801841735839844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.880270004272461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.894174575805664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([52, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8953313827514648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8953313827514648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.895430564880371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9121923446655273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([770, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.931593418121338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.931593418121338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 770, 256]), torch.Size([1, 770, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9330620765686035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1998238563537598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 770, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.14816951751709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.149016857147217  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1498641967773438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1489744186401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5686, 40])
input nodes number: 21438
output nodes number: 5686
edges number: 58947
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1491622924804688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.149162769317627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04517698287963867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 2 input nodes size: 62913
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.040601253509521484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.040601253509521484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07060050964355469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07064390182495117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04199409484863281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04361534118652344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04361534118652344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04361534118652344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([62913, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04361534118652344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1290, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12154436111450195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12154436111450195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1290, 128]), torch.Size([1, 1290, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12277460098266602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1333599090576172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1290, 128])
m.shape torch.Size([1649, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13506221771240234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13506221771240234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1649, 128]), torch.Size([1, 1649, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13663482666015625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.16080760955810547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1649, 128])
m.shape torch.Size([1634, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.16235876083374023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.16235876083374023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1634, 128]), torch.Size([1, 1634, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.16391706466674805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19979524612426758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1634, 128])
m.shape torch.Size([1618, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2021021842956543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2021021842956543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1618, 128]), torch.Size([1, 1618, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2036452293395996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24839353561401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1618, 128])
m.shape torch.Size([1458, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2510981559753418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2510981559753418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1458, 128]), torch.Size([1, 1458, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2524886131286621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.302609920501709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1458, 128])
m.shape torch.Size([1246, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3054795265197754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3054795265197754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1246, 128]), torch.Size([1, 1246, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3066678047180176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.35880136489868164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1246, 128])
m.shape torch.Size([1157, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36206912994384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36206912994384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1157, 128]), torch.Size([1, 1157, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3631725311279297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.41834259033203125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1157, 128])
m.shape torch.Size([1070, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.421872615814209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.421872615814209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.42289304733276367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4811267852783203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([941, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.48465490341186523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.48465490341186523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 941, 128]), torch.Size([1, 941, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4855523109436035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5431504249572754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 941, 128])
m.shape torch.Size([10206, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5913677215576172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5913677215576172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10206, 128]), torch.Size([1, 10206, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6019248962402344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.294473648071289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10206, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2247505187988281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2462348937988281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2677192687988281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2460689544677734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([22269, 256])
first layer input nodes number: 62913
first layer output nodes number: 22269
edges number: 157916
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2681903839111328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2896747589111328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2949843406677246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2949843406677246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([601, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.353105068206787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.353105068206787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3542513847351074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.36342191696167  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([523, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3638544082641602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3638544082641602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.364851951599121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3799524307250977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([349, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.380476474761963  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.380476474761963  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3811421394348145  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4006190299987793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([344, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.402411937713623  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.402411937713623  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4030680656433105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4230351448059082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([306, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.424177646636963  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.424177646636963  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4247612953186035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4458122253417969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([304, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4472737312316895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4472737312316895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4478535652160645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.473574161529541  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([284, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4751954078674316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4751954078674316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4757370948791504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5037708282470703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([278, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5056376457214355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5056376457214355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5061678886413574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5366435050964355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([265, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5386710166931152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5386710166931152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5391764640808105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5722260475158691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([226, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.574145793914795  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.574145793914795  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5745768547058105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.60518217086792  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([206, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.607144832611084  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.607144832611084  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6075377464294434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6381850242614746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([181, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6410202980041504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6410202980041504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6413655281066895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6707100868225098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([163, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.672574520111084  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.672574520111084  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6728854179382324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7014880180358887  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([141, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7032299041748047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7032299041748047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7034988403320312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.730123519897461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([138, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7319788932800293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7319788932800293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7322421073913574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7601428031921387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([100, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7615489959716797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7615489959716797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.761739730834961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7832927703857422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([105, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7849130630493164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7849130630493164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7851133346557617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8091459274291992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([95, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8106894493103027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8106894493103027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.81087064743042  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8338828086853027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([79, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8352351188659668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8352351188659668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.835385799407959  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.855576992034912  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([87, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8571743965148926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8571743965148926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8573403358459473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8807377815246582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8818659782409668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8818659782409668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8819804191589355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8989176750183105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([72, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9003829956054688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9003829956054688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9005203247070312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9218063354492188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9226441383361816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9226441383361816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.922722339630127  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9353909492492676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([56, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9366436004638672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9366436004638672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9367504119873047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9548015594482422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([771, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9732742309570312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9732742309570312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 771, 256]), torch.Size([1, 771, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9747447967529297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.240631103515625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 771, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.188413619995117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.189274311065674  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1901350021362305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1892309188842773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5775, 40])
input nodes number: 22269
output nodes number: 5775
edges number: 59624
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.189453601837158  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1894540786743164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04672670364379883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 3 input nodes size: 69661
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0420074462890625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0420074462890625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07522439956665039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07526731491088867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.045224666595458984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04690694808959961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04690694808959961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04690694808959961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([69661, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04690694808959961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1505, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13187551498413086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13187551498413086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1505, 128]), torch.Size([1, 1505, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13331079483032227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1448974609375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1505, 128])
m.shape torch.Size([1879, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14597177505493164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14597177505493164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1879, 128]), torch.Size([1, 1879, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14776372909545898  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17484569549560547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1879, 128])
m.shape torch.Size([2032, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17685651779174805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17685651779174805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2032, 128]), torch.Size([1, 2032, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17879438400268555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.22170209884643555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2032, 128])
m.shape torch.Size([1819, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.22420263290405273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.22420263290405273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1819, 128]), torch.Size([1, 1819, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2259373664855957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2762446403503418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1819, 128])
m.shape torch.Size([1635, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.27927541732788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.27927541732788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1635, 128]), torch.Size([1, 1635, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2808346748352051  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3386082649230957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1635, 128])
m.shape torch.Size([1418, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3418855667114258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3418855667114258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1418, 128]), torch.Size([1, 1418, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.34323787689208984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4025850296020508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1418, 128])
m.shape torch.Size([1296, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4062347412109375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4062347412109375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1296, 128]), torch.Size([1, 1296, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.407470703125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4694099426269531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1296, 128])
m.shape torch.Size([1163, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.47322845458984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.47322845458984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1163, 128]), torch.Size([1, 1163, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4743375778198242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5375766754150391  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1163, 128])
m.shape torch.Size([1055, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5415496826171875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5415496826171875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5425558090209961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6078910827636719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
m.shape torch.Size([10886, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6601223945617676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6601223945617676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10886, 128]), torch.Size([1, 10886, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.670504093170166  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4292340278625488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10886, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3533072471618652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3768515586853027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4003958702087402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3766674995422363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([24688, 256])
first layer input nodes number: 69661
first layer output nodes number: 24688
edges number: 172049
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4009170532226562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4244613647460938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4303474426269531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4303474426269531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([680, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4826984405517578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4826984405517578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 680, 256]), torch.Size([1, 680, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4839954376220703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4943714141845703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 680, 256])
m.shape torch.Size([596, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4950098991394043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4950098991394043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4961466789245605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.514136791229248  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([506, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.515246868133545  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.515246868133545  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.516211986541748  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5375046730041504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([399, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5387191772460938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5387191772460938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.539480209350586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.562753677368164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([358, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5640935897827148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5640935897827148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5647764205932617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5906505584716797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5920395851135254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5920395851135254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5926117897033691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.618171215057373  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([256, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6196074485778809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6196074485778809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6200957298278809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6445097923278809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([248, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6461725234985352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6461725234985352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6466455459594727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6736078262329102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([227, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6753349304199219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6753349304199219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6757678985595703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7034778594970703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([204, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7052221298217773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7052221298217773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.705611228942871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7332372665405273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([164, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7347769737243652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7347769737243652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7350897789001465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.759488582611084  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([161, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7611894607543945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7611894607543945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7614965438842773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7875986099243164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([129, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7890572547912598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7890572547912598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7893033027648926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8119397163391113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([117, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8133912086486816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8133912086486816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8136143684387207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.835707187652588  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([124, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.83738374710083  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.83738374710083  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8376202583312988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8626904487609863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([99, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8649778366088867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8649778366088867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8651666641235352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8865041732788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8875417709350586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8875417709350586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.887669563293457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9030046463012695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([79, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9043078422546387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9043078422546387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9044585227966309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9235949516296387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([78, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9249444007873535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9249444007873535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.925093173980713  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9450287818908691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([73, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9463577270507812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9463577270507812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9464969635009766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9661293029785156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.967069149017334  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.967069149017334  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9671645164489746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.981278896331787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9822888374328613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9822888374328613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.982384204864502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9971661567687988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([51, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.998246192932129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.998246192932129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9983434677124023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.014101982116699  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.014814853668213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.014814853668213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0148777961730957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.025515079498291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([680, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.041822910308838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.041822910308838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 680, 256]), torch.Size([1, 680, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0431199073791504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.272207736968994  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 680, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.225832462310791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.226686477661133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2275404930114746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2266435623168945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5729, 40])
input nodes number: 24688
output nodes number: 5729
edges number: 53548
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2268638610839844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2268643379211426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05011796951293945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 4 input nodes size: 75776
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04521799087524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04521799087524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08135080337524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08139467239379883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.048134803771972656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05048942565917969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05048942565917969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05048942565917969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([75776, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05048942565917969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1146, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17061758041381836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17061758041381836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1146, 128]), torch.Size([1, 1146, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17171049118041992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1811976432800293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1146, 128])
m.shape torch.Size([1462, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18270635604858398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18270635604858398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1462, 128]), torch.Size([1, 1462, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18410062789916992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.20501470565795898  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1462, 128])
m.shape torch.Size([1455, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.20639896392822266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.20639896392822266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1455, 128]), torch.Size([1, 1455, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.20778656005859375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2383136749267578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1455, 128])
m.shape torch.Size([1428, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24049997329711914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24049997329711914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1428, 128]), torch.Size([1, 1428, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24186182022094727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.28182077407836914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1428, 128])
m.shape torch.Size([1382, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.28443479537963867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.28443479537963867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1382, 128]), torch.Size([1, 1382, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2857527732849121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.33319997787475586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1382, 128])
m.shape torch.Size([1220, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.336031436920166  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.336031436920166  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1220, 128]), torch.Size([1, 1220, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.33719491958618164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3885335922241211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1220, 128])
m.shape torch.Size([1093, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3916001319885254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3916001319885254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3926424980163574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4460926055908203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([1042, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44954633712768555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44954633712768555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.45054006576538086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5080485343933105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([1024, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5119462013244629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5119462013244629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1024, 128]), torch.Size([1, 1024, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5129227638244629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5754227638244629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1024, 128])
m.shape torch.Size([19099, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6660056114196777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6660056114196777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 19099, 128]), torch.Size([1, 19099, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6842198371887207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9774298667907715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 19099, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8656024932861328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.894547462463379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.923492431640625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8943209648132324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([30351, 256])
first layer input nodes number: 75776
first layer output nodes number: 30351
edges number: 244570
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9240589141845703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9530038833618164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.960240364074707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.960240364074707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([596, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.029684066772461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.029684066772461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.030820846557617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.040996551513672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([501, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.041391372680664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.041391372680664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.042346954345703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0610179901123047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([370, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0616283416748047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0616283416748047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0623340606689453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0789546966552734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([312, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.079833984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.079833984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0804290771484375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.098738670349121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([263, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0997681617736816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0997681617736816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1002697944641113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1208534240722656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([230, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.121929168701172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.121929168701172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1223678588867188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1412315368652344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([192, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.142961025238037  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.142961025238037  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.143327236175537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.161637783050537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([184, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.162869453430176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.162869453430176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1632204055786133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.183224678039551  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([163, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1844592094421387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1844592094421387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.184770107269287  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.204667568206787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([178, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2067813873291016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2067813873291016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.207120895385742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2312259674072266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([153, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2326741218566895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2326741218566895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2329659461975098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.255728244781494  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([130, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.257081985473633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.257081985473633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2573299407958984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2784061431884766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([150, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2802629470825195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2802629470825195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2805490493774414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.306870460510254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([121, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3083558082580566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3083558082580566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.308586597442627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.331434726715088  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([126, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3331360816955566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3331360816955566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.333376407623291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3588509559631348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([119, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3605728149414062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3605728149414062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.360799789428711  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3864479064941406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([119, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3882789611816406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3882789611816406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3885059356689453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.415742874145508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([108, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4174981117248535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4174981117248535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4177041053771973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4438652992248535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([110, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4457712173461914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4457712173461914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.445981025695801  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.474095344543457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([98, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.475874423980713  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.475874423980713  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4760613441467285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5024170875549316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([95, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.504241466522217  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.504241466522217  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.504422664642334  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5312399864196777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([62, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.532543182373047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.532543182373047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5326614379882812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5509910583496094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5524797439575195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5524797439575195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5526132583618164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.57424259185791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([67, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5766096115112305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5766096115112305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.576737403869629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.598334312438965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([1337, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.63045072555542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.63045072555542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1337, 256]), torch.Size([1, 1337, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.633188247680664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.090033531188965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1337, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.0260610580444336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.0269336700439453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.027806282043457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.0268898010253906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5854, 40])
input nodes number: 30351
output nodes number: 5854
edges number: 71414
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.0271787643432617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.02717924118042  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.054705142974853516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 5 input nodes size: 75051
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04815340042114258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04815340042114258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08394050598144531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08398246765136719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0478057861328125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.050200462341308594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.050200462341308594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.050200462341308594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([75051, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.050200462341308594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1107, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17290401458740234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17290401458740234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17395973205566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1824054718017578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([1427, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1836543083190918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1836543083190918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1427, 128]), torch.Size([1, 1427, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18501520156860352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2054286003112793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1427, 128])
m.shape torch.Size([1445, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.20737457275390625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.20737457275390625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1445, 128]), torch.Size([1, 1445, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.20875263214111328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23906993865966797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1445, 128])
m.shape torch.Size([1423, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24137544631958008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24137544631958008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1423, 128]), torch.Size([1, 1423, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24273252487182617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2826199531555176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1423, 128])
m.shape torch.Size([1295, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.28502893447875977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.28502893447875977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1295, 128]), torch.Size([1, 1295, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.28626394271850586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3311271667480469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1295, 128])
m.shape torch.Size([1176, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3338742256164551  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3338742256164551  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1176, 128]), torch.Size([1, 1176, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.33499574661254883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38368654251098633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1176, 128])
m.shape torch.Size([1041, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3866004943847656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3866004943847656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38759326934814453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4377431869506836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([961, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44091272354125977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44091272354125977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44182920455932617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.49443483352661133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([900, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.49783897399902344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.49783897399902344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.49869728088378906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5543804168701172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([19930, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6489849090576172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6489849090576172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 19930, 128]), torch.Size([1, 19930, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6685161590576172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0221900939941406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 19930, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9070625305175781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.936345100402832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.965627670288086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9361162185668945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([30705, 256])
first layer input nodes number: 75051
first layer output nodes number: 30705
edges number: 249894
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.966188907623291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.995471477508545  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0027923583984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0027923583984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([573, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.072197437286377  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.072197437286377  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0732903480529785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.082991600036621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([504, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.083414077758789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.083414077758789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0843753814697266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0989456176757812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([428, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0998167991638184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0998167991638184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.100633144378662  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1194071769714355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([346, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1203513145446777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1203513145446777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.121011257171631  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.142242431640625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([249, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1431236267089844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1431236267089844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1435985565185547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.160696029663086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([205, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1616697311401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1616697311401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1620607376098633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1788740158081055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1797356605529785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1797356605529785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1800312995910645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1948132514953613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.195596218109131  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.195596218109131  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.195827007293701  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.208981990814209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([128, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2100391387939453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2100391387939453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2102832794189453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2259082794189453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([118, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.227053165435791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.227053165435791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.227278232574463  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.243257999420166  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([116, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2443718910217285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2443718910217285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2445931434631348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2618508338928223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([115, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2630667686462402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2630667686462402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2632861137390137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.281930446624756  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.282970428466797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.282970428466797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2831459045410156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2992897033691406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.300467014312744  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.300467014312744  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3006463050842285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3183960914611816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([92, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3196330070495605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3196330070495605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3198084831237793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.338408946990967  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([90, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.339705467224121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.339705467224121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.339877128601074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3592748641967773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.360398292541504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.360398292541504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.360539436340332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.377476692199707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([96, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3790669441223145  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3790669441223145  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3792500495910645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4025044441223145  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([69, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4036731719970703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4036731719970703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4038047790527344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4214401245117188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4226818084716797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4226818084716797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.422811508178711  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.441099166870117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([86, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.442770481109619  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.442770481109619  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.442934513092041  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4672112464904785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([70, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4686098098754883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4686098098754883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.468743324279785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.489438056945801  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([54, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.490565299987793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.490565299987793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.490668296813965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5073537826538086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.508786678314209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.508786678314209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5089030265808105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5285658836364746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([1624, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5675296783447266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.5675296783447266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1624, 256]), torch.Size([1, 1624, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.570627212524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.129037857055664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1624, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.064639091491699  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.0654778480529785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.066316604614258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.0654358863830566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5628, 40])
input nodes number: 30705
output nodes number: 5628
edges number: 71406
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.0656728744506836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 3.065673351287842  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05440235137939453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 6 input nodes size: 72787
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04777193069458008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04777193069458008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08247947692871094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08252334594726562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.046694278717041016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.048891544342041016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.048891544342041016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.048891544342041016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([72787, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.048891544342041016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1185, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15887880325317383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15887880325317383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1185, 128]), torch.Size([1, 1185, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.16000890731811523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1694779396057129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1185, 128])
m.shape torch.Size([1548, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17100763320922852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17100763320922852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1548, 128]), torch.Size([1, 1548, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1724839210510254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19462823867797852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1548, 128])
m.shape torch.Size([1511, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19605159759521484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19605159759521484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1511, 128]), torch.Size([1, 1511, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1974925994873047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.22919464111328125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1511, 128])
m.shape torch.Size([1472, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23128175735473633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23128175735473633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1472, 128]), torch.Size([1, 1472, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23268556594848633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.27339601516723633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1472, 128])
m.shape torch.Size([1374, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2759699821472168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2759699821472168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1374, 128]), torch.Size([1, 1374, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.277280330657959  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3246750831604004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1374, 128])
m.shape torch.Size([1255, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.32761049270629883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.32761049270629883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1255, 128]), torch.Size([1, 1255, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.32880735397338867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38176870346069336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1255, 128])
m.shape torch.Size([1121, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38491201400756836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38491201400756836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38598108291625977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4401116371154785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1101, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44377708435058594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44377708435058594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4448270797729492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5064945220947266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1059, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5105142593383789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5105142593383789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5115242004394531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.576927661895752  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([16845, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6567459106445312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6567459106445312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 16845, 128]), torch.Size([1, 16845, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6728105545043945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8134002685546875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 16845, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7117195129394531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7388715744018555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7660236358642578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.738659381866455  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([28471, 256])
first layer input nodes number: 72787
first layer output nodes number: 28471
edges number: 223738
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7665681838989258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7937202453613281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8006534576416016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8006534576416016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([589, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8703436851501465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8703436851501465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.871467113494873  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8804545402526855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 589, 256])
m.shape torch.Size([512, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8808770179748535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8808770179748535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8818535804748535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8965020179748535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 512, 256])
m.shape torch.Size([409, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.897209644317627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.897209644317627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8979897499084473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9166388511657715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([299, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9174776077270508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9174776077270508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9180479049682617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9381060600280762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([271, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9391236305236816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9391236305236816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9396405220031738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9588494300842285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([202, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9601426124572754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9601426124572754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9605278968811035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.977095127105713  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([178, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.978100299835205  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.978100299835205  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9784398078918457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.995415210723877  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([184, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9966602325439453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9966602325439453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9970111846923828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0170154571533203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([181, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0184059143066406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0184059143066406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0187511444091797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0408458709716797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([173, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0424962043762207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0424962043762207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0428261756896973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.066254138946533  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([169, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0678763389587402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0678763389587402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0681986808776855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.09334135055542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0947489738464355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0947489738464355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.095008373260498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1170573234558105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([129, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.118539810180664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.118539810180664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.118785858154297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1414222717285156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([118, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1433162689208984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1433162689208984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1435413360595703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.165822982788086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([107, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1672534942626953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1672534942626953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1674575805664062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1890907287597656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([103, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.190572738647461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.190572738647461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1907691955566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2129688262939453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([96, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2144393920898438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2144393920898438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2146224975585938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2365951538085938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([104, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2387924194335938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2387924194335938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2389907836914062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2641830444335938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([99, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2658920288085938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2658920288085938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.266080856323242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.291383743286133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([88, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2929811477661133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2929811477661133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.293148994445801  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3168153762817383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([87, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3184876441955566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3184876441955566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3186535835266113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.343212604522705  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([61, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.344858169555664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.344858169555664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3449745178222656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.363008499145508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.364321231842041  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.364321231842041  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.3644394874572754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.383596897125244  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([75, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.385268211364746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.385268211364746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.385411262512207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4095869064331055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([1395, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4430346488952637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.4430346488952637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1395, 256]), torch.Size([1, 1395, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.445695400238037  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.926650047302246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1395, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.8623929023742676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.8632612228393555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.8641295433044434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.863217353820801  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5827, 40])
input nodes number: 28471
output nodes number: 5827
edges number: 71168
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.8635029792785645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.8635034561157227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05289411544799805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 7 input nodes size: 75307
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04672384262084961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04672384262084961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08263301849365234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08267545700073242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.047924041748046875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04952239990234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04952239990234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04952239990234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([75307, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04952239990234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1801, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13552522659301758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13552522659301758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1801, 128]), torch.Size([1, 1801, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13724279403686523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15098333358764648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1801, 128])
m.shape torch.Size([2266, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15228557586669922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15228557586669922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2266, 128]), torch.Size([1, 2266, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15444660186767578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18751287460327148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2266, 128])
m.shape torch.Size([2264, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18967103958129883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18967103958129883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2264, 128]), torch.Size([1, 2264, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19183111190795898  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24002790451049805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2264, 128])
m.shape torch.Size([2095, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24326658248901367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24326658248901367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2095, 128]), torch.Size([1, 2095, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24526453018188477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30519819259643555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2095, 128])
m.shape torch.Size([1827, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30855512619018555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30855512619018555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1827, 128]), torch.Size([1, 1827, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.31029748916625977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37302255630493164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1827, 128])
m.shape torch.Size([1481, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3763885498046875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3763885498046875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1481, 128]), torch.Size([1, 1481, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37780094146728516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4390439987182617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1481, 128])
m.shape torch.Size([1331, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4427804946899414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4427804946899414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4440498352050781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5076045989990234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([1230, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5116620063781738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5116620063781738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1230, 128]), torch.Size([1, 1230, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5128350257873535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5816006660461426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1230, 128])
m.shape torch.Size([1010, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5853486061096191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5853486061096191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5863118171691895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6488871574401855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([10603, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6991868019104004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6991868019104004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10603, 128]), torch.Size([1, 10603, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.7092986106872559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4277477264404297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10603, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3511290550231934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3758368492126465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4005446434020996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3756437301635742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25908, 256])
first layer input nodes number: 75307
first layer output nodes number: 25908
edges number: 173803
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4011077880859375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4258155822753906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.431992530822754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.431992530822754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([874, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4724268913269043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4724268913269043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 874, 256]), torch.Size([1, 874, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4740939140319824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4874300956726074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 874, 256])
m.shape torch.Size([797, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4883689880371094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4883689880371094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 797, 256]), torch.Size([1, 797, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.489889144897461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5126914978027344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 797, 256])
m.shape torch.Size([617, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.513768196105957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.513768196105957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 617, 256]), torch.Size([1, 617, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5149450302124023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5417780876159668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 617, 256])
m.shape torch.Size([486, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5430583953857422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5430583953857422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.543985366821289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5708675384521484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([414, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5723938941955566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5723938941955566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.573183536529541  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6019082069396973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([307, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6032838821411133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6032838821411133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6038694381713867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6306376457214355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([262, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.632340431213379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.632340431213379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6328401565551758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6618967056274414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([244, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6635231971740723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6635231971740723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6639885902404785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6905159950256348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([187, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6919012069702148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6919012069702148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6922578811645508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7150850296020508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.716416358947754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.716416358947754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7167158126831055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7379770278930664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([141, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7393183708190918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7393183708190918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7395873069763184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7605643272399902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7618751525878906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7618751525878906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7621002197265625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7812309265136719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([98, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7824511528015137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7824511528015137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7826380729675293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7998347282409668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.801074504852295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.801074504852295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.801257610321045  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.819385051727295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([83, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.820737361907959  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.820737361907959  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8208956718444824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8376765251159668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8386430740356445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8386430740356445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8387727737426758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.853428840637207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8542466163635254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8542466163635254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8543496131896973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8667092323303223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8675575256347656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8675575256347656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8676567077636719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8802528381347656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8811163902282715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8811163902282715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.881211757659912  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8939909934997559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.894597053527832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.894597053527832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8946619033813477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9038057327270508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9042983055114746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9042983055114746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9043478965759277  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9116873741149902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.912381649017334  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.912381649017334  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9124464988708496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9224982261657715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9230408668518066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9230408668518066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9230904579162598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.931124210357666  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9316530227661133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9316530227661133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9316987991333008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9394350051879883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([384, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.948638916015625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.948638916015625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.949371337890625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.080718994140625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 384, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0465402603149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.047379970550537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.048219680786133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.047337532043457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5633, 40])
input nodes number: 25908
output nodes number: 5633
edges number: 40684
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.047544479370117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0475449562072754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05260038375854492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 8 input nodes size: 73019
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04789543151855469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04789543151855469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08271360397338867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08275604248046875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04680442810058594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04826545715332031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04826545715332031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04826545715332031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([73019, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04826545715332031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1839, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12711429595947266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12711429595947266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1839, 128]), torch.Size([1, 1839, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12886810302734375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1443309783935547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1839, 128])
m.shape torch.Size([2202, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1455540657043457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1455540657043457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2202, 128]), torch.Size([1, 2202, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14765405654907227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18064641952514648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2202, 128])
m.shape torch.Size([2247, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1818857192993164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1818857192993164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2247, 128]), torch.Size([1, 2247, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18493223190307617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2330474853515625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2247, 128])
m.shape torch.Size([1966, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23626184463500977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23626184463500977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1966, 128]), torch.Size([1, 1966, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.23813676834106445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.29407310485839844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1966, 128])
m.shape torch.Size([1799, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2976675033569336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2976675033569336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1799, 128]), torch.Size([1, 1799, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.29938316345214844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3611469268798828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1799, 128])
m.shape torch.Size([1471, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36449766159057617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36449766159057617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1471, 128]), torch.Size([1, 1471, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36590051651000977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4262232780456543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1471, 128])
m.shape torch.Size([1223, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.42960405349731445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.42960405349731445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1223, 128]), torch.Size([1, 1223, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4307703971862793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.490811824798584  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1223, 128])
m.shape torch.Size([1076, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.49433326721191406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.49433326721191406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4953594207763672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5540695190429688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([957, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5576634407043457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5576634407043457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5585761070251465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6173543930053711  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([9467, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6620402336120605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6620402336120605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9467, 128]), torch.Size([1, 9467, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6710686683654785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3120875358581543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9467, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2428016662597656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2662391662597656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.289362907409668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.265744686126709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([24247, 256])
first layer input nodes number: 73019
first layer output nodes number: 24247
edges number: 159121
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2899088859558105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.313032627105713  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3188138008117676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3188138008117676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([956, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3553581237792969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3553581237792969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 956, 256]), torch.Size([1, 956, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3571815490722656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3730745315551758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 956, 256])
m.shape torch.Size([831, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.374253749847412  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.374253749847412  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 831, 256]), torch.Size([1, 831, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3758387565612793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4011588096618652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 831, 256])
m.shape torch.Size([631, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4021859169006348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4021859169006348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4033894538879395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4298672676086426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 631, 256])
m.shape torch.Size([533, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4313149452209473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4313149452209473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4323315620422363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4618134498596191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([460, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4635157585144043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4635157585144043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.464393138885498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4972939491271973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([342, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4988279342651367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4988279342651367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4994802474975586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5305266380310059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([286, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5321955680847168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5321955680847168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5327410697937012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.561924934387207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([199, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5631823539733887  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5631823539733887  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5635619163513184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5851969718933105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([193, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.586677074432373  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.586677074432373  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5870451927185059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6106047630310059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6119685173034668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6119685173034668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6122756004333496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6340785026550293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([125, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6354355812072754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6354355812072754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.635673999786377  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6542706489562988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([101, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6553163528442383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6553163528442383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6555089950561523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6718835830688477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([90, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6729121208190918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6729121208190918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.673083782196045  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6888766288757324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6897330284118652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6897330284118652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.689866542816162  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7030844688415527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7039403915405273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7039403915405273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7040624618530273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7170019149780273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7176175117492676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7176175117492676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7177014350891113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.727184772491455  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.728041648864746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.728041648864746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7281465530395508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7407350540161133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7413749694824219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7413749694824219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7414512634277344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7511405944824219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7519426345825195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7519426345825195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.752030372619629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7637872695922852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7645511627197266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7645511627197266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7646312713623047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7759265899658203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7763309478759766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7763309478759766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7763729095458984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.782583236694336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7829852104187012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7829852104187012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7830233573913574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7889361381530762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7893152236938477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7893152236938477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7893495559692383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7949113845825195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7953557968139648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7953557968139648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.795393943786621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8018407821655273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([293, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8088622093200684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8088622093200684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8094210624694824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9085230827331543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 293, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8783798217773438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.879220962524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8800621032714844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.879178524017334  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5642, 40])
input nodes number: 24247
output nodes number: 5642
edges number: 36827
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8794031143188477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8794035911560059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05115318298339844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 9 input nodes size: 76207
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04680585861206055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04680585861206055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0831441879272461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08318662643432617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04832601547241211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04979276657104492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04979276657104492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04979276657104492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([76207, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04979276657104492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1887, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1309680938720703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1309680938720703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1887, 128]), torch.Size([1, 1887, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1327676773071289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14716434478759766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1887, 128])
m.shape torch.Size([2311, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1489887237548828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1489887237548828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2311, 128]), torch.Size([1, 2311, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1520552635192871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1857314109802246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2311, 128])
m.shape torch.Size([2309, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18751287460327148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18751287460327148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2309, 128]), torch.Size([1, 2309, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19013547897338867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24100971221923828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2309, 128])
m.shape torch.Size([2050, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24431276321411133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24431276321411133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2050, 128]), torch.Size([1, 2050, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24626779556274414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30521106719970703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2050, 128])
m.shape torch.Size([1883, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30776453018188477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30776453018188477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1883, 128]), torch.Size([1, 1883, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30956029891967773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37488365173339844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1883, 128])
m.shape torch.Size([1458, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3781571388244629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3781571388244629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1458, 128]), torch.Size([1, 1458, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3795475959777832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44017934799194336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1458, 128])
m.shape torch.Size([1220, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4435563087463379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4435563087463379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1220, 128]), torch.Size([1, 1220, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4447197914123535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5043282508850098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1220, 128])
m.shape torch.Size([1107, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5079693794250488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5079693794250488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5090250968933105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5702576637268066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([919, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5736737251281738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5736737251281738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5745501518249512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.631324291229248  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([9835, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6777830123901367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6777830123901367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9835, 128]), torch.Size([1, 9835, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6871623992919922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3672070503234863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9835, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.295839786529541  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3196616172790527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3434834480285645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3194751739501953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([24979, 256])
first layer input nodes number: 76207
first layer output nodes number: 24979
edges number: 163816
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3440532684326172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.367875099182129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.373830795288086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.373830795288086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1040, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4067912101745605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4067912101745605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1040, 256]), torch.Size([1, 1040, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4090590476989746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4285531044006348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1040, 256])
m.shape torch.Size([874, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4288220405578613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4288220405578613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 874, 256]), torch.Size([1, 874, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4304890632629395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4560446739196777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 874, 256])
m.shape torch.Size([730, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4579410552978516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4579410552978516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 730, 256]), torch.Size([1, 730, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4593334197998047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4899654388427734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 730, 256])
m.shape torch.Size([553, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4919991493225098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4919991493225098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.493053913116455  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5310349464416504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([489, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5332517623901367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5332517623901367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.534184455871582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.570556640625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([320, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5719356536865234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5719356536865234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5725460052490234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.599843978881836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([258, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6012749671936035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6012749671936035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6017670631408691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6273717880249023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([210, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6287407875061035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6287407875061035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6291413307189941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6519722938537598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([168, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6532254219055176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6532254219055176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.65354585647583  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.67405366897583  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([144, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6756134033203125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6756134033203125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6758880615234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6953887939453125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([110, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6964144706726074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6964144706726074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6966242790222168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.712989330291748  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([106, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7141070365905762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7141070365905762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7143092155456543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.731494426727295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7324929237365723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7324929237365723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7326607704162598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7481026649475098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7487993240356445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7487993240356445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7489099502563477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.759861946105957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7606143951416016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7606143951416016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.760721206665039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.772043228149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7726664543151855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7726664543151855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7727503776550293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.782233715057373  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.782747745513916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.782747745513916  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7828125953674316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7905945777893066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7910466194152832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7910466194152832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.791100025177002  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7978825569152832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7984037399291992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7984037399291992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7984609603881836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8061285018920898  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8064460754394531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8064460754394531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8064804077148438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8113212585449219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8116674423217773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8116674423217773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.811701774597168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8167829513549805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8169984817504883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8169984817504883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8170194625854492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8202714920043945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8204822540283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8204822540283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8205013275146484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8235912322998047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8239049911499023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8239049911499023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8239316940307617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.828444480895996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([229, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8339338302612305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8339338302612305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8343706130981445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9112443923950195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 229, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.884324073791504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.885164737701416  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8860054016113281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.885122299194336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5640, 40])
input nodes number: 24979
output nodes number: 5640
edges number: 32898
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8853507041931152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8853511810302734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05269670486450195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 10 input nodes size: 77921
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.048325538635253906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.048325538635253906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08548116683959961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08552312850952148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04914236068725586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0506281852722168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0506281852722168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0506281852722168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([77921, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0506281852722168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([2026, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13402795791625977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13402795791625977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2026, 128]), torch.Size([1, 2026, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13596010208129883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15141725540161133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2026, 128])
m.shape torch.Size([2427, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15276575088500977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15276575088500977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2427, 128]), torch.Size([1, 2427, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15629863739013672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19234704971313477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2427, 128])
m.shape torch.Size([2268, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19451904296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19451904296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2268, 128]), torch.Size([1, 2268, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19675779342651367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24440717697143555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2268, 128])
m.shape torch.Size([2140, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2476515769958496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2476515769958496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2140, 128]), torch.Size([1, 2140, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24969244003295898  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3095545768737793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2140, 128])
m.shape torch.Size([1912, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3130927085876465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3130927085876465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1912, 128]), torch.Size([1, 1912, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.31491613388061523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38094472885131836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1912, 128])
m.shape torch.Size([1494, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3843073844909668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3843073844909668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38573217391967773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44720983505249023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([1300, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4508366584777832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4508366584777832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1300, 128]), torch.Size([1, 1300, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.45207643508911133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5140652656555176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1300, 128])
m.shape torch.Size([1110, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5176796913146973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5176796913146973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5187382698059082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5807785987854004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([943, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5842962265014648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5842962265014648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 943, 128]), torch.Size([1, 943, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5851955413818359  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6430072784423828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 943, 128])
m.shape torch.Size([10099, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6907134056091309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6907134056091309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10099, 128]), torch.Size([1, 10099, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.7006711959838867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3893241882324219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10099, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3159289360046387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.340456485748291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3649840354919434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3402647972106934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25719, 256])
first layer input nodes number: 77921
first layer output nodes number: 25719
edges number: 168225
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3655667304992676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.39009428024292  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.396226406097412  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.396226406097412  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1077, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4274005889892578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4274005889892578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1077, 256]), torch.Size([1, 1077, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.429640293121338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4474506378173828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1077, 256])
m.shape torch.Size([940, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4481420516967773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4481420516967773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 940, 256]), torch.Size([1, 940, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.449934959411621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4768285751342773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 940, 256])
m.shape torch.Size([742, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4781708717346191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4781708717346191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 742, 256]), torch.Size([1, 742, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.479586124420166  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5114731788635254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 742, 256])
m.shape torch.Size([544, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5130038261413574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5130038261413574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5140414237976074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5458941459655762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([477, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5479369163513184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5479369163513184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 477, 256]), torch.Size([1, 477, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.54884672164917  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5836691856384277  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 477, 256])
m.shape torch.Size([337, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.585157871246338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.585157871246338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5858006477355957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6143598556518555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([260, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6157879829406738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6157879829406738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.616283893585205  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6421513557434082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6434721946716309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6434721946716309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6438612937927246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6660399436950684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([135, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.667013168334961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.667013168334961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6672706604003906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6837501525878906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([134, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6849093437194824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6849093437194824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6851649284362793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7033114433288574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([85, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7040824890136719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7040824890136719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.704244613647461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7168903350830078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([87, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7178130149841309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7178130149841309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7179789543151855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.732083797454834  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.732900619506836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.732900619506836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7330379486083984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7456722259521484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.746316909790039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.746316909790039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7464179992675781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7564258575439453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7570385932922363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7570385932922363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7571263313293457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7664265632629395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7669672966003418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7669672966003418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7670397758483887  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7752299308776855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.775651454925537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.775651454925537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7757048606872559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7821135520935059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.782485008239746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.782485008239746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7825288772583008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.788100242614746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7883343696594238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7883343696594238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7883610725402832  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7919392585754395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7925410270690918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7925410270690918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7926020622253418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8012080192565918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8014802932739258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8014802932739258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.801508903503418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8057432174682617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8058981895446777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8058981895446777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8059134483337402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8082785606384277  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8084921836853027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8084921836853027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8085112571716309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.811601161956787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8118224143981934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8118224143981934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8118414878845215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8150649070739746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([223, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8204140663146973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8204140663146973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8208394050598145  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8956990242004395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 223, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8710732460021973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8719072341918945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8727412223815918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8718652725219727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5594, 40])
input nodes number: 25719
output nodes number: 5594
edges number: 31060
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8720922470092773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8720927238464355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0535578727722168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 11 input nodes size: 77167
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.049135684967041016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.049135684967041016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08593177795410156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08597421646118164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04877662658691406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05029296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05029296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05029296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([77167, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05029296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1908, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13546371459960938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13546371459960938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1908, 128]), torch.Size([1, 1908, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1372833251953125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1518402099609375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1908, 128])
m.shape torch.Size([2330, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1531968116760254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1531968116760254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2330, 128]), torch.Size([1, 2330, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15541887283325195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18908357620239258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2330, 128])
m.shape torch.Size([2237, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19130563735961914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19130563735961914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2237, 128]), torch.Size([1, 2237, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19412708282470703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24172306060791016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2237, 128])
m.shape torch.Size([2044, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24422407150268555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24422407150268555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2044, 128]), torch.Size([1, 2044, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24617338180541992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3027796745300293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2044, 128])
m.shape torch.Size([1737, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30594635009765625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30594635009765625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1737, 128]), torch.Size([1, 1737, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3076028823852539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.36820459365844727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1737, 128])
m.shape torch.Size([1482, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3716163635253906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3716163635253906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1482, 128]), torch.Size([1, 1482, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3730297088623047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4344611167907715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1482, 128])
m.shape torch.Size([1237, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4378833770751953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4378833770751953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1237, 128]), torch.Size([1, 1237, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.43906307220458984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5000720024108887  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1237, 128])
m.shape torch.Size([1095, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5036592483520508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5036592483520508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5047035217285156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5656957626342773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([949, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5692462921142578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5692462921142578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 949, 128]), torch.Size([1, 949, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5701513290405273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6280736923217773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 949, 128])
m.shape torch.Size([10548, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6784024238586426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6784024238586426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10548, 128]), torch.Size([1, 10548, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6888833045959473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4030976295471191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10548, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3277454376220703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.352128028869629  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3765106201171875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3519372940063477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25567, 256])
first layer input nodes number: 77167
first layer output nodes number: 25567
edges number: 170472
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3770875930786133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4014701843261719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4075660705566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4075660705566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1034, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4405455589294434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4405455589294434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1034, 256]), torch.Size([1, 1034, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4429006576538086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4616899490356445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1034, 256])
m.shape torch.Size([924, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.462113857269287  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.462113857269287  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 924, 256]), torch.Size([1, 924, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4638762474060059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4930644035339355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 924, 256])
m.shape torch.Size([701, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.494509220123291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.494509220123291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4958462715148926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.526857852935791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([576, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5284037590026855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5284037590026855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5295023918151855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5613627433776855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([437, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5629138946533203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5629138946533203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5637474060058594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5941438674926758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([354, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.596604347229004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.596604347229004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5972795486450195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6265878677368164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([251, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.627939224243164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.627939224243164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.62841796875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6523551940917969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([199, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6536459922790527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6536459922790527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6540255546569824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6756606101989746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([172, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.676987648010254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.676987648010254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6773157119750977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6983118057250977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([141, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6995244026184082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6995244026184082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6997933387756348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7188878059387207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([119, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7201290130615234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7201290130615234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7203559875488281  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7380599975585938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7388348579406738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7388348579406738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7389817237854004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7514653205871582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([76, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7523417472839355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7523417472839355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7524867057800293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7658228874206543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7666254043579102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7666254043579102  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.766749382019043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7790231704711914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7797398567199707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7797398567199707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7798428535461426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7907605171203613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.791308879852295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.791308879852295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7913832664489746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7997889518737793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8003077507019043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8003077507019043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.80037260055542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.808154582977295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.808624267578125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.808624267578125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8086795806884766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.815704345703125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8160057067871094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8160057067871094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8160400390625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8206405639648438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.820988655090332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.820988655090332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8210248947143555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8261346817016602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8265810012817383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8265810012817383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.826624870300293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8331174850463867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8334550857543945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8334550857543945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8334875106811523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8385133743286133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.838850975036621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.838850975036621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.838881492614746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.843825340270996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8441100120544434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8441100120544434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.84413480758667  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.848325252532959  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([245, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8541998863220215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8541998863220215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8546671867370605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9369120597839355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 245, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.910118579864502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9109582901000977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9117980003356934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9109158515930176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5633, 40])
input nodes number: 25567
output nodes number: 5633
edges number: 32954
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9111547470092773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9111552238464355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.053272247314453125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 12 input nodes size: 74851
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0487823486328125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0487823486328125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08447408676147461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08451604843139648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04767751693725586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04912424087524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04912424087524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04912424087524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([74851, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04912424087524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1979, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.129364013671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.129364013671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1979, 128]), torch.Size([1, 1979, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13125133514404297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14634990692138672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1979, 128])
m.shape torch.Size([2376, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1483292579650879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1483292579650879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2376, 128]), torch.Size([1, 2376, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15059518814086914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18638277053833008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2376, 128])
m.shape torch.Size([2314, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18864870071411133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18864870071411133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2314, 128]), torch.Size([1, 2314, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19115734100341797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24125385284423828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2314, 128])
m.shape torch.Size([2074, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24456405639648438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24456405639648438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2074, 128]), torch.Size([1, 2074, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24654197692871094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30562591552734375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2074, 128])
m.shape torch.Size([1769, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30811357498168945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30811357498168945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1769, 128]), torch.Size([1, 1769, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3098006248474121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37053442001342773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1769, 128])
m.shape torch.Size([1469, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37389373779296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37389373779296875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1469, 128]), torch.Size([1, 1469, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37529468536376953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4362821578979492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1469, 128])
m.shape torch.Size([1280, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.43985414505004883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.43985414505004883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1280, 128]), torch.Size([1, 1280, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44107484817504883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5033831596374512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1280, 128])
m.shape torch.Size([1125, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5070643424987793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5070643424987793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5081372261047363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5708022117614746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([932, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5742654800415039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5742654800415039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5751543045043945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6320786476135254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([9583, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6773295402526855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6773295402526855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9583, 128]), torch.Size([1, 9583, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6869850158691406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3368644714355469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9583, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2660274505615234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2897748947143555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3135223388671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2895889282226562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([24901, 256])
first layer input nodes number: 74851
first layer output nodes number: 24901
edges number: 161806
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.314082145690918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.33782958984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.343766689300537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.343766689300537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1053, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3760833740234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3760833740234375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1053, 256]), torch.Size([1, 1053, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.378469467163086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3955326080322266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1053, 256])
m.shape torch.Size([911, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3960480690002441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3960480690002441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 911, 256]), torch.Size([1, 911, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3977856636047363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4238929748535156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 911, 256])
m.shape torch.Size([722, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4255094528198242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4255094528198242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 722, 256]), torch.Size([1, 722, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4268865585327148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4612512588500977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 722, 256])
m.shape torch.Size([558, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4632396697998047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4632396697998047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.464303970336914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4957003593444824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([431, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.497239589691162  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.497239589691162  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4980616569519043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.528303623199463  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([329, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.529789924621582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.529789924621582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5304174423217773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5581893920898438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([285, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5605497360229492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5605497360229492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5610933303833008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5905961990356445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([224, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5920467376708984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5920467376708984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5924739837646484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6168270111083984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([177, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6181445121765137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6181445121765137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6184821128845215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6400885581970215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([129, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.641160011291504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.641160011291504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6414060592651367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6588754653930664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([115, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.659968376159668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.659968376159668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6601877212524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6772966384887695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([79, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.678098201751709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.678098201751709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6782488822937012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.691056728363037  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6918439865112305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6918439865112305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6919755935668945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7040834426879883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7048254013061523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7048254013061523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.704939842224121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7162694931030273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7168612480163574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7168612480163574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.716947078704834  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7260451316833496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7265868186950684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7265868186950684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7266592979431152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.734849452972412  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.73551607131958  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.73551607131958  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.735598087310791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7454400062561035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7459354400634766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7459354400634766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7459945678710938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7535037994384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7539677619934082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7539677619934082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7540192604064941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7609200477600098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7613749504089355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7613749504089355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7614226341247559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.76814603805542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7684454917907715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7684454917907715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7684760093688965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7729926109313965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.773210048675537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.773210048675537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.773231029510498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7764830589294434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.77695894241333  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.77695894241333  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.777000904083252  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7837986946105957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7841010093688965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7841010093688965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7841277122497559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7886404991149902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([208, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7936253547668457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7936253547668457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7940220832824707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8638463020324707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 208, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8379006385803223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8387384414672852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.839576244354248  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8386964797973633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5622, 40])
input nodes number: 24901
output nodes number: 5622
edges number: 32227
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8389225006103516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8389229774475098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05198812484741211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 13 input nodes size: 75502
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04767560958862305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04767560958862305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08367776870727539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08372068405151367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04798698425292969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04942512512207031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04942512512207031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04942512512207031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([75502, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04942512512207031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1946, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1291666030883789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1291666030883789  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1946, 128]), torch.Size([1, 1946, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13102245330810547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14586925506591797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1946, 128])
m.shape torch.Size([2410, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14800167083740234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14800167083740234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2410, 128]), torch.Size([1, 2410, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1503000259399414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18546104431152344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2410, 128])
m.shape torch.Size([2419, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18777227401733398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18777227401733398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2419, 128]), torch.Size([1, 2419, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1900792121887207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24083185195922852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2419, 128])
m.shape torch.Size([1998, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24421453475952148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24421453475952148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1998, 128]), torch.Size([1, 1998, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24611997604370117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.30185461044311523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1998, 128])
m.shape torch.Size([1838, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3052840232849121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3052840232849121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1838, 128]), torch.Size([1, 1838, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3070368766784668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37035036087036133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1838, 128])
m.shape torch.Size([1543, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3738884925842285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3738884925842285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1543, 128]), torch.Size([1, 1543, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.37536001205444336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.43863534927368164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1543, 128])
m.shape torch.Size([1285, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44218873977661133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44218873977661133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1285, 128]), torch.Size([1, 1285, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44341421127319336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5052242279052734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1285, 128])
m.shape torch.Size([1117, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5088725090026855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5088725090026855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5099377632141113  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5715384483337402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([936, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5756235122680664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5756235122680664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5765161514282227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6345386505126953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([9399, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6789102554321289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6789102554321289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9399, 128]), torch.Size([1, 9399, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6878738403320312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3242883682250977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9399, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2545247077941895  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2782626152038574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3020005226135254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2780771255493164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([24891, 256])
first layer input nodes number: 75502
first layer output nodes number: 24891
edges number: 160808
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.302565097808838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3263030052185059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.332237720489502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.332237720489502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1044, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3643460273742676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3643460273742676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1044, 256]), torch.Size([1, 1044, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.36649751663208  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3840618133544922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1044, 256])
m.shape torch.Size([906, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3848824501037598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3848824501037598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 906, 256]), torch.Size([1, 906, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.386610507965088  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4131112098693848  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 906, 256])
m.shape torch.Size([761, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4148831367492676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4148831367492676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 761, 256]), torch.Size([1, 761, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.416334629058838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4540324211120605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 761, 256])
m.shape torch.Size([575, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.455517292022705  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.455517292022705  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4566140174865723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4899520874023438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 575, 256])
m.shape torch.Size([466, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4916434288024902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4916434288024902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4925322532653809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5246071815490723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([366, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5262737274169922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5262737274169922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5269718170166016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5605053901672363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([282, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5620536804199219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5620536804199219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.562591552734375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5929970741271973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([224, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5944504737854004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5944504737854004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5948777198791504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6192307472229004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([172, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6205053329467773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6205053329467773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.620833396911621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.641829490661621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([139, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6430015563964844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6430015563964844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6432666778564453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6620903015136719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([96, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6629729270935059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6629729270935059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6631560325622559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6774382591247559  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6785235404968262  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6785235404968262  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.678718090057373  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6952548027038574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([80, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.696157455444336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.696157455444336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.696310043334961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.710348129272461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([66, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7111601829528809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7111601829528809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7112860679626465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7237486839294434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7242770195007324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7242770195007324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7243552207946777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7326445579528809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.733236312866211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.733236312866211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7333145141601562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7421512603759766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7427496910095215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7427496910095215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7428240776062012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7517504692077637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7522497177124023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7522497177124023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7523088455200195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7598180770874023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.760190486907959  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.760190486907959  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7602324485778809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.765855312347412  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7661418914794922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7661418914794922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7661724090576172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7704753875732422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7708234786987305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7708234786987305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.770857810974121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7759389877319336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7762393951416016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7762393951416016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7762680053710938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7807025909423828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.780909538269043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.780909538269043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.780928611755371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7840185165405273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7842631340026855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7842631340026855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7842841148376465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.787829875946045  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([189, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.792360782623291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.792360782623291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7927212715148926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8561673164367676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 189, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8307509422302246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8316020965576172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8324532508850098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.831559181213379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5712, 40])
input nodes number: 24891
output nodes number: 5712
edges number: 32070
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.831800937652588  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.831801414489746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05229997634887695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 14 input nodes size: 75173
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.048000335693359375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.048000335693359375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08384561538696289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08388757705688477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04784250259399414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04931306838989258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04931306838989258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04931306838989258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([75173, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04931306838989258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1986, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13062429428100586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13062429428100586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1986, 128]), torch.Size([1, 1986, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13251829147338867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14767026901245117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1986, 128])
m.shape torch.Size([2386, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14994049072265625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14994049072265625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2386, 128]), torch.Size([1, 2386, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15296173095703125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1889657974243164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2386, 128])
m.shape torch.Size([2302, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19124126434326172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19124126434326172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2302, 128]), torch.Size([1, 2302, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1934366226196289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24347591400146484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2302, 128])
m.shape torch.Size([2060, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24676895141601562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24676895141601562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2060, 128]), torch.Size([1, 2060, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2487335205078125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3084287643432617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2060, 128])
m.shape torch.Size([1909, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3119978904724121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3119978904724121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1909, 128]), torch.Size([1, 1909, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.31381845474243164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3797740936279297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1909, 128])
m.shape torch.Size([1497, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3831467628479004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3831467628479004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1497, 128]), torch.Size([1, 1497, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38457441329956055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4461493492126465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1497, 128])
m.shape torch.Size([1320, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4498414993286133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4498414993286133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1320, 128]), torch.Size([1, 1320, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.45110034942626953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.514042854309082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1320, 128])
m.shape torch.Size([1106, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5176324844360352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5176324844360352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5186872482299805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.580479621887207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([963, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5840849876403809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5840849876403809  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5850033760070801  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6441049575805664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([9680, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6898036003112793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6898036003112793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9680, 128]), torch.Size([1, 9680, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6992640495300293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.354712963104248  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9680, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2823805809020996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3064217567443848  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.33046293258667  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3062338829040527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25209, 256])
first layer input nodes number: 75173
first layer output nodes number: 25209
edges number: 163986
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3310251235961914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3550662994384766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.361076831817627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.361076831817627  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1016, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3941969871520996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3941969871520996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1016, 256]), torch.Size([1, 1016, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.396134853363037  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4133501052856445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1016, 256])
m.shape torch.Size([871, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4140558242797852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4140558242797852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 871, 256]), torch.Size([1, 871, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4157171249389648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4406366348266602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 871, 256])
m.shape torch.Size([684, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4417853355407715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4417853355407715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 684, 256]), torch.Size([1, 684, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4430899620056152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.475296974182129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 684, 256])
m.shape torch.Size([532, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.477177619934082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.477177619934082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4781923294067383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5076189041137695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([479, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.509413719177246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.509413719177246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5103273391723633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5440731048583984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([357, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.545675277709961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.545675277709961  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.546356201171875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5760841369628906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([258, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5774798393249512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5774798393249512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5779719352722168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.60359525680542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([239, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.605186939239502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.605186939239502  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6056427955627441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6316266059875488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([198, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6331114768981934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6331114768981934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6334891319274902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6576590538024902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([142, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6588354110717773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6588354110717773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6591062545776367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6783361434936523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([116, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6795358657836914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6795358657836914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6797571182250977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6970148086547852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([97, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6980352401733398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6980352401733398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6982202529907227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7139463424682617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7146787643432617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7146787643432617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7148046493530273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7263860702514648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7272248268127441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7272248268127441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7273526191711426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.740004062652588  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7407622337341309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7407622337341309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7408709526062012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7523951530456543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.753063678741455  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.753063678741455  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7531533241271973  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7632832527160645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.763810634613037  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.763810634613037  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7638773918151855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.771888256072998  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.772512435913086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.772512435913086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7725849151611328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.781789779663086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7821736335754395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7821736335754395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7822175025939941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7880959510803223  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7885546684265137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7885546684265137  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.788602352142334  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.795325756072998  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7958269119262695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7958269119262695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7958765029907227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8032159805297852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8034873008728027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8034873008728027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.803514003753662  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8076529502868652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8080596923828125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8080596923828125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.808095932006836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8139667510986328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8143177032470703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8143177032470703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8143482208251953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8195056915283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([203, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8243684768676758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8243684768676758  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8247556686401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8929014205932617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 203, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.866281509399414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8671197891235352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8679580688476562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8670778274536133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5625, 40])
input nodes number: 25209
output nodes number: 5625
edges number: 33204
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8672947883605957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.867295265197754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.052205562591552734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 15 input nodes size: 77168
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.047829627990722656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.047829627990722656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0846261978149414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08466768264770508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04878044128417969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.050232887268066406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.050232887268066406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.050232887268066406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([77168, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.050232887268066406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([2029, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13205814361572266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13205814361572266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2029, 128]), torch.Size([1, 2029, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13399314880371094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1494731903076172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2029, 128])
m.shape torch.Size([2509, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15089845657348633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.15089845657348633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2509, 128]), torch.Size([1, 2509, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1539287567138672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18989229202270508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2509, 128])
m.shape torch.Size([2387, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19211053848266602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19211053848266602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2387, 128]), torch.Size([1, 2387, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.19444513320922852  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24546051025390625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2387, 128])
m.shape torch.Size([2049, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24887514114379883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.24887514114379883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 2049, 128]), torch.Size([1, 2049, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.25092172622680664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.31049251556396484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 2049, 128])
m.shape torch.Size([1925, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.31440067291259766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.31440067291259766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1925, 128]), torch.Size([1, 1925, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3162364959716797  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3823261260986328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1925, 128])
m.shape torch.Size([1477, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3856339454650879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3856339454650879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1477, 128]), torch.Size([1, 1477, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3870425224304199  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44761133193969727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1477, 128])
m.shape torch.Size([1247, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.45106935501098633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.45106935501098633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1247, 128]), torch.Size([1, 1247, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4522585868835449  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5135025978088379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1247, 128])
m.shape torch.Size([1046, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5168981552124023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5168981552124023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1046, 128]), torch.Size([1, 1046, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5178956985473633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5750885009765625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1046, 128])
m.shape torch.Size([905, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5784735679626465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5784735679626465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5793366432189941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6353473663330078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([9885, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6820511817932129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6820511817932129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9885, 128]), torch.Size([1, 9885, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6914782524108887  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.372988224029541  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9885, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3010787963867188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3253583908081055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3496379852294922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3251686096191406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([25459, 256])
first layer input nodes number: 77168
first layer output nodes number: 25459
edges number: 164983
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.350214958190918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3744945526123047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3805646896362305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3805646896362305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1093, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4107084274291992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4107084274291992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1093, 256]), torch.Size([1, 1093, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4130735397338867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.432504653930664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1093, 256])
m.shape torch.Size([954, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4335737228393555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4335737228393555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 954, 256]), torch.Size([1, 954, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4353933334350586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4626941680908203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 954, 256])
m.shape torch.Size([743, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4644312858581543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4644312858581543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 743, 256]), torch.Size([1, 743, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.465848445892334  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4970817565917969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 743, 256])
m.shape torch.Size([541, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.49845552444458  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.49845552444458  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4994874000549316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5362095832824707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([468, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5383415222167969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5383415222167969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5392341613769531  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5739669799804688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([337, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5754642486572266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5754642486572266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5761070251464844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6051445007324219  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([268, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6066265106201172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6066265106201172  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.607137680053711  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6335029602050781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([210, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6348624229431152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6348624229431152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6352629661560059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6580939292907715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([152, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6592087745666504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6592087745666504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.659498691558838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.678053379058838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([109, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6789565086364746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6789565086364746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6791644096374512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.693925380706787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([101, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6948895454406738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6948895454406738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.695082187652588  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7101082801818848  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([92, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.711073398590088  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.711073398590088  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7112488746643066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7261643409729004  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7267389297485352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7267389297485352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7268400192260742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.736140251159668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.736668586730957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.736668586730957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.736750602722168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7448701858520508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7453193664550781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7453193664550781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7453842163085938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.75225830078125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7527027130126953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7527027130126953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7527618408203125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7594432830810547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7598061561584473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7598061561584473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7598519325256348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7653450965881348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7656512260437012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7656512260437012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7656874656677246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7702898979187012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.770637035369873  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.770637035369873  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7706751823425293  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7757868766784668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7761139869689941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7761139869689941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7761483192443848  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.780989170074463  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.781416416168213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.781416416168213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7814583778381348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7876687049865723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7877960205078125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7877960205078125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7878093719482422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7898788452148438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7900052070617676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7900052070617676  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7900166511535645  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7918705940246582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7920265197753906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7920265197753906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7920398712158203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7942962646484375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([208, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7992877960205078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7992877960205078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7996845245361328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8695087432861328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 208, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8452982902526855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8461270332336426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8469557762145996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.846085548400879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5560, 40])
input nodes number: 25459
output nodes number: 5560
edges number: 29894
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8463072776794434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8463077545166016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.053105831146240234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.053105831146240234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.053105831146240234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018417954444885254 |0.0030545443296432495 |0.116634801030159 |8.983910083770752e-05 |0.07547709345817566 |0.00461888313293457 |[05:43:08] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 510472 edges into 16 parts and get 28989 edge cuts

----------------------------------------------------------pseudo_mini_loss sum 4.2603654861450195
Total (block generation + training)time/epoch 18.816816329956055
Training time/epoch 3.4979615211486816
Training time without block to device /epoch 3.4490888118743896
Training time without total dataloading part /epoch 3.0798466205596924
load block tensor time/epoch 0.29468727111816406
block to device time/epoch 0.04887270927429199
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1569135
Number of first layer input nodes during this epoch:  1162545
Number of first layer output nodes during this epoch:  406590
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05310535430908203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01853036880493164
global_2_local spend time (sec) 0.047444820404052734
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004320859909057617
A = g.adjacency_matrix() spent  0.011536359786987305
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09672093391418457
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3350119590759277
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1807022094726562

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 0.024 seconds
Metis partitioning: 0.088 seconds
Split the graph: 0.036 seconds
Construct subgraphs: 0.130 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.2775123119354248
5817
5636
5549
5826
5854
5712
5815
5819
5543
5538
5760
5549
5547
5805
5541
5630
total k batches seeds list generation spend  10.849592208862305
after graph partition
graph partition algorithm spend time 10.94318699836731
5817
5636
5549
5826
5854
5712
5815
5819
5543
5538
5760
5549
5547
5805
5541
5630
partition_len_list
[24199, 23485, 23034, 20443, 32390, 29164, 28744, 27421, 25239, 24391, 24492, 25299, 25385, 25164, 24446, 25196]
shared_neighbor_graph_partition_s0 selection method  spend 11.04215407371521
time for parepare:  0.016571998596191406
local_output_nid generation:  0.0013573169708251953
local_in_edges_tensor generation:  0.0015139579772949219
mini_batch_src_global generation:  0.0022559165954589844
r_  generation:  0.019088029861450195
local_output_nid generation:  0.001531362533569336
local_in_edges_tensor generation:  0.0015282630920410156
mini_batch_src_global generation:  0.002386808395385742
r_  generation:  0.017399072647094727
local_output_nid generation:  0.0016326904296875
local_in_edges_tensor generation:  0.0013713836669921875
mini_batch_src_global generation:  0.0012624263763427734
r_  generation:  0.014371156692504883
local_output_nid generation:  0.0017402172088623047
local_in_edges_tensor generation:  0.0014312267303466797
mini_batch_src_global generation:  0.001768350601196289
r_  generation:  0.01991748809814453
local_output_nid generation:  0.001783132553100586
local_in_edges_tensor generation:  0.0014908313751220703
mini_batch_src_global generation:  0.0022144317626953125
r_  generation:  0.023972034454345703
local_output_nid generation:  0.0018310546875
local_in_edges_tensor generation:  0.0014615058898925781
mini_batch_src_global generation:  0.003412008285522461
r_  generation:  0.040183305740356445
local_output_nid generation:  0.0022864341735839844
local_in_edges_tensor generation:  0.0017919540405273438
mini_batch_src_global generation:  0.005671977996826172
r_  generation:  0.02557682991027832
local_output_nid generation:  0.0025513172149658203
local_in_edges_tensor generation:  0.0038352012634277344
mini_batch_src_global generation:  0.0022046566009521484
r_  generation:  0.02823805809020996
local_output_nid generation:  0.002599477767944336
local_in_edges_tensor generation:  0.0024750232696533203
mini_batch_src_global generation:  0.0031003952026367188
r_  generation:  0.015743732452392578
local_output_nid generation:  0.0021657943725585938
local_in_edges_tensor generation:  0.0017218589782714844
mini_batch_src_global generation:  0.003354787826538086
r_  generation:  0.014360189437866211
local_output_nid generation:  0.0018486976623535156
local_in_edges_tensor generation:  0.0015556812286376953
mini_batch_src_global generation:  0.0012803077697753906
r_  generation:  0.02439403533935547
local_output_nid generation:  0.003345489501953125
local_in_edges_tensor generation:  0.001596689224243164
mini_batch_src_global generation:  0.001583099365234375
r_  generation:  0.01057577133178711
local_output_nid generation:  0.002851724624633789
local_in_edges_tensor generation:  0.001451253890991211
mini_batch_src_global generation:  0.0014336109161376953
r_  generation:  0.010255575180053711
local_output_nid generation:  0.00289154052734375
local_in_edges_tensor generation:  0.0014100074768066406
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.011651992797851562
local_output_nid generation:  0.002601146697998047
local_in_edges_tensor generation:  0.0015461444854736328
mini_batch_src_global generation:  0.0014252662658691406
r_  generation:  0.009928226470947266
local_output_nid generation:  0.0032804012298583984
local_in_edges_tensor generation:  0.0016219615936279297
mini_batch_src_global generation:  0.002331256866455078
r_  generation:  0.010898828506469727
----------------------check_connections_block total spend ----------------------------- 0.5055737495422363
generate_one_block  0.03442645072937012
generate_one_block  0.02734088897705078
generate_one_block  0.02294135093688965
generate_one_block  0.029616117477416992
generate_one_block  0.04023265838623047
generate_one_block  0.03817176818847656
generate_one_block  0.034510135650634766
generate_one_block  0.039563655853271484
generate_one_block  0.02328801155090332
generate_one_block  0.02070140838623047
generate_one_block  0.020909786224365234
generate_one_block  0.019588232040405273
generate_one_block  0.015610456466674805
generate_one_block  0.017360925674438477
generate_one_block  0.01694631576538086
generate_one_block  0.016760826110839844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04519248008728027
gen group dst list time:  0.011325836181640625
time for parepare:  0.01911139488220215
local_output_nid generation:  0.004822731018066406
local_in_edges_tensor generation:  0.018860816955566406
mini_batch_src_global generation:  0.007544517517089844
r_  generation:  0.06812596321105957
local_output_nid generation:  0.008552789688110352
local_in_edges_tensor generation:  0.006815910339355469
mini_batch_src_global generation:  0.008260965347290039
r_  generation:  0.06340718269348145
local_output_nid generation:  0.007311582565307617
local_in_edges_tensor generation:  0.005697488784790039
mini_batch_src_global generation:  0.005853891372680664
r_  generation:  0.06369972229003906
local_output_nid generation:  0.006368875503540039
local_in_edges_tensor generation:  0.0053098201751708984
mini_batch_src_global generation:  0.006186962127685547
r_  generation:  0.05544734001159668
local_output_nid generation:  0.009162425994873047
local_in_edges_tensor generation:  0.0076715946197509766
mini_batch_src_global generation:  0.010528564453125
r_  generation:  0.0982978343963623
local_output_nid generation:  0.00809025764465332
local_in_edges_tensor generation:  0.00813746452331543
mini_batch_src_global generation:  0.011082649230957031
r_  generation:  0.08731627464294434
local_output_nid generation:  0.008037805557250977
local_in_edges_tensor generation:  0.007601261138916016
mini_batch_src_global generation:  0.010799169540405273
r_  generation:  0.08748912811279297
local_output_nid generation:  0.007866859436035156
local_in_edges_tensor generation:  0.006223917007446289
mini_batch_src_global generation:  0.009446382522583008
r_  generation:  0.07670116424560547
local_output_nid generation:  0.007330417633056641
local_in_edges_tensor generation:  0.005849599838256836
mini_batch_src_global generation:  0.00838327407836914
r_  generation:  0.07063794136047363
local_output_nid generation:  0.007032632827758789
local_in_edges_tensor generation:  0.005407571792602539
mini_batch_src_global generation:  0.007673978805541992
r_  generation:  0.06648111343383789
local_output_nid generation:  0.0070629119873046875
local_in_edges_tensor generation:  0.005542278289794922
mini_batch_src_global generation:  0.0077021121978759766
r_  generation:  0.06882739067077637
local_output_nid generation:  0.007158041000366211
local_in_edges_tensor generation:  0.0055332183837890625
mini_batch_src_global generation:  0.008214235305786133
r_  generation:  0.06974649429321289
local_output_nid generation:  0.0073451995849609375
local_in_edges_tensor generation:  0.005724430084228516
mini_batch_src_global generation:  0.00838017463684082
r_  generation:  0.07218337059020996
local_output_nid generation:  0.00724029541015625
local_in_edges_tensor generation:  0.005589008331298828
mini_batch_src_global generation:  0.008333206176757812
r_  generation:  0.07017898559570312
local_output_nid generation:  0.007021427154541016
local_in_edges_tensor generation:  0.0053784847259521484
mini_batch_src_global generation:  0.007984161376953125
r_  generation:  0.07103848457336426
local_output_nid generation:  0.007257699966430664
local_in_edges_tensor generation:  0.009249448776245117
mini_batch_src_global generation:  0.01036381721496582
r_  generation:  0.07386159896850586
----------------------check_connections_block total spend ----------------------------- 1.87371826171875
generate_one_block  0.11192059516906738
generate_one_block  0.08642268180847168
generate_one_block  0.08793449401855469
generate_one_block  0.07307744026184082
generate_one_block  0.13270926475524902
generate_one_block  0.11521220207214355
generate_one_block  0.11094498634338379
generate_one_block  0.0977177619934082
generate_one_block  0.08548355102539062
generate_one_block  0.08075070381164551
generate_one_block  0.08221626281738281
generate_one_block  0.08483552932739258
generate_one_block  0.08621644973754883
generate_one_block  0.08596038818359375
generate_one_block  0.08214688301086426
generate_one_block  0.08486294746398926
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05310535430908203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

connection checking time:  1.87371826171875
block generation total time  1.4884121417999268
average batch blocks generation time:  0.09302575886249542
block dataloader generation time/epoch 15.440755248069763
pseudo mini batch 0 input nodes size: 69021
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04876995086669922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04876995086669922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.08197307586669922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.0820164680480957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04517841339111328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04684925079345703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04684925079345703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04684925079345703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([69021, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04684925079345703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1476, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13050460815429688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13050460815429688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1476, 128]), torch.Size([1, 1476, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1319122314453125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1431732177734375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1476, 128])
m.shape torch.Size([1843, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1442270278930664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1442270278930664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1843, 128]), torch.Size([1, 1843, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14598464965820312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1723489761352539  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1843, 128])
m.shape torch.Size([1865, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17413806915283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17413806915283203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1865, 128]), torch.Size([1, 1865, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1759166717529297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21504592895507812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1865, 128])
m.shape torch.Size([1834, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21765470504760742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21765470504760742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1834, 128]), torch.Size([1, 1834, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21940374374389648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2701258659362793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1834, 128])
m.shape torch.Size([1594, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.27305173873901367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.27305173873901367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1594, 128]), torch.Size([1, 1594, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.27457189559936523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3292975425720215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1594, 128])
m.shape torch.Size([1429, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3326258659362793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3326258659362793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1429, 128]), torch.Size([1, 1429, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.33398866653442383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3943638801574707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1429, 128])
m.shape torch.Size([1192, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3976612091064453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3976612091064453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1192, 128]), torch.Size([1, 1192, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.39879798889160156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4560399055480957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1192, 128])
m.shape torch.Size([1148, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4598507881164551  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4598507881164551  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1148, 128]), torch.Size([1, 1148, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.46094560623168945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5233502388000488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1148, 128])
m.shape torch.Size([938, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5268282890319824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5268282890319824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5277228355407715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5866026878356934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([10880, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6388897895812988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6388897895812988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10880, 128]), torch.Size([1, 10880, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6494755744934082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4081425666809082  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10880, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.333256721496582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.356694221496582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3797721862792969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.356153964996338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([24199, 256])
first layer input nodes number: 69021
first layer output nodes number: 24199
edges number: 169407
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3802886009216309  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4033665657043457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4091362953186035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4091362953186035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([699, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4631857872009277  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4631857872009277  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4645190238952637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4753227233886719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 699, 256])
m.shape torch.Size([594, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.475954532623291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.475954532623291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 594, 256]), torch.Size([1, 594, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4770874977111816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4947381019592285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 594, 256])
m.shape torch.Size([467, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4955248832702637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4955248832702637  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.496415615081787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5167007446289062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([427, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5179085731506348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5179085731506348  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5187230110168457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5428576469421387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([372, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.544238567352295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.544238567352295  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5449481010437012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5711569786071777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([308, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5733184814453125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5733184814453125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5739059448242188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.599700927734375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([267, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6012039184570312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6012039184570312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6017131805419922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6276369094848633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([261, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6293892860412598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6293892860412598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6298871040344238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6588654518127441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([228, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6605892181396484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6605892181396484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6610240936279297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6888561248779297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([214, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6906957626342773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6906957626342773  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6911039352416992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7200841903686523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([157, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7215399742126465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7215399742126465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.721839427947998  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.74519681930542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([154, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7468233108520508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7468233108520508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.747117042541504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7720842361450195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([130, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.773561954498291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.773561954498291  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7738099098205566  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7966217994689941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([116, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7980589866638184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7980589866638184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7982802391052246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8201842308044434  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([121, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8220815658569336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8220815658569336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.822312355041504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.846776008605957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([103, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8482446670532227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8482446670532227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8484411239624023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.870640754699707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([90, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8720130920410156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8720130920410156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8721847534179688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8927841186523438  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8938231468200684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8938231468200684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8939471244812012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9096922874450684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([84, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9111642837524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9111642837524414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9113245010375977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9327936172485352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([66, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9339823722839355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9339823722839355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9341082572937012  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9518580436706543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9528851509094238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9528851509094238  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9529881477355957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9682316780090332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9691953659057617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9691953659057617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9692869186401367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9834775924682617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.984316349029541  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.984316349029541  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9843926429748535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9967522621154785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.99782133102417  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.99782133102417  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.997912883758545  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.01338529586792  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([704, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0302553176879883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0302553176879883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0315980911254883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2745790481567383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 704, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2265944480895996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.227461338043213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.228328227996826  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2274179458618164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5817, 40])
input nodes number: 24199
output nodes number: 5817
edges number: 54683
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.227680206298828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.2276811599731445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.05008983612060547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 1 input nodes size: 68345
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04521751403808594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04521751403808594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07842063903808594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07846307754516602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04521656036376953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.046802520751953125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.046802520751953125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.046802520751953125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([68345, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.046802520751953125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1408, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1273941993713379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1273941993713379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1408, 128]), torch.Size([1, 1408, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1287369728088379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1394791603088379  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1408, 128])
m.shape torch.Size([1851, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14106512069702148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14106512069702148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1851, 128]), torch.Size([1, 1851, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14283037185668945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1698164939880371  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1851, 128])
m.shape torch.Size([1858, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17159175872802734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17159175872802734  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1858, 128]), torch.Size([1, 1858, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17336368560791016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21234607696533203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1858, 128])
m.shape torch.Size([1755, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21480751037597656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21480751037597656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1755, 128]), torch.Size([1, 1755, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21648120880126953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2650184631347656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1755, 128])
m.shape torch.Size([1632, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.26807260513305664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.26807260513305664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1632, 128]), torch.Size([1, 1632, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.26962900161743164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.32736825942993164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1632, 128])
m.shape torch.Size([1368, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3305039405822754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3305039405822754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1368, 128]), torch.Size([1, 1368, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.33180856704711914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3883662223815918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1368, 128])
m.shape torch.Size([1237, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3918428421020508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3918428421020508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1237, 128]), torch.Size([1, 1237, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3930225372314453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4534454345703125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1237, 128])
m.shape torch.Size([1165, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.45729970932006836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.45729970932006836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.45841073989868164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5218734741210938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1165, 128])
m.shape torch.Size([959, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5254335403442383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5254335403442383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5263481140136719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5855278968811035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([10252, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6339559555053711  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6339559555053711  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 10252, 128]), torch.Size([1, 10252, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6443414688110352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3385133743286133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 10252, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2665576934814453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.288954734802246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3113517761230469  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2887797355651855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([23485, 256])
first layer input nodes number: 68345
first layer output nodes number: 23485
edges number: 163202
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3118629455566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3342599868774414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3398594856262207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3398594856262207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([733, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3883934020996094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3883934020996094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 733, 256]), torch.Size([1, 733, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.389791488647461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4023785591125488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 733, 256])
m.shape torch.Size([610, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4028944969177246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4028944969177246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4040579795837402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.422339916229248  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 610, 256])
m.shape torch.Size([477, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4232721328735352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4232721328735352  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 477, 256]), torch.Size([1, 477, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4241819381713867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4451589584350586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 477, 256])
m.shape torch.Size([399, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4462800025939941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4462800025939941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4470410346984863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4735398292541504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([397, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.475104808807373  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.475104808807373  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4758620262145996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5086665153503418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([298, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5100064277648926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5100064277648926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5105748176574707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5365204811096191  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([287, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5381674766540527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5381674766540527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.53871488571167  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.567990779876709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([251, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5696473121643066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5696473121643066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5701260566711426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.597414493560791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([224, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5991129875183105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5991129875183105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5995402336120605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6268839836120605  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([186, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6284584999084473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6284584999084473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6288132667541504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6540017127990723  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([191, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.655843734741211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.655843734741211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6562080383300781  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6846237182617188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([147, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6861371994018555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6861371994018555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.686417579650879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.710249900817871  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([136, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7118091583251953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7118091583251953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7120685577392578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7359333038330078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([122, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.73744535446167  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.73744535446167  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.737678050994873  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7607150077819824  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([96, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7619829177856445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7619829177856445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7621660232543945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7815752029418945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7827138900756836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7827138900756836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7828664779663086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8001089096069336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([76, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8012747764587402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8012747764587402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.801419734954834  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.818814754486084  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8199706077575684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8199706077575684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.820106029510498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8373045921325684  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8383326530456543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8383326530456543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.838447093963623  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8537821769714355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8550324440002441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8550324440002441  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8551621437072754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8734498023986816  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.874293327331543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.874293327331543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8743791580200195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8870820999145508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.888117790222168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.888117790222168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8882150650024414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9032926559448242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.903951644897461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.903951644897461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.904012680053711  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.913900375366211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9145622253417969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9145622253417969  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9146194458007812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9242897033691406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([569, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9379935264587402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9379935264587402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9390788078308105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.1300883293151855  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 569, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.08756685256958  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.088407039642334  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.089247226715088  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.088364601135254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5636, 40])
input nodes number: 23485
output nodes number: 5636
edges number: 49525
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.088555335998535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0885558128356934  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04982948303222656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 2 input nodes size: 68939
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.045189857482910156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.045189857482910156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07839298248291016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07843446731567383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04518890380859375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04670238494873047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04670238494873047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04670238494873047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([68939, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04670238494873047  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1538, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12460803985595703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12460803985595703  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1538, 128]), torch.Size([1, 1538, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12607479095458984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13780879974365234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1538, 128])
m.shape torch.Size([1914, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13908815383911133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.13908815383911133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1914, 128]), torch.Size([1, 1914, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1409134864807129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.16829347610473633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1914, 128])
m.shape torch.Size([1912, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17011594772338867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17011594772338867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1912, 128]), torch.Size([1, 1912, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.17193937301635742  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21205472946166992  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1912, 128])
m.shape torch.Size([1745, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21447134017944336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21447134017944336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1745, 128]), torch.Size([1, 1745, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.21613550186157227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.26439619064331055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1745, 128])
m.shape torch.Size([1583, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.26733827590942383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.26733827590942383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1583, 128]), torch.Size([1, 1583, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2688479423522949  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3231959342956543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1583, 128])
m.shape torch.Size([1362, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3263378143310547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3263378143310547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1362, 128]), torch.Size([1, 1362, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.32763671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3842282295227051  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1362, 128])
m.shape torch.Size([1162, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38745737075805664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38745737075805664  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1162, 128]), torch.Size([1, 1162, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3885655403137207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44466161727905273  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1162, 128])
m.shape torch.Size([1029, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44803285598754883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44803285598754883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1029, 128]), torch.Size([1, 1029, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44901418685913086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5051960945129395  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1029, 128])
m.shape torch.Size([862, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5084047317504883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5084047317504883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5092267990112305  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5634727478027344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([9927, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6103973388671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6103973388671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9927, 128]), torch.Size([1, 9927, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.6198644638061523  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3055624961853027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9927, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2362432479858398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2582101821899414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.280177116394043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2580385208129883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([23034, 256])
first layer input nodes number: 68939
first layer output nodes number: 23034
edges number: 157563
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2806930541992188  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3026599884033203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.308427333831787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.308427333831787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([794, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3531780242919922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3531780242919922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 794, 256]), torch.Size([1, 794, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3546924591064453  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3672246932983398  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 794, 256])
m.shape torch.Size([711, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3678936958312988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3678936958312988  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 711, 256]), torch.Size([1, 711, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3692498207092285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3895916938781738  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 711, 256])
m.shape torch.Size([528, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3904681205749512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3904681205749512  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3914752006530762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4182686805725098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([447, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.419715404510498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.419715404510498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4205679893493652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4486727714538574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([380, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4500727653503418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4500727653503418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4507975578308105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.477381706237793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4788708686828613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4788708686828613  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4794831275939941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5068955421447754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([271, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5084128379821777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5084128379821777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.50892972946167  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.535231113433838  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([206, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5365567207336426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5365567207336426  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.536949634552002  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5593457221984863  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([202, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.560896873474121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.560896873474121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5612821578979492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5859403610229492  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([158, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.587266445159912  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.587266445159912  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5875678062438965  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.608964443206787  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6101884841918945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6101884841918945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6104364395141602  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.629776954650879  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([127, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.631117820739746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.631117820739746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6313600540161133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6519498825073242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6532888412475586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6532888412475586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6534910202026367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6720914840698242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([82, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6730937957763672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6730937957763672  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6732501983642578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6887340545654297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.689669132232666  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.689669132232666  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.689802646636963  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7039551734924316  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.705026626586914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.705026626586914  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7051677703857422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7211170196533203  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([83, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7224030494689941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7224030494689941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7225613594055176  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.74155855178833  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.742673397064209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.742673397064209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.742805004119873  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.759519100189209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7603850364685059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7603850364685059  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7604823112487793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.77351713180542  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7742762565612793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7742762565612793  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7743563652038574  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.785651683807373  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7864594459533691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7864594459533691  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7865395545959473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7983956336975098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7993073463439941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7993073463439941  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7993931770324707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.812696933746338  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([49, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.813737392425537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.813737392425537  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.813830852508545  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8289713859558105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8295707702636719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8295707702636719  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8296241760253906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8386497497558594  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([533, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8514304161071777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8514304161071777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8524470329284668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 2.0322861671447754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 533, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9935259819030762  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9943532943725586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.995180606842041  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.994311809539795  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5549, 40])
input nodes number: 23034
output nodes number: 5549
edges number: 45529
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9945120811462402  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9945125579833984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.04963397979736328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 3 input nodes size: 55329
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.045176029205322266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.045176029205322266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07155895233154297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.07160282135009766  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.038358211517333984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.039934635162353516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.039934635162353516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.039934635162353516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([55329, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.039934635162353516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1095, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.11188030242919922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.11188030242919922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.11292457580566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12175416946411133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1419, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12258529663085938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12258529663085938  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1419, 128]), torch.Size([1, 1419, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.12393856048583984  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14490938186645508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1419, 128])
m.shape torch.Size([1554, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1464557647705078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1464557647705078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1554, 128]), torch.Size([1, 1554, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.14793777465820312  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.1805419921875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1554, 128])
m.shape torch.Size([1435, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18253803253173828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18253803253173828  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1435, 128]), torch.Size([1, 1435, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.18390655517578125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.22396564483642578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1435, 128])
m.shape torch.Size([1376, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2265620231628418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2265620231628418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1376, 128]), torch.Size([1, 1376, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2278742790222168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2751154899597168  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1376, 128])
m.shape torch.Size([1249, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2780327796936035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2780327796936035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1249, 128]), torch.Size([1, 1249, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.2792239189147949  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3310990333557129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1249, 128])
m.shape torch.Size([1070, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3340749740600586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3340749740600586  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3350954055786133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.3864765167236328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([940, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38955211639404297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.38955211639404297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.39044857025146484  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4417276382446289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([878, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44504737854003906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44504737854003906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.44588470458984375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.4996919631958008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([9427, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.544224739074707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.544224739074707  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 9427, 128]), torch.Size([1, 9427, 128])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 0.5532150268554688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.1915254592895508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 9427, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.1268234252929688  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.1463193893432617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.1658153533935547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.1461668014526367  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([20443, 256])
first layer input nodes number: 55329
first layer output nodes number: 20443
edges number: 145891
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.1662297248840332  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.1857256889343262  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.1905999183654785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.1905999183654785  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([499, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2543578147888184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2543578147888184  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 499, 256]), torch.Size([1, 499, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2553095817565918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2631783485412598  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 499, 256])
m.shape torch.Size([419, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2635083198547363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2635083198547363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2643074989318848  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2769999504089355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([357, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2777185440063477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2777185440063477  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2783994674682617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2948064804077148  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([278, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2955846786499023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2955846786499023  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.2961149215698242  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3155860900878906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([293, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.316882610321045  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.316882610321045  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.317441463470459  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3424735069274902  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([279, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3445930480957031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3445930480957031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3451251983642578  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.369873046875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([275, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.371457576751709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.371457576751709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.3719820976257324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4005093574523926  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([257, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4022235870361328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4022235870361328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4027137756347656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4309329986572266  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([250, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4328508377075195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4328508377075195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4333276748657227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4638452529907227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([262, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4661250114440918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4661250114440918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.4666247367858887  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5027174949645996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([249, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5051002502441406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5051002502441406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.505575180053711  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5426197052001953  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([195, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5446314811706543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5446314811706543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5450034141540527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.57661771774292  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([176, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5786309242248535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5786309242248535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.5789666175842285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6098504066467285  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([176, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.612051010131836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.612051010131836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.612386703491211  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.645620346069336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([153, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.647658348083496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.647658348083496  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6479501724243164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6788835525512695  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([125, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6806602478027344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.6806602478027344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.680898666381836  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7078399658203125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([133, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7098941802978516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7098941802978516  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7101478576660156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7405891418457031  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([104, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.74249267578125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.74249267578125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7426910400390625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.76788330078125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([83, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7692999839782715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7692999839782715  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.769458293914795  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.7906718254089355  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([117, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.792841911315918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.792841911315918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.793065071105957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8245306015014648  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([98, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.82639741897583  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.82639741897583  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8265843391418457  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8542485237121582  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([58, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8553814888000488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8553814888000488  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.855492115020752  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8726391792297363  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8737998008728027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8737998008728027  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8739047050476074  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8908991813659668  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8924155235290527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.8924155235290527  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.892545223236084  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9144644737243652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([867, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9360456466674805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.9360456466674805  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 867, 256]), torch.Size([1, 867, 256])
----------------------------------------3
 Nvidia-smi: 5.8416748046875 GB
    Memory Allocated: 1.937699317932129  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8612060546875 GB
    Memory Allocated: 2.229161262512207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 867, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.8612060546875 GB
    Memory Allocated: 2.1712112426757812  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.8612060546875 GB
    Memory Allocated: 2.172079563140869  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 2.172947883605957  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 2.1720356941223145  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([5826, 40])
input nodes number: 20443
output nodes number: 5826
edges number: 65592
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 2.1722731590270996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 2.172273635864258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 0.042977333068847656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

pseudo mini batch 4 input nodes size: 78696
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 0.03839921951293945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 0.03839921951293945  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 0.07592439651489258  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 0.07596826553344727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 0.049541473388671875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 0.052634239196777344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 0.052634239196777344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 0.052634239196777344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([78696, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8631591796875 GB
    Memory Allocated: 0.052634239196777344  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([1079, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.18329858779907227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.18329858779907227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.1843276023864746  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.19255971908569336  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1405, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.19338512420654297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.19338512420654297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1405, 128]), torch.Size([1, 1405, 128])
----------------------------------------3
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.19472503662109375  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.21482372283935547  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1405, 128])
m.shape torch.Size([1421, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.21637964248657227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.21637964248657227  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1421, 128]), torch.Size([1, 1421, 128])
----------------------------------------3
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.21773481369018555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.2481074333190918  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1421, 128])
m.shape torch.Size([1388, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.2500772476196289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.2500772476196289  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1388, 128]), torch.Size([1, 1388, 128])
----------------------------------------3
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.2514009475708008  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.2906618118286133  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1388, 128])
m.shape torch.Size([1357, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.29323530197143555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.29323530197143555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1357, 128]), torch.Size([1, 1357, 128])
----------------------------------------3
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.29452943801879883  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.3418254852294922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1357, 128])
m.shape torch.Size([1241, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.344728946685791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.344728946685791  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1241, 128]), torch.Size([1, 1241, 128])
----------------------------------------3
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.34591245651245117  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.3974900245666504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1241, 128])
m.shape torch.Size([1245, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.40105390548706055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.40105390548706055  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1245, 128]), torch.Size([1, 1245, 128])
----------------------------------------3
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.40224123001098633  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.4626755714416504  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1245, 128])
m.shape torch.Size([1112, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.4663238525390625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.4663238525390625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1112, 128]), torch.Size([1, 1112, 128])
----------------------------------------3
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.46738433837890625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.528717041015625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1112, 128])
m.shape torch.Size([1092, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.5328731536865234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.5328731536865234  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.5339145660400391  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.6022109985351562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([21050, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.7020645141601562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.7020645141601562  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 21050, 128]), torch.Size([1, 21050, 128])
----------------------------------------3
 Nvidia-smi: 5.9901123046875 GB
    Memory Allocated: 0.7221393585205078  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.1587610244750977  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 21050, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.036604881286621  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.0674943923950195  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.098383903503418  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.0672526359558105  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

torch.Size([32390, 256])
first layer input nodes number: 78696
first layer output nodes number: 32390
edges number: 265874
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.0989723205566406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.129861831665039  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.1375842094421387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.1375842094421387  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

m.shape torch.Size([530, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2110795974731445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2110795974731445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 530, 256]), torch.Size([1, 530, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.212090492248535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.221053123474121  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 530, 256])
m.shape torch.Size([474, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.221458911895752  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.221458911895752  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.222362995147705  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2386622428894043  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([364, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2393336296081543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2393336296081543  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.240027904510498  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2576889991760254  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([306, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2585248947143555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2585248947143555  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.259108543395996  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.276273250579834  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([238, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.277313232421875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.277313232421875  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2777671813964844  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.294109344482422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([187, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2949609756469727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2949609756469727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.2953176498413086  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.310654640197754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([180, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.311687469482422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.311687469482422  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.312030792236328  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3291969299316406  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([163, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3302788734436035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3302788734436035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.330589771270752  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.348310947418213  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([183, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.349738597869873  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.349738597869873  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3500876426696777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3724265098571777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([172, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3739051818847656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3739051818847656  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3742332458496094  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3975257873535156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([140, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3988423347473145  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.3988423347473145  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.399109363555908  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4199376106262207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([130, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4213037490844727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4213037490844727  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4215517044067383  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4426279067993164  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([152, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4444031715393066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4444031715393066  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.444693088531494  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.471365451812744  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([115, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4727683067321777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4727683067321777  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.472987651824951  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4947028160095215  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([114, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.496236801147461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.496236801147461  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.4964542388916016  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.519502639770508  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([125, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.5213165283203125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.5213165283203125  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.521554946899414  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.5484962463378906  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([111, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.5501909255981445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.5501909255981445  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.5504026412963867  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.575808525085449  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([119, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.577761650085449  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.577761650085449  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.577988624572754  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.606814384460449  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([105, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.60861873626709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.60861873626709  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.608819007873535  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.635655403137207  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([110, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.6376700401306152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.6376700401306152  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.6378798484802246  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.6674628257751465  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([100, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.6693763732910156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.6693763732910156  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.669567108154297  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.697795867919922  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([79, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.699371337890625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.699371337890625  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.699522018432617  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.7228775024414062  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([74, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.724465847015381  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.724465847015381  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.724606990814209  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.7474722862243652  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([78, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.7492012977600098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.7492012977600098  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.749350070953369  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.7744927406311035  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([1505, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.8105807304382324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.8105807304382324  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

 h.shape torch.Size([1, 1505, 256]), torch.Size([1, 1505, 256])
----------------------------------------3
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 2.8137612342834473  GigaBytes
Max Memory Allocated: 3.172055244445801  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 3.3330464363098145  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1505, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 3.2648825645446777  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 3.2657551765441895  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 3.266627788543701  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 3.2657113075256348  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5854, 40])
input nodes number: 32390
output nodes number: 5854
edges number: 75694
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 3.2660012245178223  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.5428466796875 GB
    Memory Allocated: 3.2660017013549805  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05712747573852539  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 5 input nodes size: 74673
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.0495457649230957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.0495457649230957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08515262603759766  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08519554138183594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.047626495361328125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04987621307373047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04987621307373047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04987621307373047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([74673, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04987621307373047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1177, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.16407012939453125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.16407012939453125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1177, 128]), torch.Size([1, 1177, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1651926040649414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.17417240142822266  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1177, 128])
m.shape torch.Size([1496, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.17503786087036133  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.17503786087036133  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.17646455764770508  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19848203659057617  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([1494, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1999058723449707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1999058723449707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.20133066177368164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23267602920532227  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([1472, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2347712516784668  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2347712516784668  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1472, 128]), torch.Size([1, 1472, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2361750602722168  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2768855094909668  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1472, 128])
m.shape torch.Size([1303, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.27929019927978516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.27929019927978516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1303, 128]), torch.Size([1, 1303, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2805328369140625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.32550048828125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1303, 128])
m.shape torch.Size([1174, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.32823801040649414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.32823801040649414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1174, 128]), torch.Size([1, 1174, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3293576240539551  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37764835357666016  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1174, 128])
m.shape torch.Size([1111, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3807969093322754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3807969093322754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.38185644149780273  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43617725372314453  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([951, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43927526473999023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43927526473999023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 951, 128]), torch.Size([1, 951, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4401822090148926  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4921383857727051  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 951, 128])
m.shape torch.Size([965, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.49582624435424805  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.49582624435424805  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4967465400695801  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5563373565673828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([18021, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.641808032989502  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.641808032989502  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 18021, 128]), torch.Size([1, 18021, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.658994197845459  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8792119026184082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 18021, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7731680870056152  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.800981044769287  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.828794002532959  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8007636070251465  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([29164, 256])
first layer input nodes number: 74673
first layer output nodes number: 29164
edges number: 232378
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8293523788452148  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8571653366088867  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8649811744689941  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8649811744689941  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([595, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.932711124420166  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.932711124420166  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 595, 256]), torch.Size([1, 595, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9338459968566895  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9431509971618652  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 595, 256])
m.shape torch.Size([534, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9437170028686523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9437170028686523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9447355270385742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9618616104125977  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([402, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9625720977783203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9625720977783203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.963338851928711  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9814887046813965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([343, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9824929237365723  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9824929237365723  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.983147144317627  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.004581928253174  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([247, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0055251121520996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0055251121520996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0059962272644043  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.022956371307373  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([207, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0239148139953613  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0239148139953613  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0243096351623535  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0412869453430176  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([198, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.043297290802002  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.043297290802002  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.043674945831299  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0625576972961426  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([163, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.06362247467041  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.06362247467041  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0639333724975586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0816545486450195  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([150, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.082797050476074  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.082797050476074  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.083083152770996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.101393699645996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([162, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.103422164916992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.103422164916992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.103731155395508  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.125669479370117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.127037525177002  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.127037525177002  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.127312183380127  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.148735523223877  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([137, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1501784324645996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1501784324645996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.150439739227295  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1726508140563965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1741418838500977  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1741418838500977  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1743364334106445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.192234992980957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1932950019836426  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1932950019836426  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1934590339660645  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.20969820022583  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([116, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2112889289855957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2112889289855957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.211510181427002  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2349629402160645  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.236743927001953  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.236743927001953  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2368850708007812  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2528343200683594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([89, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.254218101501465  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.254218101501465  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.254387855529785  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2747583389282227  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([104, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.276473045349121  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.276473045349121  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2766714096069336  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.301863670349121  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([80, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3032379150390625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3032379150390625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3033905029296875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3238372802734375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([72, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3251452445983887  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3251452445983887  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.325282573699951  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3446459770202637  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([77, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3461318016052246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3461318016052246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.346278667449951  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3680148124694824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3697257041931152  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3697257041931152  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3698344230651855  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.386685848236084  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3881349563598633  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3881349563598633  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3882646560668945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.409276008605957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([55, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.41048002243042  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.41048002243042  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.4105849266052246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.428313732147217  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([1450, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.463102340698242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.463102340698242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1450, 256]), torch.Size([1, 1450, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.4664249420166016  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.9610748291015625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1450, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.897864818572998  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.8987159729003906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.899567127227783  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.8986730575561523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5712, 40])
input nodes number: 29164
output nodes number: 5712
edges number: 69410
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.898911952972412  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.8989124298095703  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05389547348022461  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 6 input nodes size: 73845
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.047605037689208984  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.047605037689208984  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08281707763671875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08286046981811523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.047210693359375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04938793182373047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04938793182373047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04938793182373047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([73845, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04938793182373047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1226, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15979480743408203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15979480743408203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1226, 128]), torch.Size([1, 1226, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1609640121459961  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1703176498413086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1226, 128])
m.shape torch.Size([1600, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.17203712463378906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.17203712463378906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1600, 128]), torch.Size([1, 1600, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.17356300354003906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19645118713378906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1600, 128])
m.shape torch.Size([1637, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1980299949645996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1980299949645996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1637, 128]), torch.Size([1, 1637, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19959115982055664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23473405838012695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1637, 128])
m.shape torch.Size([1443, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23670578002929688  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23670578002929688  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1443, 128]), torch.Size([1, 1443, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2380819320678711  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2782554626464844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1443, 128])
m.shape torch.Size([1444, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.28101015090942383  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.28101015090942383  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1444, 128]), torch.Size([1, 1444, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.28238725662231445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3322148323059082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1444, 128])
m.shape torch.Size([1239, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3350710868835449  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3350710868835449  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1239, 128]), torch.Size([1, 1239, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.33625268936157227  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.38831281661987305  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1239, 128])
m.shape torch.Size([1143, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3915371894836426  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3915371894836426  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3926272392272949  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4474925994873047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1143, 128])
m.shape torch.Size([1138, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.45128870010375977  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.45128870010375977  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4523739814758301  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5142350196838379  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1064, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5182585716247559  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5182585716247559  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5192732810974121  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5856776237487793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([16810, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6653265953063965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6653265953063965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 16810, 128]), torch.Size([1, 16810, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6813578605651855  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.819577693939209  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 16810, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.717656135559082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7450685501098633  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7724809646606445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7448539733886719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([28744, 256])
first layer input nodes number: 73845
first layer output nodes number: 28744
edges number: 224544
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7730331420898438  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.800445556640625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8074455261230469  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8074455261230469  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([626, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8731765747070312  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8731765747070312  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8743705749511719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8839225769042969  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([561, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.884446144104004  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.884446144104004  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8855161666870117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.901566505432129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([458, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9024019241333008  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9024019241333008  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.903275489807129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9235248565673828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([309, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9243640899658203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9243640899658203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9249534606933594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9440159797668457  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([287, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9451007843017578  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9451007843017578  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.945648193359375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9659843444824219  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([236, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9670720100402832  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9670720100402832  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.967522144317627  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9868779182434082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([204, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9885873794555664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9885873794555664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9889764785766602  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0084314346313477  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([171, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.009552001953125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.009552001953125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.009878158569336  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0284690856933594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([173, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0298027992248535  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0298027992248535  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.03013277053833  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.05125093460083  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([169, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.05271053314209  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.05271053314209  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.053032875061035  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0759191513061523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([152, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0773653984069824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0773653984069824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.07765531539917  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.100268840789795  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([142, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.101761817932129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.101761817932129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1020326614379883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.125054359436035  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([118, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1263933181762695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1263933181762695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1266183853149414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.147324562072754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([109, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.148678779602051  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.148678779602051  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1488866806030273  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.169468879699707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([96, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1707491874694824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1707491874694824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1709322929382324  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1903414726257324  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1918492317199707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1918492317199707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.192047595977783  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2144627571105957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([80, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2156710624694824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2156710624694824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2158236503601074  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2341341972351074  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([85, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2355284690856934  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2355284690856934  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2356905937194824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2562804222106934  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([85, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.257751941680908  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.257751941680908  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2579140663146973  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2796387672424316  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([78, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.281057357788086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.281057357788086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2812061309814453  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.302183151245117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([75, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3036227226257324  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3036227226257324  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3037657737731934  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.324937343597412  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([58, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.32609224319458  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.32609224319458  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.326202869415283  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3433499336242676  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3442673683166504  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3442673683166504  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.344351291656494  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3579468727111816  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([76, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3596582412719727  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3596582412719727  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.3598031997680664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.38430118560791  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([1319, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.415922164916992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.415922164916992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1319, 256]), torch.Size([1, 1319, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.418437957763672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.8699960708618164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1319, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.8108081817626953  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.8116750717163086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.812541961669922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.811631679534912  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5815, 40])
input nodes number: 28744
output nodes number: 5815
edges number: 67519
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.8119053840637207  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.811905860900879  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.053343772888183594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 7 input nodes size: 77429
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.0472264289855957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.0472264289855957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08414745330810547  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08419084548950195  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.0489354133605957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05072450637817383  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05072450637817383  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05072450637817383  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([77429, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05072450637817383  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1689, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1453871726989746  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1453871726989746  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1689, 128]), torch.Size([1, 1689, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14699792861938477  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15988397598266602  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1689, 128])
m.shape torch.Size([2150, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.16122007369995117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.16122007369995117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2150, 128]), torch.Size([1, 2150, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1632704734802246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1942734718322754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2150, 128])
m.shape torch.Size([2257, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19647693634033203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19647693634033203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2257, 128]), torch.Size([1, 2257, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1995525360107422  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24784326553344727  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2257, 128])
m.shape torch.Size([1989, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2510719299316406  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2510719299316406  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1989, 128]), torch.Size([1, 1989, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.25296878814697266  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.30854034423828125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1989, 128])
m.shape torch.Size([1812, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.311948299407959  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.311948299407959  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1812, 128]), torch.Size([1, 1812, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3136763572692871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3758864402770996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1812, 128])
m.shape torch.Size([1480, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3792567253112793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3792567253112793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1480, 128]), torch.Size([1, 1480, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.38066816329956055  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4413599967956543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1480, 128])
m.shape torch.Size([1315, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.44504356384277344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.44504356384277344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1315, 128]), torch.Size([1, 1315, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.44629764556884766  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5094342231750488  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1315, 128])
m.shape torch.Size([1211, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5134267807006836  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5134267807006836  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1211, 128]), torch.Size([1, 1211, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5145816802978516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5804109573364258  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1211, 128])
m.shape torch.Size([1054, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5843567848205566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5843567848205566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5853619575500488  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.651026725769043  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([12464, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.7099571228027344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.7099571228027344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 12464, 128]), torch.Size([1, 12464, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.7218437194824219  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5657920837402344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 12464, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4815196990966797  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5076704025268555  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5338211059570312  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5074658393859863  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([27421, 256])
first layer input nodes number: 77429
first layer output nodes number: 27421
edges number: 191675
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5343999862670898  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5605506896972656  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5670886039733887  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5670886039733887  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([836, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.614553451538086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.614553451538086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6161479949951172  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6297969818115234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([734, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.630448818206787  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.630448818206787  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 734, 256]), torch.Size([1, 734, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6318488121032715  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6563739776611328  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 734, 256])
m.shape torch.Size([611, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6576619148254395  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6576619148254395  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.658827304840088  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6844658851623535  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 611, 256])
m.shape torch.Size([458, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6858711242675781  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6858711242675781  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6867446899414062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7132391929626465  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([412, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.71478271484375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.71478271484375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7155685424804688  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7443618774414062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([296, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.745676040649414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.745676040649414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7462406158447266  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7720699310302734  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([234, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.773362159729004  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.773362159729004  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.773808479309082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7961244583129883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([232, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.797685146331787  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.797685146331787  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7981276512145996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.823350429534912  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([191, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8247814178466797  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8247814178466797  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8251457214355469  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8484611511230469  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8498268127441406  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8498268127441406  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8501338958740234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8719367980957031  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8732109069824219  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8732109069824219  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8734683990478516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8935527801513672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([133, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8949580192565918  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8949580192565918  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8952116966247559  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9167742729187012  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([114, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9189963340759277  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9189963340759277  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9192137718200684  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9392180442810059  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([109, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9405760765075684  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9405760765075684  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.940783977508545  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9613661766052246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([88, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9625310897827148  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9625310897827148  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9626989364624023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9804906845092773  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.981560230255127  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.981560230255127  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.981703281402588  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9978680610656738  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9987115859985352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9987115859985352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9988183975219727  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0116357803344727  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([72, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0128283500671387  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0128283500671387  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.012965679168701  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0304064750671387  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0313992500305176  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0313992500305176  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0315098762512207  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0463337898254395  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.047105312347412  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.047105312347412  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.047187328338623  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0587515830993652  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.059598922729492  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.059598922729492  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.059682846069336  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.072103500366211  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0729074478149414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0729074478149414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.072983741760254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.0848093032836914  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.085721969604492  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.085721969604492  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.085803985595703  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.099090576171875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.099903106689453  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.099903106689453  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.099973678588867  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1119003295898438  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([607, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.127267837524414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.127267837524414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 607, 256]), torch.Size([1, 607, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.1284255981445312  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.333062171936035  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 607, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2918410301208496  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.292708396911621  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2935757637023926  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2926650047302246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5819, 40])
input nodes number: 27421
output nodes number: 5819
edges number: 48303
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2929134368896484  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.2929139137268066  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05413103103637695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 8 input nodes size: 74260
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.048935890197753906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.048935890197753906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08434581756591797  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08438730239868164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04742288589477539  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04896402359008789  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04896402359008789  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04896402359008789  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([74260, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04896402359008789  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1821, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1321096420288086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1321096420288086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1821, 128]), torch.Size([1, 1821, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13384628295898438  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.147918701171875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1821, 128])
m.shape torch.Size([2238, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1491847038269043  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1491847038269043  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2238, 128]), torch.Size([1, 2238, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15131902694702148  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1841597557067871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2238, 128])
m.shape torch.Size([2243, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18630123138427734  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18630123138427734  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2243, 128]), torch.Size([1, 2243, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1887531280517578  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2363719940185547  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2243, 128])
m.shape torch.Size([2011, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23958063125610352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23958063125610352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2011, 128]), torch.Size([1, 2011, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24149847030639648  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2978215217590332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2011, 128])
m.shape torch.Size([1873, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.301328182220459  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.301328182220459  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1873, 128]), torch.Size([1, 1873, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3031144142150879  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.368194580078125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1873, 128])
m.shape torch.Size([1508, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3716158866882324  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3716158866882324  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1508, 128]), torch.Size([1, 1508, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37305402755737305  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43503332138061523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1508, 128])
m.shape torch.Size([1257, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4385099411010742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4385099411010742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1257, 128]), torch.Size([1, 1257, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4397087097167969  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5003490447998047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1257, 128])
m.shape torch.Size([1143, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5041098594665527  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5041098594665527  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5051999092102051  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5677299499511719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1143, 128])
m.shape torch.Size([983, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5714035034179688  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5714035034179688  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5723409652709961  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6335597038269043  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([10162, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6815471649169922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6815471649169922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 10162, 128]), torch.Size([1, 10162, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6912384033203125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3821430206298828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 10162, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3087773323059082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3328471183776855  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.356916904449463  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3326587677001953  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([25239, 256])
first layer input nodes number: 74260
first layer output nodes number: 25239
edges number: 167893
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3574724197387695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3815422058105469  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3875598907470703  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3875598907470703  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([879, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4259872436523438  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4259872436523438  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 879, 256]), torch.Size([1, 879, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.427663803100586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4410762786865234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 879, 256])
m.shape torch.Size([770, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4419054985046387  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4419054985046387  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 770, 256]), torch.Size([1, 770, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4433741569519043  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4659037590026855  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 770, 256])
m.shape torch.Size([626, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4671788215637207  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4671788215637207  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4683728218078613  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4946799278259277  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([519, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4962005615234375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4962005615234375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4971904754638672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5273628234863281  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([421, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5289855003356934  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5289855003356934  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5297884941101074  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5623712539672852  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([322, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5638270378112793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5638270378112793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.564441204071045  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5908503532409668  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([244, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5921850204467773  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5921850204467773  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5926504135131836  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.615920066833496  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([244, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6175637245178223  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6175637245178223  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6180291175842285  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6445565223693848  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([166, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6457600593566895  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6457600593566895  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6460766792297363  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6663403511047363  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6680231094360352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6680231094360352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6683282852172852  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6899957656860352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6913762092590332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6913762092590332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.691652774810791  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7132248878479004  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([101, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7142601013183594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7142601013183594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7144527435302734  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7308273315429688  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.731919288635254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.731919288635254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.732100486755371  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7487707138061523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.749875545501709  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.749875545501709  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7500300407409668  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7653250694274902  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7661418914794922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7661418914794922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7662601470947266  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7787952423095703  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7796745300292969  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7796745300292969  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7797908782958984  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.792938232421875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7937464714050293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7937464714050293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7938475608825684  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8059782981872559  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8067755699157715  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8067755699157715  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8068690299987793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8187384605407715  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.81965970993042  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.81965970993042  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.819760799407959  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8333067893981934  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.833986759185791  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.833986759185791  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.834059238433838  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8442788124084473  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8449492454528809  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8449492454528809  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8450160026550293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.854896068572998  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.855391502380371  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.855391502380371  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8554391860961914  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8628301620483398  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8632926940917969  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8632926940917969  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8633346557617188  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8701324462890625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8705501556396484  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8705501556396484  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8705863952636719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8767108917236328  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([353, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8851747512817383  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8851747512817383  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.885848045349121  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 2.005122184753418  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 353, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9728832244873047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9737095832824707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9745359420776367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.973668098449707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5543, 40])
input nodes number: 25239
output nodes number: 5543
edges number: 38868
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9738569259643555  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9738574028015137  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.051935672760009766  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 9 input nodes size: 73479
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04738187789916992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04738187789916992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08241939544677734  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08246088027954102  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04700946807861328  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04843425750732422  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04843425750732422  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04843425750732422  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([73479, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04843425750732422  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1946, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1267852783203125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1267852783203125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1946, 128]), torch.Size([1, 1946, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.12864112854003906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14380121231079102  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1946, 128])
m.shape torch.Size([2265, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1450333595275879  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1450333595275879  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2265, 128]), torch.Size([1, 2265, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14719343185424805  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1801319122314453  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2265, 128])
m.shape torch.Size([2294, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18182897567749023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18182897567749023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2294, 128]), torch.Size([1, 2294, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1845073699951172  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23450851440429688  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2294, 128])
m.shape torch.Size([2074, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23779010772705078  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23779010772705078  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2074, 128]), torch.Size([1, 2074, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2398967742919922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2995181083679199  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2074, 128])
m.shape torch.Size([1800, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3032259941101074  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3032259941101074  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1800, 128]), torch.Size([1, 1800, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.30494260787963867  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.36674070358276367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1800, 128])
m.shape torch.Size([1477, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37010812759399414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37010812759399414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1477, 128]), torch.Size([1, 1477, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37151670455932617  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4320855140686035  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1477, 128])
m.shape torch.Size([1286, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43567371368408203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43567371368408203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1286, 128]), torch.Size([1, 1286, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43690013885498047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4992694854736328  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1286, 128])
m.shape torch.Size([1070, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5027379989624023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5027379989624023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.503758430480957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.562891960144043  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([898, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5662355422973633  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5662355422973633  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 898, 128]), torch.Size([1, 898, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5670919418334961  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6225919723510742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 898, 128])
m.shape torch.Size([9281, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6664190292358398  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6664190292358398  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 9281, 128]), torch.Size([1, 9281, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6752700805664062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.303694725036621  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 9281, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.235109806060791  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.258547306060791  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.2818083763122559  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.2581887245178223  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([24391, 256])
first layer input nodes number: 73479
first layer output nodes number: 24391
edges number: 157970
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.282358169555664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.305619239807129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3114347457885742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3114347457885742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1001, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3443961143493652  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3443961143493652  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1001, 256]), torch.Size([1, 1001, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3463053703308105  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3624062538146973  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1001, 256])
m.shape torch.Size([838, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.363144874572754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.363144874572754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 838, 256]), torch.Size([1, 838, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3647432327270508  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3922319412231445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 838, 256])
m.shape torch.Size([710, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3935494422912598  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3935494422912598  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 710, 256]), torch.Size([1, 710, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3949036598205566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.424696445465088  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 710, 256])
m.shape torch.Size([529, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.426438808441162  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.426438808441162  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.42744779586792  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4572606086730957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([459, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4589619636535645  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4589619636535645  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4598374366760254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4924626350402832  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([333, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.493945598602295  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.493945598602295  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4945807456970215  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.525637149810791  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([272, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5271496772766113  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5271496772766113  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5276684761047363  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5545282363891602  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([219, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.555953025817871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.555953025817871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.556370735168457  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5801801681518555  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([169, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5814332962036133  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5814332962036133  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5817556381225586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6023855209350586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([134, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6035122871398926  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6035122871398926  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6037678718566895  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6219143867492676  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([103, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.622875690460205  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.622875690460205  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6230721473693848  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6383957862854004  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([96, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6394047737121582  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6394047737121582  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6395878791809082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6551518440246582  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([76, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6560101509094238  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6560101509094238  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6561551094055176  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6694912910461426  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6704416275024414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6704416275024414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6705865859985352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6849374771118164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([64, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6857876777648926  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6857876777648926  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6859097480773926  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6988492012023926  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6996493339538574  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6996493339538574  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.699756145477295  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7118258476257324  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7123937606811523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7123937606811523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7124662399291992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7211637496948242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7216119766235352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7216119766235352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.721665382385254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7284479141235352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7288413047790527  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7288413047790527  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7288851737976074  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7347636222839355  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7352418899536133  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7352418899536133  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7352914810180664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.742283821105957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7426223754882812  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7426223754882812  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7426567077636719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7477378845214844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7480802536010742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7480802536010742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.748112678527832  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.753138542175293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7535648345947266  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7535648345947266  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7536029815673828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7597827911376953  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7601327896118164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7601327896118164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7601633071899414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7653207778930664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([217, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.770519733428955  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.770519733428955  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7709336280822754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8437790870666504  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 217, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.817671775817871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8184971809387207  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8193225860595703  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.818455696105957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5538, 40])
input nodes number: 24391
output nodes number: 5538
edges number: 33054
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.818678379058838  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.818678855895996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05126190185546875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 10 input nodes size: 74100
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.047008514404296875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.047008514404296875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08234214782714844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08238506317138672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.047306060791015625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04877281188964844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04877281188964844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04877281188964844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([74100, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04877281188964844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1885, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1281437873840332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1281437873840332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1885, 128]), torch.Size([1, 1885, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.12994146347045898  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14458179473876953  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1885, 128])
m.shape torch.Size([2345, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1459193229675293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1459193229675293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2345, 128]), torch.Size([1, 2345, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14815568923950195  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18254899978637695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2345, 128])
m.shape torch.Size([2245, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1847853660583496  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1847853660583496  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2245, 128]), torch.Size([1, 2245, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18694448471069336  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23528385162353516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2245, 128])
m.shape torch.Size([2019, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23780202865600586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23780202865600586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2019, 128]), torch.Size([1, 2019, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23972749710083008  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.29611921310424805  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2019, 128])
m.shape torch.Size([1736, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.29929542541503906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.29929542541503906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1736, 128]), torch.Size([1, 1736, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3009510040283203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3605518341064453  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1736, 128])
m.shape torch.Size([1452, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3638782501220703  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3638782501220703  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1452, 128]), torch.Size([1, 1452, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3652629852294922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.42674779891967773  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1452, 128])
m.shape torch.Size([1243, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4302043914794922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4302043914794922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1243, 128]), torch.Size([1, 1243, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43138980865478516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4917898178100586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1243, 128])
m.shape torch.Size([1036, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4951491355895996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4951491355895996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4961371421813965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5526213645935059  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([944, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5561785697937012  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5561785697937012  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5570788383483887  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6153783798217773  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([9587, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6606426239013672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6606426239013672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 9587, 128]), torch.Size([1, 9587, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.670280933380127  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.319920539855957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 9587, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.249711036682129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.273148536682129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.2965059280395508  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.272885799407959  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([24492, 256])
first layer input nodes number: 74100
first layer output nodes number: 24492
edges number: 160133
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.2970600128173828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3204174041748047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3262567520141602  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3262567520141602  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([973, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.36256742477417  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.36256742477417  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 973, 256]), torch.Size([1, 973, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3644232749938965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3803119659423828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 973, 256])
m.shape torch.Size([877, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3811445236206055  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3811445236206055  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 877, 256]), torch.Size([1, 877, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.382817268371582  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4079084396362305  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 877, 256])
m.shape torch.Size([665, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4089899063110352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4089899063110352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 665, 256]), torch.Size([1, 665, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4102582931518555  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4440317153930664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 665, 256])
m.shape torch.Size([555, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4455313682556152  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4455313682556152  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 555, 256]), torch.Size([1, 555, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4465899467468262  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4772887229919434  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 555, 256])
m.shape torch.Size([449, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4789175987243652  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4789175987243652  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.479773998260498  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5111842155456543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([356, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5128092765808105  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5128092765808105  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5134882926940918  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.543271541595459  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([293, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5449037551879883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5449037551879883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5454626083374023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5759282112121582  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([216, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5773096084594727  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5773096084594727  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5777215957641602  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6012048721313477  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([196, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6026945114135742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6026945114135742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6030683517456055  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6269941329956055  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6283354759216309  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6283354759216309  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.628638744354248  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6501708030700684  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([128, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6513724327087402  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6513724327087402  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6516165733337402  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6706595420837402  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([99, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6718792915344238  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6718792915344238  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6720681190490723  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6881184577941895  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([89, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6891365051269531  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6891365051269531  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6893062591552734  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7049236297607422  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([75, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7059173583984375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7059173583984375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7060604095458984  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7202224731445312  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([64, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7210736274719238  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7210736274719238  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7211956977844238  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7341351509094238  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7349200248718262  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7349200248718262  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7350249290466309  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7468791007995605  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7476277351379395  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7476277351379395  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7477211952209473  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7589364051818848  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7597203254699707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7597203254699707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7598118782043457  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7714390754699707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.771996021270752  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.771996021270752  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7720589637756348  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7804932594299316  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7810964584350586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7810964584350586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7811594009399414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.790034294128418  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7906084060668945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7906084060668945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.790665626525879  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7991342544555664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7994866371154785  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7994866371154785  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7995209693908691  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.804842472076416  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.80515718460083  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.80515718460083  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8051857948303223  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8098206520080566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8101987838745117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8101987838745117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8102312088012695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8157110214233398  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([268, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8225483894348145  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8225483894348145  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8230595588684082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9136052131652832  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 268, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8838481903076172  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8847064971923828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8855648040771484  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8846635818481445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5760, 40])
input nodes number: 24492
output nodes number: 5760
edges number: 36562
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8849220275878906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8849225044250488  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05171060562133789  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 11 input nodes size: 77073
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04733896255493164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04733896255493164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.0840902328491211  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08413171768188477  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04875516891479492  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05022287368774414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05022287368774414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05022287368774414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([77073, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05022287368774414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1933, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13231563568115234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13231563568115234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1933, 128]), torch.Size([1, 1933, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13415908813476562  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14890670776367188  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1933, 128])
m.shape torch.Size([2487, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15035676956176758  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15035676956176758  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2487, 128]), torch.Size([1, 2487, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15272855758666992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1890707015991211  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2487, 128])
m.shape torch.Size([2300, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19061803817749023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19061803817749023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2300, 128]), torch.Size([1, 2300, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19348621368408203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24431371688842773  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2300, 128])
m.shape torch.Size([2024, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2476038932800293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2476038932800293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2024, 128]), torch.Size([1, 2024, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24953413009643555  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3059687614440918  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2024, 128])
m.shape torch.Size([1856, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.30942869186401367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.30942869186401367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1856, 128]), torch.Size([1, 1856, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.31119871139526367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37522459030151367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1856, 128])
m.shape torch.Size([1450, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37848806381225586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37848806381225586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1450, 128]), torch.Size([1, 1450, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3798708915710449  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43967580795288086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1450, 128])
m.shape torch.Size([1186, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.44294309616088867  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.44294309616088867  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1186, 128]), torch.Size([1, 1186, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4440741539001465  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5011162757873535  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1186, 128])
m.shape torch.Size([1116, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5048079490661621  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5048079490661621  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5058722496032715  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5673918724060059  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([936, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5708765983581543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5708765983581543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5717692375183105  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6300902366638184  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([10011, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6773800849914551  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6773800849914551  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 10011, 128]), torch.Size([1, 10011, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.686927318572998  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.373079776763916  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 10011, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3000187873840332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.324145793914795  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3482728004455566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3239569664001465  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([25299, 256])
first layer input nodes number: 77073
first layer output nodes number: 25299
edges number: 165647
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3488492965698242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.372976303100586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3790082931518555  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3790082931518555  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1049, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4101877212524414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4101877212524414  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1049, 256]), torch.Size([1, 1049, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4128079414367676  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4293208122253418  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1049, 256])
m.shape torch.Size([922, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4303178787231445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4303178787231445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 922, 256]), torch.Size([1, 922, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4320764541625977  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4584550857543945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 922, 256])
m.shape torch.Size([739, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4599790573120117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4599790573120117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 739, 256]), torch.Size([1, 739, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4613885879516602  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4935312271118164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 739, 256])
m.shape torch.Size([525, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4952287673950195  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4952287673950195  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 525, 256]), torch.Size([1, 525, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.496230125427246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5299158096313477  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 525, 256])
m.shape torch.Size([458, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5318222045898438  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5318222045898438  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5326957702636719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5663647651672363  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([341, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.567894458770752  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.567894458770752  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.568544864654541  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5975756645202637  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([257, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5989799499511719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5989799499511719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5994701385498047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6250996589660645  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([208, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6264538764953613  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6264538764953613  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6268506050109863  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6494641304016113  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([178, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.650805950164795  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.650805950164795  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6511454582214355  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6728739738464355  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([123, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.673886775970459  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.673886775970459  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.674121379852295  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6907782554626465  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([82, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6915283203125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6915283203125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6916847229003906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7038841247558594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7046942710876465  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7046942710876465  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.704841136932373  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7173247337341309  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7182388305664062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7182388305664062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7183895111083984  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7322521209716797  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.732957363128662  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.732957363128662  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7330679893493652  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7440199851989746  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7447724342346191  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7447724342346191  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7448792457580566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7562012672424316  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7565016746520996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7565016746520996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7565455436706543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.761502742767334  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7621021270751953  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7621021270751953  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7621746063232422  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7708721160888672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.771355152130127  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.771355152130127  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7714123725891113  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.778679370880127  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7790346145629883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7790346145629883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7790746688842773  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7844419479370117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7850756645202637  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7850756645202637  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7851405143737793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7942843437194824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7945752143859863  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7945752143859863  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7946057319641113  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7991223335266113  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.79929780960083  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.79929780960083  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7993149757385254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8019757270812988  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8020777702331543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8020777702331543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8020873069763184  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8036322593688965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.803812026977539  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.803812026977539  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8038272857666016  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.806406021118164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([213, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8115167617797852  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8115167617797852  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8119230270385742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8834257125854492  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 213, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8586864471435547  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.859513759613037  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8603410720825195  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8594722747802734  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5549, 40])
input nodes number: 25299
output nodes number: 5549
edges number: 31145
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8596715927124023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8596720695495605  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05309581756591797  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 12 input nodes size: 77109
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04872417449951172  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04872417449951172  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08549261093139648  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08553409576416016  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04874134063720703  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05021095275878906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05021095275878906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05021095275878906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([77109, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05021095275878906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1922, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13340044021606445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13340044021606445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1922, 128]), torch.Size([1, 1922, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13523340225219727  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14989709854125977  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1922, 128])
m.shape torch.Size([2431, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15129899978637695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15129899978637695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2431, 128]), torch.Size([1, 2431, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15361738204956055  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1889486312866211  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2431, 128])
m.shape torch.Size([2296, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19107389450073242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19107389450073242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2296, 128]), torch.Size([1, 2296, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1933584213256836  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24330472946166992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2296, 128])
m.shape torch.Size([2093, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24547576904296875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24547576904296875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2093, 128]), torch.Size([1, 2093, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24834537506103516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.30710792541503906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2093, 128])
m.shape torch.Size([1828, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3104681968688965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3104681968688965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1828, 128]), torch.Size([1, 1828, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3122115135192871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37576818466186523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1828, 128])
m.shape torch.Size([1454, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.379056453704834  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.379056453704834  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1454, 128]), torch.Size([1, 1454, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.38044309616088867  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.44109678268432617  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1454, 128])
m.shape torch.Size([1238, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4445357322692871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4445357322692871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1238, 128]), torch.Size([1, 1238, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.44571638107299805  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5053896903991699  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1238, 128])
m.shape torch.Size([1078, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5089116096496582  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5089116096496582  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5099396705627441  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5695691108703613  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([890, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5728745460510254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5728745460510254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.573723316192627  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6300997734069824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([10155, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.678098201751709  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.678098201751709  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 10155, 128]), torch.Size([1, 10155, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6877827644348145  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3783049583435059  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 10155, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3050103187561035  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3292193412780762  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3534283638000488  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3290300369262695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([25385, 256])
first layer input nodes number: 77109
first layer output nodes number: 25385
edges number: 166758
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3540048599243164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.378213882446289  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3851714134216309  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3851714134216309  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1031, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4157090187072754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4157090187072754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1031, 256]), torch.Size([1, 1031, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.417829990386963  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4358696937561035  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1031, 256])
m.shape torch.Size([934, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4370160102844238  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4370160102844238  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 934, 256]), torch.Size([1, 934, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4387974739074707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4655194282531738  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 934, 256])
m.shape torch.Size([754, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4670042991638184  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4670042991638184  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 754, 256]), torch.Size([1, 754, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.468442440032959  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5008325576782227  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 754, 256])
m.shape torch.Size([558, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5026850700378418  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5026850700378418  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5037493705749512  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5353312492370605  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([467, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5371437072753906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5371437072753906  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.538034439086914  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5746135711669922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([337, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.576298713684082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.576298713684082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5769414901733398  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6058201789855957  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([244, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6071405410766602  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6071405410766602  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6076059341430664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.630875587463379  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([222, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.632349967956543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.632349967956543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6327733993530273  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6569089889526367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([170, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.658167839050293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.658167839050293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.658492088317871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.679244041442871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([122, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6802549362182617  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6802549362182617  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6804876327514648  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6970090866088867  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([107, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6980242729187012  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6980242729187012  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.698228359222412  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7141470909118652  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([88, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7150602340698242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7150602340698242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7152280807495117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7294950485229492  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7301483154296875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7301483154296875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7302608489990234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7406139373779297  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7412843704223633  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7412843704223633  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7413873672485352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7515840530395508  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7520952224731445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7520952224731445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7521696090698242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.760054588317871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7605557441711426  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7605557441711426  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.760622501373291  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7681660652160645  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7685251235961914  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7685251235961914  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.768570899963379  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.774064064025879  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7742834091186523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7742834091186523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7743101119995117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7777013778686523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7780170440673828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7780170440673828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7780513763427734  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7826519012451172  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7828655242919922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7828655242919922  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.782888412475586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7861156463623047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7864274978637695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7864274978637695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7864580154418945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7909746170043945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7911286354064941  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7911286354064941  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7911438941955566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7935090065002441  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7936782836914062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7936782836914062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7936935424804688  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7961654663085938  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7964577674865723  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7964577674865723  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7964825630187988  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.800673007965088  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([213, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.805778980255127  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.805778980255127  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.806185245513916  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.877687931060791  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 213, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8534536361694336  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8542804718017578  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.855107307434082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8542389869689941  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5547, 40])
input nodes number: 25385
output nodes number: 5547
edges number: 30460
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8544692993164062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8544697761535645  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05311250686645508  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 13 input nodes size: 75682
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04874086380004883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04874086380004883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08482885360717773  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08487224578857422  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04806232452392578  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04956626892089844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04956626892089844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04956626892089844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([75682, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04956626892089844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1920, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13274431228637695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13274431228637695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1920, 128]), torch.Size([1, 1920, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13457536697387695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14922380447387695  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1920, 128])
m.shape torch.Size([2308, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15128278732299805  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15128278732299805  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2308, 128]), torch.Size([1, 2308, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15348386764526367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18695402145385742  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2308, 128])
m.shape torch.Size([2248, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18915510177612305  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18915510177612305  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2248, 128]), torch.Size([1, 2248, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19214963912963867  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23978757858276367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2248, 128])
m.shape torch.Size([2024, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2423396110534668  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2423396110534668  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2024, 128]), torch.Size([1, 2024, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24426984786987305  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3007044792175293  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2024, 128])
m.shape torch.Size([1823, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.30408573150634766  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.30408573150634766  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1823, 128]), torch.Size([1, 1823, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.30582427978515625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.36892175674438477  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1823, 128])
m.shape torch.Size([1466, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37224674224853516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37224674224853516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1466, 128]), torch.Size([1, 1466, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3736448287963867  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43419361114501953  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1466, 128])
m.shape torch.Size([1216, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43755340576171875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43755340576171875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1216, 128]), torch.Size([1, 1216, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.43871307373046875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4996452331542969  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1216, 128])
m.shape torch.Size([1093, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.50323486328125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.50323486328125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.504277229309082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5653762817382812  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([953, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5689449310302734  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5689449310302734  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5698537826538086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6280202865600586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([10113, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.675788402557373  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.675788402557373  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 10113, 128]), torch.Size([1, 10113, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6862311363220215  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.375593662261963  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 10113, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3022165298461914  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3262147903442383  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3502130508422852  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3260269165039062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([25164, 256])
first layer input nodes number: 75682
first layer output nodes number: 25164
edges number: 166250
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3507790565490723  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3747773170471191  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3807768821716309  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3807768821716309  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1062, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4161925315856934  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4161925315856934  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1062, 256]), torch.Size([1, 1062, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4186015129089355  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4357719421386719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1062, 256])
m.shape torch.Size([870, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4366264343261719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4366264343261719  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 870, 256]), torch.Size([1, 870, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4382858276367188  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4631767272949219  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 870, 256])
m.shape torch.Size([722, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4645586013793945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4645586013793945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 722, 256]), torch.Size([1, 722, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4659357070922852  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4968700408935547  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 722, 256])
m.shape torch.Size([520, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4983925819396973  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4983925819396973  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4993844032287598  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5306878089904785  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([472, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5327682495117188  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5327682495117188  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5336685180664062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.567239761352539  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([344, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5687737464904785  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5687737464904785  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.569429874420166  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5981392860412598  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([275, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5996618270874023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5996618270874023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6001863479614258  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6272735595703125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([227, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6287569999694824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6287569999694824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6291899681091309  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6538691520690918  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([183, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.655235767364502  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.655235767364502  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6555848121643066  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6779236793518066  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6792869567871094  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6792869567871094  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6795921325683594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7012596130371094  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.702502727508545  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.702502727508545  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7027544975280762  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7223925590515137  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7235126495361328  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7235126495361328  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7237186431884766  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7412281036376953  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7422246932983398  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7422246932983398  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7423925399780273  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7578344345092773  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7587733268737793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7587733268737793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.758918285369873  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7732691764831543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.774062156677246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.774062156677246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7741765975952148  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7863073348999023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7869882583618164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7869882583618164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7870798110961914  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7974252700805664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7980332374572754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7980332374572754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.798109531402588  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.807264804840088  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8078670501708984  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8078670501708984  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8079376220703125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8169002532958984  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8173584938049316  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8173584938049316  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8174099922180176  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8243107795715332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.824765682220459  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.824765682220459  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8248133659362793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8315367698669434  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8319368362426758  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8319368362426758  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8319768905639648  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.837904930114746  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8382658958435059  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8382658958435059  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8383002281188965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8436217308044434  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.844024658203125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.844024658203125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8440608978271484  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8499317169189453  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.850259780883789  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.850259780883789  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8502883911132812  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.855123519897461  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([256, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8612604141235352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8612604141235352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8617486953735352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9476861953735352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 256, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9186468124389648  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9195122718811035  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9203777313232422  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.919468879699707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5805, 40])
input nodes number: 25164
output nodes number: 5805
edges number: 35477
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.91973876953125  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.9197392463684082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.0525670051574707  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 14 input nodes size: 75052
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.048100948333740234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.048100948333740234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08388853073120117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08393001556396484  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04779863357543945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04921293258666992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04921293258666992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04921293258666992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([75052, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04921293258666992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1944, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.12845182418823242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.12845182418823242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1944, 128]), torch.Size([1, 1944, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.13030576705932617  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14530420303344727  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1944, 128])
m.shape torch.Size([2325, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14659452438354492  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14659452438354492  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2325, 128]), torch.Size([1, 2325, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14881181716918945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18262386322021484  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2325, 128])
m.shape torch.Size([2229, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18484115600585938  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18484115600585938  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2229, 128]), torch.Size([1, 2229, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1869668960571289  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.23539972305297852  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2229, 128])
m.shape torch.Size([1978, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2385883331298828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2385883331298828  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1978, 128]), torch.Size([1, 1978, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24047470092773438  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.29651451110839844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1978, 128])
m.shape torch.Size([1718, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2996673583984375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2996673583984375  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1718, 128]), torch.Size([1, 1718, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.30130577087402344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3602886199951172  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1718, 128])
m.shape torch.Size([1451, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3636207580566406  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3636207580566406  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1451, 128]), torch.Size([1, 1451, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3650045394897461  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.42542457580566406  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1451, 128])
m.shape torch.Size([1216, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.42879152297973633  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.42879152297973633  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1216, 128]), torch.Size([1, 1216, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.42995119094848633  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.48999691009521484  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1216, 128])
m.shape torch.Size([1092, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.49358272552490234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.49358272552490234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.49462413787841797  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5556325912475586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([857, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5587897300720215  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5587897300720215  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5596070289611816  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6121597290039062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([9636, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6576991081237793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6576991081237793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 9636, 128]), torch.Size([1, 9636, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6671271324157715  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3198275566101074  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 9636, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.249985694885254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.273423194885254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.296736717224121  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.2731170654296875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([24446, 256])
first layer input nodes number: 75052
first layer output nodes number: 24446
edges number: 159810
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.2972979545593262  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3206114768981934  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3264398574829102  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3264398574829102  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1082, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.356438159942627  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.356438159942627  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1082, 256]), torch.Size([1, 1082, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3585586547851562  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3764967918395996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1082, 256])
m.shape torch.Size([929, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3772187232971191  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3772187232971191  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 929, 256]), torch.Size([1, 929, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.378990650177002  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4060249328613281  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 929, 256])
m.shape torch.Size([710, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4079570770263672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4079570770263672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 710, 256]), torch.Size([1, 710, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.409311294555664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4423713684082031  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 710, 256])
m.shape torch.Size([584, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.444817066192627  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.444817066192627  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4459309577941895  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4834980964660645  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 584, 256])
m.shape torch.Size([439, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.485051155090332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.485051155090332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4858884811401367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5168380737304688  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([333, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5183401107788086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5183401107788086  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5189752578735352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5466852188110352  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([268, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.548171043395996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.548171043395996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5486822128295898  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.576704978942871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([214, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5780949592590332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5780949592590332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.578503131866455  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.601768970489502  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.602940559387207  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.602940559387207  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6032438278198242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6226530075073242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([126, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6237125396728516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6237125396728516  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.623952865600586  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6410160064697266  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([98, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6419320106506348  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6419320106506348  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6421189308166504  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6566987037658691  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([93, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6576781272888184  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6576781272888184  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.65785551071167  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6729331016540527  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6736693382263184  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6736693382263184  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.673795223236084  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6853766441345215  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6859192848205566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6859192848205566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6860051155090332  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.694502353668213  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.69500732421875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.69500732421875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6950798034667969  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7027626037597656  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.703279972076416  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.703279972076416  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7033486366271973  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7111077308654785  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7117271423339844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7117271423339844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7118034362792969  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7209587097167969  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7213187217712402  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7213187217712402  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.721362590789795  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7269339561462402  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7273321151733398  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7273321151733398  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7273759841918945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7332544326782227  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.733597755432129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.733597755432129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7336339950561523  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.738743782043457  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7391095161437988  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7391095161437988  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7391457557678223  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.744509220123291  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7446393966674805  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7446393966674805  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7446527481079102  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7467222213745117  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.747025489807129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.747025489807129  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7470521926879883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.751378059387207  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.751410961151123  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.751410961151123  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7514147758483887  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7520594596862793  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([174, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7562384605407715  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7562384605407715  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7565703392028809  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8149809837341309  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 174, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.791348934173584  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7921748161315918  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7930006980895996  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7921333312988281  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5541, 40])
input nodes number: 24446
output nodes number: 5541
edges number: 29890
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7923173904418945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7923178672790527  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05197906494140625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

pseudo mini batch 15 input nodes size: 75801
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.047759056091308594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.047759056091308594  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08390378952026367  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.08394575119018555  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.04811668395996094  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.049582481384277344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.049582481384277344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.049582481384277344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([75801, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.049582481384277344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1981, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1309061050415039  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1309061050415039  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1981, 128]), torch.Size([1, 1981, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.1327953338623047  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14790916442871094  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1981, 128])
m.shape torch.Size([2369, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14988231658935547  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.14988231658935547  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2369, 128]), torch.Size([1, 2369, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.15288066864013672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.18893766403198242  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2369, 128])
m.shape torch.Size([2351, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19119691848754883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19119691848754883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2351, 128]), torch.Size([1, 2351, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.19343900680541992  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.2437119483947754  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2351, 128])
m.shape torch.Size([2091, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24707508087158203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24707508087158203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.24979066848754883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.30938148498535156  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([1777, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.31203413009643555  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.31203413009643555  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1777, 128]), torch.Size([1, 1777, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.31372880935668945  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.37547731399536133  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1777, 128])
m.shape torch.Size([1568, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3791160583496094  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3791160583496094  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1568, 128]), torch.Size([1, 1568, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.3806114196777344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4449119567871094  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1568, 128])
m.shape torch.Size([1296, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4484901428222656  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4484901428222656  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1296, 128]), torch.Size([1, 1296, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.4497261047363281  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5119609832763672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1296, 128])
m.shape torch.Size([1103, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5155506134033203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5155506134033203  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5166025161743164  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5780029296875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([908, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5813736915588379  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5813736915588379  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.5822396278381348  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.638420581817627  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([9752, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6844887733459473  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.6844887733459473  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 9752, 128]), torch.Size([1, 9752, 128])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.693789005279541  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3708596229553223  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 9752, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.2992095947265625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3232383728027344  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3472671508789062  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3230504989624023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([25196, 256])
first layer input nodes number: 75801
first layer output nodes number: 25196
edges number: 164017
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3478341102600098  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3718628883361816  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3778700828552246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.3778700828552246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

m.shape torch.Size([1039, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4103798866271973  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4103798866271973  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 1039, 256]), torch.Size([1, 1039, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.412790298461914  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.431142807006836  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 1039, 256])
m.shape torch.Size([929, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4313421249389648  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4313421249389648  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 929, 256]), torch.Size([1, 929, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4331140518188477  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4596929550170898  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 929, 256])
m.shape torch.Size([687, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.460909366607666  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.460909366607666  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 687, 256]), torch.Size([1, 687, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4622197151184082  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4934163093566895  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 687, 256])
m.shape torch.Size([563, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4951605796813965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.4951605796813965  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.49623441696167  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.532529354095459  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([431, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5340638160705566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5340638160705566  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5348858833312988  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.565122127532959  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([370, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5668449401855469  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5668449401855469  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5675506591796875  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.5990352630615234  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([276, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6005396842956543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6005396842956543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6010661125183105  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6285319328308105  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([218, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6299452781677246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6299452781677246  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6303610801696777  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6540617942810059  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([154, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6551861763000488  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6551861763000488  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.655479907989502  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.674278736114502  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([131, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.675795555114746  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.675795555114746  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6760454177856445  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6937856674194336  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([110, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6948237419128418  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6948237419128418  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.6950335502624512  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7113986015319824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([110, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7125625610351562  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7125625610351562  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7127723693847656  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7306060791015625  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7313761711120605  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7313761711120605  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7315096855163574  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.74379301071167  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.744452953338623  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.744452953338623  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.744555950164795  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7547526359558105  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7554512023925781  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7554512023925781  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7555503845214844  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7660636901855469  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7665834426879883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7665834426879883  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7666540145874023  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7746286392211914  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7750835418701172  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7750835418701172  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7751407623291016  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7820072174072266  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7824978828430176  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7824978828430176  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.782555103302002  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7898221015930176  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7903780937194824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7903780937194824  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7904391288757324  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7986178398132324  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.799048900604248  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.799048900604248  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.7990946769714355  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.805549144744873  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8060712814331055  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8060712814331055  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8061227798461914  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8137445449829102  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8140997886657715  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8140997886657715  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.814134120941162  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.819455623626709  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8196816444396973  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8196816444396973  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8197026252746582  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.82310152053833  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.823437213897705  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.823437213897705  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8234658241271973  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.828300952911377  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([212, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8333806991577148  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8333806991577148  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.833785057067871  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.904952049255371  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

rst.shape  torch.Size([1, 212, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.878962516784668  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8798017501831055  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes
Using backend: pytorch

----------------------------------------after rst
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.880640983581543  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8797597885131836  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

torch.Size([5630, 40])
input nodes number: 25196
output nodes number: 5630
edges number: 32539
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8800029754638672  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 1.8800034523010254  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05249643325805664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05249643325805664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 6.6151123046875 GB
    Memory Allocated: 0.05249643325805664  GigaBytes
Max Memory Allocated: 3.3689284324645996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0186832994222641 |0.0017465800046920776 |0.11787621676921844 |8.827447891235352e-05 |0.0768638402223587 |0.00462031364440918 |
----------------------------------------------------------pseudo_mini_loss sum 3.1796464920043945
Total (block generation + training)time/epoch 18.952801823616028
Training time/epoch 3.5255422592163086
Training time without block to device /epoch 3.4975969791412354
Training time without total dataloading part /epoch 3.121873617172241
load block tensor time/epoch 0.2989327907562256
block to device time/epoch 0.027945280075073242
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1577325
Number of first layer input nodes during this epoch:  1168833
Number of first layer output nodes during this epoch:  408492
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
