[05:27:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21674458 edges into 16 parts and get 5320420 edge cuts
main start at this time 1651555636.7865756
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.022069692611694336
global_2_local spend time (sec) 0.03595280647277832
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0042836666107177734
A = g.adjacency_matrix() spent  0.007867813110351562
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0850224494934082
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2827904224395752
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1461117267608643

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11680458, 2.0: 2009204, 3.0: 503973, 4.0: 152362, 5.0: 55000, 6.0: 23754, 7.0: 11121, 8.0: 5689, 9.0: 3141, 10.0: 1718, 11.0: 1012, 12.0: 561, 13.0: 341, 14.0: 224, 15.0: 154, 16.0: 98, 17.0: 78, 18.0: 41, 19.0: 29, 20.0: 8, 21.0: 4})
Convert a graph into a bidirected graph: 0.797 seconds
Metis partitioning: 4.366 seconds
Split the graph: 0.518 seconds
Construct subgraphs: 0.077 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.7692601680755615
5524
5647
5679
5813
5844
5778
5761
5753
5581
5526
5854
5517
5518
5611
5782
5753
total k batches seeds list generation spend  18.57335066795349
after graph partition
graph partition algorithm spend time 18.64963459968567
5524
5647
5679
5813
5844
5778
5761
5753
5581
5526
5854
5517
5518
5611
5782
5753
partition_len_list
[12964, 13022, 10262, 10852, 14209, 13992, 10821, 12063, 30497, 24330, 30308, 25881, 25552, 18702, 14672, 12241]
shared_neighbor_graph_partition_s0 selection method  spend 18.73340392112732
time for parepare:  0.01712799072265625
local_output_nid generation:  0.0011286735534667969
local_in_edges_tensor generation:  0.0014812946319580078
mini_batch_src_global generation:  0.002065896987915039
r_  generation:  0.016762495040893555
local_output_nid generation:  0.0013594627380371094
local_in_edges_tensor generation:  0.0013179779052734375
mini_batch_src_global generation:  0.0019085407257080078
r_  generation:  0.016895055770874023
local_output_nid generation:  0.001481771469116211
local_in_edges_tensor generation:  0.001234292984008789
mini_batch_src_global generation:  0.0016357898712158203
r_  generation:  0.013891935348510742
local_output_nid generation:  0.0015032291412353516
local_in_edges_tensor generation:  0.0012502670288085938
mini_batch_src_global generation:  0.0014431476593017578
r_  generation:  0.015978336334228516
local_output_nid generation:  0.0016341209411621094
local_in_edges_tensor generation:  0.0012083053588867188
mini_batch_src_global generation:  0.0016014575958251953
r_  generation:  0.016352176666259766
local_output_nid generation:  0.0016090869903564453
local_in_edges_tensor generation:  0.0011947154998779297
mini_batch_src_global generation:  0.0014889240264892578
r_  generation:  0.015451669692993164
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0011067390441894531
mini_batch_src_global generation:  0.0011398792266845703
r_  generation:  0.011908292770385742
local_output_nid generation:  0.0015521049499511719
local_in_edges_tensor generation:  0.0011744499206542969
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.013529777526855469
local_output_nid generation:  0.0015239715576171875
local_in_edges_tensor generation:  0.0011742115020751953
mini_batch_src_global generation:  0.0018274784088134766
r_  generation:  0.019501209259033203
local_output_nid generation:  0.0016200542449951172
local_in_edges_tensor generation:  0.0012428760528564453
mini_batch_src_global generation:  0.005236387252807617
r_  generation:  0.01514291763305664
local_output_nid generation:  0.0017895698547363281
local_in_edges_tensor generation:  0.0015985965728759766
mini_batch_src_global generation:  0.0021677017211914062
r_  generation:  0.024979591369628906
local_output_nid generation:  0.0017247200012207031
local_in_edges_tensor generation:  0.0012826919555664062
mini_batch_src_global generation:  0.0020301342010498047
r_  generation:  0.019878387451171875
local_output_nid generation:  0.0017590522766113281
local_in_edges_tensor generation:  0.0012989044189453125
mini_batch_src_global generation:  0.0016837120056152344
r_  generation:  0.01803302764892578
local_output_nid generation:  0.0017676353454589844
local_in_edges_tensor generation:  0.0012080669403076172
mini_batch_src_global generation:  0.0013861656188964844
r_  generation:  0.01422429084777832
local_output_nid generation:  0.001705169677734375
local_in_edges_tensor generation:  0.0030961036682128906
mini_batch_src_global generation:  0.0021028518676757812
r_  generation:  0.013865232467651367
local_output_nid generation:  0.00226593017578125
local_in_edges_tensor generation:  0.0021970272064208984
mini_batch_src_global generation:  0.0013899803161621094
r_  generation:  0.011111259460449219
----------------------check_connections_block total spend ----------------------------- 0.4228646755218506
generate_one_block  0.02377009391784668
generate_one_block  0.02067422866821289
generate_one_block  0.01854848861694336
generate_one_block  0.02104020118713379
generate_one_block  0.026847362518310547
generate_one_block  0.021237850189208984
generate_one_block  0.015946149826049805
generate_one_block  0.017670392990112305
generate_one_block  0.029931068420410156
generate_one_block  0.020977497100830078
generate_one_block  0.03743767738342285
generate_one_block  0.0267181396484375
generate_one_block  0.02479696273803711
generate_one_block  0.019360065460205078
generate_one_block  0.017776966094970703
generate_one_block  0.015828609466552734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04454445838928223
gen group dst list time:  0.008280038833618164
time for parepare:  0.024425268173217773
local_output_nid generation:  0.0024976730346679688
local_in_edges_tensor generation:  0.012057065963745117
mini_batch_src_global generation:  0.002710580825805664
r_  generation:  0.028499126434326172
local_output_nid generation:  0.003697633743286133
local_in_edges_tensor generation:  0.0035085678100585938
mini_batch_src_global generation:  0.003108978271484375
r_  generation:  0.030014991760253906
local_output_nid generation:  0.0029306411743164062
local_in_edges_tensor generation:  0.0025987625122070312
mini_batch_src_global generation:  0.001920938491821289
r_  generation:  0.02174663543701172
local_output_nid generation:  0.003034830093383789
local_in_edges_tensor generation:  0.0022437572479248047
mini_batch_src_global generation:  0.002166748046875
r_  generation:  0.024472951889038086
local_output_nid generation:  0.003943204879760742
local_in_edges_tensor generation:  0.003115415573120117
mini_batch_src_global generation:  0.0031082630157470703
r_  generation:  0.034067392349243164
local_output_nid generation:  0.003813505172729492
local_in_edges_tensor generation:  0.0032052993774414062
mini_batch_src_global generation:  0.0032248497009277344
r_  generation:  0.03202700614929199
local_output_nid generation:  0.003069639205932617
local_in_edges_tensor generation:  0.00232696533203125
mini_batch_src_global generation:  0.002004384994506836
r_  generation:  0.0213165283203125
local_output_nid generation:  0.0033855438232421875
local_in_edges_tensor generation:  0.002526998519897461
mini_batch_src_global generation:  0.0019800662994384766
r_  generation:  0.02514505386352539
local_output_nid generation:  0.007360696792602539
local_in_edges_tensor generation:  0.008898258209228516
mini_batch_src_global generation:  0.009999990463256836
r_  generation:  0.0840754508972168
local_output_nid generation:  0.006666898727416992
local_in_edges_tensor generation:  0.006884336471557617
mini_batch_src_global generation:  0.007929325103759766
r_  generation:  0.06429100036621094
local_output_nid generation:  0.007365226745605469
local_in_edges_tensor generation:  0.008217334747314453
mini_batch_src_global generation:  0.011058568954467773
r_  generation:  0.08928370475769043
local_output_nid generation:  0.006870746612548828
local_in_edges_tensor generation:  0.005682706832885742
mini_batch_src_global generation:  0.008918523788452148
r_  generation:  0.07204985618591309
local_output_nid generation:  0.006775856018066406
local_in_edges_tensor generation:  0.005664825439453125
mini_batch_src_global generation:  0.008529186248779297
r_  generation:  0.07094597816467285
local_output_nid generation:  0.005164623260498047
local_in_edges_tensor generation:  0.00423884391784668
mini_batch_src_global generation:  0.00596308708190918
r_  generation:  0.047280311584472656
local_output_nid generation:  0.0040547847747802734
local_in_edges_tensor generation:  0.0032808780670166016
mini_batch_src_global generation:  0.003555774688720703
r_  generation:  0.03224349021911621
local_output_nid generation:  0.003464937210083008
local_in_edges_tensor generation:  0.0027284622192382812
mini_batch_src_global generation:  0.0024254322052001953
r_  generation:  0.025528669357299805
----------------------check_connections_block total spend ----------------------------- 1.1306076049804688
generate_one_block  0.036248207092285156
generate_one_block  0.037873268127441406
generate_one_block  0.027629852294921875
generate_one_block  0.031053781509399414
generate_one_block  0.04385638236999512
generate_one_block  0.04137420654296875
generate_one_block  0.03301191329956055
generate_one_block  0.03146505355834961
generate_one_block  0.11830496788024902
generate_one_block  0.08675146102905273
generate_one_block  0.11817431449890137
generate_one_block  0.0974130630493164
generate_one_block  0.09426259994506836
generate_one_block  0.06024026870727539
generate_one_block  0.04003572463989258
generate_one_block  0.030666589736938477
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.1306076049804688
block generation total time  0.9283616542816162
average batch blocks generation time:  0.05802260339260101
pseudo mini batch 0 input nodes size: 25056
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.014725208282470703  GigaBytes
Max Memory Allocated: 0.014725208282470703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.014766693115234375  GigaBytes
Max Memory Allocated: 0.014766693115234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.014766693115234375  GigaBytes
Max Memory Allocated: 0.014766693115234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.015727996826171875  GigaBytes
Max Memory Allocated: 0.015727996826171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.015727996826171875  GigaBytes
Max Memory Allocated: 0.015727996826171875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.015727996826171875  GigaBytes
Max Memory Allocated: 0.015727996826171875  GigaBytes

torch.Size([25056, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.015727996826171875  GigaBytes
Max Memory Allocated: 0.015727996826171875  GigaBytes

m.shape torch.Size([1232, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2440185546875 GB
    Memory Allocated: 0.05731391906738281  GigaBytes
Max Memory Allocated: 0.057940006256103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2440185546875 GB
    Memory Allocated: 0.05731391906738281  GigaBytes
Max Memory Allocated: 0.057940006256103516  GigaBytes

 h.shape torch.Size([1, 1232, 128]), torch.Size([1, 1232, 128])
----------------------------------------3
 Nvidia-smi: 1.2440185546875 GB
    Memory Allocated: 0.05848884582519531  GigaBytes
Max Memory Allocated: 0.05848884582519531  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.06788825988769531  GigaBytes
Max Memory Allocated: 0.06847572326660156  GigaBytes

rst.shape  torch.Size([1, 1232, 128])
m.shape torch.Size([1238, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.06902503967285156  GigaBytes
Max Memory Allocated: 0.06905317306518555  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.06902503967285156  GigaBytes
Max Memory Allocated: 0.06905317306518555  GigaBytes

 h.shape torch.Size([1, 1238, 128]), torch.Size([1, 1238, 128])
----------------------------------------3
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0702056884765625  GigaBytes
Max Memory Allocated: 0.0702056884765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.08859062194824219  GigaBytes
Max Memory Allocated: 0.08977127075195312  GigaBytes

rst.shape  torch.Size([1, 1238, 128])
m.shape torch.Size([1118, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.089599609375  GigaBytes
Max Memory Allocated: 0.08977127075195312  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.089599609375  GigaBytes
Max Memory Allocated: 0.08977127075195312  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09066581726074219  GigaBytes
Max Memory Allocated: 0.09066581726074219  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.11476612091064453  GigaBytes
Max Memory Allocated: 0.11636543273925781  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([973, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.1160888671875  GigaBytes
Max Memory Allocated: 0.11636543273925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.1160888671875  GigaBytes
Max Memory Allocated: 0.11636543273925781  GigaBytes

 h.shape torch.Size([1, 973, 128]), torch.Size([1, 973, 128])
----------------------------------------3
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.11701679229736328  GigaBytes
Max Memory Allocated: 0.11701679229736328  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.1443462371826172  GigaBytes
Max Memory Allocated: 0.14620208740234375  GigaBytes

rst.shape  torch.Size([1, 973, 128])
m.shape torch.Size([928, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.14609479904174805  GigaBytes
Max Memory Allocated: 0.14620208740234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.14609479904174805  GigaBytes
Max Memory Allocated: 0.14620208740234375  GigaBytes

 h.shape torch.Size([1, 928, 128]), torch.Size([1, 928, 128])
----------------------------------------3
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.14697980880737305  GigaBytes
Max Memory Allocated: 0.14697980880737305  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.17986059188842773  GigaBytes
Max Memory Allocated: 0.18207311630249023  GigaBytes

rst.shape  torch.Size([1, 928, 128])
m.shape torch.Size([764, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18160390853881836  GigaBytes
Max Memory Allocated: 0.18207311630249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18160390853881836  GigaBytes
Max Memory Allocated: 0.18207311630249023  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18233251571655273  GigaBytes
Max Memory Allocated: 0.18233251571655273  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.21366262435913086  GigaBytes
Max Memory Allocated: 0.21584844589233398  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([670, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.21553468704223633  GigaBytes
Max Memory Allocated: 0.21584844589233398  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.21553468704223633  GigaBytes
Max Memory Allocated: 0.21584844589233398  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.21617364883422852  GigaBytes
Max Memory Allocated: 0.21617364883422852  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.24922704696655273  GigaBytes
Max Memory Allocated: 0.2514634132385254  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([569, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.25107812881469727  GigaBytes
Max Memory Allocated: 0.2514634132385254  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.25107812881469727  GigaBytes
Max Memory Allocated: 0.2514634132385254  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.2516207695007324  GigaBytes
Max Memory Allocated: 0.2516207695007324  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.28259706497192383  GigaBytes
Max Memory Allocated: 0.28476762771606445  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([496, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.284454345703125  GigaBytes
Max Memory Allocated: 0.28476762771606445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.284454345703125  GigaBytes
Max Memory Allocated: 0.28476762771606445  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.2849273681640625  GigaBytes
Max Memory Allocated: 0.2849273681640625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.3152008056640625  GigaBytes
Max Memory Allocated: 0.31732940673828125  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([4976, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.33869171142578125  GigaBytes
Max Memory Allocated: 0.3392481803894043  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.33869171142578125  GigaBytes
Max Memory Allocated: 0.3392481803894043  GigaBytes

 h.shape torch.Size([1, 4976, 128]), torch.Size([1, 4976, 128])
----------------------------------------3
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.34343719482421875  GigaBytes
Max Memory Allocated: 0.34343719482421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.6897048950195312  GigaBytes
Max Memory Allocated: 0.7134323120117188  GigaBytes

rst.shape  torch.Size([1, 4976, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.65283203125  GigaBytes
Max Memory Allocated: 0.7134323120117188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.6658592224121094  GigaBytes
Max Memory Allocated: 0.7134323120117188  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.67822265625  GigaBytes
Max Memory Allocated: 0.7134323120117188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.6650986671447754  GigaBytes
Max Memory Allocated: 0.7134323120117188  GigaBytes

torch.Size([12964, 256])
first layer input nodes number: 25056
first layer output nodes number: 12964
edges number: 83644
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.6777477264404297  GigaBytes
Max Memory Allocated: 0.7134323120117188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.6907749176025391  GigaBytes
Max Memory Allocated: 0.7134323120117188  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.693202018737793  GigaBytes
Max Memory Allocated: 0.7134323120117188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.693202018737793  GigaBytes
Max Memory Allocated: 0.7134323120117188  GigaBytes

m.shape torch.Size([813, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.7376537322998047  GigaBytes
Max Memory Allocated: 0.7376570701599121  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.7376537322998047  GigaBytes
Max Memory Allocated: 0.7376570701599121  GigaBytes

 h.shape torch.Size([1, 813, 256]), torch.Size([1, 813, 256])
----------------------------------------3
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.7392044067382812  GigaBytes
Max Memory Allocated: 0.7392044067382812  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.7516098022460938  GigaBytes
Max Memory Allocated: 0.752385139465332  GigaBytes

rst.shape  torch.Size([1, 813, 256])
m.shape torch.Size([704, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.7523307800292969  GigaBytes
Max Memory Allocated: 0.752385139465332  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.7523307800292969  GigaBytes
Max Memory Allocated: 0.752385139465332  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.7536735534667969  GigaBytes
Max Memory Allocated: 0.7536735534667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7745656967163086  GigaBytes
Max Memory Allocated: 0.7761678695678711  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([569, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7755703926086426  GigaBytes
Max Memory Allocated: 0.7761678695678711  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7755703926086426  GigaBytes
Max Memory Allocated: 0.7761678695678711  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7766556739807129  GigaBytes
Max Memory Allocated: 0.7766556739807129  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.8007340431213379  GigaBytes
Max Memory Allocated: 0.8025450706481934  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([432, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.8020153045654297  GigaBytes
Max Memory Allocated: 0.8025450706481934  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.8020153045654297  GigaBytes
Max Memory Allocated: 0.8025450706481934  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.8028392791748047  GigaBytes
Max Memory Allocated: 0.8028392791748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.8270931243896484  GigaBytes
Max Memory Allocated: 0.8287410736083984  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([397, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.8285894393920898  GigaBytes
Max Memory Allocated: 0.8287410736083984  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.8285894393920898  GigaBytes
Max Memory Allocated: 0.8287410736083984  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.8293466567993164  GigaBytes
Max Memory Allocated: 0.8293466567993164  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.8572731018066406  GigaBytes
Max Memory Allocated: 0.859166145324707  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.8586249351501465  GigaBytes
Max Memory Allocated: 0.859166145324707  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.8586249351501465  GigaBytes
Max Memory Allocated: 0.859166145324707  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.8591971397399902  GigaBytes
Max Memory Allocated: 0.8591971397399902  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.884519100189209  GigaBytes
Max Memory Allocated: 0.8862357139587402  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([237, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.8858275413513184  GigaBytes
Max Memory Allocated: 0.8862357139587402  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.8858275413513184  GigaBytes
Max Memory Allocated: 0.8862357139587402  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.8862795829772949  GigaBytes
Max Memory Allocated: 0.8862795829772949  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.908881664276123  GigaBytes
Max Memory Allocated: 0.910463809967041  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([198, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.9101781845092773  GigaBytes
Max Memory Allocated: 0.910463809967041  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.9101781845092773  GigaBytes
Max Memory Allocated: 0.910463809967041  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.9105558395385742  GigaBytes
Max Memory Allocated: 0.9105558395385742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.9320821762084961  GigaBytes
Max Memory Allocated: 0.9335927963256836  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([178, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.9334335327148438  GigaBytes
Max Memory Allocated: 0.9335927963256836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.9334335327148438  GigaBytes
Max Memory Allocated: 0.9335927963256836  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.9337730407714844  GigaBytes
Max Memory Allocated: 0.9337730407714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9555015563964844  GigaBytes
Max Memory Allocated: 0.9578237533569336  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([156, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9576659202575684  GigaBytes
Max Memory Allocated: 0.9578237533569336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9576659202575684  GigaBytes
Max Memory Allocated: 0.9578237533569336  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9579634666442871  GigaBytes
Max Memory Allocated: 0.9579634666442871  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.9790892601013184  GigaBytes
Max Memory Allocated: 0.9805769920349121  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([123, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.9802412986755371  GigaBytes
Max Memory Allocated: 0.9805769920349121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.9802412986755371  GigaBytes
Max Memory Allocated: 0.9805769920349121  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.980475902557373  GigaBytes
Max Memory Allocated: 0.9805769920349121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.9987750053405762  GigaBytes
Max Memory Allocated: 1.0000653266906738  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([121, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 1.0000534057617188  GigaBytes
Max Memory Allocated: 1.0000653266906738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 1.0000534057617188  GigaBytes
Max Memory Allocated: 1.0000653266906738  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 1.000284194946289  GigaBytes
Max Memory Allocated: 1.000284194946289  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 1.0199012756347656  GigaBytes
Max Memory Allocated: 1.0212860107421875  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 1.0210728645324707  GigaBytes
Max Memory Allocated: 1.0212860107421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 1.0210728645324707  GigaBytes
Max Memory Allocated: 1.0212860107421875  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 1.0212693214416504  GigaBytes
Max Memory Allocated: 1.0212860107421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 1.0393433570861816  GigaBytes
Max Memory Allocated: 1.0406203269958496  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([99, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 1.0405774116516113  GigaBytes
Max Memory Allocated: 1.0406203269958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 1.0405774116516113  GigaBytes
Max Memory Allocated: 1.0406203269958496  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 1.0407662391662598  GigaBytes
Max Memory Allocated: 1.0407662391662598  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 1.059460163116455  GigaBytes
Max Memory Allocated: 1.0607819557189941  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([88, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 1.0606346130371094  GigaBytes
Max Memory Allocated: 1.0607819557189941  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 1.0606346130371094  GigaBytes
Max Memory Allocated: 1.0607819557189941  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 1.0608024597167969  GigaBytes
Max Memory Allocated: 1.0608024597167969  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 1.0785942077636719  GigaBytes
Max Memory Allocated: 1.0798530578613281  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([57, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 1.0793871879577637  GigaBytes
Max Memory Allocated: 1.0798530578613281  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 1.0793871879577637  GigaBytes
Max Memory Allocated: 1.0798530578613281  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 1.079495906829834  GigaBytes
Max Memory Allocated: 1.0798530578613281  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2947998046875 GB
    Memory Allocated: 1.0917811393737793  GigaBytes
Max Memory Allocated: 1.0926508903503418  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2947998046875 GB
    Memory Allocated: 1.0929036140441895  GigaBytes
Max Memory Allocated: 1.0929083824157715  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2947998046875 GB
    Memory Allocated: 1.0929036140441895  GigaBytes
Max Memory Allocated: 1.0929083824157715  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.2947998046875 GB
    Memory Allocated: 1.093040943145752  GigaBytes
Max Memory Allocated: 1.093040943145752  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 1.109520435333252  GigaBytes
Max Memory Allocated: 1.1106877326965332  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 1.1105971336364746  GigaBytes
Max Memory Allocated: 1.1106877326965332  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 1.1105971336364746  GigaBytes
Max Memory Allocated: 1.1106877326965332  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 1.1107192039489746  GigaBytes
Max Memory Allocated: 1.1107192039489746  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3240966796875 GB
    Memory Allocated: 1.1262221336364746  GigaBytes
Max Memory Allocated: 1.1273207664489746  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.3240966796875 GB
    Memory Allocated: 1.127293586730957  GigaBytes
Max Memory Allocated: 1.1273207664489746  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3240966796875 GB
    Memory Allocated: 1.127293586730957  GigaBytes
Max Memory Allocated: 1.1273207664489746  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.3260498046875 GB
    Memory Allocated: 1.1274118423461914  GigaBytes
Max Memory Allocated: 1.1274118423461914  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.1432580947875977  GigaBytes
Max Memory Allocated: 1.1443815231323242  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([63, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.1444101333618164  GigaBytes
Max Memory Allocated: 1.1444149017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.1444101333618164  GigaBytes
Max Memory Allocated: 1.1444149017333984  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 1.1445302963256836  GigaBytes
Max Memory Allocated: 1.1445302963256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 1.161473274230957  GigaBytes
Max Memory Allocated: 1.162674903869629  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 1.1625032424926758  GigaBytes
Max Memory Allocated: 1.162674903869629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 1.1625032424926758  GigaBytes
Max Memory Allocated: 1.162674903869629  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 1.1626062393188477  GigaBytes
Max Memory Allocated: 1.162674903869629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 1.1778497695922852  GigaBytes
Max Memory Allocated: 1.1789312362670898  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 1.1784749031066895  GigaBytes
Max Memory Allocated: 1.1789312362670898  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 1.1784749031066895  GigaBytes
Max Memory Allocated: 1.1789312362670898  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 1.1785359382629395  GigaBytes
Max Memory Allocated: 1.1789312362670898  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.1879963874816895  GigaBytes
Max Memory Allocated: 1.1886677742004395  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 1.1888060569763184  GigaBytes
Max Memory Allocated: 1.1888093948364258  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 1.1888060569763184  GigaBytes
Max Memory Allocated: 1.1888093948364258  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 1.1888785362243652  GigaBytes
Max Memory Allocated: 1.1888785362243652  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 1.200620174407959  GigaBytes
Max Memory Allocated: 1.201453685760498  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 1.2012529373168945  GigaBytes
Max Memory Allocated: 1.201453685760498  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 1.2012529373168945  GigaBytes
Max Memory Allocated: 1.201453685760498  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 1.201308250427246  GigaBytes
Max Memory Allocated: 1.201453685760498  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 1.2106561660766602  GigaBytes
Max Memory Allocated: 1.211319923400879  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([535, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.4197998046875 GB
    Memory Allocated: 1.2244000434875488  GigaBytes
Max Memory Allocated: 1.2244501113891602  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4197998046875 GB
    Memory Allocated: 1.2244000434875488  GigaBytes
Max Memory Allocated: 1.2244501113891602  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 2.4197998046875 GB
    Memory Allocated: 1.2254204750061035  GigaBytes
Max Memory Allocated: 1.2254204750061035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 1.4050164222717285  GigaBytes
Max Memory Allocated: 1.4186882972717285  GigaBytes

rst.shape  torch.Size([1, 535, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6424560546875 GB
    Memory Allocated: 1.3665456771850586  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6424560546875 GB
    Memory Allocated: 1.3673691749572754  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6444091796875 GB
    Memory Allocated: 1.3681926727294922  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.6444091796875 GB
    Memory Allocated: 1.3673276901245117  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

torch.Size([5524, 40])
input nodes number: 12964
output nodes number: 5524
edges number: 45205
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6444091796875 GB
    Memory Allocated: 1.3682894706726074  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.6444091796875 GB
    Memory Allocated: 1.3682904243469238  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.02116680145263672  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

pseudo mini batch 1 input nodes size: 24049
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.018366336822509766  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.018366336822509766  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.02983379364013672  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.029876232147216797  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.017887115478515625  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.018858909606933594  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.018858909606933594  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.018858909606933594  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

torch.Size([24049, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.018858909606933594  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

m.shape torch.Size([1103, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.06153392791748047  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.06153392791748047  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.06258583068847656  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.07110166549682617  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1220, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.07173919677734375  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.07173919677734375  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 1220, 128]), torch.Size([1, 1220, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.07290267944335938  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.09035491943359375  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 1220, 128])
m.shape torch.Size([1110, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.09136104583740234  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.09136104583740234  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.09241962432861328  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.1165771484375  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([966, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.1178903579711914  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.1178903579711914  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 966, 128]), torch.Size([1, 966, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.11881160736083984  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.14552783966064453  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 966, 128])
m.shape torch.Size([902, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.1472177505493164  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.1472177505493164  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 902, 128]), torch.Size([1, 902, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.14807796478271484  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.17910003662109375  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 902, 128])
m.shape torch.Size([731, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.18076133728027344  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.18076133728027344  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 731, 128]), torch.Size([1, 731, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.1814584732055664  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.21158123016357422  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 731, 128])
m.shape torch.Size([675, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.2134857177734375  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.2134857177734375  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 675, 128]), torch.Size([1, 675, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.21412944793701172  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.2470078468322754  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 675, 128])
m.shape torch.Size([639, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.24912357330322266  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.24912357330322266  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.24973297119140625  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.2853364944458008  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([513, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.2872333526611328  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.2872333526611328  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.2877225875854492  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.31966447830200195  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([5163, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.34481048583984375  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.34481048583984375  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 5163, 128]), torch.Size([1, 5163, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.3497343063354492  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7002029418945312  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 5163, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.6626834869384766  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.6751022338867188  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.6875209808349609  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.6750049591064453  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

torch.Size([13022, 256])
first layer input nodes number: 24049
first layer output nodes number: 13022
edges number: 85717
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.6877021789550781  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7001209259033203  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7035951614379883  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7035951614379883  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

m.shape torch.Size([776, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7474007606506348  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7474007606506348  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 776, 256]), torch.Size([1, 776, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7488808631896973  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7612357139587402  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 776, 256])
m.shape torch.Size([726, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7628045082092285  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7628045082092285  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 726, 256]), torch.Size([1, 726, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7641892433166504  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7849602699279785  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 726, 256])
m.shape torch.Size([580, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7865791320800781  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7865791320800781  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.7876853942871094  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.8128519058227539  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([459, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.814063549041748  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.814063549041748  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.814939022064209  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.8417239189147949  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([380, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.8439803123474121  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.8439803123474121  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.8447051048278809  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.8709216117858887  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([318, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.8723931312561035  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.8723931312561035  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.8729996681213379  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.899355411529541  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([282, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9014720916748047  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9014720916748047  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9020099639892578  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9291400909423828  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([249, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9307861328125  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9307861328125  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9312610626220703  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9583320617675781  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([200, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9598250389099121  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9598250389099121  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9602065086364746  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9846205711364746  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([179, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9861502647399902  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9861502647399902  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 0.9864916801452637  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0107321739196777  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([173, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0123906135559082  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0123906135559082  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0127205848693848  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0384583473205566  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([127, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0397744178771973  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0397744178771973  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0400166511535645  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0606064796447754  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0618476867675781  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0618476867675781  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0620555877685547  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0811824798583984  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0824780464172363  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0824780464172363  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.0826764106750488  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1023144721984863  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([94, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1035709381103516  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1035709381103516  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.103750228881836  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1227550506591797  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.123849868774414  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.123849868774414  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1239967346191406  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1405925750732422  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([81, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1418428421020508  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1418428421020508  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1419973373413086  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.160536766052246  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1613073348999023  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1613073348999023  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1614007949829102  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1732702255249023  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.174008846282959  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.174008846282959  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.17409086227417  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1850810050964355  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1860013008117676  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1860013008117676  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1860966682434082  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.1995434761047363  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.200505256652832  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.200505256652832  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2006006240844727  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2147150039672852  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2153229713439941  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2153229713439941  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2153820991516113  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2245469093322754  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2252469062805176  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2252469062805176  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2253098487854004  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.235506534576416  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.236374855041504  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.236374855041504  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2364492416381836  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2490205764770508  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([438, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2595081329345703  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2595081329345703  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.2603435516357422  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.4086742401123047  GigaBytes
Max Memory Allocated: 1.4203319549560547  GigaBytes

rst.shape  torch.Size([1, 438, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.3710217475891113  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.3718633651733398  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.3727049827575684  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.3718209266662598  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

torch.Size([5647, 40])
input nodes number: 13022
output nodes number: 5647
edges number: 44563
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.371978759765625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.3719792366027832  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.02071666717529297  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

pseudo mini batch 2 input nodes size: 19019
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.017905235290527344  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.017905235290527344  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.026974201202392578  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.027016639709472656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.015506744384765625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.01627349853515625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.01627349853515625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.01627349853515625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

torch.Size([19019, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.01627349853515625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

m.shape torch.Size([1208, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.04665327072143555  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.04665327072143555  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 1208, 128]), torch.Size([1, 1208, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.0478053092956543  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.0570216178894043  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 1208, 128])
m.shape torch.Size([1195, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.05758523941040039  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.05758523941040039  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 1195, 128]), torch.Size([1, 1195, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.05872488021850586  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.07642793655395508  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 1195, 128])
m.shape torch.Size([1083, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.0774073600769043  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.0774073600769043  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.07844018936157227  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.10116243362426758  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([885, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.10233402252197266  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.10233402252197266  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 885, 128]), torch.Size([1, 885, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.10317802429199219  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.12823963165283203  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 885, 128])
m.shape torch.Size([684, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.12944841384887695  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.12944841384887695  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 684, 128]), torch.Size([1, 684, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.13010072708129883  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.15358400344848633  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 684, 128])
m.shape torch.Size([581, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.15492010116577148  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.15492010116577148  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.15547418594360352  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.17963361740112305  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([511, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.1810622215270996  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.1810622215270996  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.1815495491027832  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2059159278869629  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([442, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.20735836029052734  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.20735836029052734  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 442, 128]), torch.Size([1, 442, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2077798843383789  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.23180675506591797  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 442, 128])
m.shape torch.Size([400, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.23331260681152344  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.23331260681152344  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.23369407653808594  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.25810813903808594  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([3273, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.27352428436279297  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.27352428436279297  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 3273, 128]), torch.Size([1, 3273, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2774486541748047  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.508702278137207  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 3273, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.4820733070373535  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.49185991287231445  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5016465187072754  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.49178314208984375  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

torch.Size([10262, 256])
first layer input nodes number: 19019
first layer output nodes number: 10262
edges number: 60736
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5017905235290527  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5115771293640137  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5140237808227539  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5140237808227539  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

m.shape torch.Size([897, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5554723739624023  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5554723739624023  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 897, 256]), torch.Size([1, 897, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5571832656860352  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5708703994750977  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 897, 256])
m.shape torch.Size([769, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5715579986572266  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5715579986572266  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 769, 256]), torch.Size([1, 769, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5730247497558594  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5964260101318359  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 769, 256])
m.shape torch.Size([614, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5981111526489258  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5981111526489258  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 614, 256]), torch.Size([1, 614, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5992822647094727  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6258344650268555  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 614, 256])
m.shape torch.Size([498, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6271638870239258  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6271638870239258  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6281137466430664  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6557512283325195  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([382, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6571121215820312  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6571121215820312  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6578407287597656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6841650009155273  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6855311393737793  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.6855311393737793  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.686103343963623  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7113661766052246  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([277, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7129440307617188  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7129440307617188  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7134723663330078  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7407064437866211  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([225, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7421727180480957  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7421727180480957  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7426018714904785  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7670636177062988  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([196, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7685446739196777  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7685446739196777  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.768918514251709  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.792844295501709  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7942366600036621  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.7942366600036621  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.794522762298584  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8148360252380371  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8162260055541992  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8162260055541992  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.816502571105957  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8380746841430664  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([143, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8395857810974121  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8395857810974121  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8398585319519043  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8630423545837402  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([108, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.864255428314209  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.864255428314209  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8644614219665527  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8834128379821777  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8844671249389648  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8844671249389648  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.8846311569213867  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9008703231811523  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([75, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9018697738647461  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9018697738647461  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.902012825012207  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9171762466430664  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9180121421813965  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9180121421813965  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9181246757507324  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9308409690856934  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9318304061889648  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9318304061889648  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9319524765014648  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9466009140014648  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9475955963134766  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9475955963134766  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9477119445800781  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9624881744384766  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9634528160095215  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9634528160095215  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.963559627532959  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.977872371673584  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9785494804382324  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9785494804382324  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9786219596862793  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9888415336608887  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9897341728210449  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9897341728210449  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.9898219108581543  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0028071403503418  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0035247802734375  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0035247802734375  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0035934448242188  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0142364501953125  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0150203704833984  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0150203704833984  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0150909423828125  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0265235900878906  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0271344184875488  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0271344184875488  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0271878242492676  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0362133979797363  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([389, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0455336570739746  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0455336570739746  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.0462756156921387  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.1784415245056152  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 389, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.1433205604553223  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.1441669464111328  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.1450133323669434  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.1441245079040527  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

torch.Size([5679, 40])
input nodes number: 10262
output nodes number: 5679
edges number: 41986
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.1442484855651855  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.1442489624023438  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.017795562744140625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

pseudo mini batch 3 input nodes size: 20881
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.015511512756347656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.015511512756347656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.02546834945678711  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.025511741638183594  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.01640033721923828  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.017301559448242188  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.017301559448242188  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.017301559448242188  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

torch.Size([20881, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.017301559448242188  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

m.shape torch.Size([828, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.052889347076416016  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.052889347076416016  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.05367898941040039  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.06055259704589844  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([957, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.06107044219970703  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.06107044219970703  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.06198310852050781  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.07567310333251953  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([937, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.07675552368164062  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.07675552368164062  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 937, 128]), torch.Size([1, 937, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.07764911651611328  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.09730815887451172  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 937, 128])
m.shape torch.Size([845, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.09847307205200195  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.09847307205200195  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.09927892684936523  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.12283945083618164  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([760, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.12424850463867188  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.12424850463867188  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 760, 128]), torch.Size([1, 760, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.12497329711914062  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.15139007568359375  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 760, 128])
m.shape torch.Size([689, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.1529989242553711  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.1529989242553711  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.153656005859375  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.18200302124023438  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([620, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.18374395370483398  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.18374395370483398  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.18433523178100586  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2138991355895996  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([545, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2156825065612793  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2156825065612793  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2162022590637207  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2475295066833496  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([456, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.24922657012939453  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.24922657012939453  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.24966144561767578  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2774934768676758  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([4215, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2973747253417969  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.2973747253417969  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 4215, 128]), torch.Size([1, 4215, 128])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.3013944625854492  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5867958068847656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 4215, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5555062294006348  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5658555030822754  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.576204776763916  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5657744407653809  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

torch.Size([10852, 256])
first layer input nodes number: 20881
first layer output nodes number: 10852
edges number: 71821
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5763626098632812  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.5867118835449219  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.589299201965332  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 0.589299201965332  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

m.shape torch.Size([607, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6373591423034668  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6373591423034668  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 607, 256]), torch.Size([1, 607, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.638516902923584  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.648322582244873  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 607, 256])
m.shape torch.Size([599, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6490249633789062  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6490249633789062  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 599, 256]), torch.Size([1, 599, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6501674652099609  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6673164367675781  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 599, 256])
m.shape torch.Size([563, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6690850257873535  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6690850257873535  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.670158863067627  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6943745613098145  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([480, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6956830024719238  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6956830024719238  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.6965985298156738  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7231488227844238  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([428, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7247481346130371  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7247481346130371  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7255644798278809  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7549529075622559  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([373, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7566957473754883  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7566957473754883  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7574071884155273  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7884869575500488  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([323, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7903046607971191  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7903046607971191  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.7909207344055176  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.8219680786132812  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([267, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.8239574432373047  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.8239574432373047  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.8244667053222656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.8537817001342773  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([229, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.8555083274841309  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.8555083274841309  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.8559451103210449  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.8838992118835449  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([234, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.885930061340332  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.885930061340332  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.8863763809204102  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.918065071105957  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([204, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.9199991226196289  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.9199991226196289  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.9203882217407227  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.9507379531860352  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([143, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.9521927833557129  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.9521927833557129  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.9524655342102051  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.975649356842041  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([144, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.9773125648498535  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.9773125648498535  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.9775872230529785  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0028557777404785  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([140, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0046024322509766  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0046024322509766  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0048694610595703  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0313053131103516  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.032412052154541  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.032412052154541  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.032576084136963  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0499634742736816  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([110, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0524935722351074  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0524935722351074  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0527033805847168  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0764117240905762  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0778264999389648  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0778264999389648  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.0780038833618164  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.099289894104004  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([78, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.100550651550293  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.100550651550293  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1006994247436523  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.119593620300293  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1205363273620605  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1205363273620605  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1206393241882324  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1344408988952637  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([80, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1359272003173828  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1359272003173828  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1360797882080078  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1575946807861328  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([59, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1587095260620117  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1587095260620117  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1588220596313477  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1754770278930664  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1763935089111328  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1763935089111328  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1764812469482422  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1900806427001953  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1907663345336914  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1907663345336914  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.1908292770385742  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.2010259628295898  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.2020325660705566  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.2020325660705566  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.2021183967590332  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.2166237831115723  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([395, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.2260723114013672  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8299560546875 GB
    Memory Allocated: 1.2260723114013672  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.2268257141113281  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 1.359940528869629  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 395, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 1.3181052207946777  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 1.3189716339111328  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.319838047027588  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.3189282417297363  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

torch.Size([5813, 40])
input nodes number: 10852
output nodes number: 5813
edges number: 49008
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.3190727233886719  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.31907320022583  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.019052505493164062  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

pseudo mini batch 4 input nodes size: 33302
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.016420364379882812  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.016420364379882812  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.03229999542236328  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.03234386444091797  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.02234363555908203  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.023446083068847656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.023446083068847656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.023446083068847656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

torch.Size([33302, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.023446083068847656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

m.shape torch.Size([1036, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.0720829963684082  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.0720829963684082  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.07307100296020508  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.08097505569458008  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([1141, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.08215665817260742  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.08215665817260742  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.08324480056762695  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.09956693649291992  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([1100, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.10059642791748047  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.10059642791748047  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.10164546966552734  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.1247243881225586  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([978, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.12606525421142578  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.12606525421142578  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.1269979476928711  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.1549234390258789  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([981, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.15679597854614258  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.15679597854614258  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 981, 128]), torch.Size([1, 981, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.1577315330505371  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.19178104400634766  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 981, 128])
m.shape torch.Size([810, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.19400453567504883  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.19400453567504883  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.1947770118713379  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.22799348831176758  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([753, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.23012065887451172  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.23012065887451172  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.23083877563476562  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.2681870460510254  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([670, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.2703838348388672  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.2703838348388672  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.2710227966308594  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.30748939514160156  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([594, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.3100881576538086  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.3100881576538086  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 594, 128]), torch.Size([1, 594, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.3106546401977539  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.3471803665161133  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 594, 128])
m.shape torch.Size([6146, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.3762035369873047  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.3762035369873047  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 6146, 128]), torch.Size([1, 6146, 128])
----------------------------------------3
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.3820648193359375  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.7982158660888672  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 6146, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.7549123764038086  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.768463134765625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.7820138931274414  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.7683568000793457  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

torch.Size([14209, 256])
first layer input nodes number: 33302
first layer output nodes number: 14209
edges number: 97732
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.782264232635498  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.7958149909973145  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.7992029190063477  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9490966796875 GB
    Memory Allocated: 0.7992029190063477  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

m.shape torch.Size([701, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.8482856750488281  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.8482856750488281  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.8496227264404297  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.8603191375732422  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([642, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.8616080284118652  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.8616080284118652  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 642, 256]), torch.Size([1, 642, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.8628325462341309  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.881591796875  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 642, 256])
m.shape torch.Size([560, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.8829398155212402  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.8829398155212402  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 560, 256]), torch.Size([1, 560, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.8840079307556152  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.908484935760498  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 560, 256])
m.shape torch.Size([467, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9099125862121582  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9099125862121582  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9108033180236816  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9381241798400879  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([412, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9396591186523438  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9396591186523438  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9404449462890625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9694442749023438  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([336, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9709892272949219  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9709892272949219  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 0.9716300964355469  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.0004425048828125  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([315, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.002241611480713  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.002241611480713  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.0028424263000488  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.0351786613464355  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([254, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.0368313789367676  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.0368313789367676  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.037315845489502  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.0649304389953613  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([232, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.066695213317871  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.066695213317871  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.0671377182006836  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.0954580307006836  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([197, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.097130298614502  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.097130298614502  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.097506046295166  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1241841316223145  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([153, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1256141662597656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1256141662597656  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.125905990600586  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1486682891845703  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([161, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1508708000183105  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1508708000183105  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1511778831481934  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1772799491882324  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([131, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1787633895874023  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1787633895874023  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.1790132522583008  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.202000617980957  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([116, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.2034368515014648  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.2034368515014648  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.203658103942871  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.2255620956420898  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([115, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.227109432220459  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.227109432220459  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.2273287773132324  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.2505793571472168  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.251607894897461  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.251607894897461  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.251749038696289  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.2676982879638672  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([81, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.268951416015625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.268951416015625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.2691059112548828  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.2876453399658203  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.2886409759521484  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.2886409759521484  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.28875732421875  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3035335540771484  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3044071197509766  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3044071197509766  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.30450439453125  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3175392150878906  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3184328079223633  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3184328079223633  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.318526268005371  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3317041397094727  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3326263427734375  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3326263427734375  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3327178955078125  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3462677001953125  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([55, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3473849296569824  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3473849296569824  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.347489833831787  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3637499809265137  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3643608093261719  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3643608093261719  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3644180297851562  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.373687744140625  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3745818138122559  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3745818138122559  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3746581077575684  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.3875517845153809  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([563, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.4010415077209473  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.4010415077209473  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.4021153450012207  GigaBytes
Max Memory Allocated: 1.4244327545166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.5911259651184082  GigaBytes
Max Memory Allocated: 1.6045489311218262  GigaBytes

rst.shape  torch.Size([1, 563, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.5482368469238281  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.5491080284118652  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.5499792098999023  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.5490641593933105  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([5844, 40])
input nodes number: 14209
output nodes number: 5844
edges number: 50122
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.5492191314697266  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9979248046875 GB
    Memory Allocated: 1.5492196083068848  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.025560855865478516  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

pseudo mini batch 5 input nodes size: 30076
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.022348403930664062  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.022348403930664062  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.03668975830078125  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.036733150482177734  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.020809650421142578  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.021827220916748047  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.021827220916748047  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.021827220916748047  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([30076, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.021827220916748047  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

m.shape torch.Size([1224, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.06670141220092773  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.06670141220092773  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1224, 128]), torch.Size([1, 1224, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.06786870956420898  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.0777277946472168  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1224, 128])
m.shape torch.Size([1375, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.0789794921875  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.0789794921875  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1375, 128]), torch.Size([1, 1375, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.0802907943725586  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.10080718994140625  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1375, 128])
m.shape torch.Size([1272, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.10197114944458008  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.10197114944458008  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1272, 128]), torch.Size([1, 1272, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.10318422317504883  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.12987184524536133  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1272, 128])
m.shape torch.Size([1087, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.13133859634399414  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.13133859634399414  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.13237524032592773  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.16260385513305664  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([931, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.1643052101135254  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.1643052101135254  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.1651930809020996  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.19715642929077148  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([835, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.19910144805908203  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.19910144805908203  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 835, 128]), torch.Size([1, 835, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.19989776611328125  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.23514938354492188  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 835, 128])
m.shape torch.Size([705, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2371044158935547  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2371044158935547  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 705, 128]), torch.Size([1, 705, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2377767562866211  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.27245092391967773  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 705, 128])
m.shape torch.Size([711, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2748270034790039  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2748270034790039  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 711, 128]), torch.Size([1, 711, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.27550506591796875  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.3152914047241211  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 711, 128])
m.shape torch.Size([587, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.3174715042114258  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.3174715042114258  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.31803131103515625  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.35492420196533203  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([5265, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.3800349235534668  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.3800349235534668  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 5265, 128]), torch.Size([1, 5265, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.3850560188293457  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.741553783416748  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 5265, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7023591995239258  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.715703010559082  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7290468215942383  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7155985832214355  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([13992, 256])
first layer input nodes number: 30076
first layer output nodes number: 13992
edges number: 90359
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7292728424072266  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7426166534423828  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7459526062011719  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7459526062011719  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

m.shape torch.Size([808, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7922306060791016  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7922306060791016  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 808, 256]), torch.Size([1, 808, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7937717437744141  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8063430786132812  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 808, 256])
m.shape torch.Size([702, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8069291114807129  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8069291114807129  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 702, 256]), torch.Size([1, 702, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8082680702209473  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8288044929504395  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 702, 256])
m.shape torch.Size([590, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8301057815551758  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8301057815551758  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8312311172485352  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8569612503051758  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([488, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8583707809448242  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8583707809448242  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8593015670776367  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8867735862731934  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([407, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8883662223815918  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8883662223815918  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8891425132751465  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9175372123718262  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([327, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9190349578857422  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9190349578857422  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9196586608886719  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9489707946777344  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([242, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9502873420715332  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9502873420715332  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9507489204406738  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9738278388977051  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([274, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9757041931152344  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9757041931152344  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.976226806640625  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0067367553710938  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([199, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0081968307495117  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0081968307495117  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0085763931274414  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0328683853149414  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([193, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.034533977508545  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.034533977508545  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0349020957946777  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0610384941101074  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([157, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.062514305114746  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.062514305114746  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0628137588500977  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0861711502075195  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([135, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0875787734985352  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0875787734985352  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0878362655639648  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1097230911254883  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([110, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1113085746765137  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1113085746765137  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.111518383026123  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1308207511901855  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([101, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.132075309753418  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.132075309753418  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.132267951965332  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1513395309448242  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1525840759277344  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1525840759277344  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.152761459350586  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1715641021728516  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([72, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1725826263427734  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1725826263427734  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.172719955444336  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1882381439208984  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1893625259399414  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1893625259399414  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1895017623901367  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2062101364135742  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2073688507080078  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2073688507080078  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2075042724609375  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2247028350830078  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([64, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2258038520812988  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2258038520812988  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2259259223937988  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2422833442687988  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2432799339294434  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2432799339294434  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.243384838104248  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.258176326751709  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2590527534484863  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2590527534484863  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2591404914855957  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2721257209777832  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2731904983520508  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2731904983520508  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2732820510864258  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2874727249145508  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2884221076965332  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2884221076965332  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2885079383850098  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.302412509918213  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.3030619621276855  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.3030619621276855  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.30311918258667  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.3127894401550293  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([448, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.3235254287719727  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.3235254287719727  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.3243799209594727  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.4796075820922852  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 448, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.4396424293518066  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.4405035972595215  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.4413647651672363  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.440460205078125  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([5778, 40])
input nodes number: 13992
output nodes number: 5778
edges number: 46088
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.4405980110168457  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.440598487854004  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.02378225326538086  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

pseudo mini batch 6 input nodes size: 19489
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.020799636840820312  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.020799636840820312  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.030092716217041016  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.0301361083984375  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.015751361846923828  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.016416072845458984  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.016416072845458984  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.016416072845458984  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([19489, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.016416072845458984  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

m.shape torch.Size([1518, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.044727325439453125  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.044727325439453125  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1518, 128]), torch.Size([1, 1518, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.04617500305175781  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.05775642395019531  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1518, 128])
m.shape torch.Size([1495, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.05851602554321289  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.05851602554321289  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1495, 128]), torch.Size([1, 1495, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.059941768646240234  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.08132791519165039  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1495, 128])
m.shape torch.Size([1333, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.0827932357788086  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.0827932357788086  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1333, 128]), torch.Size([1, 1333, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.08406448364257812  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.11203193664550781  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1333, 128])
m.shape torch.Size([1107, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.1136622428894043  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.1136622428894043  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.11471796035766602  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.14624929428100586  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([901, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.1483612060546875  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.1483612060546875  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.14922046661376953  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.18078136444091797  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([700, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.18235445022583008  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.18235445022583008  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 700, 128]), torch.Size([1, 700, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.18302202224731445  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.21193933486938477  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 700, 128])
m.shape torch.Size([582, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2135481834411621  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2135481834411621  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.21410322189331055  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2436203956604004  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([515, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.24530744552612305  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.24530744552612305  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.24579858779907227  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2746615409851074  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([422, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2762269973754883  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2762269973754883  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2766294479370117  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.3023862838745117  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([2248, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.31302928924560547  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.31302928924560547  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 2248, 128]), torch.Size([1, 2248, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.3151731491088867  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.46927928924560547  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 2248, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.446164608001709  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.456484317779541  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.46680402755737305  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.4564032554626465  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([10821, 256])
first layer input nodes number: 19489
first layer output nodes number: 10821
edges number: 56112
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.4669513702392578  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.47727108001708984  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.47985124588012695  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.47985124588012695  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

m.shape torch.Size([1034, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.513298511505127  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.513298511505127  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1034, 256]), torch.Size([1, 1034, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.515678882598877  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5320224761962891  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1034, 256])
m.shape torch.Size([914, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.533022403717041  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.533022403717041  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 914, 256]), torch.Size([1, 914, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5347657203674316  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.560915470123291  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 914, 256])
m.shape torch.Size([702, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5622978210449219  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5622978210449219  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 702, 256]), torch.Size([1, 702, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5636367797851562  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.593968391418457  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 702, 256])
m.shape torch.Size([557, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5954403877258301  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5954403877258301  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5965027809143066  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.627312183380127  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([442, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6289052963256836  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6289052963256836  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6297483444213867  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6603918075561523  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([347, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6619715690612793  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6619715690612793  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6626334190368652  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6910929679870605  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([300, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6927804946899414  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6927804946899414  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6933526992797852  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7225275039672852  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([264, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.724271297454834  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.724271297454834  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7247748374938965  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7546525001525879  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([194, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7560791969299316  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7560791969299316  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7564492225646973  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7801308631896973  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([153, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7814164161682129  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7814164161682129  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7817082405090332  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8024277687072754  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([124, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8035931587219238  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8035931587219238  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8038296699523926  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8222775459289551  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([104, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8233590126037598  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8233590126037598  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8235573768615723  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8404183387756348  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([89, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8414316177368164  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8414316177368164  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8416013717651367  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8572187423706055  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.858156681060791  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.858156681060791  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8583016395568848  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.872652530670166  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8736758232116699  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8736758232116699  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8738207817077637  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8891863822937012  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8898830413818359  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8898830413818359  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8899784088134766  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9007549285888672  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9012956619262695  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9012956619262695  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9013643264770508  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9096040725708008  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9102964401245117  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9102964401245117  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9103765487670898  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9205503463745117  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.921149730682373  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.921149730682373  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9212164878845215  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9301619529724121  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9305710792541504  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9305710792541504  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9306149482727051  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.936800479888916  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9372835159301758  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9372835159301758  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9373311996459961  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9443883895874023  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9447665214538574  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9447665214538574  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9448027610778809  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9504199028015137  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9507555961608887  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9507555961608887  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9507861137390137  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9557299613952637  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9560146331787109  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9560146331787109  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9560394287109375  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9602298736572266  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([126, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9632453918457031  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9632453918457031  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9634857177734375  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0057830810546875  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 126, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9795441627502441  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.980402946472168  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9812617301940918  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9803595542907715  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([5761, 40])
input nodes number: 10821
output nodes number: 5761
edges number: 33015
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9804816246032715  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9804821014404297  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.017778396606445312  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

pseudo mini batch 7 input nodes size: 22856
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.015748977661132812  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.015748977661132812  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.026647567749023438  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.02669048309326172  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.01735401153564453  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.018163681030273438  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.018163681030273438  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.018163681030273438  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([22856, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.018163681030273438  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

m.shape torch.Size([1354, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.053086280822753906  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.053086280822753906  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1354, 128]), torch.Size([1, 1354, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.05437755584716797  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.06489849090576172  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1354, 128])
m.shape torch.Size([1426, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.06561279296875  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.06561279296875  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1426, 128]), torch.Size([1, 1426, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.06697273254394531  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.08744430541992188  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1426, 128])
m.shape torch.Size([1268, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.0885782241821289  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.0885782241821289  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1268, 128]), torch.Size([1, 1268, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.08978748321533203  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.11639118194580078  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1268, 128])
m.shape torch.Size([1085, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.11785602569580078  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.11785602569580078  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.11889076232910156  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.15068531036376953  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([975, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.15249252319335938  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.15249252319335938  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.15342235565185547  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.18696928024291992  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([807, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.1888132095336914  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.1888132095336914  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.18958282470703125  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.22267627716064453  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([679, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.22455787658691406  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.22455787658691406  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2252054214477539  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2583298683166504  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([582, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.26070117950439453  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.26070117950439453  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.26125621795654297  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2936525344848633  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([516, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2955894470214844  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.2955894470214844  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.29608154296875  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.32859230041503906  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([3371, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.3444204330444336  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.3444204330444336  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 3371, 128]), torch.Size([1, 3371, 128])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.34787750244140625  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5790376663208008  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 3371, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5494093894958496  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5609135627746582  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5724177360534668  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5608234405517578  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([12063, 256])
first layer input nodes number: 22856
first layer output nodes number: 12063
edges number: 69830
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5725903511047363  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5840945243835449  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5869708061218262  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.5869708061218262  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

m.shape torch.Size([901, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6253280639648438  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6253280639648438  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 901, 256]), torch.Size([1, 901, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6270465850830078  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6407947540283203  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 901, 256])
m.shape torch.Size([814, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6415014266967773  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6415014266967773  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 814, 256]), torch.Size([1, 814, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6430540084838867  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6663427352905273  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 814, 256])
m.shape torch.Size([660, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6678962707519531  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6678962707519531  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 660, 256]), torch.Size([1, 660, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6691551208496094  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.696894645690918  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 660, 256])
m.shape torch.Size([512, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6986846923828125  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6986846923828125  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.6996612548828125  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7279815673828125  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 512, 256])
m.shape torch.Size([437, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7295937538146973  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7295937538146973  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7304272651672363  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7611784934997559  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([359, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7628321647644043  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7628321647644043  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.763516902923584  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7930760383605957  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([281, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7946243286132812  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7946243286132812  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.7951602935791016  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8230404853820801  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([225, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8251667022705078  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8251667022705078  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8255958557128906  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8500576019287109  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([218, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8517289161682129  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8517289161682129  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.852144718170166  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.878756046295166  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([181, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8802881240844727  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8802881240844727  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.8806333541870117  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9051446914672852  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([159, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9066534042358398  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9066534042358398  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.906956672668457  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9306116104125977  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([119, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9318327903747559  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9318327903747559  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9320597648620605  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.951352596282959  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9525012969970703  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9525012969970703  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9526939392089844  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9704170227050781  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9713973999023438  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9713973999023438  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9715499877929688  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9866561889648438  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9877047538757324  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9877047538757324  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.9878535270690918  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0036234855651855  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.004641056060791  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.004641056060791  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0047764778137207  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0200791358947754  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0208940505981445  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0208940505981445  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0209970474243164  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0333566665649414  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0340495109558105  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0340495109558105  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0341315269470215  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0445475578308105  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.045346736907959  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.045346736907959  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0454344749450684  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0571913719177246  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0581474304199219  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0581474304199219  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0582466125488281  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0722312927246094  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.072646141052246  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.072646141052246  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0726900100708008  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0791826248168945  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0797104835510254  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0797104835510254  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0797600746154785  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.087446689605713  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0879969596862793  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0879969596862793  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0880465507507324  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0960803031921387  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0965170860290527  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.0965170860290527  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.096555233001709  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1030020713806152  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([267, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1093988418579102  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1093988418579102  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.109908103942871  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.2000846862792969  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 267, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1682219505310059  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.169079303741455  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1699366569519043  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1690363883972168  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([5753, 40])
input nodes number: 12063
output nodes number: 5753
edges number: 38765
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.1691679954528809  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 1.169168472290039  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.019766807556152344  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

pseudo mini batch 8 input nodes size: 65551
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.017352581024169922  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.017352581024169922  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.04860973358154297  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.048651695251464844  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.03771018981933594  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.04003334045410156  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.04003334045410156  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.04003334045410156  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

torch.Size([65551, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.04003334045410156  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

m.shape torch.Size([1167, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.16363286972045898  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.16363286972045898  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.16474580764770508  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.17364931106567383  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1255, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.17428970336914062  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.17428970336914062  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1255, 128]), torch.Size([1, 1255, 128])
----------------------------------------3
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.17548656463623047  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.19343948364257812  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1255, 128])
m.shape torch.Size([1334, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.1947493553161621  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.1947493553161621  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1334, 128]), torch.Size([1, 1334, 128])
----------------------------------------3
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.19602155685424805  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.2249598503112793  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1334, 128])
m.shape torch.Size([1170, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.22655534744262695  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.22655534744262695  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1170, 128]), torch.Size([1, 1170, 128])
----------------------------------------3
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.22767114639282227  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.26002931594848633  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1170, 128])
m.shape torch.Size([1105, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.26210594177246094  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.26210594177246094  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.26315975189208984  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.30165958404541016  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1148, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.30441713333129883  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.30441713333129883  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1148, 128]), torch.Size([1, 1148, 128])
----------------------------------------3
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.3055119514465332  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.35258913040161133  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1148, 128])
m.shape torch.Size([1072, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.3556199073791504  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.3556199073791504  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1072, 128]), torch.Size([1, 1072, 128])
----------------------------------------3
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.3566422462463379  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.4077591896057129  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1072, 128])
m.shape torch.Size([1024, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.41115427017211914  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.41115427017211914  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 1024, 128]), torch.Size([1, 1024, 128])
----------------------------------------3
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.41213083267211914  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.46791696548461914  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 1024, 128])
m.shape torch.Size([981, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.47163867950439453  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.47163867950439453  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 981, 128]), torch.Size([1, 981, 128])
----------------------------------------3
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.47257423400878906  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 0.533635139465332  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

rst.shape  torch.Size([1, 981, 128])
m.shape torch.Size([20241, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.3162841796875 GB
    Memory Allocated: 0.6296839714050293  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3162841796875 GB
    Memory Allocated: 0.6296839714050293  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

 h.shape torch.Size([1, 20241, 128]), torch.Size([1, 20241, 128])
----------------------------------------3
 Nvidia-smi: 3.3162841796875 GB
    Memory Allocated: 0.6492152214050293  GigaBytes
Max Memory Allocated: 1.607330322265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.0326290130615234  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

rst.shape  torch.Size([1, 20241, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 1.9166932106018066  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 1.945777416229248  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 1.9748616218566895  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 1.9455499649047852  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

torch.Size([30497, 256])
first layer input nodes number: 65551
first layer output nodes number: 30497
edges number: 251707
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 1.9753522872924805  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.004436492919922  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.0117077827453613  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.0117077827453613  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

m.shape torch.Size([651, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.070234775543213  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.070234775543213  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.071476459503174  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.0814099311828613  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

rst.shape  torch.Size([1, 651, 256])
m.shape torch.Size([574, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.0819268226623535  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.0819268226623535  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.083021640777588  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.100369930267334  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([511, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.1013293266296387  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.1013293266296387  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.102303981781006  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.124570369720459  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([354, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.125459671020508  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.125459671020508  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.1261348724365234  GigaBytes
Max Memory Allocated: 2.129145622253418  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.1479077339172363  GigaBytes
Max Memory Allocated: 2.1494240760803223  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([311, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.1490983963012695  GigaBytes
Max Memory Allocated: 2.1494240760803223  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.1490983963012695  GigaBytes
Max Memory Allocated: 2.1494240760803223  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.149691581726074  GigaBytes
Max Memory Allocated: 2.149691581726074  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.1715779304504395  GigaBytes
Max Memory Allocated: 2.173060894012451  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([247, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.172706127166748  GigaBytes
Max Memory Allocated: 2.173060894012451  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.172706127166748  GigaBytes
Max Memory Allocated: 2.173060894012451  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.1731772422790527  GigaBytes
Max Memory Allocated: 2.1731772422790527  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.1934351921081543  GigaBytes
Max Memory Allocated: 2.1953072547912598  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([201, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.195082187652588  GigaBytes
Max Memory Allocated: 2.1953072547912598  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.195082187652588  GigaBytes
Max Memory Allocated: 2.1953072547912598  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.195465564727783  GigaBytes
Max Memory Allocated: 2.195465564727783  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.214634418487549  GigaBytes
Max Memory Allocated: 2.2159762382507324  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([166, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.215719223022461  GigaBytes
Max Memory Allocated: 2.2159762382507324  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.215719223022461  GigaBytes
Max Memory Allocated: 2.2159762382507324  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.216035842895508  GigaBytes
Max Memory Allocated: 2.216035842895508  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2340831756591797  GigaBytes
Max Memory Allocated: 2.235349655151367  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2353005409240723  GigaBytes
Max Memory Allocated: 2.235349655151367  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2353005409240723  GigaBytes
Max Memory Allocated: 2.235349655151367  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2356038093566895  GigaBytes
Max Memory Allocated: 2.2356038093566895  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2550129890441895  GigaBytes
Max Memory Allocated: 2.256377696990967  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.256303310394287  GigaBytes
Max Memory Allocated: 2.256377696990967  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.256303310394287  GigaBytes
Max Memory Allocated: 2.256377696990967  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.256589412689209  GigaBytes
Max Memory Allocated: 2.256589412689209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.276902675628662  GigaBytes
Max Memory Allocated: 2.2783331871032715  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2781553268432617  GigaBytes
Max Memory Allocated: 2.2783331871032715  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2781553268432617  GigaBytes
Max Memory Allocated: 2.2783331871032715  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.278407096862793  GigaBytes
Max Memory Allocated: 2.278407096862793  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2980451583862305  GigaBytes
Max Memory Allocated: 2.2994298934936523  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([119, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2992920875549316  GigaBytes
Max Memory Allocated: 2.2994298934936523  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2992920875549316  GigaBytes
Max Memory Allocated: 2.2994298934936523  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.2995190620422363  GigaBytes
Max Memory Allocated: 2.2995190620422363  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3188118934631348  GigaBytes
Max Memory Allocated: 2.320173740386963  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([108, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3200478553771973  GigaBytes
Max Memory Allocated: 2.320173740386963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3200478553771973  GigaBytes
Max Memory Allocated: 2.320173740386963  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.320253849029541  GigaBytes
Max Memory Allocated: 2.320253849029541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.339205265045166  GigaBytes
Max Memory Allocated: 2.3405442237854004  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([95, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3403806686401367  GigaBytes
Max Memory Allocated: 2.3405442237854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3403806686401367  GigaBytes
Max Memory Allocated: 2.3405442237854004  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.340561866760254  GigaBytes
Max Memory Allocated: 2.340561866760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3585004806518555  GigaBytes
Max Memory Allocated: 2.359768867492676  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([96, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3597941398620605  GigaBytes
Max Memory Allocated: 2.359799861907959  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3597941398620605  GigaBytes
Max Memory Allocated: 2.359799861907959  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3599772453308105  GigaBytes
Max Memory Allocated: 2.3599772453308105  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3793864250183105  GigaBytes
Max Memory Allocated: 2.3807597160339355  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([94, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3807406425476074  GigaBytes
Max Memory Allocated: 2.3807597160339355  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.3807406425476074  GigaBytes
Max Memory Allocated: 2.3807597160339355  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.380919933319092  GigaBytes
Max Memory Allocated: 2.380919933319092  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.401179790496826  GigaBytes
Max Memory Allocated: 2.402614116668701  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.402095317840576  GigaBytes
Max Memory Allocated: 2.402614116668701  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.402095317840576  GigaBytes
Max Memory Allocated: 2.402614116668701  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.4022116661071777  GigaBytes
Max Memory Allocated: 2.402614116668701  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.4161734580993652  GigaBytes
Max Memory Allocated: 2.417243480682373  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([84, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.4175686836242676  GigaBytes
Max Memory Allocated: 2.417574405670166  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.4175686836242676  GigaBytes
Max Memory Allocated: 2.417574405670166  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.417728900909424  GigaBytes
Max Memory Allocated: 2.417728900909424  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.4380764961242676  GigaBytes
Max Memory Allocated: 2.439518451690674  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([71, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.439293384552002  GigaBytes
Max Memory Allocated: 2.439518451690674  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.439293384552002  GigaBytes
Max Memory Allocated: 2.439518451690674  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.4394288063049316  GigaBytes
Max Memory Allocated: 2.439518451690674  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.4575753211975098  GigaBytes
Max Memory Allocated: 2.458861827850342  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.458655834197998  GigaBytes
Max Memory Allocated: 2.458861827850342  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.458655834197998  GigaBytes
Max Memory Allocated: 2.458861827850342  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.4587645530700684  GigaBytes
Max Memory Allocated: 2.458861827850342  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.4740939140319824  GigaBytes
Max Memory Allocated: 2.4751811027526855  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.475311279296875  GigaBytes
Max Memory Allocated: 2.4753165245056152  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.475311279296875  GigaBytes
Max Memory Allocated: 2.4753165245056152  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.475431442260742  GigaBytes
Max Memory Allocated: 2.475431442260742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.493215560913086  GigaBytes
Max Memory Allocated: 2.4944772720336914  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.494339942932129  GigaBytes
Max Memory Allocated: 2.4944772720336914  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.494339942932129  GigaBytes
Max Memory Allocated: 2.4944772720336914  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.4944467544555664  GigaBytes
Max Memory Allocated: 2.4944772720336914  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.511002540588379  GigaBytes
Max Memory Allocated: 2.5131454467773438  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.5117673873901367  GigaBytes
Max Memory Allocated: 2.5131454467773438  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.5117673873901367  GigaBytes
Max Memory Allocated: 2.5131454467773438  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.511837959289551  GigaBytes
Max Memory Allocated: 2.5131454467773438  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.523270606994629  GigaBytes
Max Memory Allocated: 2.5240821838378906  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.524313449859619  GigaBytes
Max Memory Allocated: 2.524317741394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.524313449859619  GigaBytes
Max Memory Allocated: 2.524317741394043  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.52439546585083  GigaBytes
Max Memory Allocated: 2.52439546585083  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.5382561683654785  GigaBytes
Max Memory Allocated: 2.5392403602600098  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([1141, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.56563138961792  GigaBytes
Max Memory Allocated: 2.565737724304199  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.56563138961792  GigaBytes
Max Memory Allocated: 2.565737724304199  GigaBytes

 h.shape torch.Size([1, 1141, 256]), torch.Size([1, 1141, 256])
----------------------------------------3
 Nvidia-smi: 4.1951904296875 GB
    Memory Allocated: 2.5686001777648926  GigaBytes
Max Memory Allocated: 2.5686001777648926  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2420654296875 GB
    Memory Allocated: 2.952353000640869  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 1141, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.2420654296875 GB
    Memory Allocated: 2.899538040161133  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.2420654296875 GB
    Memory Allocated: 2.9003701210021973  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.2420654296875 GB
    Memory Allocated: 2.9012022018432617  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.2420654296875 GB
    Memory Allocated: 2.9003281593322754  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

torch.Size([5581, 40])
input nodes number: 30497
output nodes number: 5581
edges number: 60010
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2420654296875 GB
    Memory Allocated: 2.9005722999572754  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2420654296875 GB
    Memory Allocated: 2.9005727767944336  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.044013023376464844  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

pseudo mini batch 9 input nodes size: 63885
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.03768491744995117  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.03768491744995117  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.06814765930175781  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.06818914413452148  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.03689002990722656  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.038550376892089844  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.038550376892089844  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.038550376892089844  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

torch.Size([63885, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.038550376892089844  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

m.shape torch.Size([1559, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.12819766998291016  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.12819766998291016  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 1559, 128]), torch.Size([1, 1559, 128])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.1296844482421875  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.14157867431640625  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 1559, 128])
m.shape torch.Size([1711, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.14246702194213867  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.14246702194213867  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 1711, 128]), torch.Size([1, 1711, 128])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.14409875869750977  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.16919279098510742  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 1711, 128])
m.shape torch.Size([1484, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.1704998016357422  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.1704998016357422  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 1484, 128]), torch.Size([1, 1484, 128])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.17191505432128906  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.203277587890625  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 1484, 128])
m.shape torch.Size([1293, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.20503616333007812  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.20503616333007812  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 1293, 128]), torch.Size([1, 1293, 128])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.2062692642211914  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.24202919006347656  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 1293, 128])
m.shape torch.Size([1180, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.24422597885131836  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.24422597885131836  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 1180, 128]), torch.Size([1, 1180, 128])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.24535131454467773  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.2869429588317871  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 1180, 128])
m.shape torch.Size([1068, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.28943586349487305  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.28943586349487305  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.2904543876647949  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.33518552780151367  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([977, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.3379373550415039  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.3379373550415039  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.3388690948486328  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.38639259338378906  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([914, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.38941335678100586  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.38941335678100586  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.39028501510620117  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.44055891036987305  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([822, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.4436507225036621  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.4436507225036621  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.44443464279174805  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.49532270431518555  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([13322, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.5584549903869629  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.5584549903869629  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 13322, 128]), torch.Size([1, 13322, 128])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.571159839630127  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.4831576347351074  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 13322, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.4003634452819824  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.4237818717956543  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.4469847679138184  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.423384666442871  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

torch.Size([24330, 256])
first layer input nodes number: 63885
first layer output nodes number: 24330
edges number: 181682
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.447463035583496  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.4706659317016602  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.4764666557312012  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.4764666557312012  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

m.shape torch.Size([954, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5170917510986328  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5170917510986328  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 954, 256]), torch.Size([1, 954, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.518911361694336  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5340418815612793  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 954, 256])
m.shape torch.Size([845, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.535079002380371  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.535079002380371  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 845, 256]), torch.Size([1, 845, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5366907119750977  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5616254806518555  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 845, 256])
m.shape torch.Size([567, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5628838539123535  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5628838539123535  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5639653205871582  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5887370109558105  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5899877548217773  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5899877548217773  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.5908594131469727  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.616445541381836  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([355, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.617715835571289  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.617715835571289  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6183929443359375  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.643608570098877  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([290, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6449427604675293  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6449427604675293  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.645495891571045  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6703028678894043  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([237, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6716208457946777  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6716208457946777  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6720728874206543  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6946749687194824  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([207, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6960406303405762  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6960406303405762  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.6964354515075684  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.718940258026123  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([164, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7201619148254395  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7201619148254395  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7204747200012207  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7404942512512207  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([144, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7417221069335938  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7417221069335938  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7419967651367188  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7614974975585938  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.762777328491211  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.762777328491211  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7630329132080078  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.782968521118164  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7841897010803223  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.7841897010803223  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.784376621246338  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.800264835357666  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8011088371276855  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8011088371276855  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8012518882751465  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8144125938415527  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8153648376464844  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8153648376464844  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8155059814453125  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8294792175292969  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8303027153015137  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8303027153015137  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.830420970916748  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8429560661315918  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8438043594360352  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8438043594360352  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.843916893005371  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.856633186340332  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8572797775268555  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8572797775268555  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8573617935180664  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.867203712463379  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8678550720214844  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8678550720214844  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8679313659667969  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8776206970214844  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8784594535827637  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8784594535827637  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8785510063171387  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8908190727233887  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8917346000671387  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8917346000671387  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.8918299674987793  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9052767753601074  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9060368537902832  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9060368537902832  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9061131477355957  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9174046516418457  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9178743362426758  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9178743362426758  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9179201126098633  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9250154495239258  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.925611972808838  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.925611972808838  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9256653785705566  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9343171119689941  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9348440170288086  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9348440170288086  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.934889793395996  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9426259994506836  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([507, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9555249214172363  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9555249214172363  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 1.9564919471740723  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.1279282569885254  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 507, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.093416690826416  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.094240188598633  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.0950636863708496  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.094198703765869  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

torch.Size([5526, 40])
input nodes number: 24330
output nodes number: 5526
edges number: 41080
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.0944132804870605  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 2.0944137573242188  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.04159259796142578  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

pseudo mini batch 10 input nodes size: 56790
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.036881446838378906  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.036881446838378906  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.0642251968383789  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.0642690658569336  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.03376483917236328  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.036304473876953125  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.036304473876953125  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.036304473876953125  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

torch.Size([56790, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 0.036304473876953125  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

m.shape torch.Size([870, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.1648087501525879  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.1648087501525879  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.16563844680786133  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.17227602005004883  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([961, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.17277765274047852  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.17277765274047852  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.17369413375854492  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.18744134902954102  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([914, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.18834495544433594  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.18834495544433594  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.18921661376953125  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.20839309692382812  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([918, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.20970821380615234  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.20970821380615234  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.21058368682861328  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.23597240447998047  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 918, 128])
m.shape torch.Size([939, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.23777341842651367  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.23777341842651367  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 939, 128]), torch.Size([1, 939, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.23866891860961914  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.27113771438598633  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 939, 128])
m.shape torch.Size([922, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.2733278274536133  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.2733278274536133  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.27420711517333984  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.3131074905395508  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([918, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.3157320022583008  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.3157320022583008  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.3166074752807617  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.36133766174316406  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 918, 128])
m.shape torch.Size([932, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.3644552230834961  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.3644552230834961  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.3653440475463867  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.4160909652709961  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([903, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.4195218086242676  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.4195218086242676  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 903, 128]), torch.Size([1, 903, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.4203829765319824  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.47635841369628906  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 903, 128])
m.shape torch.Size([22031, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.5809798240661621  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.5809798240661621  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 22031, 128]), torch.Size([1, 22031, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.6019902229309082  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.108895778656006  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 22031, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 1.9872684478759766  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.016172409057617  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.045076370239258  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.015946388244629  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

torch.Size([30308, 256])
first layer input nodes number: 56790
first layer output nodes number: 30308
edges number: 261752
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.045501708984375  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.0744056701660156  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.081631660461426  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.081631660461426  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

m.shape torch.Size([506, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.158292770385742  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.158292770385742  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.1592578887939453  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.1691269874572754  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([437, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.1694846153259277  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.1694846153259277  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.170318126678467  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.1829538345336914  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([332, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.1834945678710938  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.1834945678710938  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.1841278076171875  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.198866844177246  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([279, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.1997323036193848  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.1997323036193848  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.2002644538879395  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.2179055213928223  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([271, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.218942165374756  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.218942165374756  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.219459056854248  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.239096164703369  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([201, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.240485191345215  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.240485191345215  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.24086856842041  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.2573537826538086  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([190, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.2584404945373535  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.2584404945373535  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.258802890777588  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.2769227027893066  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([173, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.278071880340576  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.278071880340576  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.2784018516540527  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.297210216522217  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.2984209060668945  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.2984209060668945  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.2987241744995117  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3181333541870117  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([163, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3195486068725586  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3195486068725586  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.319859504699707  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.341933250427246  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([128, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3431310653686523  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3431310653686523  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3433752059936523  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3624181747436523  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([135, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3638534545898438  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3638534545898438  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3641109466552734  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.385997772216797  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([128, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3874683380126953  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3874683380126953  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.3877124786376953  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.4101734161376953  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([108, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.412395477294922  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.412395477294922  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.4126014709472656  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.432994842529297  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.4343481063842773  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.4343481063842773  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.4345407485961914  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.454960823059082  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([100, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.45640230178833  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.45640230178833  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.4565930366516113  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.4781460762023926  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([103, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.479733943939209  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.479733943939209  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.4799304008483887  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.503505229949951  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([97, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.5050854682922363  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.5050854682922363  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.505270481109619  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.5287671089172363  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([86, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.530245304107666  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.530245304107666  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.530409336090088  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.552389621734619  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([84, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.553922653198242  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.553922653198242  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.5540828704833984  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.5766735076904297  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([90, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.5784101486206055  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.5784101486206055  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.5785818099975586  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.603987693786621  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([64, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.605255126953125  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.605255126953125  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.605377197265625  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.624298095703125  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([76, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.625917434692383  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.625917434692383  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.6260623931884766  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.649545669555664  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.6510419845581055  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.6510419845581055  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 2.6511716842651367  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 2.673090934753418  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([1775, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 2.7156763076782227  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 2.7156763076782227  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

 h.shape torch.Size([1, 1775, 256]), torch.Size([1, 1775, 256])
----------------------------------------3
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 2.719061851501465  GigaBytes
Max Memory Allocated: 2.979696750640869  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 3.3269519805908203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1775, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 3.2560501098632812  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1893310546875 GB
    Memory Allocated: 3.256922721862793  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1912841796875 GB
    Memory Allocated: 3.2577953338623047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.1912841796875 GB
    Memory Allocated: 3.2568788528442383  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([5854, 40])
input nodes number: 30308
output nodes number: 5854
edges number: 79011
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1912841796875 GB
    Memory Allocated: 3.257197856903076  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1912841796875 GB
    Memory Allocated: 3.2571983337402344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0406498908996582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

pseudo mini batch 11 input nodes size: 55084
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0338139533996582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0338139533996582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06008005142211914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06012153625488281  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.032733917236328125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.034709930419921875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.034709930419921875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.034709930419921875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([55084, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.034709930419921875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([1254, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.13776588439941406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.13776588439941406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1254, 128]), torch.Size([1, 1254, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1389617919921875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14928865432739258  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1254, 128])
m.shape torch.Size([1260, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14989233016967773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14989233016967773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1260, 128]), torch.Size([1, 1260, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1510939598083496  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16911840438842773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1260, 128])
m.shape torch.Size([1212, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.17051076889038086  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.17051076889038086  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1212, 128]), torch.Size([1, 1212, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.17166662216186523  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.19709539413452148  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1212, 128])
m.shape torch.Size([1018, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.19863080978393555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.19863080978393555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1996016502380371  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.22775602340698242  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([979, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.22960472106933594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.22960472106933594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23053836822509766  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.26500797271728516  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([879, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2670559883117676  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2670559883117676  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.26789426803588867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.30507612228393555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([863, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3075375556945801  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3075375556945801  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.30836057662963867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3496584892272949  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([773, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.35219573974609375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.35219573974609375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3529329299926758  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3955097198486328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([747, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3983469009399414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3983469009399414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3990592956542969  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.44525575637817383  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([16896, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5254659652709961  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5254659652709961  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 16896, 128]), torch.Size([1, 16896, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5415792465209961  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.687331199645996  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 16896, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.591202735900879  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.616593360900879  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.641275405883789  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6156916618347168  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([25881, 256])
first layer input nodes number: 55084
first layer output nodes number: 25881
edges number: 209559
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6416878700256348  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6670784950256348  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.673205852508545  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.673205852508545  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([794, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7274847030639648  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7274847030639648  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 794, 256]), torch.Size([1, 794, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.728999137878418  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7422819137573242  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 794, 256])
m.shape torch.Size([619, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7428159713745117  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7428159713745117  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7439966201782227  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7636280059814453  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 619, 256])
m.shape torch.Size([519, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7645344734191895  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7645344734191895  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7655243873596191  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7889046669006348  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([375, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7898592948913574  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7898592948913574  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.790574550628662  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8122153282165527  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([307, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8133330345153809  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8133330345153809  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8139185905456543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8350281715393066  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([246, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8368983268737793  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8368983268737793  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8373675346374512  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8575434684753418  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([194, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.858614444732666  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.858614444732666  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8589844703674316  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.877485752105713  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([147, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8784313201904297  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8784313201904297  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8787117004394531  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.894693374633789  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([153, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8958768844604492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8958768844604492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8961687088012695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9148454666137695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([126, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9159107208251953  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9159107208251953  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9161510467529297  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9332141876220703  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([117, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9350085258483887  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9350085258483887  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9352316856384277  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9526381492614746  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([123, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9539456367492676  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9539456367492676  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9541802406311035  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9741215705871582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.975266456604004  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.975266456604004  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.975459098815918  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9931821823120117  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9940547943115234  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9940547943115234  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.994192123413086  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0077877044677734  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.008816719055176  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.008816719055176  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0089616775512695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.024327278137207  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.025343418121338  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.025343418121338  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.025473117828369  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0401291847229004  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([76, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.041306495666504  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.041306495666504  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0414514541625977  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0588464736938477  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.059950828552246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.059950828552246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0600805282592773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.076552391052246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0776095390319824  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0776095390319824  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.07771635055542  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.092029094696045  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0937609672546387  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0937609672546387  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.093869686126709  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.109199047088623  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([57, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.110295295715332  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.110295295715332  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1104040145874023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1264944076538086  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1270322799682617  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1270322799682617  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1270856857299805  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1353635787963867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1361770629882812  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1361770629882812  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.136249542236328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.147991180419922  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1489720344543457  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1489720344543457  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1490559577941895  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.163239002227783  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([1056, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.188784599304199  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.188784599304199  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1056, 256]), torch.Size([1, 1056, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.190798759460449  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.556624412536621  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1056, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.5074844360351562  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.5083069801330566  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.509129524230957  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.508265495300293  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([5517, 40])
input nodes number: 25881
output nodes number: 5517
edges number: 55446
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.5084500312805176  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.508450508117676  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03810262680053711  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

pseudo mini batch 12 input nodes size: 59330
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0326838493347168  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0326838493347168  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0609745979309082  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.061016082763671875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.034708499908447266  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03658342361450195  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03658342361450195  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03658342361450195  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([59330, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03658342361450195  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([1371, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.13540124893188477  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.13540124893188477  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1371, 128]), torch.Size([1, 1371, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.13670873641967773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14716863632202148  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1371, 128])
m.shape torch.Size([1488, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14846372604370117  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14846372604370117  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1488, 128]), torch.Size([1, 1488, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14988279342651367  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.17125749588012695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1488, 128])
m.shape torch.Size([1275, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1728672981262207  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1728672981262207  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1275, 128]), torch.Size([1, 1275, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.17408323287963867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.20083379745483398  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1275, 128])
m.shape torch.Size([1193, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2025012969970703  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2025012969970703  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1193, 128]), torch.Size([1, 1193, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.20363903045654297  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23663330078125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1193, 128])
m.shape torch.Size([1098, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23868227005004883  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23868227005004883  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2397294044494629  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.278109073638916  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([918, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2802119255065918  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2802119255065918  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.28108739852905273  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3190035820007324  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 918, 128])
m.shape torch.Size([920, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3216366767883301  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3216366767883301  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.32251405715942383  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3672909736633301  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([851, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3700985908508301  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3700985908508301  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3709101676940918  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.4172234535217285  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([857, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.42049551010131836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.42049551010131836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.4213128089904785  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.4736199378967285  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([15581, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5475072860717773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5475072860717773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 15581, 128]), torch.Size([1, 15581, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5623664855957031  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6173696517944336  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 15581, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5259332656860352  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5503015518188477  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5746698379516602  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5501108169555664  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([25552, 256])
first layer input nodes number: 59330
first layer output nodes number: 25552
edges number: 200713
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5751142501831055  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.599482536315918  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.605574607849121  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.605574607849121  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([865, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.655834674835205  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.655834674835205  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 865, 256]), torch.Size([1, 865, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.657484531402588  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6712512969970703  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 865, 256])
m.shape torch.Size([729, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.671949863433838  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.671949863433838  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 729, 256]), torch.Size([1, 729, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6733403205871582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6943917274475098  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 729, 256])
m.shape torch.Size([524, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6952323913574219  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6952323913574219  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 524, 256]), torch.Size([1, 524, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6962318420410156  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7190699577331543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 524, 256])
m.shape torch.Size([434, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7204594612121582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7204594612121582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7212872505187988  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7484002113342285  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([312, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7495489120483398  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7495489120483398  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7501440048217773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7773914337158203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([255, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.778564453125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.778564453125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7790508270263672  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7999649047851562  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([188, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8009867668151855  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8009867668151855  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8013453483581543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8192744255065918  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([154, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.820279598236084  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.820279598236084  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.820573329925537  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8373160362243652  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([166, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8386054039001465  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8386054039001465  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8389220237731934  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8591856956481934  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([125, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8602290153503418  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8602290153503418  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8604674339294434  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8773951530456543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.87846040725708  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.87846040725708  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.878674030303955  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.895336627960205  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([103, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8964180946350098  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8964180946350098  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8966145515441895  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.913313388824463  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([84, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.914289951324463  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.914289951324463  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9144501686096191  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9291901588439941  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9299445152282715  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9299445152282715  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9300627708435059  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.941770076751709  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9426484107971191  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9426484107971191  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.942772388458252  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.95591402053833  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9567594528198242  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9567594528198242  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9568719863891602  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.969588279724121  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9703330993652344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9703330993652344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9704265594482422  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9816417694091797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9826254844665527  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9826254844665527  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9827361106872559  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9967856407165527  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9978046417236328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9978046417236328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9979076385498047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.011709213256836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.012561321258545  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.012561321258545  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.012650966644287  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0252909660339355  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0258116722106934  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0258116722106934  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.025865077972412  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.033769130706787  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.034461498260498  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.034461498260498  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0345263481140137  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0445780754089355  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.045032024383545  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.045032024383545  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.045073986053467  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0518717765808105  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0525660514831543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0525660514831543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0526251792907715  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.062617778778076  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([958, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0856075286865234  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0856075286865234  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 958, 256]), torch.Size([1, 958, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.087434768676758  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.4093570709228516  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 958, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.364759922027588  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.3655824661254883  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.3664050102233887  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.3655409812927246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([5518, 40])
input nodes number: 25552
output nodes number: 5518
edges number: 50739
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.3657732009887695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.3657736778259277  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03991413116455078  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

pseudo mini batch 13 input nodes size: 43103
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.034708499908447266  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.034708499908447266  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.05526161193847656  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.05530357360839844  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.02697134017944336  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.028249263763427734  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.028249263763427734  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.028249263763427734  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([43103, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.028249263763427734  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([1578, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0936427116394043  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0936427116394043  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1578, 128]), torch.Size([1, 1578, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.09514760971069336  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.10718679428100586  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1578, 128])
m.shape torch.Size([1541, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1082620620727539  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1082620620727539  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1541, 128]), torch.Size([1, 1541, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.10973167419433594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1317758560180664  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1541, 128])
m.shape torch.Size([1226, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.13295602798461914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.13295602798461914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1226, 128]), torch.Size([1, 1226, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1341252326965332  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.15984773635864258  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1226, 128])
m.shape torch.Size([1111, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16138219833374023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16138219833374023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16244173049926758  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.19370794296264648  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([1028, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.19562911987304688  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.19562911987304688  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1966094970703125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23192214965820312  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([878, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23394393920898438  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23394393920898438  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23478126525878906  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2707862854003906  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([801, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2730412483215332  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2730412483215332  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2738051414489746  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.31255149841308594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([753, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.31504201889038086  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.31504201889038086  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.31576013565063477  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3578639030456543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([665, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.36035871505737305  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.36035871505737305  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3609929084777832  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.40265655517578125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([9121, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.4458317756652832  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.4458317756652832  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 9121, 128]), torch.Size([1, 9121, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.4545302391052246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0721211433410645  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 9121, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0133824348449707  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0312180519104004  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.04905366897583  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0310783386230469  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([18702, 256])
first layer input nodes number: 43103
first layer output nodes number: 18702
edges number: 132016
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0493769645690918  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0672125816345215  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.071671485900879  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.071671485900879  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([1053, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1108026504516602  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1108026504516602  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1053, 256]), torch.Size([1, 1053, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.113051414489746  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1323766708374023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1053, 256])
m.shape torch.Size([866, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1329889297485352  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1329889297485352  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 866, 256]), torch.Size([1, 866, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1346406936645508  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1598458290100098  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 866, 256])
m.shape torch.Size([577, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1611676216125488  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1611676216125488  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1622681617736816  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1864800453186035  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([447, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.188077449798584  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.188077449798584  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1889300346374512  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2188048362731934  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([383, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.220527172088623  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.220527172088623  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2212576866149902  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.257056713104248  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([312, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2588400840759277  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2588400840759277  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2594351768493652  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.287306308746338  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2886638641357422  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2886638641357422  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.289133071899414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3125934600830078  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([216, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3140196800231934  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3140196800231934  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3144316673278809  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3379149436950684  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3390846252441406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3390846252441406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3393878936767578  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3587970733642578  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3600778579711914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3600778579711914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3603620529174805  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.380539894104004  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([126, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.381730079650879  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.381730079650879  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3819704055786133  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4007158279418945  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([96, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.401702880859375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.401702880859375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.401885986328125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.417449951171875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4182209968566895  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4182209968566895  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4183526039123535  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4304604530334473  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4312291145324707  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4312291145324707  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.431347370147705  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4430546760559082  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.443903923034668  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.443903923034668  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4440240859985352  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.456761360168457  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4575934410095215  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4575934410095215  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4577040672302246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4702048301696777  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4709992408752441  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4709992408752441  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4710984230041504  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4830002784729004  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4837985038757324  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4837985038757324  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4838919639587402  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4957613945007324  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.496518611907959  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.496518611907959  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4966025352478027  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5078482627868652  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5085945129394531  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5085945129394531  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5086727142333984  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5196990966796875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5204071998596191  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5204071998596191  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5204777717590332  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5309224128723145  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5313949584960938  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5313949584960938  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5314407348632812  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5385360717773438  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5389113426208496  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5389113426208496  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5389456748962402  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5445075035095215  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5451593399047852  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5451593399047852  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5452146530151367  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5545625686645508  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([435, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5649871826171875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5649871826171875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.565816879272461  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7145328521728516  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 435, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6809115409851074  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6817479133605957  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.682584285736084  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6817059516906738  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([5611, 40])
input nodes number: 18702
output nodes number: 5611
edges number: 39350
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.681901454925537  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6819019317626953  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.030638694763183594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

pseudo mini batch 14 input nodes size: 32259
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.02698516845703125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.02698516845703125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04236745834350586  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.042410850524902344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.021815776824951172  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.022740840911865234  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.022740840911865234  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.022740840911865234  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([32259, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.022740840911865234  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([1563, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06598949432373047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06598949432373047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1563, 128]), torch.Size([1, 1563, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06748008728027344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.07940483093261719  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1563, 128])
m.shape torch.Size([1636, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.08032369613647461  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.08032369613647461  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1636, 128]), torch.Size([1, 1636, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.08188390731811523  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.10528707504272461  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1636, 128])
m.shape torch.Size([1526, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1066899299621582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1066899299621582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1526, 128]), torch.Size([1, 1526, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.10814523696899414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14016199111938477  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1526, 128])
m.shape torch.Size([1328, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14219141006469727  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14219141006469727  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1328, 128]), torch.Size([1, 1328, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14345788955688477  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.18018579483032227  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1328, 128])
m.shape torch.Size([1197, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.18240642547607422  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.18240642547607422  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1197, 128]), torch.Size([1, 1197, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1835479736328125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.22464370727539062  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1197, 128])
m.shape torch.Size([962, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.22682523727416992  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.22682523727416992  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.22774267196655273  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2674250602722168  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([802, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.26964330673217773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.26964330673217773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.27040815353393555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.30912113189697266  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([739, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3115577697753906  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3115577697753906  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.31226253509521484  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.35321998596191406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([576, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.35533952713012695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.35533952713012695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.35588884353637695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.39269256591796875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([4343, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.41312694549560547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.41312694549560547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 4343, 128]), torch.Size([1, 4343, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.41780853271484375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.726201057434082  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 4343, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6890029907226562  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7029953002929688  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7169876098632812  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.702885627746582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([14672, 256])
first layer input nodes number: 32259
first layer output nodes number: 14672
edges number: 86622
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7172303199768066  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7312226295471191  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7347207069396973  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7347207069396973  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([995, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7719435691833496  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7719435691833496  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 995, 256]), torch.Size([1, 995, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.773841381072998  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7890238761901855  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 995, 256])
m.shape torch.Size([825, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7898306846618652  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7898306846618652  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 825, 256]), torch.Size([1, 825, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7914042472839355  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8151717185974121  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 825, 256])
m.shape torch.Size([681, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8164410591125488  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8164410591125488  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 681, 256]), torch.Size([1, 681, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8177399635314941  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8468117713928223  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 681, 256])
m.shape torch.Size([518, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8486232757568359  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8486232757568359  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 518, 256]), torch.Size([1, 518, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8496112823486328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8782634735107422  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 518, 256])
m.shape torch.Size([498, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8801627159118652  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8801627159118652  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8811125755310059  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9158415794372559  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([342, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9173393249511719  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9173393249511719  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9179916381835938  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9468898773193359  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([260, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9483132362365723  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9483132362365723  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9488091468811035  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9737381935119629  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([247, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9753894805908203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9753894805908203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.975860595703125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0027141571044922  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([193, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0041484832763672  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0041484832763672  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0045166015625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.028076171875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0293245315551758  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0293245315551758  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0296087265014648  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0497865676879883  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0508289337158203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0508289337158203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0510425567626953  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0677051544189453  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([115, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.068924903869629  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.068924903869629  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0691442489624023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0877885818481445  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0889410972595215  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0889410972595215  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0891337394714355  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1068568229675293  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1078505516052246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1078505516052246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1080050468444824  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1233000755310059  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1241745948791504  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1241745948791504  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.124300479888916  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1376442909240723  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1384272575378418  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1384272575378418  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1385321617126465  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1503863334655762  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1510858535766602  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1510858535766602  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1511735916137695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1617021560668945  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1624889373779297  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1624889373779297  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1625804901123047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1742076873779297  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.174929141998291  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.174929141998291  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1750092506408691  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.185743808746338  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1864538192749023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1864538192749023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.186528205871582  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.197016716003418  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1973834037780762  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1973834037780762  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.1974215507507324  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2030673027038574  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2034711837768555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2034711837768555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2035093307495117  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2094221115112305  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2099781036376953  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2099781036376953  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2100276947021484  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2180614471435547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2185673713684082  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2185673713684082  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.218611240386963  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.226025104522705  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([280, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2327313423156738  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2327313423156738  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2332653999328613  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.3288788795471191  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 280, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2982478141784668  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2991094589233398  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.299971103668213  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2990660667419434  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([5782, 40])
input nodes number: 14672
output nodes number: 5782
edges number: 37488
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2992444038391113  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.2992448806762695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.024605751037597656  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

pseudo mini batch 15 input nodes size: 26218
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.021841049194335938  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.021841049194335938  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03434276580810547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03438568115234375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.018959999084472656  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0196990966796875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0196990966796875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0196990966796875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([26218, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0196990966796875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([1519, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.05321645736694336  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.05321645736694336  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1519, 128]), torch.Size([1, 1519, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.05466508865356445  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0662541389465332  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1519, 128])
m.shape torch.Size([1682, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06713390350341797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06713390350341797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1682, 128]), torch.Size([1, 1682, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06873798370361328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.09363842010498047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1682, 128])
m.shape torch.Size([1399, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.09559059143066406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.09559059143066406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1399, 128]), torch.Size([1, 1399, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0969247817993164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.12712955474853516  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1399, 128])
m.shape torch.Size([1166, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.12868642807006836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.12868642807006836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1166, 128]), torch.Size([1, 1166, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.12979841232299805  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16289663314819336  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1166, 128])
m.shape torch.Size([1026, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16478681564331055  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16478681564331055  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1026, 128]), torch.Size([1, 1026, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16576528549194336  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2009902000427246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1026, 128])
m.shape torch.Size([765, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.20268964767456055  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.20268964767456055  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.20341920852661133  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2358708381652832  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([669, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23773908615112305  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23773908615112305  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23837709426879883  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2711491584777832  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([540, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2728900909423828  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2728900909423828  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2734050750732422  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3033924102783203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([464, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3051261901855469  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3051261901855469  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3055686950683594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3338890075683594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([3011, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3480253219604492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3480253219604492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 3011, 128]), torch.Size([1, 3011, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.35114574432373047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5645537376403809  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 3011, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5360221862792969  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5476961135864258  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5593700408935547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5476045608520508  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([12241, 256])
first layer input nodes number: 26218
first layer output nodes number: 12241
edges number: 66753
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5595674514770508  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5712413787841797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.574160099029541  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.574160099029541  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([1073, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6074962615966797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6074962615966797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1073, 256]), torch.Size([1, 1073, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6097044944763184  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6263327598571777  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1073, 256])
m.shape torch.Size([941, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6272187232971191  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6272187232971191  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 941, 256]), torch.Size([1, 941, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6290135383605957  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6569628715515137  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 941, 256])
m.shape torch.Size([728, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6581649780273438  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6581649780273438  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 728, 256]), torch.Size([1, 728, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6595535278320312  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6901016235351562  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 728, 256])
m.shape torch.Size([563, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6922931671142578  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6922931671142578  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.6933670043945312  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7247104644775391  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([500, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7265768051147461  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7265768051147461  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7275304794311523  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7618932723999023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([315, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7637958526611328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7637958526611328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7643966674804688  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7910528182983398  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([272, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7925825119018555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7925825119018555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.7931013107299805  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8201208114624023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([206, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8214454650878906  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8214454650878906  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.82183837890625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8442344665527344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([177, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8455691337585449  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8455691337585449  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8459067344665527  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8675131797790527  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8687863349914551  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8687863349914551  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.869072437286377  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8893857002258301  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([104, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8903422355651855  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.8903422355651855  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.890540599822998  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.906013011932373  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([95, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9070096015930176  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9070096015930176  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9071907997131348  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9225926399230957  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9236893653869629  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9236893653869629  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9238705635070801  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9405407905578613  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.941500186920166  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.941500186920166  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9416489601135254  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9563775062561035  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9570960998535156  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9570960998535156  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9572010040283203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9683208465576172  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9690065383911133  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9690065383911133  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9690980911254883  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9794435501098633  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9801497459411621  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9801497459411621  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9802374839782715  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9907660484313965  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9913277626037598  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9913277626037598  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9913945198059082  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.9998726844787598  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0002779960632324  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0002779960632324  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.00032377243042  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.006457805633545  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0068578720092773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0068578720092773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0068998336791992  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0128164291381836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0134215354919434  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0134215354919434  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0134806632995605  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0222315788269043  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.022477149963379  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.022477149963379  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0225019454956055  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0263452529907227  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.026686668395996  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.026686668395996  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.026717185974121  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.031661033630371  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0320844650268555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0320844650268555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.032120704650879  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0382452011108398  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([147, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0417594909667969  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0417594909667969  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0420398712158203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0913867950439453  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 147, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.06477689743042  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0656342506408691  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes
[05:28:06] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21719692 edges into 16 parts and get 4938448 edge cuts

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0664916038513184  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0655913352966309  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([5753, 40])
input nodes number: 12241
output nodes number: 5753
edges number: 32374
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0657215118408203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.0657219886779785  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.021209716796875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.026760101318359375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.026760101318359375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013763219118118286 |0.021983101963996887 |0.1486736387014389 |9.745359420776367e-05 |0.07493887841701508 |0.005822181701660156 |
----------------------------------------------------------pseudo_mini_loss sum 5.333719253540039
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  877316
Number of first layer input nodes during this epoch:  596948
Number of first layer output nodes during this epoch:  280368
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.026759624481201172  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026119709014892578
global_2_local spend time (sec) 0.05115699768066406
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004300832748413086
A = g.adjacency_matrix() spent  0.01533651351928711
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09629511833190918
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.303779125213623
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1606345176696777

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11701738, 2.0: 2017886, 3.0: 504377, 4.0: 152112, 5.0: 55817, 6.0: 23824, 7.0: 11409, 8.0: 5685, 9.0: 3070, 10.0: 1700, 11.0: 1036, 12.0: 534, 13.0: 336, 14.0: 225, 15.0: 120, 16.0: 118, 17.0: 96, 18.0: 53, 19.0: 34, 20.0: 8, 21.0: 6})
Convert a graph into a bidirected graph: 0.825 seconds
Metis partitioning: 4.775 seconds
Split the graph: 0.637 seconds
Construct subgraphs: 0.098 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.345503091812134
5517
5550
5542
5854
5560
5804
5537
5524
5786
5788
5809
5517
5810
5777
5795
5771
total k batches seeds list generation spend  19.90813183784485
after graph partition
graph partition algorithm spend time 19.989510536193848
5517
5550
5542
5854
5560
5804
5537
5524
5786
5788
5809
5517
5810
5777
5795
5771
partition_len_list
[25697, 27585, 26362, 30124, 10587, 14122, 18418, 21889, 11231, 10987, 12679, 12027, 13905, 11957, 11702, 13325]
shared_neighbor_graph_partition_s0 selection method  spend 20.094746351242065
time for parepare:  0.020009756088256836
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.001546621322631836
mini_batch_src_global generation:  0.0031402111053466797
r_  generation:  0.015076398849487305
local_output_nid generation:  0.0016779899597167969
local_in_edges_tensor generation:  0.0014295578002929688
mini_batch_src_global generation:  0.0021202564239501953
r_  generation:  0.0203094482421875
local_output_nid generation:  0.0017764568328857422
local_in_edges_tensor generation:  0.0013632774353027344
mini_batch_src_global generation:  0.002045154571533203
r_  generation:  0.021295785903930664
local_output_nid generation:  0.0018780231475830078
local_in_edges_tensor generation:  0.0015535354614257812
mini_batch_src_global generation:  0.0029036998748779297
r_  generation:  0.029179096221923828
local_output_nid generation:  0.0018839836120605469
local_in_edges_tensor generation:  0.001264810562133789
mini_batch_src_global generation:  0.0017178058624267578
r_  generation:  0.011628150939941406
local_output_nid generation:  0.0018856525421142578
local_in_edges_tensor generation:  0.0012822151184082031
mini_batch_src_global generation:  0.0014216899871826172
r_  generation:  0.01581096649169922
local_output_nid generation:  0.0017466545104980469
local_in_edges_tensor generation:  0.00122833251953125
mini_batch_src_global generation:  0.0014636516571044922
r_  generation:  0.016448259353637695
local_output_nid generation:  0.0017061233520507812
local_in_edges_tensor generation:  0.0011568069458007812
mini_batch_src_global generation:  0.0016376972198486328
r_  generation:  0.017135143280029297
local_output_nid generation:  0.00177001953125
local_in_edges_tensor generation:  0.0011553764343261719
mini_batch_src_global generation:  0.0015854835510253906
r_  generation:  0.014613866806030273
local_output_nid generation:  0.0017518997192382812
local_in_edges_tensor generation:  0.0012230873107910156
mini_batch_src_global generation:  0.0014069080352783203
r_  generation:  0.01648092269897461
local_output_nid generation:  0.0017101764678955078
local_in_edges_tensor generation:  0.00119781494140625
mini_batch_src_global generation:  0.0014820098876953125
r_  generation:  0.01635575294494629
local_output_nid generation:  0.0016322135925292969
local_in_edges_tensor generation:  0.0011451244354248047
mini_batch_src_global generation:  0.0013301372528076172
r_  generation:  0.014273643493652344
local_output_nid generation:  0.0017244815826416016
local_in_edges_tensor generation:  0.0012171268463134766
mini_batch_src_global generation:  0.0014238357543945312
r_  generation:  0.01684117317199707
local_output_nid generation:  0.0017559528350830078
local_in_edges_tensor generation:  0.001241445541381836
mini_batch_src_global generation:  0.0013234615325927734
r_  generation:  0.014393806457519531
local_output_nid generation:  0.0016834735870361328
local_in_edges_tensor generation:  0.0011243820190429688
mini_batch_src_global generation:  0.0011322498321533203
r_  generation:  0.012762784957885742
local_output_nid generation:  0.0016620159149169922
local_in_edges_tensor generation:  0.001146078109741211
mini_batch_src_global generation:  0.0012671947479248047
r_  generation:  0.014870882034301758
----------------------check_connections_block total spend ----------------------------- 0.4426727294921875
generate_one_block  0.028192520141601562
generate_one_block  0.027310848236083984
generate_one_block  0.027522802352905273
generate_one_block  0.03958272933959961
generate_one_block  0.015303850173950195
generate_one_block  0.017425537109375
generate_one_block  0.020602703094482422
generate_one_block  0.021520614624023438
generate_one_block  0.01910114288330078
generate_one_block  0.02196359634399414
generate_one_block  0.02186274528503418
generate_one_block  0.020930051803588867
generate_one_block  0.02317523956298828
generate_one_block  0.018831491470336914
generate_one_block  0.017024517059326172
generate_one_block  0.019811630249023438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037862300872802734
gen group dst list time:  0.008072137832641602
time for parepare:  0.02301311492919922
local_output_nid generation:  0.005110740661621094
local_in_edges_tensor generation:  0.013334512710571289
mini_batch_src_global generation:  0.006911039352416992
r_  generation:  0.06580352783203125
local_output_nid generation:  0.007691383361816406
local_in_edges_tensor generation:  0.008873939514160156
mini_batch_src_global generation:  0.008920669555664062
r_  generation:  0.07731485366821289
local_output_nid generation:  0.007272005081176758
local_in_edges_tensor generation:  0.00834035873413086
mini_batch_src_global generation:  0.007944345474243164
r_  generation:  0.07485556602478027
local_output_nid generation:  0.007710456848144531
local_in_edges_tensor generation:  0.008176088333129883
mini_batch_src_global generation:  0.01045846939086914
r_  generation:  0.0894017219543457
local_output_nid generation:  0.003343820571899414
local_in_edges_tensor generation:  0.0025587081909179688
mini_batch_src_global generation:  0.0038797855377197266
r_  generation:  0.02330183982849121
local_output_nid generation:  0.0041713714599609375
local_in_edges_tensor generation:  0.0030257701873779297
mini_batch_src_global generation:  0.0026543140411376953
r_  generation:  0.031126022338867188
local_output_nid generation:  0.005011081695556641
local_in_edges_tensor generation:  0.0038483142852783203
mini_batch_src_global generation:  0.004695892333984375
r_  generation:  0.04506421089172363
local_output_nid generation:  0.0059320926666259766
local_in_edges_tensor generation:  0.004758596420288086
mini_batch_src_global generation:  0.00617218017578125
r_  generation:  0.05911684036254883
local_output_nid generation:  0.003397703170776367
local_in_edges_tensor generation:  0.002568960189819336
mini_batch_src_global generation:  0.003225088119506836
r_  generation:  0.024908781051635742
local_output_nid generation:  0.003284931182861328
local_in_edges_tensor generation:  0.0023708343505859375
mini_batch_src_global generation:  0.0022983551025390625
r_  generation:  0.0254976749420166
local_output_nid generation:  0.0035469532012939453
local_in_edges_tensor generation:  0.0026123523712158203
mini_batch_src_global generation:  0.0025877952575683594
r_  generation:  0.02938532829284668
local_output_nid generation:  0.0034630298614501953
local_in_edges_tensor generation:  0.0025086402893066406
mini_batch_src_global generation:  0.002581357955932617
r_  generation:  0.027199745178222656
local_output_nid generation:  0.003947019577026367
local_in_edges_tensor generation:  0.002937793731689453
mini_batch_src_global generation:  0.0030303001403808594
r_  generation:  0.033379316329956055
local_output_nid generation:  0.003361940383911133
local_in_edges_tensor generation:  0.0025429725646972656
mini_batch_src_global generation:  0.0024576187133789062
r_  generation:  0.02636241912841797
local_output_nid generation:  0.0032296180725097656
local_in_edges_tensor generation:  0.002465486526489258
mini_batch_src_global generation:  0.0021212100982666016
r_  generation:  0.024538516998291016
local_output_nid generation:  0.003622293472290039
local_in_edges_tensor generation:  0.0027704238891601562
mini_batch_src_global generation:  0.002701282501220703
r_  generation:  0.03078603744506836
----------------------check_connections_block total spend ----------------------------- 1.1008188724517822
generate_one_block  0.10822129249572754
generate_one_block  0.10594344139099121
generate_one_block  0.10927295684814453
generate_one_block  0.11892151832580566
generate_one_block  0.028354883193969727
generate_one_block  0.04053306579589844
generate_one_block  0.06070065498352051
generate_one_block  0.07715916633605957
generate_one_block  0.03166985511779785
generate_one_block  0.03282785415649414
generate_one_block  0.037207603454589844
generate_one_block  0.034200191497802734
generate_one_block  0.04810190200805664
generate_one_block  0.03373980522155762
generate_one_block  0.030560016632080078
generate_one_block  0.03926706314086914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.026759624481201172  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

connection checking time:  1.1008188724517822
block generation total time  0.9366812705993652
average batch blocks generation time:  0.05854257941246033
block dataloader generation time/epoch 23.14776873588562
pseudo mini batch 0 input nodes size: 65678
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.024505138397216797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.024505138397216797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.05582284927368164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.05586433410644531  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0433197021484375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04507255554199219  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04507255554199219  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04507255554199219  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([65678, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04507255554199219  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([1597, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14096641540527344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14096641540527344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1597, 128]), torch.Size([1, 1597, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14248943328857422  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.15467357635498047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1597, 128])
m.shape torch.Size([1686, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1555647850036621  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1555647850036621  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1686, 128]), torch.Size([1, 1686, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.15717267990112305  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1820998191833496  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1686, 128])
m.shape torch.Size([1511, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1834573745727539  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1834573745727539  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1511, 128]), torch.Size([1, 1511, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.18489837646484375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2166004180908203  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1511, 128])
m.shape torch.Size([1347, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.21844911575317383  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.21844911575317383  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1347, 128]), torch.Size([1, 1347, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.21973371505737305  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.25728273391723633  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1347, 128])
m.shape torch.Size([1258, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2596397399902344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2596397399902344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1258, 128]), torch.Size([1, 1258, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.26083946228027344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3043651580810547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1258, 128])
m.shape torch.Size([1005, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.306640625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.306640625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1005, 128]), torch.Size([1, 1005, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3075990676879883  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.34968137741088867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1005, 128])
m.shape torch.Size([981, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3524765968322754  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3524765968322754  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 981, 128]), torch.Size([1, 981, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3534121513366699  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.4010305404663086  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 981, 128])
m.shape torch.Size([964, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.40424013137817383  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.40424013137817383  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 964, 128]), torch.Size([1, 964, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.40515947341918945  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.4575619697570801  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 964, 128])
m.shape torch.Size([824, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.46063852310180664  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.46063852310180664  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.4614243507385254  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5124545097351074  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([14524, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5813174247741699  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5813174247741699  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 14524, 128]), torch.Size([1, 14524, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5951685905456543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.578601360321045  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 14524, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.4907255172729492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5161161422729492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5406227111816406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.515040397644043  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([25697, 256])
first layer input nodes number: 65678
first layer output nodes number: 25697
edges number: 194445
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.541114330291748  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.566504955291748  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5725369453430176  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.5725369453430176  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([996, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.612823486328125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.612823486328125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 996, 256]), torch.Size([1, 996, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6147232055664062  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6315584182739258  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 996, 256])
m.shape torch.Size([863, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6322674751281738  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6322674751281738  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 863, 256]), torch.Size([1, 863, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.633913516998291  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6586041450500488  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 863, 256])
m.shape torch.Size([608, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6595344543457031  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6595344543457031  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6606941223144531  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6862068176269531  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 608, 256])
m.shape torch.Size([447, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6877555847167969  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6877555847167969  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.688608169555664  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.71661376953125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([354, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7178888320922852  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7178888320922852  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7185640335083008  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7437047958374023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([276, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7449588775634766  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7449588775634766  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7454853057861328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7703394889831543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([211, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.771496295928955  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.771496295928955  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7718987464904785  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7920212745666504  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([201, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7933659553527832  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7933659553527832  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7937493324279785  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8156018257141113  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([151, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8167166709899902  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8167166709899902  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.817004680633545  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.835437297821045  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([126, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8365044593811035  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8365044593811035  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.836744785308838  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8538079261779785  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([119, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8549461364746094  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8549461364746094  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.855173110961914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8728771209716797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([95, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8738594055175781  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8738594055175781  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8740406036376953  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8894424438476562  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8901143074035645  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8901143074035645  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.890230655670166  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9009346961975098  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9017243385314941  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9017243385314941  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9018445014953613  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.913740634918213  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9146323204040527  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9146323204040527  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9147582054138184  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9281020164489746  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9287619590759277  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9287619590759277  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.92885160446167  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.938981533050537  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9395904541015625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9395904541015625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.939666748046875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.948822021484375  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9495973587036133  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9495973587036133  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9496870040893555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9610719680786133  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.961958885192871  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.961958885192871  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9620561599731445  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9750909805297852  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.97581148147583  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.97581148147583  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9758877754211426  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.986645221710205  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.987253189086914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.987253189086914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.987314224243164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.996347427368164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9970149993896484  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9970149993896484  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9970779418945312  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.006834030151367  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0074658393859863  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0074658393859863  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0075230598449707  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0167927742004395  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.017364025115967  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.017364025115967  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.01741361618042  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.025794506072998  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([534, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0386009216308594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0386009216308594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0396194458007812  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2197647094726562  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 534, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1855950355529785  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.186417579650879  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1872401237487793  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1863760948181152  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([5517, 40])
input nodes number: 25697
output nodes number: 5517
edges number: 40687
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1865744590759277  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.186575412750244  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04822206497192383  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

pseudo mini batch 1 input nodes size: 60364
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04328584671020508  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04328584671020508  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.07206964492797852  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.07211112976074219  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04075193405151367  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.042813777923583984  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.042813777923583984  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.042813777923583984  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([60364, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.042813777923583984  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([1275, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1519918441772461  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1519918441772461  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1275, 128]), torch.Size([1, 1275, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.15320777893066406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1629352569580078  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1275, 128])
m.shape torch.Size([1431, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16369199752807617  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16369199752807617  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1431, 128]), torch.Size([1, 1431, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.16505670547485352  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.18555212020874023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1431, 128])
m.shape torch.Size([1250, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.18665790557861328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.18665790557861328  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1250, 128]), torch.Size([1, 1250, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1878499984741211  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.21407604217529297  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1250, 128])
m.shape torch.Size([1126, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.21562767028808594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.21562767028808594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1126, 128]), torch.Size([1, 1126, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.21670150756835938  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.24784278869628906  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1126, 128])
m.shape torch.Size([1125, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.24998807907104492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.24998807907104492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.25106096267700195  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.289888858795166  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1019, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2922677993774414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2922677993774414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1019, 128]), torch.Size([1, 1019, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2932395935058594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3353281021118164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1019, 128])
m.shape torch.Size([967, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3380699157714844  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3380699157714844  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 967, 128]), torch.Size([1, 967, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3389921188354492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.38605546951293945  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 967, 128])
m.shape torch.Size([934, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3891572952270508  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3891572952270508  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 934, 128]), torch.Size([1, 934, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3900480270385742  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.44086694717407227  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 934, 128])
m.shape torch.Size([905, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.444305419921875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.444305419921875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.44516849517822266  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5015172958374023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([17553, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.584784984588623  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.584784984588623  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 17553, 128]), torch.Size([1, 17553, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.601524829864502  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7900538444519043  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 17553, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6884369850158691  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7147440910339355  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.741051197052002  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7145380973815918  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([27585, 256])
first layer input nodes number: 60364
first layer output nodes number: 27585
edges number: 222046
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7415032386779785  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.767810344696045  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.775346279144287  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.775346279144287  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([765, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8287677764892578  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8287677764892578  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 765, 256]), torch.Size([1, 765, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8302268981933594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8418998718261719  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 765, 256])
m.shape torch.Size([667, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.842775821685791  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.842775821685791  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 667, 256]), torch.Size([1, 667, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.844048023223877  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8642325401306152  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 667, 256])
m.shape torch.Size([482, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8652243614196777  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8652243614196777  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 482, 256]), torch.Size([1, 482, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8661437034606934  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.890246868133545  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 482, 256])
m.shape torch.Size([377, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8914170265197754  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8914170265197754  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8921360969543457  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.914013385772705  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([345, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9153118133544922  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9153118133544922  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9159698486328125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9406147003173828  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([254, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9417505264282227  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9417505264282227  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.942234992980957  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9630670547485352  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([185, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9641032218933105  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9641032218933105  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9644560813903809  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9820990562438965  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([172, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9832453727722168  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9832453727722168  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9835734367370605  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0022730827331543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([154, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0036206245422363  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0036206245422363  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0039143562316895  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0227131843566895  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([154, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0240468978881836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0240468978881836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0243406295776367  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0451955795288086  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([128, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0464019775390625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0464019775390625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0466461181640625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0656890869140625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([107, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.066845417022705  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.066845417022705  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.067049503326416  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0843968391418457  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([105, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.085610866546631  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.085610866546631  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.085811138153076  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.104236125946045  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1054139137268066  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1054139137268066  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1055855751037598  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.122580051422119  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([94, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.123849868774414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.123849868774414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1240291595458984  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.143033981323242  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.144380569458008  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.144380569458008  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1445274353027344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.161123275756836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1621780395507812  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1621780395507812  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1623077392578125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1778717041015625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([75, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.179104804992676  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.179104804992676  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1792478561401367  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.197415351867676  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.198439598083496  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.198439598083496  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.198554039001465  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2138891220092773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.214754581451416  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.214754581451416  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.214846134185791  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.227755069732666  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.228837490081787  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.228837490081787  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.228942394256592  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2444682121276855  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([43, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2453250885009766  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2453250885009766  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2454071044921875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.258119583129883  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2588305473327637  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2588305473327637  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2588953971862793  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2694010734558105  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2702221870422363  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2702221870422363  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2702927589416504  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.282219409942627  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([974, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.3055877685546875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.3055877685546875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 974, 256]), torch.Size([1, 974, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.307445526123047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.6445274353027344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 974, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.5967164039611816  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.597543716430664  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.5983710289001465  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.5975022315979004  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([5550, 40])
input nodes number: 27585
output nodes number: 5550
edges number: 54585
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.59775447845459  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.597754955291748  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.046418190002441406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

pseudo mini batch 2 input nodes size: 54699
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0407567024230957  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.0407567024230957  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06683921813964844  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06688070297241211  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.038055419921875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.040076255798339844  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.040076255798339844  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.040076255798339844  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([54699, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.040076255798339844  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([1212, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1452174186706543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.1452174186706543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1212, 128]), torch.Size([1, 1212, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.14637327194213867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.15562009811401367  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1212, 128])
m.shape torch.Size([1243, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.15630340576171875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.15630340576171875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1243, 128]), torch.Size([1, 1243, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.15748882293701172  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.17527008056640625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1243, 128])
m.shape torch.Size([1185, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.17661333084106445  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.17661333084106445  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1185, 128]), torch.Size([1, 1185, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.17774343490600586  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.20271635055541992  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1185, 128])
m.shape torch.Size([1122, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.20429134368896484  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.20429134368896484  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.20536136627197266  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2365427017211914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1015, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23842763900756836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.23842763900756836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1015, 128]), torch.Size([1, 1015, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2393956184387207  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.27512073516845703  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1015, 128])
m.shape torch.Size([930, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2772974967956543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2772974967956543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.2781844139099121  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3170657157897949  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([908, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3196530342102051  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3196530342102051  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.32051897048950195  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.36527109146118164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([790, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.36785173416137695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.36785173416137695  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.3686051368713379  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.41154909133911133  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([775, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.41449832916259766  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.41449832916259766  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.4152374267578125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.46285438537597656  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([17182, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5444149971008301  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5444149971008301  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 17182, 128]), torch.Size([1, 17182, 128])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.5608010292053223  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.724259853363037  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 17182, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6261587142944336  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6515493392944336  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6766901016235352  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6511030197143555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([26362, 256])
first layer input nodes number: 54699
first layer output nodes number: 26362
edges number: 213867
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.6770997047424316  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7024903297424316  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7085309028625488  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7085309028625488  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([709, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7645139694213867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7645139694213867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7658662796020508  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7780065536499023  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([591, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7785167694091797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7785167694091797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7796440124511719  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.7994394302368164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([502, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8003368377685547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8003368377685547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8012943267822266  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8230972290039062  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([411, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8243207931518555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8243207931518555  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8251047134399414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8478765487670898  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([331, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8490753173828125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8490753173828125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8497066497802734  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8730387687683105  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([238, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8740959167480469  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8740959167480469  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8745498657226562  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8940696716308594  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([220, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8953232765197754  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8953232765197754  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.8957428932189941  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9167237281799316  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([154, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9177632331848145  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9177632331848145  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9180569648742676  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9347996711730957  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([162, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9360542297363281  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9360542297363281  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9363632202148438  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9561386108398438  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([127, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9572334289550781  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9572334289550781  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9574756622314453  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9746742248535156  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([120, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9766325950622559  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9766325950622559  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9768614768981934  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9947142601013184  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([121, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9959955215454102  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9959955215454102  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 1.9962263107299805  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.015843391418457  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.016976833343506  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.016976833343506  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0171542167663574  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.033473491668701  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.034633159637451  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.034633159637451  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0347819328308105  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0495104789733887  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.050445556640625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.050445556640625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.050579071044922  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0647315979003906  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0657877922058105  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0657877922058105  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.065927028656006  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.081660747528076  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0827512741088867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0827512741088867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.0828866958618164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.099137306213379  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.100717544555664  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.100717544555664  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1008377075195312  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.116098403930664  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([68, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1172804832458496  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1172804832458496  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.117410182952881  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1347899436950684  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([62, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1359171867370605  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1359171867370605  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.136035442352295  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.152709484100342  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.153700351715088  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.153700351715088  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.153799533843994  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.168478488922119  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1692113876342773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1692113876342773  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1692819595336914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.180220603942871  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.181069850921631  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.181069850921631  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1811461448669434  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1935057640075684  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.194275379180908  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.194275379180908  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.1943421363830566  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2056241035461426  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([1114, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.232358455657959  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.232358455657959  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1114, 256]), torch.Size([1, 1114, 256])
----------------------------------------3
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.2351927757263184  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.619666576385498  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 1114, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.569119453430176  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.5699453353881836  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.5707712173461914  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.56990385055542  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([5542, 40])
input nodes number: 26362
output nodes number: 5542
edges number: 57304
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.5701403617858887  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 2.570140838623047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04358243942260742  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

pseudo mini batch 3 input nodes size: 54668
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03805398941040039  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03805398941040039  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06412172317504883  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.06416559219360352  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.03804159164428711  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04065752029418945  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04065752029418945  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04065752029418945  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([54668, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.2694091796875 GB
    Memory Allocated: 0.04065752029418945  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([702, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.1710519790649414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.1710519790649414  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.1717214584350586  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.1770772933959961  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([795, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.17750072479248047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.17750072479248047  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.17825889587402344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.19010639190673828  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([825, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.19090747833251953  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.19090747833251953  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.1916942596435547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.20907831192016602  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([807, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.21022415161132812  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.21022415161132812  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.21099376678466797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.23331260681152344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([829, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.23490428924560547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.23490428924560547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.23569488525390625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.2643599510192871  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([861, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.26642799377441406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.26642799377441406  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.26724910736083984  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.30350780487060547  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([846, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.3059210777282715  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.3059210777282715  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.30672788619995117  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.347750186920166  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([854, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.3506045341491699  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.3506045341491699  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.35141897201538086  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.3978419303894043  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([874, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.4011855125427246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.4011855125427246  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.40201902389526367  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.45629358291625977  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([22731, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.5642666816711426  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.5642666816711426  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 22731, 128]), torch.Size([1, 22731, 128])
----------------------------------------3
 Nvidia-smi: 5.3963623046875 GB
    Memory Allocated: 0.585944652557373  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.125291347503662  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 22731, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.001295566558838  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.0300240516662598  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.0587525367736816  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.029799461364746  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

torch.Size([30124, 256])
first layer input nodes number: 54668
first layer output nodes number: 30124
edges number: 265236
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.059162139892578  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.087890625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.095808506011963  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.095808506011963  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

m.shape torch.Size([398, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.178849697113037  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.178849697113037  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.1796088218688965  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.1858248710632324  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.186133861541748  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.186133861541748  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.186816692352295  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.1981616020202637  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([308, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.1987085342407227  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.1987085342407227  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.199295997619629  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.214442253112793  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.215048313140869  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.215048313140869  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2154946327209473  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.228437900543213  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2297892570495605  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2297892570495605  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2302069664001465  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2452445030212402  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([203, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2466588020324707  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2466588020324707  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2470459938049316  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.263695240020752  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([163, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2653751373291016  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2653751373291016  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.26568603515625  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.281230926513672  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([153, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.282252311706543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.282252311706543  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.2825441360473633  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.299178123474121  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([161, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3013949394226074  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3013949394226074  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3017020225524902  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3213553428649902  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([156, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3227014541625977  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3227014541625977  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3229990005493164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3441247940063477  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([138, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3460187911987305  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3460187911987305  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3462820053100586  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3668127059936523  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([152, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.368434429168701  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.368434429168701  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3687243461608887  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.393367290496826  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([139, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3950157165527344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3950157165527344  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.3952808380126953  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.4196720123291016  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([113, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.421060085296631  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.421060085296631  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.4212756156921387  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.442613124847412  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([113, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.445096969604492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.445096969604492  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.4453125  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.468158721923828  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([109, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.4697275161743164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.4697275161743164  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.469935417175293  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.4934282302856445  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([95, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.4948768615722656  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.4948768615722656  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.495058059692383  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.5168018341064453  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([115, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.5187010765075684  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.5187010765075684  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.518920421600342  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.5467772483825684  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([87, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.5482563972473145  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.5482563972473145  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.548422336578369  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.5706582069396973  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([105, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.5725936889648438  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.5725936889648438  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.572793960571289  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.601032257080078  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([113, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.604114532470703  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.604114532470703  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.604330062866211  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.636228561401367  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([68, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.6377487182617188  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.6377487182617188  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.63787841796875  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.6579818725585938  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([76, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.659597396850586  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.659597396850586  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 2.6597423553466797  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0155029296875 GB
    Memory Allocated: 2.683225631713867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([81, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0155029296875 GB
    Memory Allocated: 2.6850218772888184  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0155029296875 GB
    Memory Allocated: 2.6850218772888184  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 6.0174560546875 GB
    Memory Allocated: 2.685176372528076  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0428466796875 GB
    Memory Allocated: 2.7112860679626465  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([1997, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0428466796875 GB
    Memory Allocated: 2.7591934204101562  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0428466796875 GB
    Memory Allocated: 2.7591934204101562  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

 h.shape torch.Size([1, 1997, 256]), torch.Size([1, 1997, 256])
----------------------------------------3
 Nvidia-smi: 6.0428466796875 GB
    Memory Allocated: 2.7630491256713867  GigaBytes
Max Memory Allocated: 3.3692712783813477  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0428466796875 GB
    Memory Allocated: 3.447366714477539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1997, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0428466796875 GB
    Memory Allocated: 3.3691353797912598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0447998046875 GB
    Memory Allocated: 3.3700079917907715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0467529296875 GB
    Memory Allocated: 3.370880603790283  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0467529296875 GB
    Memory Allocated: 3.369964122772217  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5854, 40])
input nodes number: 30124
output nodes number: 5854
edges number: 85755
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0467529296875 GB
    Memory Allocated: 3.370279312133789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0467529296875 GB
    Memory Allocated: 3.3702797889709473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04510688781738281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 4 input nodes size: 22520
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.038088321685791016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.038088321685791016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04882669448852539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04886817932128906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022756576538085938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023406028747558594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023406028747558594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023406028747558594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([22520, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023406028747558594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1451, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0522613525390625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0522613525390625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1451, 128]), torch.Size([1, 1451, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05364513397216797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06471538543701172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1451, 128])
m.shape torch.Size([1535, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06627988815307617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06627988815307617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1535, 128]), torch.Size([1, 1535, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06774377822875977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08970212936401367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1535, 128])
m.shape torch.Size([1239, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09093093872070312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09093093872070312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1239, 128]), torch.Size([1, 1239, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09211254119873047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11818599700927734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1239, 128])
m.shape torch.Size([1017, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11953496932983398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11953496932983398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1017, 128]), torch.Size([1, 1017, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12050485610961914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14901113510131836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1017, 128])
m.shape torch.Size([827, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1504979133605957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1504979133605957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15128660202026367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18074607849121094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([651, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18221426010131836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18221426010131836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18283510208129883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21043634414672852  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([557, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21198511123657227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21198511123657227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21251630783081055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23973655700683594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([464, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2412409782409668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2412409782409668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2416834831237793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2669062614440918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([399, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26839733123779297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26839733123779297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26877784729003906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29313087463378906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([2447, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3046088218688965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3046088218688965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 2447, 128]), torch.Size([1, 2447, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3079090118408203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4813566207885742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 2447, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4576902389526367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4677867889404297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.47788333892822266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.46770763397216797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([10587, 256])
first layer input nodes number: 22520
first layer output nodes number: 10587
edges number: 56019
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.47805309295654297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.48814964294433594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4906740188598633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4906740188598633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1059, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.521721363067627  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.521721363067627  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1059, 256]), torch.Size([1, 1059, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5237741470336914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5415101051330566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1059, 256])
m.shape torch.Size([936, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.542534351348877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.542534351348877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 936, 256]), torch.Size([1, 936, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5443196296691895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.571098804473877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 936, 256])
m.shape torch.Size([695, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5725736618041992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5725736618041992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 695, 256]), torch.Size([1, 695, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5738992691040039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6041116714477539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 695, 256])
m.shape torch.Size([529, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6054830551147461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6054830551147461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6064920425415039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6359739303588867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([450, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6376323699951172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6376323699951172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6384906768798828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6693897247314453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([319, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6708002090454102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6708002090454102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6714086532592773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6989641189575195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([248, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7003288269042969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7003288269042969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7008018493652344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7244529724121094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([212, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7258467674255371  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7258467674255371  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7262511253356934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7492995262145996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([171, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7507648468017578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7507648468017578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7510910034179688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7719650268554688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7732343673706055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7732343673706055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7735185623168945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.793696403503418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([124, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.794865608215332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.794865608215332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7951021194458008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8135499954223633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([82, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8143777847290039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8143777847290039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8145341873168945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8278284072875977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8286876678466797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8286876678466797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8288307189941406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8419914245605469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8428215980529785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8428215980529785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.842949390411377  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8556008338928223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8563590049743652  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8563590049743652  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8564677238464355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8679919242858887  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8687067031860352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8687067031860352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8688020706176758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8795785903930664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8802175521850586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8802175521850586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8802976608276367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8899106979370117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.890632152557373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.890632152557373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8907160758972168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.901374340057373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9018988609313965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9018988609313965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9019579887390137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9098811149597168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.910332202911377  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.910332202911377  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9103798866271973  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9171032905578613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.917442798614502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.917442798614502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9174771308898926  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9225583076477051  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9227738380432129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9227738380432129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9227948188781738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9260468482971191  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9262576103210449  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9262576103210449  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.926276683807373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9293665885925293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9296340942382812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9296340942382812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.929656982421875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9335250854492188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([144, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.936974048614502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.936974048614502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.937248706817627  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.985588550567627  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 144, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9610600471496582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9618887901306152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9627175331115723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9618473052978516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5560, 40])
input nodes number: 10587
output nodes number: 5560
edges number: 31006
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9619240760803223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9619245529174805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024711132049560547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 5 input nodes size: 33008
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02271270751953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02271270751953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0384521484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.038495540618896484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.027715682983398438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02863025665283203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02863025665283203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02863025665283203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([33008, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02863025665283203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1520, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07153701782226562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07153701782226562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1520, 128]), torch.Size([1, 1520, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07298660278320312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08547592163085938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1520, 128])
m.shape torch.Size([1569, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08624744415283203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08624744415283203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1569, 128]), torch.Size([1, 1569, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08774375915527344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1105804443359375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1569, 128])
m.shape torch.Size([1427, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11187362670898438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11187362670898438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1427, 128]), torch.Size([1, 1427, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1132345199584961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14391756057739258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1427, 128])
m.shape torch.Size([1171, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14547061920166016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14547061920166016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1171, 128]), torch.Size([1, 1171, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14658737182617188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17897319793701172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1171, 128])
m.shape torch.Size([1120, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18108510971069336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18108510971069336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18215322494506836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22091054916381836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([887, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2229142189025879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2229142189025879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22376012802124023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26102209091186523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([748, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2632122039794922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2632122039794922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26392555236816406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3000469207763672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([669, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3022422790527344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3022422790527344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30288028717041016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.34055137634277344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([527, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.34249401092529297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.34249401092529297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.34299659729003906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3758072853088379  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([4484, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.39693737030029297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.39693737030029297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 4484, 128]), torch.Size([1, 4484, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4012136459350586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7091989517211914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 4484, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6722197532653809  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6856875419616699  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.699155330657959  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.685582160949707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([14122, 256])
first layer input nodes number: 33008
first layer output nodes number: 14122
edges number: 84716
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6994032859802246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7128710746765137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7171158790588379  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7171158790588379  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([997, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.754784107208252  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.754784107208252  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 997, 256]), torch.Size([1, 997, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.756685733795166  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7718987464904785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 997, 256])
m.shape torch.Size([812, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7728314399719238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7728314399719238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 812, 256]), torch.Size([1, 812, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7743802070617676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7981505393981934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 812, 256])
m.shape torch.Size([665, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7996516227722168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7996516227722168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 665, 256]), torch.Size([1, 665, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8009200096130371  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8296799659729004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 665, 256])
m.shape torch.Size([519, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8313217163085938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8313217163085938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8323116302490234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8617877960205078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([486, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8636283874511719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8636283874511719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8645553588867188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8979511260986328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([353, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8995237350463867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8995237350463867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9001970291137695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9291543960571289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([257, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9305472373962402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9305472373962402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.931037425994873  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9558606147766113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([228, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9573688507080078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9573688507080078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9578037261962891  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9825916290283203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([203, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9841303825378418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9841303825378418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9845175743103027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0092978477478027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([176, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.010796070098877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.010796070098877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.011131763458252  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.034965991973877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([126, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.036130428314209  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.036130428314209  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0363707542419434  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0551161766052246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0563111305236816  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0563111305236816  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0565285682678223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0750107765197754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0761890411376953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0761890411376953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.076385498046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0944595336914062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0954785346984863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0954785346984863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0956368446350098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.11130952835083  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([81, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1127557754516602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1127557754516602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.112910270690918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.129286766052246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1301937103271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1301937103271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1303157806396484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1441097259521484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1448330879211426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1448330879211426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1449246406555176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1559109687805176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1567821502685547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1567821502685547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1568832397460938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1697216033935547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1704750061035156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1704750061035156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1705589294433594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1818046569824219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1824164390563965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1824164390563965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.182481288909912  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1916251182556152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1920976638793945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1920976638793945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1921453475952148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.199202537536621  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1996231079101562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1996231079101562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1996631622314453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.20587158203125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.206294059753418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.206294059753418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2063322067260742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2125120162963867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2131390571594238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2131390571594238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2131924629211426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2222180366516113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([264, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2285351753234863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2285351753234863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2290387153625488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3189969062805176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 264, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2879624366760254  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2888274192810059  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2896924018859863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2887840270996094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5804, 40])
input nodes number: 14122
output nodes number: 5804
edges number: 37949
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2889690399169922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2889695167541504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.030492305755615234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 6 input nodes size: 40750
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.027751922607421875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.027751922607421875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.047283172607421875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04732465744018555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03154182434082031  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03282737731933594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03282737731933594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03282737731933594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([40750, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03282737731933594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1379, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09780120849609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09780120849609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1379, 128]), torch.Size([1, 1379, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09911632537841797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10963726043701172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1379, 128])
m.shape torch.Size([1428, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11034154891967773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11034154891967773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1428, 128]), torch.Size([1, 1428, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11170339584350586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13218450546264648  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1428, 128])
m.shape torch.Size([1261, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13330745697021484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13330745697021484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1261, 128]), torch.Size([1, 1261, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13451004028320312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1609668731689453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1261, 128])
m.shape torch.Size([1148, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1626129150390625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1626129150390625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1148, 128]), torch.Size([1, 1148, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16370773315429688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19545745849609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1148, 128])
m.shape torch.Size([1023, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19734907150268555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19734907150268555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1023, 128]), torch.Size([1, 1023, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19832468032836914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23405742645263672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1023, 128])
m.shape torch.Size([895, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2361302375793457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2361302375793457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 895, 128]), torch.Size([1, 895, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2369837760925293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27368593215942383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 895, 128])
m.shape torch.Size([795, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2759127616882324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2759127616882324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2766709327697754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3148331642150879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([753, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31732654571533203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31732654571533203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31804466247558594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.36029481887817383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([666, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3627939224243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3627939224243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.36342906951904297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.40522003173828125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([9070, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4481515884399414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4481515884399414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 9070, 128]), torch.Size([1, 9070, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4568014144897461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.070939064025879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 9070, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0124030113220215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0299677848815918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.047532558441162  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0298304557800293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([18418, 256])
first layer input nodes number: 40750
first layer output nodes number: 18418
edges number: 131378
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0478382110595703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0654029846191406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0697941780090332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0697941780090332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([945, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1104130744934082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1104130744934082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 945, 256]), torch.Size([1, 945, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.112215518951416  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1272854804992676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 945, 256])
m.shape torch.Size([754, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.127871036529541  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.127871036529541  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 754, 256]), torch.Size([1, 754, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1293091773986816  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1510348320007324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 754, 256])
m.shape torch.Size([588, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1521658897399902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1521658897399902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.153287410736084  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1779608726501465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([448, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1794462203979492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1794462203979492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1803007125854492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2113523483276367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([402, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2131719589233398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2131719589233398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2139387130737305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2514543533325195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([334, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2533178329467773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2533178329467773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2539548873901367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.284398078918457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([266, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2858695983886719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2858695983886719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.286376953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.311859130859375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([215, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3132586479187012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3132586479187012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3136687278747559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.337043285369873  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([152, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.33815336227417  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.33815336227417  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3384432792663574  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3569979667663574  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([142, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3582181930541992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3582181930541992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3584890365600586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3777189254760742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([137, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3790321350097656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3790321350097656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.379293441772461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3996753692626953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([105, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4007558822631836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4007558822631836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.400956153869629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4179792404174805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.418778896331787  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.418778896331787  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4189162254333496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4315505027770996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([61, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4323029518127441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4323029518127441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4324193000793457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4439377784729004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4447450637817383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4447450637817383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.444859504699707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4569902420043945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.457901954650879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.457901954650879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.458022117614746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4716005325317383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4724884033203125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4724884033203125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4725990295410156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4858741760253906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4865975379943848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4865975379943848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4866833686828613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4975838661193848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4984540939331055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4984540939331055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.498549461364746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5113286972045898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5121464729309082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5121464729309082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5122323036193848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.52433443069458  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5250587463378906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5250587463378906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5251312255859375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.535858154296875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5363717079162598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5363717079162598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.536421298980713  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5441079139709473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.544459342956543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.544459342956543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5444917678833008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5497446060180664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.550489902496338  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.550489902496338  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5505528450012207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.561190128326416  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([481, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.572716236114502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.572716236114502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5736336708068848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7372498512268066  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 481, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7027711868286133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.703596591949463  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7044219970703125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7035551071166992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5537, 40])
input nodes number: 18418
output nodes number: 5537
edges number: 41082
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7036943435668945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7036948204040527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03515768051147461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 7 input nodes size: 51755
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03150224685668945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03150224685668945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05689287185668945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.056934356689453125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03736162185668945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03890275955200195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03890275955200195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03890275955200195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([51755, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03890275955200195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1555, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11948299407958984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11948299407958984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1555, 128]), torch.Size([1, 1555, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12096595764160156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1328296661376953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1555, 128])
m.shape torch.Size([1639, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1336512565612793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1336512565612793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1639, 128]), torch.Size([1, 1639, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13521432876586914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1586604118347168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1639, 128])
m.shape torch.Size([1321, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15976858139038086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15976858139038086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1321, 128]), torch.Size([1, 1321, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16102838516235352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18921136856079102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1321, 128])
m.shape torch.Size([1052, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19058799743652344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19058799743652344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1915912628173828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22159957885742188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([1014, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22351551055908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22351551055908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1014, 128]), torch.Size([1, 1014, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22448253631591797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2592954635620117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1014, 128])
m.shape torch.Size([847, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26123523712158203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26123523712158203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2620429992675781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29694175720214844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([765, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2990913391113281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2990913391113281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2998208999633789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.337130069732666  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([787, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3397674560546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3397674560546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3405179977416992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3833332061767578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([742, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3861422538757324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3861422538757324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 742, 128]), torch.Size([1, 742, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.38684988021850586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.43291711807250977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 742, 128])
m.shape torch.Size([12167, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.49115705490112305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.49115705490112305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 12167, 128]), torch.Size([1, 12167, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5027604103088379  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3265986442565918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 12167, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2530207633972168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2738957405090332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2947707176208496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2737321853637695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([21889, 256])
first layer input nodes number: 51755
first layer output nodes number: 21889
edges number: 163155
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2951583862304688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3160333633422852  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3214516639709473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3214516639709473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([989, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3645033836364746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3645033836364746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 989, 256]), torch.Size([1, 989, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3663897514343262  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3828043937683105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 989, 256])
m.shape torch.Size([885, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3840584754943848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3840584754943848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 885, 256]), torch.Size([1, 885, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3857464790344238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.415754795074463  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 885, 256])
m.shape torch.Size([623, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4167075157165527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4167075157165527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 623, 256]), torch.Size([1, 623, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.417895793914795  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4447965621948242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 623, 256])
m.shape torch.Size([429, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4460911750793457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4460911750793457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4469094276428223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4708781242370605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([324, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4720263481140137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4720263481140137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.472644329071045  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4953088760375977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([258, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.496488094329834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.496488094329834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4969801902770996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.519392967224121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([186, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5203986167907715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5203986167907715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5207533836364746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5384917259216309  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([157, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5395216941833496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5395216941833496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5398211479187012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5568900108337402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5581159591674805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5581159591674805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5584192276000977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5778284072875977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([119, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5788207054138184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5788207054138184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.579047679901123  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5951628684997559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([86, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5959587097167969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5959587097167969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5961227416992188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.608917236328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([90, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.609957218170166  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.609957218170166  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6101288795471191  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6247200965881348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6255216598510742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6255216598510742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.625657081604004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6381158828735352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6388020515441895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6388020515441895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.638908863067627  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6494832038879395  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.650064468383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.650064468383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6501483917236328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6590442657470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6597099304199219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6597099304199219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6597976684570312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6697120666503906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6703219413757324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6703219413757324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.670398235321045  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.679553508758545  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.680276870727539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.680276870727539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6803607940673828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.691019058227539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.691652774810791  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.691652774810791  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.691723346710205  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7011799812316895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7018752098083496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7018752098083496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7019476890563965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7121672630310059  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7127165794372559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7127165794372559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7127718925476074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7209582328796387  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7214384078979492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7214384078979492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7214841842651367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7285795211791992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7290654182434082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7290654182434082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.729109287261963  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7362160682678223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7368173599243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7368173599243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7368688583374023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7455720901489258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([740, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.763493537902832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.763493537902832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 740, 256]), torch.Size([1, 740, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7649049758911133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0133180618286133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 740, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9762086868286133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.97703218460083  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9778556823730469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9769906997680664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5524, 40])
input nodes number: 21889
output nodes number: 5524
edges number: 43569
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.977193832397461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9771943092346191  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04170656204223633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 8 input nodes size: 21212
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03735971450805664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03735971450805664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04747438430786133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04751777648925781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02208566665649414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022888660430908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022888660430908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022888660430908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([21212, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022888660430908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1285, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05572032928466797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05572032928466797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1285, 128]), torch.Size([1, 1285, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05694580078125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06674957275390625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1285, 128])
m.shape torch.Size([1388, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06746053695678711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06746053695678711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1388, 128]), torch.Size([1, 1388, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06878423690795898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08907461166381836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1388, 128])
m.shape torch.Size([1195, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09012222290039062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09012222290039062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1195, 128]), torch.Size([1, 1195, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0912618637084961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1165318489074707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1195, 128])
m.shape torch.Size([1004, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11787700653076172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11787700653076172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1004, 128]), torch.Size([1, 1004, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1188344955444336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14707660675048828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1004, 128])
m.shape torch.Size([752, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1488943099975586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1488943099975586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 752, 128]), torch.Size([1, 752, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1496114730834961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17641305923461914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 752, 128])
m.shape torch.Size([675, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17798566818237305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17798566818237305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 675, 128]), torch.Size([1, 675, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17862939834594727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20702600479125977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 675, 128])
m.shape torch.Size([547, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20852994918823242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20852994918823242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20905160903930664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23578834533691406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([529, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23754549026489258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23754549026489258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23804998397827148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2671666145324707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([444, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26881980895996094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26881980895996094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 444, 128]), torch.Size([1, 444, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2692432403564453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2963428497314453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 444, 128])
m.shape torch.Size([3412, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31240081787109375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31240081787109375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 3412, 128]), torch.Size([1, 3412, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3156547546386719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5467758178710938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 3412, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5189766883850098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5296874046325684  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.540398120880127  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5296034812927246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([11231, 256])
first layer input nodes number: 21212
first layer output nodes number: 11231
edges number: 65649
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5405583381652832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5512690544128418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5545306205749512  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5545306205749512  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([922, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5969796180725098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5969796180725098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 922, 256]), torch.Size([1, 922, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5987381935119629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6128067970275879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 922, 256])
m.shape torch.Size([818, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6137261390686035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6137261390686035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 818, 256]), torch.Size([1, 818, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6152863502502441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6390342712402344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 818, 256])
m.shape torch.Size([624, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6401066780090332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6401066780090332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6412968635559082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.667879581451416  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([512, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6694283485412598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6694283485412598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6704049110412598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6987252235412598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 512, 256])
m.shape torch.Size([386, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7000923156738281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7000923156738281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7008285522460938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.727386474609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([311, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7288122177124023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7288122177124023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.729405403137207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.755122184753418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([243, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7564606666564941  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7564606666564941  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7569241523742676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7800984382629395  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([238, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7816967964172363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7816967964172363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7821507453918457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8080258369445801  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([205, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8096694946289062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8096694946289062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8100605010986328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8350849151611328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([167, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8364949226379395  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8364949226379395  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8368134498596191  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.859428882598877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([154, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8608980178833008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8608980178833008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8611917495727539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8841028213500977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([148, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8856630325317383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8856630325317383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8859453201293945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9099397659301758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([108, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9111480712890625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9111480712890625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9113540649414062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9303054809570312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([82, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9313058853149414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9313058853149414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.931462287902832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9469461441040039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([75, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9479494094848633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9479494094848633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9480924606323242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9632558822631836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9640917778015137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9640917778015137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9642043113708496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9769206047058105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9779758453369141  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9779758453369141  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9781055450439453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9936695098876953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9945735931396484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9945735931396484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9946804046630859  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0082454681396484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.009087085723877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.009087085723877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0091805458068848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0217041969299316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0223302841186523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0223302841186523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0223970413208008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0318098068237305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0326447486877441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0326447486877441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.032726764678955  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0448651313781738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0455646514892578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0455646514892578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0456314086914062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.055978775024414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.056851863861084  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.056851863861084  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0569300651550293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.06959867477417  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.070113182067871  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.070113182067871  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0701589584350586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.077895164489746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([383, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0879640579223633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0879640579223633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0886945724487305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.219954490661621  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 383, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.183967113494873  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1848297119140625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.185692310333252  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.184786319732666  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5786, 40])
input nodes number: 11231
output nodes number: 5786
edges number: 42047
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.184952735900879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.184953212738037  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024519920349121094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 9 input nodes size: 21612
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022124767303466797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022124767303466797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.032430171966552734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03247356414794922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022315502166748047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02324533462524414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02324533462524414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02324533462524414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([21612, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02324533462524414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([756, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.059918880462646484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.059918880462646484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 756, 128]), torch.Size([1, 756, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06063985824584961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06689023971557617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 756, 128])
m.shape torch.Size([924, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06741094589233398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06741094589233398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06829214096069336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08202505111694336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([897, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08286762237548828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08286762237548828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 897, 128]), torch.Size([1, 897, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08372306823730469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10269784927368164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 897, 128])
m.shape torch.Size([845, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10396575927734375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10396575927734375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10477161407470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12833213806152344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([763, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12974834442138672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12974834442138672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1304759979248047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1569199562072754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([720, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1586160659790039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1586160659790039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1593027114868164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1895742416381836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 720, 128])
m.shape torch.Size([631, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19133710861206055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19133710861206055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 631, 128]), torch.Size([1, 631, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1919388771057129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22255325317382812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 631, 128])
m.shape torch.Size([578, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2244572639465332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2244572639465332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22500848770141602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25711679458618164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([461, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.258819580078125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.258819580078125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 461, 128]), torch.Size([1, 461, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2592592239379883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2873964309692383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 461, 128])
m.shape torch.Size([4412, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3082146644592285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3082146644592285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 4412, 128]), torch.Size([1, 4412, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31256723403930664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6200275421142578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 4412, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5874629020690918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5979409217834473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6084189414978027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5978589057922363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([10987, 256])
first layer input nodes number: 21612
first layer output nodes number: 10987
edges number: 74120
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6085820198059082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6190600395202637  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6216797828674316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6216797828674316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([563, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.671661376953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.671661376953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6727352142333984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6818351745605469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([567, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6825013160705566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6825013160705566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6835827827453613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7002062797546387  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([522, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7012438774108887  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7012438774108887  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7022395133972168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.725059986114502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7263345718383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7263345718383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7272138595581055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7532625198364258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([414, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7548127174377441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7548127174377441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7556023597717285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7847599983215332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([388, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7866029739379883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7866029739379883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7873430252075195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8199968338012695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([338, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8219008445739746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8219008445739746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8225455284118652  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8550562858581543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([263, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8567562103271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8567562103271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8572578430175781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8864650726318359  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([230, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8882040977478027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8882040977478027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8886427879333496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9167189598083496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([246, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9188642501831055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9188642501831055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9193334579467773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9526472091674805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([215, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9546856880187988  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9546856880187988  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9550957679748535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9870820045471191  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([149, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9888100624084473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9888100624084473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9890942573547363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0132508277893066  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([157, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0150704383850098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0150704383850098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0153698921203613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.042919635772705  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([137, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0446133613586426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0446133613586426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.044874668121338  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0707440376281738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([95, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0719833374023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0719833374023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.072164535522461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0913715362548828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([102, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0928497314453125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0928497314453125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0930442810058594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1150283813476562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([97, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.11651611328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.11651611328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1167011260986328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1389026641845703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([84, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.140263557434082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.140263557434082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1404237747192383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.160771369934082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1617870330810547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1617870330810547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1619014739990234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.177236557006836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([90, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1789097785949707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1789097785949707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1790814399719238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2032856941223145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([64, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2044916152954102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2044916152954102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2046136856079102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2226800918579102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2234864234924316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2234864234924316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.223564624786377  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2356858253479004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2364425659179688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2364425659179688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.23651123046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2476348876953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2485928535461426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2485928535461426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2486748695373535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.262535572052002  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([426, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.272730827331543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.272730827331543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.273543357849121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.416701316833496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 426, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3728599548339844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3737225532531738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3745851516723633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3736791610717773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5788, 40])
input nodes number: 10987
output nodes number: 5788
edges number: 50531
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3738045692443848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.373805046081543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0250244140625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 10 input nodes size: 22712
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022315502166748047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022315502166748047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03314542770385742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.033188819885253906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022840023040771484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023834705352783203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023834705352783203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023834705352783203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([22712, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023834705352783203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1074, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06646919250488281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06646919250488281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06749343872070312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07648086547851562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1085, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07700347900390625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07700347900390625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07803821563720703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09382152557373047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1078, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09484624862670898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09484624862670898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09587430953979492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11849164962768555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([940, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11980009078979492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11980009078979492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1206965446472168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14671659469604492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([908, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14843320846557617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14843320846557617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14929914474487305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1809535026550293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([729, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18260622024536133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18260622024536133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 729, 128]), torch.Size([1, 729, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18330144882202148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2131962776184082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 729, 128])
m.shape torch.Size([663, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21506166458129883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21506166458129883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21569395065307617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24878215789794922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([612, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25080060958862305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25080060958862305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25138425827026367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.285214900970459  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([494, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28704309463500977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28704309463500977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28751420974731445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31766557693481445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([5096, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.34172964096069336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.34172964096069336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 5096, 128]), torch.Size([1, 5096, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3465895652770996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6932921409606934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 5096, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6555581092834473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6676497459411621  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.679741382598877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6675548553466797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([12679, 256])
first layer input nodes number: 22712
first layer output nodes number: 12679
edges number: 84095
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6799125671386719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6920042037963867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6950273513793945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6950273513793945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([754, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7433891296386719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7433891296386719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 754, 256]), torch.Size([1, 754, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7448272705078125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7566256523132324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 754, 256])
m.shape torch.Size([636, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7573099136352539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7573099136352539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 636, 256]), torch.Size([1, 636, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7585229873657227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7768802642822266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 636, 256])
m.shape torch.Size([596, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7780790328979492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7780790328979492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7792158126831055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8045387268066406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([437, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8059120178222656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8059120178222656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8067455291748047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8319568634033203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([406, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.834416389465332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.834416389465332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8351907730102539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8640146255493164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([320, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8654727935791016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8654727935791016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8660831451416016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8932971954345703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([286, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8949165344238281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8949165344238281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8954620361328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.923121452331543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([238, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9246788024902344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9246788024902344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9251327514648438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9510078430175781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([210, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9525976181030273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9525976181030273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.952998161315918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.978632926940918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([194, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9802975654602051  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9802975654602051  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9806675910949707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.00693941116333  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([177, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0088310241699219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0088310241699219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0091686248779297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.035501480102539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([139, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0369362831115723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0369362831115723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0372014045715332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.059736728668213  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([120, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0611038208007812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0611038208007812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0613327026367188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0823898315429688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([116, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.083836555480957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.083836555480957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0840578079223633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.105961799621582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([113, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.107480525970459  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.107480525970459  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1076960563659668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.130542278289795  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([92, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1318492889404297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1318492889404297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1320247650146484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1518535614013672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([89, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1532201766967773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1532201766967773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1533899307250977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1737604141235352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.174748420715332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.174748420715332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1748666763305664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.189885139465332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1908307075500488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1908307075500488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1909356117248535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2049927711486816  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2062478065490723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2062478065490723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2063775062561035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2246651649475098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2256903648376465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2256903648376465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2257933616638184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2410368919372559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2417678833007812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2417678833007812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2418384552001953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.252777099609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.253692626953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.253692626953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.253774642944336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2670612335205078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2679200172424316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2679200172424316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2679944038391113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2805657386779785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([528, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2932157516479492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2932157516479492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2942228317260742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4723691940307617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 528, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4302453994750977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4311113357543945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4319772720336914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.431067943572998  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5809, 40])
input nodes number: 12679
output nodes number: 5809
edges number: 49321
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4312095642089844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4312100410461426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025720596313476562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 11 input nodes size: 23037
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022843360900878906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022843360900878906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0338282585144043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03386974334716797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02299642562866211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023860454559326172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023860454559326172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023860454559326172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([23037, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023860454559326172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1233, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.061020851135253906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.061020851135253906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1233, 128]), torch.Size([1, 1233, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06219673156738281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07193899154663086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1233, 128])
m.shape torch.Size([1277, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07256889343261719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07256889343261719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1277, 128]), torch.Size([1, 1277, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07378673553466797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09241390228271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1277, 128])
m.shape torch.Size([1156, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09345865249633789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09345865249633789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1156, 128]), torch.Size([1, 1156, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09456110000610352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11934709548950195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1156, 128])
m.shape torch.Size([978, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12066125869750977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12066125869750977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12159395217895508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15022516250610352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([859, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15180683135986328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15180683135986328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15262603759765625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18211746215820312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([686, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1836705207824707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1836705207824707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 686, 128]), torch.Size([1, 686, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1843247413635254  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21267366409301758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 686, 128])
m.shape torch.Size([615, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2143993377685547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2143993377685547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21498584747314453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24581384658813477  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([527, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24753093719482422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24753093719482422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2480335235595703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27785348892211914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([481, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2796664237976074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2796664237976074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28012514114379883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30948305130004883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([4215, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.32935237884521484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.32935237884521484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 4215, 128]), torch.Size([1, 4215, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3333721160888672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6191544532775879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 4215, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5874037742614746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5988736152648926  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6103434562683105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5987839698791504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([12027, 256])
first layer input nodes number: 23037
first layer output nodes number: 12027
edges number: 74578
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6105170249938965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6219868659973145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.624854564666748  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.624854564666748  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([871, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6655817031860352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6655817031860352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 871, 256]), torch.Size([1, 871, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6672430038452148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6805334091186523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 871, 256])
m.shape torch.Size([773, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6813740730285645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6813740730285645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 773, 256]), torch.Size([1, 773, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6828484535217285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7049641609191895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 773, 256])
m.shape torch.Size([595, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7060303688049316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7060303688049316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 595, 256]), torch.Size([1, 595, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7071652412414551  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7327299118041992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 595, 256])
m.shape torch.Size([496, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7343411445617676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7343411445617676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7352871894836426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7627224922180176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([383, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7640900611877441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7640900611877441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7648205757141113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7913413047790527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([288, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7926368713378906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7926368713378906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7931861877441406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8231682777404785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([258, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8246297836303711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8246297836303711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8251218795776367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.849827766418457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8511505126953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8511505126953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8515396118164062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.87371826171875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8752107620239258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8752107620239258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8755826950073242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8993864059448242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([143, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9005751609802246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9005751609802246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9008479118347168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9202132225036621  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([109, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.921229362487793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.921229362487793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9214372634887695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9376535415649414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([104, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9387493133544922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9387493133544922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9389476776123047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9558086395263672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9568967819213867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9568967819213867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9570779800415039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9737482070922852  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9748959541320801  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9748959541320801  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9750714302062988  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9924435615539551  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([67, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9933218955993652  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9933218955993652  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9934496879577637  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.006995677947998  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0076546669006348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0076546669006348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.007744312286377  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0178742408752441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0189409255981445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0189409255981445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0190706253051758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0346345901489258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0354866981506348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0354866981506348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0355877876281738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0484261512756348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0493621826171875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0493621826171875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0494651794433594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0632667541503906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0641765594482422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0641765594482422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0642719268798828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.077718734741211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0784788131713867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0784788131713867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0785551071166992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0898466110229492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0904850959777832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0904850959777832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0905461311340332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1000065803527832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1006617546081543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1006617546081543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1007208824157715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1102995872497559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1109390258789062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1109390258789062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1109943389892578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1203422546386719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([440, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1308870315551758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1308870315551758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 440, 256]), torch.Size([1, 440, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1317262649536133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2800798416137695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 440, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2454438209533691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2462663650512695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.24708890914917  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2462248802185059  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5517, 40])
input nodes number: 12027
output nodes number: 5517
edges number: 41268
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2463126182556152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2463130950927734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025492191314697266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 12 input nodes size: 33211
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022953033447265625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022953033447265625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03878927230834961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.038832664489746094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02780628204345703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02890300750732422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02890300750732422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02890300750732422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([33211, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02890300750732422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1059, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0775289535522461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0775289535522461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07853889465332031  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08661842346191406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([1092, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08778858184814453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08778858184814453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08882999420166016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10445117950439453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1034, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10540962219238281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10540962219238281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1034, 128]), torch.Size([1, 1034, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10639572143554688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12822818756103516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1034, 128])
m.shape torch.Size([936, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12952041625976562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12952041625976562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13041305541992188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1565399169921875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([891, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1582179069519043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1582179069519043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15906763076782227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18998432159423828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([779, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1917881965637207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1917881965637207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 779, 128]), torch.Size([1, 779, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19253110885620117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2248845100402832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 779, 128])
m.shape torch.Size([718, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22690963745117188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22690963745117188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 718, 128]), torch.Size([1, 718, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22759437561035156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26253223419189453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 718, 128])
m.shape torch.Size([639, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26462745666503906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26462745666503906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26523685455322266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30008506774902344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([525, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3020334243774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3020334243774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3025341033935547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3352360725402832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([6232, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3647022247314453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3647022247314453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 6232, 128]), torch.Size([1, 6232, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3712158203125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7931900024414062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 6232, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7497067451477051  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.762967586517334  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7762284278869629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7628636360168457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([13905, 256])
first layer input nodes number: 33211
first layer output nodes number: 13905
edges number: 96401
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7764778137207031  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.789738655090332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7930541038513184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7930541038513184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([731, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8431963920593262  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8431963920593262  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 731, 256]), torch.Size([1, 731, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8445906639099121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8566045761108398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 731, 256])
m.shape torch.Size([634, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8576183319091797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8576183319091797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8588275909423828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8773555755615234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([529, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8784642219543457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8784642219543457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8794732093811035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9016709327697754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([453, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9029083251953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9029083251953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9037723541259766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9307365417480469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([402, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9322366714477539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9322366714477539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9330034255981445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9628019332885742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([324, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.964287281036377  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.964287281036377  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9649052619934082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9932551383972168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([314, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9950590133666992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9950590133666992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9956579208374023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0272760391235352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([255, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0289373397827148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0289373397827148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.029423713684082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0571470260620117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([205, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0586771965026855  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0586771965026855  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.059068202972412  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.084092617034912  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([208, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0858964920043945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0858964920043945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0862932205200195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1144609451293945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([143, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1159300804138184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1159300804138184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1162028312683105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1374773979187012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([148, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.139310359954834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.139310359954834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1395926475524902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1635870933532715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([128, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1650452613830566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1650452613830566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1652894020080566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1877503395080566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([127, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1893372535705566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1893372535705566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1895794868469238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2135605812072754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([110, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2150254249572754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2150254249572754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2152352333068848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2374749183654785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.238569736480713  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.238569736480713  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2387166023254395  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.255312442779541  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([79, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2565298080444336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2565298080444336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2566804885864258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2747621536254883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2762031555175781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2762031555175781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2763214111328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2913398742675781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2922306060791016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2922306060791016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2923297882080078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3056201934814453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3065929412841797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3065929412841797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.306692123413086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3206768035888672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3215155601501465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3215155601501465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3215994834899902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3340201377868652  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([54, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3351202011108398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3351202011108398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3352231979370117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3511877059936523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3518218994140625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3518218994140625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3518810272216797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.361459732055664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3623299598693848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3623299598693848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3624043464660645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3749756813049316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([609, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3895716667175293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3895716667175293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.390733242034912  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5955357551574707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 609, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5515427589416504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5524086952209473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5532746315002441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5523653030395508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5810, 40])
input nodes number: 13905
output nodes number: 5810
edges number: 50661
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.552556037902832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5525565147399902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03104543685913086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 13 input nodes size: 23979
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.027849674224853516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.027849674224853516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03928375244140625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.039327144622802734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023447513580322266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024271488189697266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024271488189697266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024271488189697266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([23979, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024271488189697266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1356, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05941343307495117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05941343307495117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1356, 128]), torch.Size([1, 1356, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06070661544799805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07142448425292969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1356, 128])
m.shape torch.Size([1360, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07301568984985352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07301568984985352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1360, 128]), torch.Size([1, 1360, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07431268692016602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09447717666625977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1360, 128])
m.shape torch.Size([1239, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09560108184814453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09560108184814453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1239, 128]), torch.Size([1, 1239, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09678268432617188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12277793884277344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1239, 128])
m.shape torch.Size([1036, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12417221069335938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12417221069335938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12516021728515625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15381240844726562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([960, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1556072235107422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1556072235107422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 960, 128]), torch.Size([1, 960, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1565227508544922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1899547576904297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 960, 128])
m.shape torch.Size([733, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19159412384033203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19159412384033203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 733, 128]), torch.Size([1, 733, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1922931671142578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2227010726928711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 733, 128])
m.shape torch.Size([644, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2245011329650879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2245011329650879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22511529922485352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25701475143432617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([573, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2588934898376465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2588934898376465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25943994522094727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29236555099487305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([496, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2942209243774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2942209243774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2946939468383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3249673843383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([3560, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3417062759399414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3417062759399414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 3560, 128]), torch.Size([1, 3560, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3459596633911133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.593876838684082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 3560, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5629153251647949  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5743184089660645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.585721492767334  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5742292404174805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([11957, 256])
first layer input nodes number: 23979
first layer output nodes number: 11957
edges number: 70291
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.585902214050293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5973052978515625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.600156307220459  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.600156307220459  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([950, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6406650543212891  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6406650543212891  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 950, 256]), torch.Size([1, 950, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6424770355224609  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6569728851318359  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 950, 256])
m.shape torch.Size([768, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6584053039550781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6584053039550781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 768, 256]), torch.Size([1, 768, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6598701477050781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6829743385314941  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 768, 256])
m.shape torch.Size([648, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6845836639404297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6845836639404297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 648, 256]), torch.Size([1, 648, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6858196258544922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7140617370605469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 648, 256])
m.shape torch.Size([524, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7157864570617676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7157864570617676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 524, 256]), torch.Size([1, 524, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7167859077453613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7458920478820801  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 524, 256])
m.shape torch.Size([426, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7474398612976074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7474398612976074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7482523918151855  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.778165340423584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([310, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7795472145080566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7795472145080566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7801384925842285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8057379722595215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([276, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8072996139526367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8072996139526367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.807826042175293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8347311019897461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([228, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8362212181091309  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8362212181091309  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8366560935974121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8614439964294434  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([225, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8631730079650879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8631730079650879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8636021614074707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8910679817199707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([174, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8925261497497559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8925261497497559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8928580284118652  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9164214134216309  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9177780151367188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9177780151367188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9180526733398438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9394760131835938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([125, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9407806396484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9407806396484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9410190582275391  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9612846374511719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([113, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9625773429870605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9625773429870605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9627928733825684  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9826216697692871  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9835638999938965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9835638999938965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9837126731872559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.998441219329834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9998245239257812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9998245239257812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9999885559082031  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0173759460449219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0184783935546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0184783935546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.018625259399414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0352210998535156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0361933708190918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0361933708190918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0363154411315918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0509638786315918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0516815185546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0516815185546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.051767349243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0626678466796875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.063645839691162  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.063645839691162  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0637507438659668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.077807903289795  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0788321495056152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0788321495056152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0789389610290527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0939993858337402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0946526527404785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0946526527404785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.094719409942627  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1045994758605957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1051373481750488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1051373481750488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1051888465881348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.113171100616455  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1138086318969727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1138086318969727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.113865852355957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1231355667114258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1237068176269531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1237068176269531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1237564086914062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1321372985839844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([287, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1390089988708496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1390089988708496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1395564079284668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2393078804016113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 287, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2053561210632324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2062172889709473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.207078456878662  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2061738967895508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5777, 40])
input nodes number: 11957
output nodes number: 5777
edges number: 40085
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2063016891479492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2063021659851074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025902271270751953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 14 input nodes size: 23967
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023442745208740234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023442745208740234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03487110137939453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.034914493560791016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023437023162841797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024184703826904297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024184703826904297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024184703826904297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([23967, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024184703826904297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1482, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.056725502014160156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.056725502014160156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1482, 128]), torch.Size([1, 1482, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05813884735107422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06944561004638672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1482, 128])
m.shape torch.Size([1545, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07098245620727539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07098245620727539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1545, 128]), torch.Size([1, 1545, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07245588302612305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09455728530883789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1545, 128])
m.shape torch.Size([1310, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0958251953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0958251953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1310, 128]), torch.Size([1, 1310, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09707450866699219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12456464767456055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1310, 128])
m.shape torch.Size([1048, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12598085403442383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12598085403442383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12698030471801758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15629816055297852  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([921, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15799427032470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15799427032470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1588726043701172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1904926300048828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([760, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19222784042358398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19222784042358398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 760, 128]), torch.Size([1, 760, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19295263290405273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22530126571655273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 760, 128])
m.shape torch.Size([634, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22705507278442383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22705507278442383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2276597023010254  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25789594650268555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([520, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25957727432250977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25957727432250977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.260073184967041  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28910255432128906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([464, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29152488708496094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29152488708496094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29196739196777344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.32028770446777344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([3018, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3344573974609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3344573974609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 3018, 128]), torch.Size([1, 3018, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.33733558654785156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5507402420043945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 3018, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5237488746643066  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5349087715148926  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5460686683654785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5348215103149414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([11702, 256])
first layer input nodes number: 23967
first layer output nodes number: 11702
edges number: 64813
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5462493896484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5574092864990234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5601992607116699  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5601992607116699  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([996, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5954670906066895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5954670906066895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 996, 256]), torch.Size([1, 996, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5973668098449707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6133370399475098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 996, 256])
m.shape torch.Size([900, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6141176223754883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6141176223754883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 900, 256]), torch.Size([1, 900, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6158342361450195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6415834426879883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 900, 256])
m.shape torch.Size([685, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6427006721496582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6427006721496582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 685, 256]), torch.Size([1, 685, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6440072059631348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6727509498596191  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 685, 256])
m.shape torch.Size([511, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6740622520446777  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6740622520446777  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6750369071960449  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7033019065856934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([473, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7050876617431641  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7050876617431641  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7059898376464844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7386980056762695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([373, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7403979301452637  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7403979301452637  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7411093711853027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7729010581970215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([308, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7746176719665527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7746176719665527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.775205135345459  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8046126365661621  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([239, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8061566352844238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8061566352844238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.806612491607666  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8325963020324707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8340034484863281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8340034484863281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8343639373779297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8574352264404297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([147, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8586678504943848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8586678504943848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8589482307434082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8788552284240723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.880486011505127  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.880486011505127  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8807435035705566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9008278846740723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9019908905029297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9019908905029297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9022045135498047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9203624725341797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9214053153991699  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9214053153991699  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9215807914733887  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9377245903015137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9387674331665039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9387674331665039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9389276504516602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9547891616821289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9556894302368164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9556894302368164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9558191299438477  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9695672988891602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9703178405761719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9703178405761719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9704189300537109  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.981842041015625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9824614524841309  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9824614524841309  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9825396537780762  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9919238090515137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9925594329833984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9925594329833984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9926338195800781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0020809173583984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0025372505187988  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0025372505187988  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0025887489318848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0094895362854004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0097908973693848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0097908973693848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0098233222961426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0143952369689941  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0149240493774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0149240493774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0149755477905273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.022597312927246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0231003761291504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0231003761291504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0231480598449707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0305390357971191  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0310678482055664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0310678482055664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0311155319213867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0388402938842773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0393242835998535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0393242835998535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0393662452697754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0464577674865723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([207, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0514106750488281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0514106750488281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0518054962158203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1212940216064453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 207, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0926856994628906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0935492515563965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0944128036499023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.093505859375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5795, 40])
input nodes number: 11702
output nodes number: 5795
edges number: 35453
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0936388969421387  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0936393737792969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025705337524414062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 15 input nodes size: 28419
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023439407348632812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023439407348632812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03711128234863281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0371546745300293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025682926177978516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02662801742553711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02662801742553711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02662801742553711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([28419, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02662801742553711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1193, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06827449798583984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06827449798583984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1193, 128]), torch.Size([1, 1193, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0694122314453125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07851409912109375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1193, 128])
m.shape torch.Size([1352, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07923460006713867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07923460006713867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1352, 128]), torch.Size([1, 1352, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08052396774291992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10026311874389648  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1352, 128])
m.shape torch.Size([1216, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10135793685913086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10135793685913086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1216, 128]), torch.Size([1, 1216, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10251760482788086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12900686264038086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1216, 128])
m.shape torch.Size([1170, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13065862655639648  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13065862655639648  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1170, 128]), torch.Size([1, 1170, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1317744255065918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16413259506225586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1170, 128])
m.shape torch.Size([977, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16590404510498047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16590404510498047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16683578491210938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20136022567749023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([813, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20322036743164062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20322036743164062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2039957046508789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23820209503173828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([740, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24028444290161133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24028444290161133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 740, 128]), torch.Size([1, 740, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24099016189575195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27655839920043945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 740, 128])
m.shape torch.Size([728, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27898263931274414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27898263931274414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 728, 128]), torch.Size([1, 728, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2796769142150879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31934213638305664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 728, 128])
m.shape torch.Size([577, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3214712142944336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3214712142944336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.322021484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3577704429626465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([4559, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.37923431396484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.37923431396484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 4559, 128]), torch.Size([1, 4559, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.38358211517333984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6922760009765625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 4559, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6563863754272461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6690940856933594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6818017959594727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6689944267272949  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([13325, 256])
first layer input nodes number: 28419
first layer output nodes number: 13325
edges number: 83775
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6820158958435059  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6947236061096191  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6979007720947266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6979007720947266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([783, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7402234077453613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7402234077453613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7417168617248535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7547039985656738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 783, 256])
m.shape torch.Size([744, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7554464340209961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7554464340209961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 744, 256]), torch.Size([1, 744, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7568655014038086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7781515121459961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 744, 256])
m.shape torch.Size([607, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7793784141540527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7793784141540527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 607, 256]), torch.Size([1, 607, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7805361747741699  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.806006908416748  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 607, 256])
m.shape torch.Size([532, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.807584285736084  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.807584285736084  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8085989952087402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.839353084564209  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([421, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8410015106201172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8410015106201172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8418045043945312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8728823661804199  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([319, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8743205070495605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8743205070495605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8749289512634277  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9013724327087402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([286, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9029927253723145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9029927253723145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9035382270812988  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9316744804382324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([315, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9338240623474121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9338240623474121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.934424877166748  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9689764976501465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([204, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9704408645629883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9704408645629883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.970829963684082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.995732307434082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([171, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9971814155578613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9971814155578613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9975075721740723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0206646919250488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([148, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.022066593170166  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.022066593170166  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0223488807678223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0443673133850098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([146, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.045910358428955  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.045910358428955  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0461888313293457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0698590278625488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([124, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0712695121765137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0712695121765137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0715060234069824  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0932650566101074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([107, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0945868492126465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0945868492126465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0947909355163574  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1149954795837402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([90, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1161913871765137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1161913871765137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1163630485534668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.134559154510498  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1356267929077148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1356267929077148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1357698440551758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1519346237182617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([62, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1528782844543457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1528782844543457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.15299654006958  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.167187213897705  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1682162284851074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1682162284851074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.168332576751709  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1831088066101074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1840734481811523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1840734481811523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1841802597045898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1984930038452148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1992473602294922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1992473602294922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1993274688720703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.210622787475586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2115516662597656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2115516662597656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2116432189941406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2251930236816406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2260355949401855  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2260355949401855  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2261157035827637  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.238532543182373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2392001152038574  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2392001152038574  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2392611503601074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2491488456726074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2496719360351562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2496719360351562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2497177124023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2574539184570312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([332, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2654085159301758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2654085159301758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])[05:28:32] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21724554 edges into 16 parts and get 5469599 edge cuts

----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2660417556762695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3795576095581055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 332, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3436040878295898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3444643020629883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3453245162963867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3444209098815918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5771, 40])
input nodes number: 13325
output nodes number: 5771
edges number: 42947
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3445606231689453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3445611000061035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.028467178344726562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.028467178344726562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.028467178344726562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01103895902633667 |0.0018622130155563354 |0.11666636168956757 |8.806586265563965e-05 |0.07616007328033447 |0.00474095344543457 |
----------------------------------------------------------pseudo_mini_loss sum 4.763493061065674
Total (block generation + training)time/epoch 26.53296947479248
Training time/epoch 3.3849096298217773
Training time without block to device /epoch 3.355114221572876
Training time without total dataloading part /epoch 3.0913729667663574
load block tensor time/epoch 0.17662334442138672
block to device time/epoch 0.029795408248901367
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  854188
Number of first layer input nodes during this epoch:  581591
Number of first layer output nodes during this epoch:  272597
----------------------------------------before generate dataloader block 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02846670150756836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02296733856201172
global_2_local spend time (sec) 0.05282711982727051
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004434823989868164
A = g.adjacency_matrix() spent  0.01386880874633789
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08400702476501465
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.2979192733764648
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1632883548736572

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11704867, 2.0: 2016386, 3.0: 505014, 4.0: 151832, 5.0: 55157, 6.0: 24090, 7.0: 11047, 8.0: 5737, 9.0: 3033, 10.0: 1743, 11.0: 999, 12.0: 546, 13.0: 336, 14.0: 193, 15.0: 115, 16.0: 108, 17.0: 90, 18.0: 42, 19.0: 26, 20.0: 6, 21.0: 3})
Convert a graph into a bidirected graph: 0.792 seconds
Metis partitioning: 4.482 seconds
Split the graph: 0.523 seconds
Construct subgraphs: 0.042 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  5.848762512207031
5832
5807
5554
5845
5797
5851
5805
5813
5804
5519
5539
5592
5495
5486
5486
5716
total k batches seeds list generation spend  19.050422430038452
after graph partition
graph partition algorithm spend time 19.134838581085205
5832
5807
5554
5845
5797
5851
5805
5813
5804
5519
5539
5592
5495
5486
5486
5716
partition_len_list
[10833, 12420, 12875, 12442, 10941, 11995, 12903, 14734, 13826, 13795, 18487, 22230, 27131, 29937, 25553, 29044]
shared_neighbor_graph_partition_s0 selection method  spend 19.245853662490845
time for parepare:  0.01768970489501953
local_output_nid generation:  0.0014400482177734375
local_in_edges_tensor generation:  0.0014891624450683594
mini_batch_src_global generation:  0.001779794692993164
r_  generation:  0.015799522399902344
local_output_nid generation:  0.0018048286437988281
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.0017998218536376953
r_  generation:  0.014887809753417969
local_output_nid generation:  0.0017542839050292969
local_in_edges_tensor generation:  0.0013027191162109375
mini_batch_src_global generation:  0.0014286041259765625
r_  generation:  0.014986038208007812
local_output_nid generation:  0.0018157958984375
local_in_edges_tensor generation:  0.0016472339630126953
mini_batch_src_global generation:  0.0017154216766357422
r_  generation:  0.017068147659301758
local_output_nid generation:  0.001920461654663086
local_in_edges_tensor generation:  0.0012428760528564453
mini_batch_src_global generation:  0.0012352466583251953
r_  generation:  0.01303553581237793
local_output_nid generation:  0.001821279525756836
local_in_edges_tensor generation:  0.0012886524200439453
mini_batch_src_global generation:  0.0012047290802001953
r_  generation:  0.013827085494995117
local_output_nid generation:  0.0018167495727539062
local_in_edges_tensor generation:  0.001194000244140625
mini_batch_src_global generation:  0.0012176036834716797
r_  generation:  0.01405954360961914
local_output_nid generation:  0.00197601318359375
local_in_edges_tensor generation:  0.0015377998352050781
mini_batch_src_global generation:  0.0016548633575439453
r_  generation:  0.015409708023071289
local_output_nid generation:  0.0019047260284423828
local_in_edges_tensor generation:  0.0013661384582519531
mini_batch_src_global generation:  0.001272439956665039
r_  generation:  0.01414036750793457
local_output_nid generation:  0.001756906509399414
local_in_edges_tensor generation:  0.0013763904571533203
mini_batch_src_global generation:  0.0012078285217285156
r_  generation:  0.012517213821411133
local_output_nid generation:  0.0018229484558105469
local_in_edges_tensor generation:  0.0012068748474121094
mini_batch_src_global generation:  0.001230478286743164
r_  generation:  0.014085769653320312
local_output_nid generation:  0.0018086433410644531
local_in_edges_tensor generation:  0.0012950897216796875
mini_batch_src_global generation:  0.0014538764953613281
r_  generation:  0.015690088272094727
local_output_nid generation:  0.0018410682678222656
local_in_edges_tensor generation:  0.0015347003936767578
mini_batch_src_global generation:  0.001444101333618164
r_  generation:  0.016858577728271484
local_output_nid generation:  0.0019304752349853516
local_in_edges_tensor generation:  0.0016405582427978516
mini_batch_src_global generation:  0.0019533634185791016
r_  generation:  0.021350622177124023
local_output_nid generation:  0.0020835399627685547
local_in_edges_tensor generation:  0.001665353775024414
mini_batch_src_global generation:  0.0019414424896240234
r_  generation:  0.020813465118408203
local_output_nid generation:  0.0021190643310546875
local_in_edges_tensor generation:  0.0019335746765136719
mini_batch_src_global generation:  0.002395153045654297
r_  generation:  0.02470088005065918
----------------------check_connections_block total spend ----------------------------- 0.44629621505737305
generate_one_block  0.027149677276611328
generate_one_block  0.022940874099731445
generate_one_block  0.022590160369873047
generate_one_block  0.023457765579223633
generate_one_block  0.017669200897216797
generate_one_block  0.01824331283569336
generate_one_block  0.018794775009155273
generate_one_block  0.021094083786010742
generate_one_block  0.019237518310546875
generate_one_block  0.01674938201904297
generate_one_block  0.020933866500854492
generate_one_block  0.02340388298034668
generate_one_block  0.024168014526367188
generate_one_block  0.029630184173583984
generate_one_block  0.028567790985107422
generate_one_block  0.035207509994506836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047699928283691406
gen group dst list time:  0.008237600326538086
time for parepare:  0.021820783615112305
local_output_nid generation:  0.0027685165405273438
local_in_edges_tensor generation:  0.0121307373046875
mini_batch_src_global generation:  0.002448558807373047
r_  generation:  0.023781299591064453
local_output_nid generation:  0.003921031951904297
local_in_edges_tensor generation:  0.003332853317260742
mini_batch_src_global generation:  0.002897977828979492
r_  generation:  0.028829574584960938
local_output_nid generation:  0.004033803939819336
local_in_edges_tensor generation:  0.003261566162109375
mini_batch_src_global generation:  0.0028133392333984375
r_  generation:  0.03023362159729004
local_output_nid generation:  0.0038475990295410156
local_in_edges_tensor generation:  0.002937793731689453
mini_batch_src_global generation:  0.0025262832641601562
r_  generation:  0.02834939956665039
local_output_nid generation:  0.003542184829711914
local_in_edges_tensor generation:  0.002694845199584961
mini_batch_src_global generation:  0.001959085464477539
r_  generation:  0.02205824851989746
local_output_nid generation:  0.003675222396850586
local_in_edges_tensor generation:  0.0026297569274902344
mini_batch_src_global generation:  0.001953601837158203
r_  generation:  0.025455474853515625
local_output_nid generation:  0.003906726837158203
local_in_edges_tensor generation:  0.005911827087402344
mini_batch_src_global generation:  0.002256631851196289
r_  generation:  0.027865886688232422
local_output_nid generation:  0.004414558410644531
local_in_edges_tensor generation:  0.003609895706176758
mini_batch_src_global generation:  0.0030488967895507812
r_  generation:  0.034235239028930664
local_output_nid generation:  0.004219532012939453
local_in_edges_tensor generation:  0.0031898021697998047
mini_batch_src_global generation:  0.002755880355834961
r_  generation:  0.03081512451171875
local_output_nid generation:  0.00519108772277832
local_in_edges_tensor generation:  0.0033550262451171875
mini_batch_src_global generation:  0.0027883052825927734
r_  generation:  0.030823230743408203
local_output_nid generation:  0.0057220458984375
local_in_edges_tensor generation:  0.004770994186401367
mini_batch_src_global generation:  0.004784584045410156
r_  generation:  0.04636740684509277
local_output_nid generation:  0.006821632385253906
local_in_edges_tensor generation:  0.00669550895690918
mini_batch_src_global generation:  0.005999326705932617
r_  generation:  0.05994462966918945
local_output_nid generation:  0.008429527282714844
local_in_edges_tensor generation:  0.008705854415893555
mini_batch_src_global generation:  0.009607315063476562
r_  generation:  0.07721972465515137
local_output_nid generation:  0.008840084075927734
local_in_edges_tensor generation:  0.007750034332275391
mini_batch_src_global generation:  0.009965896606445312
r_  generation:  0.08894658088684082
local_output_nid generation:  0.007825613021850586
local_in_edges_tensor generation:  0.007250070571899414
mini_batch_src_global generation:  0.01142573356628418
r_  generation:  0.07485365867614746
local_output_nid generation:  0.008699417114257812
local_in_edges_tensor generation:  0.007221221923828125
mini_batch_src_global generation:  0.010835647583007812
r_  generation:  0.09245824813842773
----------------------check_connections_block total spend ----------------------------- 1.1717286109924316
generate_one_block  0.05108451843261719
generate_one_block  0.038431406021118164
generate_one_block  0.03732943534851074
generate_one_block  0.03745913505554199
generate_one_block  0.02837991714477539
generate_one_block  0.03115391731262207
generate_one_block  0.035402536392211914
generate_one_block  0.046304941177368164
generate_one_block  0.03963613510131836
generate_one_block  0.04000282287597656
generate_one_block  0.06368756294250488
generate_one_block  0.07944917678833008
generate_one_block  0.10350370407104492
generate_one_block  0.1218874454498291
generate_one_block  0.09668970108032227
generate_one_block  0.11563324928283691
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02846670150756836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

connection checking time:  1.1717286109924316
block generation total time  0.9660356044769287
average batch blocks generation time:  0.060377225279808044
block dataloader generation time/epoch 22.780770778656006
pseudo mini batch 0 input nodes size: 20424
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025678634643554688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025678634643554688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03541755676269531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03546142578125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.021746158599853516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02262258529663086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02262258529663086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02262258529663086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([20424, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02262258529663086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([889, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05760049819946289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05760049819946289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05844831466674805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06577253341674805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([1010, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06631183624267578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06631183624267578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0672750473022461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08172321319580078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([945, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08306312561035156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08306312561035156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08396434783935547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10422611236572266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([874, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10544252395629883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10544252395629883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10627603530883789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1304478645324707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([744, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1318049430847168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1318049430847168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13251447677612305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15829038619995117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([711, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15996980667114258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15996980667114258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 711, 128]), torch.Size([1, 711, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16064786911010742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19071340560913086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 711, 128])
m.shape torch.Size([592, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1923503875732422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1923503875732422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1929149627685547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.221923828125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([549, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22373580932617188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22373580932617188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2242593765258789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2547111511230469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([448, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25637197494506836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25637197494506836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25679922103881836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28414297103881836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([4071, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30346059799194336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30346059799194336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 4071, 128]), torch.Size([1, 4071, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3073430061340332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5843052864074707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 4071, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5537681579589844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5640993118286133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5744304656982422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5640182495117188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([10833, 256])
first layer input nodes number: 20424
first layer output nodes number: 10833
edges number: 70504
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5745849609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5849161148071289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5874991416931152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5874991416931152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([661, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6336445808410645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6336445808410645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 661, 256]), torch.Size([1, 661, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6349053382873535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.644991397857666  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 661, 256])
m.shape torch.Size([659, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.645789623260498  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.645789623260498  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 659, 256]), torch.Size([1, 659, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6470465660095215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6660385131835938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 659, 256])
m.shape torch.Size([572, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.667081356048584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.667081356048584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6681723594665527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6931185722351074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 572, 256])
m.shape torch.Size([502, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6945033073425293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6945033073425293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6954607963562012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.723609447479248  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([416, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7251300811767578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7251300811767578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7259235382080078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7545795440673828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([400, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7564897537231445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7564897537231445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7572526931762695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7902727127075195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([319, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7926545143127441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7926545143127441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7932629585266113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8248629570007324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([268, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8266196250915527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8266196250915527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8271307945251465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8563742637634277  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([217, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8579959869384766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8579959869384766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8584098815917969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8848991394042969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([216, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8867683410644531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8867683410644531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8871803283691406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9164314270019531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([196, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9182977676391602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9182977676391602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9186716079711914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9478311538696289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([131, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.949155330657959  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.949155330657959  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9494051933288574  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9706435203552246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([144, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.972318172454834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.972318172454834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.972592830657959  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.997861385345459  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([126, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9994196891784668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9994196891784668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9996600151062012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0234522819519043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([83, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0247712135314941  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0247712135314941  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0249295234680176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.041710376739502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([101, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.043184757232666  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.043184757232666  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.04337739944458  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0651459693908691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0666022300720215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0666022300720215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0667834281921387  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0885272026062012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0896649360656738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0896649360656738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0898003578186035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1069989204406738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1078810691833496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1078810691833496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1079802513122559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1212706565856934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([80, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1227588653564453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1227588653564453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1229114532470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1444263458251953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1455211639404297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1455211639404297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1456317901611328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1620044708251953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1628165245056152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1628165245056152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1628947257995605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.175015926361084  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1756625175476074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1756625175476074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1757216453552246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.185300350189209  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1862397193908691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1862397193908691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1863198280334473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1998581886291504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([351, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2082524299621582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2082524299621582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2089219093322754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3308377265930176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 351, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2911834716796875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2920527458190918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.292922019958496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.292008876800537  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5832, 40])
input nodes number: 10833
output nodes number: 5832
edges number: 46995
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2921428680419922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2921438217163086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024321556091308594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 1 input nodes size: 28299
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02175617218017578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02175617218017578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03542804718017578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.035471439361572266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025688648223876953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026607990264892578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026607990264892578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026607990264892578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([28299, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026607990264892578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1147, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0661764144897461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0661764144897461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1147, 128]), torch.Size([1, 1147, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06727027893066406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07602119445800781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1147, 128])
m.shape torch.Size([1255, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07667112350463867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07667112350463867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1255, 128]), torch.Size([1, 1255, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07786798477172852  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09582090377807617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1255, 128])
m.shape torch.Size([1166, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09689044952392578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09689044952392578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1166, 128]), torch.Size([1, 1166, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09800243377685547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12267112731933594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1166, 128])
m.shape torch.Size([944, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1239156723022461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1239156723022461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1248159408569336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1509237289428711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([815, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15241670608520508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15241670608520508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15319395065307617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18135976791381836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([711, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18300533294677734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18300533294677734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 711, 128]), torch.Size([1, 711, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1836833953857422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21300983428955078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 711, 128])
m.shape torch.Size([613, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21471691131591797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21471691131591797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 613, 128]), torch.Size([1, 613, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.215301513671875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2454218864440918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 613, 128])
m.shape torch.Size([584, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24735736846923828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24735736846923828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24791431427001953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2800469398498535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 584, 128])
m.shape torch.Size([483, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2818412780761719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2818412780761719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2823019027709961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3117818832397461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([4702, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3339724540710449  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3339724540710449  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 4702, 128]), torch.Size([1, 4702, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3391842842102051  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6590099334716797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 4702, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6237668991088867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6356115341186523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.647456169128418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6355185508728027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([12420, 256])
first layer input nodes number: 28299
first layer output nodes number: 12420
edges number: 79602
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6476693153381348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6595139503479004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6633505821228027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6633505821228027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([812, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7063288688659668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7063288688659668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 812, 256]), torch.Size([1, 812, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7078776359558105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7202677726745605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 812, 256])
m.shape torch.Size([785, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7210483551025391  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7210483551025391  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 785, 256]), torch.Size([1, 785, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7225456237792969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7450046539306641  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 785, 256])
m.shape torch.Size([646, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7470955848693848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7470955848693848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 646, 256]), torch.Size([1, 646, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7483277320861816  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7754349708557129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 646, 256])
m.shape torch.Size([502, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.777061939239502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.777061939239502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7780194282531738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8061528205871582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([398, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8075871467590332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8075871467590332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8083462715148926  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8368191719055176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([314, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8382506370544434  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8382506370544434  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8388495445251465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8675885200500488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([269, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8690991401672363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8690991401672363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8696122169494629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8958964347839355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([246, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8975315093994141  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8975315093994141  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8980007171630859  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9247455596923828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([210, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9263277053833008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9263277053833008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9267282485961914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9523630142211914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([194, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9540276527404785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9540276527404785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9543976783752441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9806694984436035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([175, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.982335090637207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.982335090637207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9826688766479492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0087041854858398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([142, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0101752281188965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0101752281188965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0104460716247559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0334677696228027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([127, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.034919261932373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.034919261932373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0351614952087402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0574469566345215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0586447715759277  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0586447715759277  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0588316917419434  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0773367881774902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0785841941833496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0785841941833496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0787615776062012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0975642204284668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0982294082641602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0982294082641602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.098322868347168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1088838577270508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1101508140563965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1101508140563965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.110267162322998  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1242289543151855  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1250362396240234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1250362396240234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.125131607055664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1372432708740234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1380906105041504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1380906105041504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1381840705871582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.150707721710205  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1515836715698242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1515836715698242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1516752243041992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1645841598510742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.165285587310791  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.165285587310791  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.165356159210205  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1758008003234863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1767597198486328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1767597198486328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.176849365234375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.190744400024414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1911420822143555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1911420822143555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1911802291870117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1973600387573242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.198009967803955  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.198009967803955  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1980652809143066  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2074131965637207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([406, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2171411514282227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2171411514282227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2179155349731445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.359889030456543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 406, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3232769966125488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3241424560546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3250079154968262  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.324099063873291  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5807, 40])
input nodes number: 12420
output nodes number: 5807
edges number: 43659
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3242316246032715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3242321014404297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02840566635131836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 2 input nodes size: 26211
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025684833526611328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025684833526611328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03818321228027344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03822469711303711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024509429931640625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025453567504882812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025453567504882812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025453567504882812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([26211, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025453567504882812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1292, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06622743606567383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06622743606567383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1292, 128]), torch.Size([1, 1292, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0674595832824707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0773167610168457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1292, 128])
m.shape torch.Size([1307, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07794713973999023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07794713973999023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1307, 128]), torch.Size([1, 1307, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0791935920715332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09793710708618164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1307, 128])
m.shape torch.Size([1175, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09899473190307617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09899473190307617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1175, 128]), torch.Size([1, 1175, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10011529922485352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12476778030395508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1175, 128])
m.shape torch.Size([1006, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12622690200805664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12622690200805664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1006, 128]), torch.Size([1, 1006, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12718629837036133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1550297737121582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1006, 128])
m.shape torch.Size([865, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15661239624023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15661239624023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15743732452392578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18729829788208008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([796, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1891632080078125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1891632080078125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18992233276367188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22264862060546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([638, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22439861297607422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22439861297607422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2250070571899414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25620269775390625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([540, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25795841217041016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25795841217041016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25847339630126953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28812360763549805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([482, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2899346351623535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2899346351623535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29039430618286133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31981325149536133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([4774, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3423476219177246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3423476219177246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 4774, 128]), torch.Size([1, 4774, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.34725046157836914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6708521842956543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 4774, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6350555419921875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.647334098815918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6596126556396484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6472377777099609  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([12875, 256])
first layer input nodes number: 26211
first layer output nodes number: 12875
edges number: 81420
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6598100662231445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.672088623046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6751585006713867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6751585006713867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([855, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7195243835449219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7195243835449219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 855, 256]), torch.Size([1, 855, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7211551666259766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7349309921264648  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 855, 256])
m.shape torch.Size([713, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.735654354095459  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.735654354095459  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 713, 256]), torch.Size([1, 713, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7370142936706543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7576541900634766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 713, 256])
m.shape torch.Size([596, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7588005065917969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7588005065917969  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7599372863769531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7849464416503906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([416, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7862033843994141  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7862033843994141  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7869968414306641  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8103599548339844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([363, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8117079734802246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8117079734802246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8124003410339355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8373293876647949  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([311, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8387770652770996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8387770652770996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8393702507019043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8671698570251465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([238, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8684749603271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8684749603271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8689289093017578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8916263580322266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([183, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8928065299987793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8928065299987793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.893155574798584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9130511283874512  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9143905639648438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9143905639648438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9147243499755859  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9360866546630859  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9374480247497559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9374480247497559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.937751293182373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9592833518981934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9606013298034668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9606013298034668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9608664512634277  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9815459251403809  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([144, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9830741882324219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9830741882324219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9833488464355469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0066947937011719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.007707118988037  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.007707118988037  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0078825950622559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0240263938903809  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.02492094039917  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.02492094039917  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0250601768493652  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0388445854187012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0409464836120605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0409464836120605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0411200523376465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0595183372497559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([62, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0603852272033691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0603852272033691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0605034828186035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.073866367340088  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([81, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0751309394836426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0751309394836426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0752854347229004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.093824863433838  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0947742462158203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0947742462158203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0948867797851562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1091785430908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([64, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1102910041809082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1102910041809082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1104130744934082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1267704963684082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1274785995483398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1274785995483398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1275548934936523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1383123397827148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1393957138061523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1393957138061523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1394929885864258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1538896560668945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1545815467834473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1545815467834473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1546483039855957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1649956703186035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.165891170501709  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.165891170501709  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.165971279144287  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1789488792419434  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1796703338623047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1796703338623047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1797332763671875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1903705596923828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([539, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2032904624938965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2032904624938965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2043185234069824  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.385352611541748  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 539, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.347032070159912  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3478598594665527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3486876487731934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.347818374633789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5554, 40])
input nodes number: 12875
output nodes number: 5554
edges number: 45070
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3479185104370117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.34791898727417  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.027243614196777344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 3 input nodes size: 21301
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024471759796142578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.024471759796142578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.034628868103027344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03467273712158203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02213287353515625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02313995361328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02313995361328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02313995361328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([21301, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02313995361328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([964, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06442928314208984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06442928314208984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 964, 128]), torch.Size([1, 964, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06534862518310547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07270336151123047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 964, 128])
m.shape torch.Size([1069, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07352399826049805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07352399826049805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07454347610473633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08983564376831055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1059, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09100198745727539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09100198745727539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09201192855834961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11423063278198242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([904, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11556434631347656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11556434631347656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11642646789550781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14223861694335938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([874, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1438913345336914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1438913345336914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14472484588623047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1751079559326172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([743, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1768169403076172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1768169403076172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17752552032470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20824146270751953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([663, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2101001739501953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2101001739501953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21073246002197266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24290943145751953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([592, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24485158920288086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24485158920288086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24541616439819336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27809619903564453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([509, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2799983024597168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2799983024597168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2804837226867676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3115506172180176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([5065, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.33545970916748047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.33545970916748047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 5065, 128]), torch.Size([1, 5065, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3402900695800781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6868124008178711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 5065, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6501450538635254  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.662010669708252  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6738762855529785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6619176864624023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([12442, 256])
first layer input nodes number: 21301
first layer output nodes number: 12442
edges number: 83331
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.674036979675293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6859025955200195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6888689994812012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6888689994812012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([669, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7393984794616699  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7393984794616699  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7406744956970215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7513699531555176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 669, 256])
m.shape torch.Size([608, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7519798278808594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7519798278808594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7531394958496094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.771812915802002  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 608, 256])
m.shape torch.Size([557, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7734432220458984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7734432220458984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.774505615234375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7978782653808594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([466, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7991390228271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7991390228271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8000278472900391  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8258037567138672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([404, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.827301025390625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.827301025390625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8280715942382812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8562049865722656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([323, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8576827049255371  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8576827049255371  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8582987785339355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8853187561035156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([306, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8870697021484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8870697021484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8876533508300781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9175395965576172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([266, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9192934036254883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9192934036254883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9198007583618164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9492692947387695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([231, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9510140419006348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9510140419006348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9514546394348145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9796528816223145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([197, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9813261032104492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9813261032104492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9817018508911133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0083799362182617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([183, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.010127067565918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.010127067565918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0104761123657227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0377016067504883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([146, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0392112731933594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0392112731933594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.03948974609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0631599426269531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([124, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.064570426940918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.064570426940918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0648069381713867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0865659713745117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([129, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.088183879852295  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.088183879852295  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0884299278259277  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1127886772155762  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([107, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.114208698272705  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.114208698272705  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.114412784576416  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1360459327697754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1371588706970215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1371588706970215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1373095512390137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1543364524841309  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([91, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1557483673095703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1557483673095703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1559219360351562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1767501831054688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.178236484527588  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.178236484527588  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1783623695373535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.194349765777588  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.195218563079834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.195218563079834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1953158378601074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.208350658416748  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([71, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2096672058105469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2096672058105469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2098026275634766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2288970947265625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([62, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2300810813903809  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2300810813903809  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2301993370056152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2477011680603027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.248445987701416  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.248445987701416  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.248518466949463  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2597527503967285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.260711669921875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.260711669921875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2607975006103516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2747020721435547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2755818367004395  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2755818367004395  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.275658130645752  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2885518074035645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([586, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3025941848754883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3025941848754883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3037118911743164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5017480850219727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 586, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4573721885681152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4582433700561523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4591145515441895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4581995010375977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5845, 40])
input nodes number: 12442
output nodes number: 5845
edges number: 51656
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4583797454833984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4583802223205566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025079727172851562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 4 input nodes size: 20001
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022176265716552734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022176265716552734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03171348571777344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03175687789916992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02155590057373047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02227306365966797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02227306365966797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02227306365966797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([20001, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02227306365966797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1339, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.052163124084472656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.052163124084472656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1339, 128]), torch.Size([1, 1339, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.053440093994140625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06365585327148438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1339, 128])
m.shape torch.Size([1473, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06459808349609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06459808349609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1473, 128]), torch.Size([1, 1473, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06600284576416016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08707427978515625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1473, 128])
m.shape torch.Size([1249, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0888056755065918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0888056755065918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1249, 128]), torch.Size([1, 1249, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0899968147277832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11657285690307617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1249, 128])
m.shape torch.Size([1087, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11805057525634766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11805057525634766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11908721923828125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15002155303955078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([905, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15166091918945312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15166091918945312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15252399444580078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18370676040649414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([740, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1853923797607422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1853923797607422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 740, 128]), torch.Size([1, 740, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1860980987548828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2170562744140625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 740, 128])
m.shape torch.Size([598, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21869945526123047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21869945526123047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2192697525024414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24898719787597656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([507, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25063610076904297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25063610076904297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25111961364746094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27867984771728516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([475, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28047657012939453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28047657012939453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2809295654296875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3099212646484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([2568, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.32193994522094727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.32193994522094727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 2568, 128]), torch.Size([1, 2568, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3243889808654785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.49827051162719727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 2568, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4736599922180176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.48409414291381836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.49452829360961914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4840126037597656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([10941, 256])
first layer input nodes number: 20001
first layer output nodes number: 10941
edges number: 59542
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.49467945098876953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5051136016845703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5077223777770996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5077223777770996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([891, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5438814163208008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5438814163208008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 891, 256]), torch.Size([1, 891, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5455808639526367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5605244636535645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 891, 256])
m.shape torch.Size([837, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.561284065246582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.561284065246582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5628805160522461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5868749618530273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([673, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5881161689758301  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5881161689758301  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 673, 256]), torch.Size([1, 673, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5893998146057129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6179280281066895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 673, 256])
m.shape torch.Size([569, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.619473934173584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.619473934173584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6205592155456543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6526122093200684  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([447, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6542530059814453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6542530059814453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6551055908203125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6861076354980469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([378, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.687861442565918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.687861442565918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6885824203491211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7197751998901367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([323, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7216596603393555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7216596603393555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7222757339477539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.753448486328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([241, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7549939155578613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7549939155578613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7554535865783691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7816548347473145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([233, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7834405899047852  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7834405899047852  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7838850021362305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8123273849487305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([180, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.813835620880127  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.813835620880127  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8141789436340332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.838554859161377  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([142, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8398847579956055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8398847579956055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8401556015014648  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8612813949584961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8624954223632812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8624954223632812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8627185821533203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8816871643066406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([113, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8829874992370605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8829874992370605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8832030296325684  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9030318260192871  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9041624069213867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9041624069213867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9043378829956055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9217100143432617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([94, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9229779243469238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9229779243469238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9231572151184082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.942162036895752  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9429030418395996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9429030418395996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9430060386657715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9546446800231934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9552469253540039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9552469253540039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9553232192993164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9644784927368164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.96527099609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.96527099609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.965362548828125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.97698974609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9777660369873047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9777660369873047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9778518676757812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9893531799316406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9899449348449707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9899449348449707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9900078773498535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9988827705383301  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9992351531982422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9992351531982422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9992713928222656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0046348571777344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.005018711090088  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.005018711090088  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0050549507141113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0106720924377441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0110740661621094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0110740661621094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0111103057861328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0169811248779297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0174708366394043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0174708366394043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0175127983093262  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.024604320526123  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([168, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0286202430725098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0286202430725098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0289406776428223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0853371620178223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 168, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0557842254638672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0566482543945312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0575122833251953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0566048622131348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5797, 40])
input nodes number: 10941
output nodes number: 5797
edges number: 36487
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.056722640991211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0567231178283691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.023715496063232422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 5 input nodes size: 22394
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.021548748016357422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.021548748016357422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0322270393371582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03227090835571289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022690296173095703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02348470687866211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02348470687866211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02348470687866211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([22394, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02348470687866211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1443, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.057311058044433594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.057311058044433594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1443, 128]), torch.Size([1, 1443, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05868721008300781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06993770599365234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1443, 128])
m.shape torch.Size([1511, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07069063186645508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07069063186645508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1511, 128]), torch.Size([1, 1511, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07213163375854492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09444952011108398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1511, 128])
m.shape torch.Size([1270, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09554576873779297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09554576873779297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1270, 128]), torch.Size([1, 1270, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0967569351196289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12340259552001953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1270, 128])
m.shape torch.Size([1155, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12537193298339844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12537193298339844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1155, 128]), torch.Size([1, 1155, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12647342681884766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.158416748046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1155, 128])
m.shape torch.Size([937, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16009998321533203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16009998321533203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 937, 128]), torch.Size([1, 937, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1609935760498047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1932830810546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 937, 128])
m.shape torch.Size([792, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19510221481323242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19510221481323242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19585752487182617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22913312911987305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([676, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23101186752319336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23101186752319336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23165655136108398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26450109481811523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([601, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26694822311401367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26694822311401367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26752138137817383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3003354072570801  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([485, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30213022232055664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30213022232055664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30259275436401367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.33219480514526367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([3125, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3468647003173828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3468647003173828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 3125, 128]), torch.Size([1, 3125, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.34984493255615234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5634994506835938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 3125, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.535158634185791  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5474801063537598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5589194297790527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5465083122253418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([11995, 256])
first layer input nodes number: 22394
first layer output nodes number: 11995
edges number: 67487
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5590882301330566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5705275535583496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.573387622833252  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.573387622833252  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([987, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6120247840881348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6120247840881348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 987, 256]), torch.Size([1, 987, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6139073371887207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6295294761657715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 987, 256])
m.shape torch.Size([833, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6305055618286133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6305055618286133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 833, 256]), torch.Size([1, 833, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6320943832397461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6559267044067383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 833, 256])
m.shape torch.Size([642, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6569838523864746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6569838523864746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 642, 256]), torch.Size([1, 642, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6582083702087402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.685147762298584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 642, 256])
m.shape torch.Size([520, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6869392395019531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6869392395019531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6879310607910156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7166938781738281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([449, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7183561325073242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7183561325073242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.719212532043457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7500667572021484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([339, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7515935897827148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7515935897827148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7522401809692383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7810478210449219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([274, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7825679779052734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7825679779052734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7830905914306641  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8099279403686523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([239, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8115043640136719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8115043640136719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8119602203369141  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8379440307617188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([202, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8394637107849121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8394637107849121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8398489952087402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8645071983337402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([186, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8661026954650879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8661026954650879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.866457462310791  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8916459083557129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([143, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8929805755615234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8929805755615234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8932533264160156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9145278930664062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9159603118896484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9159603118896484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9162197113037109  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9382686614990234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.939326286315918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.939326286315918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9395074844360352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9561777114868164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9573254585266113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9573254585266113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9575009346008301  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9748730659484863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9759387969970703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9759387969970703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9760913848876953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9922657012939453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.993250846862793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.993250846862793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.993382453918457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.008254051208496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0091524124145508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0091524124145508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0092649459838867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0227689743041992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0236296653747559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0236296653747559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.023730754852295  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0365691184997559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0374135971069336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0374135971069336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0375070571899414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0500307083129883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0507144927978516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0507144927978516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0507869720458984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0610065460205078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0617375373840332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0617375373840332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.06181001663208  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0725369453430176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0730295181274414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0730295181274414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0730772018432617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0804681777954102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0811519622802734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0811519622802734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0812129974365234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0911006927490234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0915780067443848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0915780067443848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0916199684143066  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0987114906311035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([249, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1046738624572754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1046738624572754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1051487922668457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1887364387512207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 249, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1567912101745605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.157663345336914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1585354804992676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1576194763183594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5851, 40])
input nodes number: 11995
output nodes number: 5851
edges number: 38963
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1577610969543457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.157761573791504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025079727172851562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 6 input nodes size: 27700
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022698402404785156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.022698402404785156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.036370277404785156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03641366958618164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025691509246826172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026542186737060547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026542186737060547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026542186737060547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([27700, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026542186737060547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1503, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06429910659790039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06429910659790039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1503, 128]), torch.Size([1, 1503, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06573247909545898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07740640640258789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1503, 128])
m.shape torch.Size([1587, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07820320129394531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07820320129394531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1587, 128]), torch.Size([1, 1587, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07971668243408203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10278987884521484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1587, 128])
m.shape torch.Size([1365, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10398578643798828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10398578643798828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1365, 128]), torch.Size([1, 1365, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10528755187988281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1339263916015625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1365, 128])
m.shape torch.Size([1077, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1353297233581543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1353297233581543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13635683059692383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16614294052124023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([910, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16872692108154297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16872692108154297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16959476470947266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20149755477905273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([783, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20330381393432617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20330381393432617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20405054092407227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23636674880981445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([651, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23816633224487305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23816633224487305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23878717422485352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2711353302001953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([598, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27310609817504883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27310609817504883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27367639541625977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3061833381652832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([485, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3079795837402344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3079795837402344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3084421157836914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3380441665649414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([3944, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3573441505432129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3573441505432129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 3944, 128]), torch.Size([1, 3944, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.36110687255859375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6361312866210938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 3944, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6034417152404785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6157469749450684  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6280522346496582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6156506538391113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([12903, 256])
first layer input nodes number: 27700
first layer output nodes number: 12903
edges number: 75474
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.628260612487793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6405658721923828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6436424255371094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6436424255371094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1043, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6820063591003418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6820063591003418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1043, 256]), torch.Size([1, 1043, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6844954490661621  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7022433280944824  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1043, 256])
m.shape torch.Size([890, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7032513618469238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7032513618469238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 890, 256]), torch.Size([1, 890, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.704948902130127  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7312836647033691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 890, 256])
m.shape torch.Size([670, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7332077026367188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7332077026367188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7344856262207031  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7625999450683594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 670, 256])
m.shape torch.Size([504, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7638988494873047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7638988494873047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7648601531982422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7927379608154297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([410, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7942280769348145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7942280769348145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7950100898742676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8234124183654785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([318, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8248553276062012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8248553276062012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8254618644714355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.852241039276123  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([256, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8536601066589355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8536601066589355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8541483879089355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8785624504089355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([241, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8801717758178711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8801717758178711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8806314468383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9068326950073242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([168, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9080562591552734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9080562591552734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9083766937255859  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9288845062255859  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([155, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9302144050598145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9302144050598145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9305100440979004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.951500415802002  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([120, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.952789306640625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.952789306640625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9530181884765625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9708709716796875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9720025062561035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9720025062561035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9722084999084473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.989717960357666  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([89, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.990727424621582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.990727424621582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9908971786499023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.006514549255371  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0074524879455566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0074524879455566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0075974464416504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0219483375549316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.022913932800293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.022913932800293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0230512619018555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0376081466674805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0384469032287598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0384469032287598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0385594367980957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0512757301330566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0520367622375488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0520367622375488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0521321296691895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0635762214660645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.064497470855713  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.064497470855713  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0646042823791504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.078169345855713  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0788650512695312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0788650512695312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0789432525634766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0894222259521484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0900559425354004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0900559425354004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0901226997375488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0995354652404785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1002087593078613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1002087593078613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1002755165100098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1101555824279785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1108412742614746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1108412742614746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1109061241149902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.120957851409912  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1217212677001953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1217212677001953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1217899322509766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.132913589477539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1334562301635742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1334562301635742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1335039138793945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1415624618530273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([314, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1490836143493652  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1490836143493652  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1496825218200684  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2565550804138184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 314, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2249059677124023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.225771427154541  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2266368865966797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2257280349731445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5805, 40])
input nodes number: 12903
output nodes number: 5805
edges number: 38548
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2258610725402832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2258615493774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02823495864868164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 7 input nodes size: 33953
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025684833526611328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025684833526611328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04187488555908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.041918277740478516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02820301055908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.029257774353027344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.029257774353027344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.029257774353027344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([33953, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.029257774353027344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1242, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07800436019897461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07800436019897461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1242, 128]), torch.Size([1, 1242, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07918882369995117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08963680267333984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1242, 128])
m.shape torch.Size([1324, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09030723571777344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09030723571777344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1324, 128]), torch.Size([1, 1324, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09156990051269531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11060523986816406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1324, 128])
m.shape torch.Size([1282, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11180782318115234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11180782318115234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1282, 128]), torch.Size([1, 1282, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11303043365478516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13992786407470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1282, 128])
m.shape torch.Size([1120, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14145278930664062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14145278930664062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14252090454101562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17349624633789062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1058, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17548465728759766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17548465728759766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17649364471435547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21410560607910156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([846, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21602153778076172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21602153778076172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2168283462524414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25205421447753906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([792, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25429439544677734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25429439544677734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2550497055053711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29288387298583984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([698, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29542064666748047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29542064666748047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 698, 128]), torch.Size([1, 698, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29608631134033203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3350362777709961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 698, 128])
m.shape torch.Size([619, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3373599052429199  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3373599052429199  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 619, 128]), torch.Size([1, 619, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3379502296447754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3765420913696289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 619, 128])
m.shape torch.Size([5753, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.40367937088012695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.40367937088012695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 5753, 128]), torch.Size([1, 5753, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4091658592224121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.801628589630127  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 5753, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7587542533874512  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7728056907653809  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7868571281433105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7726955413818359  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([14734, 256])
first layer input nodes number: 33953
first layer output nodes number: 14734
edges number: 96811
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7871122360229492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8011636734008789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8046765327453613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8046765327453613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([813, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8489937782287598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8489937782287598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 813, 256]), torch.Size([1, 813, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8505444526672363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8629498481750488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 813, 256])
m.shape torch.Size([727, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8637180328369141  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8637180328369141  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8651046752929688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8863811492919922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([612, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8876686096191406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8876686096191406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8888359069824219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.914581298828125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 612, 256])
m.shape torch.Size([478, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9158353805541992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9158353805541992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9167470932006836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9439401626586914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([446, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9456276893615723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9456276893615723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9464783668518066  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.977205753326416  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([354, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9788222312927246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9788222312927246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9794974327087402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0099797248840332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([297, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0116405487060547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0116405487060547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.01220703125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0420904159545898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([252, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0437450408935547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0437450408935547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0442256927490234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0716228485107422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([210, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.073500633239746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.073500633239746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0739011764526367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0995359420776367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([170, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1009697914123535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1009697914123535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1012940406799316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1243157386779785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.12559175491333  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.12559175491333  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1258511543273926  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1460843086242676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([134, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1475005149841309  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1475005149841309  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1477560997009277  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.169480800628662  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([115, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.170790195465088  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.170790195465088  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1710095405578613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1911892890930176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1924924850463867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1924924850463867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.192692756652832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.212519645690918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2137317657470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2137317657470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2139053344726562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2323036193847656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([87, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2335548400878906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2335548400878906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2337207794189453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.252471923828125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([86, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2537941932678223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2537941932678223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2539582252502441  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2736420631408691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2744426727294922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2744426727294922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2745399475097656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2868938446044922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2876853942871094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2876853942871094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2877731323242188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.299530029296875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3004283905029297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3004283905029297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3005218505859375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.313699722290039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3145413398742676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3145413398742676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3146252632141113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3270459175109863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3277864456176758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3277864456176758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3278570175170898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3387956619262695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.339423656463623  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.339423656463623  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3394808769226074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3487505912780762  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.349390983581543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.349390983581543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3494462966918945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3587942123413086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([414, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3687143325805664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3687143325805664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3695039749145508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.510340690612793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 414, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.472395420074463  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.473261833190918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.474128246307373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4732184410095215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5813, 40])
input nodes number: 14734
output nodes number: 5813
edges number: 44588
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4733729362487793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4733734130859375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0312957763671875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 8 input nodes size: 29303
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.028203964233398438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.028203964233398438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04217672348022461  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.042220115661621094  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025986671447753906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026905059814453125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026905059814453125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026905059814453125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([29303, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.026905059814453125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1466, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06843423843383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06843423843383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1466, 128]), torch.Size([1, 1466, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06983232498168945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08101701736450195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1466, 128])
m.shape torch.Size([1545, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08179140090942383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08179140090942383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1545, 128]), torch.Size([1, 1545, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08326482772827148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10536623001098633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1545, 128])
m.shape torch.Size([1373, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10681533813476562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10681533813476562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1373, 128]), torch.Size([1, 1373, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1081247329711914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13750934600830078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1373, 128])
m.shape torch.Size([1147, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13904237747192383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13904237747192383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1147, 128]), torch.Size([1, 1147, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1401362419128418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1721634864807129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1147, 128])
m.shape torch.Size([1103, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17424631118774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17424631118774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17529821395874023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21376371383666992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([856, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21568679809570312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21568679809570312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21650314331054688  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25346803665161133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([732, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25550317764282227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25550317764282227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25620126724243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2916531562805176  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 732, 128])
m.shape torch.Size([660, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2938218116760254  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2938218116760254  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 660, 128]), torch.Size([1, 660, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2944512367248535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.33092594146728516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 660, 128])
m.shape torch.Size([532, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.33289432525634766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.33289432525634766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3334016799926758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.36672496795654297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([4412, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3875093460083008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3875093460083008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 4412, 128]), torch.Size([1, 4412, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3918619155883789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6998510360717773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 4412, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6642446517944336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6774301528930664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6906156539916992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6773266792297363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([13826, 256])
first layer input nodes number: 29303
first layer output nodes number: 13826
edges number: 83226
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6908359527587891  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7040214538574219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7073178291320801  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7073178291320801  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([975, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7468347549438477  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7468347549438477  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 975, 256]), torch.Size([1, 975, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7486944198608398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7635717391967773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 975, 256])
m.shape torch.Size([808, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.764195442199707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.764195442199707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 808, 256]), torch.Size([1, 808, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7657365798950195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7894630432128906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 808, 256])
m.shape torch.Size([657, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7913336753845215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7913336753845215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7925868034362793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8202757835388184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([491, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8215370178222656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8215370178222656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8224735260009766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8511810302734375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([471, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8529763221740723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8529763221740723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.853874683380127  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8862156867980957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([326, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8876466751098633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8876466751098633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8882684707641602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9159026145935059  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([274, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9174351692199707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9174351692199707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9179577827453613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9455342292785645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([228, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.947026252746582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.947026252746582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9474611282348633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9722490310668945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([206, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.973813533782959  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.973813533782959  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9742064476013184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9993529319763184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0007519721984863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0007519721984863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0010685920715332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0235486030578613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([109, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0245428085327148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0245428085327148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0247507095336914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0409669876098633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([115, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.042189598083496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.042189598083496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0424089431762695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0610532760620117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([104, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0622434616088867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0622434616088867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0624418258666992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0806913375854492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0819110870361328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0819110870361328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0820980072021484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1006031036376953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1015625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1015625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1017017364501953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1164608001708984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([72, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1174983978271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1174983978271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.117635726928711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1331539154052734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1338696479797363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1338696479797363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1339612007141113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1449475288391113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1458187103271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1458187103271484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1459197998046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1587581634521484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1596574783325195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1596574783325195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1597566604614258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1730470657348633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1738243103027344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1738243103027344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1739063262939453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1854705810546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1859140396118164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1859140396118164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.185959815979004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.192734718322754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1932830810546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1932830810546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1933345794677734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2013168334960938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2017555236816406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2017555236816406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2017955780029297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2082843780517578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2087950706481934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2087950706481934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.208838939666748  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2162528038024902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([340, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.224400520324707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.224400520324707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2250490188598633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.340245246887207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 340, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3072829246520996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.30814790725708  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3090128898620605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3081045150756836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5804, 40])
input nodes number: 13826
output nodes number: 5804
edges number: 39894
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3082499504089355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3082504272460938  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.02871417999267578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 9 input nodes size: 32606
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025985240936279297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.025985240936279297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04153299331665039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04157447814941406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.027558326721191406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.028440475463867188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.028440475463867188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.028440475463867188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([32606, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.028440475463867188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1388, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07126855850219727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07126855850219727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1388, 128]), torch.Size([1, 1388, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07259225845336914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08318185806274414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1388, 128])
m.shape torch.Size([1555, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08400297164916992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08400297164916992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1555, 128]), torch.Size([1, 1555, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.08548593521118164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10869264602661133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1555, 128])
m.shape torch.Size([1375, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10991811752319336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.10991811752319336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1375, 128]), torch.Size([1, 1375, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11122941970825195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14007806777954102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1375, 128])
m.shape torch.Size([1187, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14168643951416016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14168643951416016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1187, 128]), torch.Size([1, 1187, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.14281845092773438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17564678192138672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1187, 128])
m.shape torch.Size([983, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17742443084716797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17742443084716797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1783618927001953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2121257781982422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([784, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21431398391723633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21431398391723633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21506166458129883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24761629104614258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([708, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24960565567016602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.24960565567016602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 708, 128]), torch.Size([1, 708, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25028085708618164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28449296951293945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 708, 128])
m.shape torch.Size([646, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28748178482055664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.28748178482055664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2880978584289551  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3233180046081543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([584, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3255162239074707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3255162239074707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.32607316970825195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3628978729248047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 584, 128])
m.shape torch.Size([4585, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.38448238372802734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.38448238372802734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 4585, 128]), torch.Size([1, 4585, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.38885498046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7001948356628418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 4585, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6633052825927734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6764612197875977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6896171569824219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6763582229614258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([13795, 256])
first layer input nodes number: 32606
first layer output nodes number: 13795
edges number: 84220
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6898622512817383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7030181884765625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7063074111938477  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7063074111938477  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([963, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7402563095092773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7402563095092773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 963, 256]), torch.Size([1, 963, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7420930862426758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7567873001098633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 963, 256])
m.shape torch.Size([878, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7579231262207031  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7579231262207031  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 878, 256]), torch.Size([1, 878, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7595977783203125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7847175598144531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 878, 256])
m.shape torch.Size([671, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7859363555908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7859363555908203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 671, 256]), torch.Size([1, 671, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.7872161865234375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8173203468322754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 671, 256])
m.shape torch.Size([543, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8187680244445801  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8187680244445801  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8198037147521973  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8502392768859863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([441, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8518409729003906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8518409729003906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8526821136474609  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8879833221435547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([291, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8892412185668945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.8892412185668945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.889796257019043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9143133163452148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([229, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9155769348144531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9155769348144531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9160137176513672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9378528594970703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([225, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9393649101257324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9393649101257324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9397940635681152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9642558097839355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.965909481048584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.965909481048584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9662814140319824  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9900851249694824  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([138, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9912257194519043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9912257194519043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.9914889335632324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0101771354675293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0112299919128418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0112299919128418  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0114436149597168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0281062126159668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([86, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0290284156799316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0290284156799316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0291924476623535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.043135166168213  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0442280769348145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0442280769348145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0444073677062988  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0609021186828613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.061781406402588  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.061781406402588  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0619187355041504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.075514316558838  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0762100219726562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0762100219726562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0763111114501953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.087026596069336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0879144668579102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0879144668579102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0880308151245117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1011781692504883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1018390655517578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1018390655517578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1019229888916016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1119937896728516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1126961708068848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1126961708068848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1127781867980957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1231942176818848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1237010955810547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1237010955810547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.123758316040039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1314258575439453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.131993293762207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.131993293762207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1320524215698242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1403894424438477  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.140925407409668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.140925407409668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1409788131713867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1488828659057617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1492156982421875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1492156982421875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1492481231689453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1542739868164062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1547002792358398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1547002792358398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.154738426208496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1609182357788086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1613378524780273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1613378524780273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1613740921020508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1674985885620117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([235, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1731271743774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1731271743774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1735754013061523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2524633407592773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 235, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2248382568359375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.225660800933838  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2264833450317383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2256193161010742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5519, 40])
input nodes number: 13795
output nodes number: 5519
edges number: 34123
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2257213592529297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.225721836090088  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.030149459838867188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 10 input nodes size: 41543
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.027515888214111328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.027515888214111328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04732513427734375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04736661911010742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.031777381896972656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03306293487548828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03306293487548828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03306293487548828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([41543, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03306293487548828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1430, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0984659194946289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0984659194946289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1430, 128]), torch.Size([1, 1430, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.09982967376708984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.11086606979370117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1430, 128])
m.shape torch.Size([1456, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1115727424621582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1115727424621582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1456, 128]), torch.Size([1, 1456, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1129612922668457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1344752311706543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1456, 128])
m.shape torch.Size([1197, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13549327850341797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13549327850341797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1197, 128]), torch.Size([1, 1197, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13663482666015625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16174888610839844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1197, 128])
m.shape torch.Size([1090, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16343450546264648  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16343450546264648  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1644740104675293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19602537155151367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1036, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19797563552856445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19797563552856445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19896364212036133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23453187942504883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([891, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2365870475769043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2365870475769043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23743677139282227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2748122215270996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([775, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2769742012023926  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2769742012023926  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2777132987976074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31581783294677734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([754, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31832456588745117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31832456588745117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 754, 128]), torch.Size([1, 754, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3190436363220215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3615536689758301  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 754, 128])
m.shape torch.Size([654, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3640007972717285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3640007972717285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3646245002746582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.40546512603759766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([9204, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.44904136657714844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.44904136657714844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 9204, 128]), torch.Size([1, 9204, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.45781898498535156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0817584991455078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 9204, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0227937698364258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0404243469238281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0580549240112305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0402865409851074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([18487, 256])
first layer input nodes number: 41543
first layer output nodes number: 18487
edges number: 132202
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0583667755126953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0759973526000977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0813593864440918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.0813593864440918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([971, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.121882438659668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.121882438659668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 971, 256]), torch.Size([1, 971, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.123734474182129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1386480331420898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 971, 256])
m.shape torch.Size([804, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1397104263305664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1397104263305664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1412439346313477  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.164626121520996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 804, 256])
m.shape torch.Size([580, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.165848731994629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.165848731994629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1669549942016602  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1917614936828613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1931982040405273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1931982040405273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.1940698623657227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2221403121948242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([392, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2236952781677246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2236952781677246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.224442958831787  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2585692405700684  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([308, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2601852416992188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2601852416992188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.260772705078125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2877330780029297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([240, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2890543937683105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2890543937683105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2895121574401855  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3124003410339355  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([220, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3138632774353027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3138632774353027  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3142828941345215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3382010459899902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([168, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.339444637298584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.339444637298584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3397650718688965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3602728843688965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([144, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.361496925354004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.361496925354004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.361771583557129  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.381272315979004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3826045989990234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3826045989990234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3828697204589844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4035491943359375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([94, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4045934677124023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4045934677124023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4047727584838867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4200124740600586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4208478927612305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4208478927612305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4209890365600586  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.433974266052246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4346842765808105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4346842765808105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4347949028015137  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.445746898651123  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4465856552124023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4465856552124023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4467039108276367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4592390060424805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4599642753601074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4599642753601074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4600615501403809  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4710536003112793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4719200134277344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4719200134277344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4720268249511719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4848442077636719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.485673427581787  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.485673427581787  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4857707023620605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.498124599456787  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.498861312866211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.498861312866211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4989433288574219  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5099334716796875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.510796070098877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.510796070098877  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5108857154846191  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5235257148742676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5243287086486816  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5243287086486816  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5244088172912598  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5362648963928223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5368380546569824  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5368380546569824  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.536893367767334  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5454668998718262  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5459036827087402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5459036827087402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5459437370300293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5524325370788574  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.553196907043457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.553196907043457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5532617568969727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5642213821411133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([454, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5750980377197266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5750980377197266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5759639739990234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.731252670288086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 454, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6969170570373535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6977424621582031  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6985678672790527  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6977009773254395  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5539, 40])
input nodes number: 18487
output nodes number: 5539
edges number: 40320
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.697883129119873  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6978836059570312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03543806076049805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 11 input nodes size: 53945
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.031780242919921875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.031780242919921875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05750322341918945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.05754518508911133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.037694454193115234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.039278507232666016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.039278507232666016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.039278507232666016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([53945, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.039278507232666016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1428, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1216435432434082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1216435432434082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1428, 128]), torch.Size([1, 1428, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.12300539016723633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.13390016555786133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1428, 128])
m.shape torch.Size([1602, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1348400115966797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1348400115966797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1602, 128]), torch.Size([1, 1602, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1363677978515625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1592845916748047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1602, 128])
m.shape torch.Size([1364, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1609487533569336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1609487533569336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1364, 128]), torch.Size([1, 1364, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16224956512451172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19107723236083984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1364, 128])
m.shape torch.Size([1105, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1928720474243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1928720474243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1939258575439453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2252492904663086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1058, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22724485397338867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22724485397338867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22825384140014648  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2654423713684082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([881, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.267458438873291  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.267458438873291  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 881, 128]), torch.Size([1, 881, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2682986259460449  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3044266700744629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 881, 128])
m.shape torch.Size([823, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30675363540649414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30675363540649414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3075385093688965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3478994369506836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([744, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3503451347351074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3503451347351074  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.35105466842651367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3918585777282715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([743, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.39469242095947266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.39469242095947266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3954010009765625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4414963722229004  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([12482, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5006608963012695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5006608963012695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 12482, 128]), torch.Size([1, 12482, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5125646591186523  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.357731819152832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 12482, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.2823553085327148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3035554885864258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3247556686401367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.303389549255371  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([22230, 256])
first layer input nodes number: 53945
first layer output nodes number: 22230
edges number: 166940
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.325727939605713  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3469281196594238  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3527965545654297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3527965545654297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([922, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3976373672485352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3976373672485352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 922, 256]), torch.Size([1, 922, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.3993959426879883  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4140925407409668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 922, 256])
m.shape torch.Size([820, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.414808750152588  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.414808750152588  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 820, 256]), torch.Size([1, 820, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4163727760314941  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4411721229553223  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 820, 256])
m.shape torch.Size([611, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4421520233154297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4421520233154297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4433174133300781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4690437316894531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 611, 256])
m.shape torch.Size([437, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4707984924316406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4707984924316406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4716320037841797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.4969863891601562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([362, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.49830961227417  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.49830961227417  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.499000072479248  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.52443265914917  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([249, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5255236625671387  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5255236625671387  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.525998592376709  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5464205741882324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([214, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5476231575012207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5476231575012207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5480313301086426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5684399604797363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([179, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5696125030517578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5696125030517578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5699539184570312  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5894145965576172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([158, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5906109809875488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5906109809875488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.5909123420715332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6101994514465332  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([130, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6112985610961914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6112985610961914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.611546516418457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6291513442993164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([110, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6302409172058105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6302409172058105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.63045072555542  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6468157768249512  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([116, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6480488777160645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6480488777160645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6482701301574707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.667076587677002  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([86, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.668057918548584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.668057918548584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6682219505310059  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6833128929138184  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([68, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6841459274291992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6841459274291992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6842756271362305  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6971158981323242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6978731155395508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6978731155395508  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.697981834411621  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7095060348510742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7102670669555664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7102670669555664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7103681564331055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7217912673950195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7224273681640625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7224273681640625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7225074768066406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7321205139160156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7329111099243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7329111099243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7330026626586914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7446298599243164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7454609870910645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7454609870910645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7455525398254395  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7578206062316895  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7586207389831543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7586207389831543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.758704662322998  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7705378532409668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.771202564239502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.771202564239502  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7712693214416504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7811493873596191  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7816872596740723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7816872596740723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7817387580871582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7897210121154785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7902703285217285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7902703285217285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7903199195861816  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.798353672027588  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7988824844360352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7988824844360352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7989282608032227  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8066644668579102  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([726, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8240861892700195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8240861892700195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 726, 256]), torch.Size([1, 726, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8254709243774414  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0701208114624023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 726, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.031602382659912  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.032435894012451  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0332694053649902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0323939323425293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5592, 40])
input nodes number: 22230
output nodes number: 5592
edges number: 45497
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0326099395751953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0326104164123535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.042172908782958984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 12 input nodes size: 65369
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03770256042480469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03770256042480469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06887292861938477  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06891393661499023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04314899444580078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.045075416564941406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.045075416564941406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.045075416564941406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([65369, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.045075416564941406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1473, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1494150161743164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1494150161743164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1473, 128]), torch.Size([1, 1473, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1508197784423828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16205787658691406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1473, 128])
m.shape torch.Size([1556, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16297483444213867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16297483444213867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1556, 128]), torch.Size([1, 1556, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1644587516784668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18671751022338867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1556, 128])
m.shape torch.Size([1457, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1882486343383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1882486343383789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1457, 128]), torch.Size([1, 1457, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1896381378173828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22020721435546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1457, 128])
m.shape torch.Size([1278, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22206830978393555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22206830978393555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1278, 128]), torch.Size([1, 1278, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22328710556030273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.25866270065307617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1278, 128])
m.shape torch.Size([1189, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26088809967041016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26088809967041016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1189, 128]), torch.Size([1, 1189, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2620220184326172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3036646842956543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1189, 128])
m.shape torch.Size([1041, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3060760498046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3060760498046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3070688247680664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3506193161010742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([994, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3534407615661621  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3534407615661621  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 994, 128]), torch.Size([1, 994, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3543887138366699  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4023585319519043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 994, 128])
m.shape torch.Size([963, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.40555810928344727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.40555810928344727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4064764976501465  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.45882463455200195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([825, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.46190595626831055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.46190595626831055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4626927375793457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5142650604248047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([16355, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5918583869934082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5918583869934082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 16355, 128]), torch.Size([1, 16355, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6082425117492676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7169675827026367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 16355, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6205534934997559  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6464276313781738  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6723017692565918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6462254524230957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([27131, 256])
first layer input nodes number: 65369
first layer output nodes number: 27131
edges number: 211896
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6727910041809082  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6986651420593262  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7052593231201172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7052593231201172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([886, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.751601219177246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.751601219177246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 886, 256]), torch.Size([1, 886, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.753291130065918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7674751281738281  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 886, 256])
m.shape torch.Size([735, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7680678367614746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7680678367614746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 735, 256]), torch.Size([1, 735, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7694697380065918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7909088134765625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 735, 256])
m.shape torch.Size([552, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7922425270080566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7922425270080566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7932953834533691  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8171391487121582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([434, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.818281650543213  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.818281650543213  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8191094398498535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.844240665435791  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([356, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8455376625061035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8455376625061035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8462166786193848  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8717989921569824  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([261, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.872964859008789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.872964859008789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8734626770019531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8962602615356445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([217, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8974714279174805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8974714279174805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8978853225708008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9185800552368164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([217, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9200420379638672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9200420379638672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9204559326171875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9440479278564453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([121, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9448881149291992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9448881149291992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9451189041137695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9598894119262695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([146, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9611773490905762  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9611773490905762  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9614558219909668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9812273979187012  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([116, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9823145866394043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9823145866394043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9825358390808105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.999793529510498  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([97, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0017271041870117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0017271041870117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0019121170043945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0176382064819336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.018707752227783  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.018707752227783  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0188851356506348  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0352044105529785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.036111831665039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.036111831665039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.036252975463867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0502262115478516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.05120849609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.05120849609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0513477325439453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0661067962646484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0668983459472656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0668983459472656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.067005157470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0790748596191406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.079789638519287  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.079789638519287  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0798792839050293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.090636730194092  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.091526508331299  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.091526508331299  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0916295051574707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.104710102081299  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.105480670928955  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.105480670928955  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1055665016174316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.117067813873291  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.117832660675049  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.117832660675049  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.117912769317627  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1292080879211426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.129995822906494  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.129995822906494  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1300740242004395  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1416478157043457  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1422853469848633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1422853469848633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1423463821411133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1518068313598633  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1525721549987793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1525721549987793  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1526408195495605  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.163764476776123  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.164468288421631  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.164468288421631  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.164529323577881  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.174844264984131  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([732, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1924023628234863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1924023628234863  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 732, 256]), torch.Size([1, 732, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.193798542022705  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4404187202453613  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 732, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3999204635620117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4007396697998047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4015588760375977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.400698661804199  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5495, 40])
input nodes number: 27131
output nodes number: 5495
edges number: 46501
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4009275436401367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.400928020477295  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.048490047454833984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 13 input nodes size: 64570
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04313468933105469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04313468933105469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07392406463623047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.07396507263183594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04275369644165039  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04504728317260742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04504728317260742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04504728317260742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([64570, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04504728317260742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1158, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16702032089233398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16702032089233398  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1158, 128]), torch.Size([1, 1158, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16812467575073242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1773977279663086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1158, 128])
m.shape torch.Size([1238, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1780261993408203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1780261993408203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1238, 128]), torch.Size([1, 1238, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17920684814453125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19723033905029297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1238, 128])
m.shape torch.Size([1179, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19850540161132812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19850540161132812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1179, 128]), torch.Size([1, 1179, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1996297836303711  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22454547882080078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1179, 128])
m.shape torch.Size([1136, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2261500358581543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2261500358581543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1136, 128]), torch.Size([1, 1136, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2272334098815918  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2591071128845215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1136, 128])
m.shape torch.Size([1098, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2611832618713379  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2611832618713379  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.26223039627075195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30001401901245117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1050, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30249452590942383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.30249452590942383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3034958839416504  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.34783411026000977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([997, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3506612777709961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3506612777709961  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 997, 128]), torch.Size([1, 997, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3516120910644531  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.39966773986816406  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 997, 128])
m.shape torch.Size([960, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.40285444259643555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.40285444259643555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 960, 128]), torch.Size([1, 960, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.40376996994018555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.45595502853393555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 960, 128])
m.shape torch.Size([973, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4596729278564453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4596729278564453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 973, 128]), torch.Size([1, 973, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4606008529663086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5214695930480957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 973, 128])
m.shape torch.Size([20148, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6170787811279297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6170787811279297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 20148, 128]), torch.Size([1, 20148, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.6366100311279297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0163631439208984  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 20148, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9017024040222168  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9302525520324707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9588027000427246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9300293922424316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([29937, 256])
first layer input nodes number: 64570
first layer output nodes number: 29937
edges number: 248401
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9592857360839844  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9878358840942383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9949736595153809  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9949736595153809  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([694, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0529165267944336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0529165267944336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 694, 256]), torch.Size([1, 694, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0542402267456055  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0648298263549805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 694, 256])
m.shape torch.Size([567, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0653724670410156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0653724670410156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0664539337158203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.083526611328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([433, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.084502696990967  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.084502696990967  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0853285789489746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1052746772766113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([354, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1064558029174805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1064558029174805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.107131004333496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.128321647644043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([309, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.129469394683838  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.129469394683838  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.130058765411377  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.151913642883301  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([246, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1530380249023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1530380249023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1535072326660156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1736831665039062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([205, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.174828052520752  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.174828052520752  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1752190589904785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1947693824768066  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([162, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.195819854736328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.195819854736328  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1961288452148438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2137413024902344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([149, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2148756980895996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2148756980895996  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2151598930358887  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2333483695983887  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([140, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2345519065856934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2345519065856934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.234818935394287  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2537779808044434  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([124, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.254955768585205  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.254955768585205  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.255192279815674  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2736401557922363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2748255729675293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2748255729675293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.275041103363037  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.293361186981201  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.294440746307373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.294440746307373  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2946219444274902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3112921714782715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([100, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.312875270843506  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.312875270843506  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.313066005706787  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.331948757171631  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([90, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.333151340484619  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.333151340484619  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3333230018615723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3515191078186035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3526177406311035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3526177406311035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.35276460647583  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3693604469299316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.370349407196045  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.370349407196045  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3704733848571777  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3853507041931152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([78, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3866381645202637  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3866381645202637  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.386786937713623  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4056811332702637  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([73, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.40693998336792  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.40693998336792  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4070792198181152  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.425736904144287  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4267630577087402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4267630577087402  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4268717765808105  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4422011375427246  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([65, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4434590339660645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4434590339660645  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4435830116271973  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4619317054748535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4629693031311035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4629693031311035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4630684852600098  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4784417152404785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.479121685028076  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.479121685028076  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.479184627532959  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4893813133239746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.490295886993408  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.490295886993408  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4903740882873535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.5035901069641113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([1164, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.531519889831543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.531519889831543  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1164, 256]), torch.Size([1, 1164, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.5337400436401367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.938441276550293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1164, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.8848633766174316  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.88568115234375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.8864989280700684  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.8856401443481445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5486, 40])
input nodes number: 29937
output nodes number: 5486
edges number: 59361
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.8859028816223145  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.8859033584594727  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04899406433105469  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 14 input nodes size: 53423
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04275226593017578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04275226593017578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06822633743286133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.0682673454284668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03743696212768555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03944253921508789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03944253921508789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03944253921508789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([53423, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03944253921508789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([1122, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1427597999572754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1427597999572754  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1438298225402832  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1533212661743164  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1120, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15465593338012695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15465593338012695  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.15572404861450195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17259645462036133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1062, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17358160018920898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17358160018920898  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17459440231323242  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19687604904174805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([999, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19828367233276367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19828367233276367  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 999, 128]), torch.Size([1, 999, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.19923639297485352  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2273421287536621  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 999, 128])
m.shape torch.Size([895, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22899961471557617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22899961471557617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 895, 128]), torch.Size([1, 895, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.22985315322875977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2607088088989258  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 895, 128])
m.shape torch.Size([876, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2627882957458496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2627882957458496  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2636237144470215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.29964590072631836  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([831, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.302001953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.302001953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3027944564819336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.34363412857055664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([783, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3462247848510742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3462247848510742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3469715118408203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3896760940551758  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([751, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.39252567291259766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.39252567291259766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 751, 128]), torch.Size([1, 751, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.39324188232421875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.44047975540161133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 751, 128])
m.shape torch.Size([17114, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5221529006958008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5221529006958008  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 17114, 128]), torch.Size([1, 17114, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5384740829467773  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6974906921386719  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 17114, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.600776195526123  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.625145435333252  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6495146751403809  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6249547004699707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([25553, 256])
first layer input nodes number: 53423
first layer output nodes number: 25553
edges number: 210255
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6499147415161133  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.6742839813232422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.680704116821289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.680704116821289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([715, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7381553649902344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7381553649902344  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 715, 256]), torch.Size([1, 715, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7395191192626953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7518768310546875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 715, 256])
m.shape torch.Size([580, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7523560523986816  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7523560523986816  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.753462314605713  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7703347206115723  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([437, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7719573974609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7719573974609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7727909088134766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.7937164306640625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([373, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.794734001159668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.794734001159668  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.795445442199707  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.817774772644043  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([289, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8195815086364746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8195815086364746  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8201327323913574  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.842700481414795  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([240, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8438091278076172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8438091278076172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8442668914794922  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8639507293701172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([216, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8651752471923828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8651752471923828  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8655872344970703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8861865997314453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([144, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8870878219604492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8870878219604492  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.8873624801635742  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9030179977416992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([173, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9043774604797363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9043774604797363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.904707431793213  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.925825595855713  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([134, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9269485473632812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9269485473632812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9272041320800781  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9453506469726562  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([127, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9465656280517578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9465656280517578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.946807861328125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9657020568847656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([119, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9669537544250488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9669537544250488  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9671807289123535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.986473560333252  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([89, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9874725341796875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9874725341796875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9876422882080078  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0032596588134766  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([79, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.004528045654297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.004528045654297  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.004678726196289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0195960998535156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([75, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.020602226257324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.020602226257324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.020745277404785  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0359086990356445  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0370216369628906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0370216369628906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.037168502807617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0537643432617188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0548839569091797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0548839569091797  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.055023193359375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0717315673828125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([75, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0729598999023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0729598999023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0731029510498047  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0912704467773438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.092228412628174  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.092228412628174  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0923352241516113  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1066479682922363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.108304500579834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.108304500579834  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1084113121032715  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.123471736907959  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.124650001525879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.124650001525879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1247663497924805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1419858932495117  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1427526473999023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1427526473999023  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.142827033996582  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1543569564819336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.155325412750244  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.155325412750244  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1554112434387207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.169315814971924  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1701955795288086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1701955795288086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.170271873474121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1831655502319336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([1174, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.211336612701416  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.211336612701416  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1174, 256]), torch.Size([1, 1174, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.213575839996338  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.6252503395080566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1174, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.5726423263549805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.573460102081299  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.574277877807617  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.5734190940856934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5486, 40])
input nodes number: 25553
output nodes number: 5486
edges number: 58828
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.57365083694458  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.5736513137817383  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.04291868209838867  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

pseudo mini batch 15 input nodes size: 56100
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03743696212768555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.03743696212768555  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06418752670288086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.06423044204711914  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.038715362548828125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.041118621826171875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.041118621826171875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.041118621826171875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([56100, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.041118621826171875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([936, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1630716323852539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1630716323852539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.16396427154541016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.17184829711914062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([992, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1723480224609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1723480224609375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1732940673828125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.1874847412109375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([936, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18835067749023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18835067749023438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.18924331665039062  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.20888137817382812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([906, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21016311645507812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.21016311645507812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2110271453857422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.236083984375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([929, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23786687850952148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.23786687850952148  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2387528419494629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2706475257873535  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([892, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27275657653808594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.27275657653808594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 892, 128]), torch.Size([1, 892, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.2736072540283203  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.31029701232910156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 892, 128])
m.shape torch.Size([869, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.312772274017334  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.312772274017334  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.313601016998291  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.35504770278930664  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([866, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3579368591308594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3579368591308594  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.3587627410888672  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4058380126953125  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([890, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4092445373535156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4092445373535156  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.4100933074951172  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.46575260162353516  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([20828, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5646438598632812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5646438598632812  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 20828, 128]), torch.Size([1, 20828, 128])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.5845069885253906  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9949169158935547  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 20828, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.879594326019287  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9072928428649902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9349913597106934  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.907076358795166  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([29044, 256])
first layer input nodes number: 56100
first layer output nodes number: 29044
edges number: 248650
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9354114532470703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9631099700927734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9700345993041992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 1.9700345993041992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

m.shape torch.Size([571, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0417094230651855  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0417094230651855  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0427985191345215  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0520081520080566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([462, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.052351951599121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.052351951599121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0532331466674805  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.066451072692871  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([368, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0670833587646484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0670833587646484  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0677852630615234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.084001064300537  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([274, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0847229957580566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0847229957580566  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.0852456092834473  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1025991439819336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([269, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1045455932617188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1045455932617188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1050586700439453  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.124349594116211  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([210, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1253042221069336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1253042221069336  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.125704765319824  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.142928123474121  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([168, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.144777774810791  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.144777774810791  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1450982093811035  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1611199378967285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([161, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.162198066711426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.162198066711426  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.1625051498413086  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.180008888244629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([160, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.181239604949951  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.181239604949951  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.181544780731201  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.201076030731201  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([144, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.20230770111084  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.20230770111084  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.202582359313965  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.22208309173584  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.223341464996338  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.223341464996338  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.223593235015869  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2432312965393066  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([139, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.244709014892578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.244709014892578  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.244974136352539  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2675094604492188  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([122, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.269608974456787  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.269608974456787  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2698416709899902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2912497520446777  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.292398452758789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.292398452758789  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.2925777435302734  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3103275299072266  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([95, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.311607837677002  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.311607837677002  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.311789035797119  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.330996036529541  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3325047492980957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3325047492980957  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.332703113555908  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3551182746887207  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([92, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.356522560119629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.356522560119629  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3566980361938477  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3777551651000977  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([92, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3792591094970703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.3792591094970703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.379434585571289  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4017200469970703  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([92, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4037704467773438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4037704467773438  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4039459228515625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.427459716796875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([93, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4291601181030273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4291601181030273  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.429337501525879  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.454348564147949  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([77, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4558143615722656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4558143615722656  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.455961227416992  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4776973724365234  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.478854179382324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.478854179382324  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4789628982543945  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.495814323425293  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.497650623321533  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.497650623321533  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.4977688789367676  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.5169262886047363  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([70, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.518482208251953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.518482208251953  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.51861572265625  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.541179656982422  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([1608, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.580475330352783  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes
Using backend: pytorch

----------------------------------------2
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.580475330352783  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

 h.shape torch.Size([1, 1608, 256]), torch.Size([1, 1608, 256])
----------------------------------------3
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 2.584068775177002  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 3.135878086090088  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

rst.shape  torch.Size([1, 1608, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 3.0699357986450195  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 3.0707879066467285  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 3.0716400146484375  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 3.0707449913024902  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

torch.Size([5716, 40])
input nodes number: 29044
output nodes number: 5716
edges number: 73760
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 3.0710387229919434  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 3.0710391998291016  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.045238494873046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.045238494873046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 6.1326904296875 GB
    Memory Allocated: 0.045238494873046875  GigaBytes
Max Memory Allocated: 3.494978904724121  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01090964674949646 |0.0019295364618301392 |0.11760272085666656 |9.042024612426758e-05 |0.07596606016159058 |0.004626035690307617 |
----------------------------------------------------------pseudo_mini_loss sum 3.7909364700317383
Total (block generation + training)time/epoch 26.174508213996887
Training time/epoch 3.4019885063171387
Training time without block to device /epoch 3.3711159229278564
Training time without total dataloading part /epoch 3.10317325592041
load block tensor time/epoch 0.17455434799194336
block to device time/epoch 0.030872583389282227
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  876288
Number of first layer input nodes during this epoch:  597142
Number of first layer output nodes during this epoch:  279146
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
