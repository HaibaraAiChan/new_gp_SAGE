[05:33:41] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28387380 edges into 16 parts and get 7386350 edge cuts
main start at this time 1651555999.2916458
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030199050903320312
global_2_local spend time (sec) 0.036110877990722656
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004620790481567383
A = g.adjacency_matrix() spent  0.007847309112548828
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07933330535888672
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2958898544311523
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2682223320007324

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366})
Convert a graph into a bidirected graph: 1.296 seconds
Metis partitioning: 5.466 seconds
Split the graph: 0.979 seconds
Construct subgraphs: 0.080 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.834575891494751
5708
5781
5791
5673
5819
5800
5785
5846
5752
5583
5518
5605
5522
5531
5517
5710
total k batches seeds list generation spend  18.654651641845703
after graph partition
graph partition algorithm spend time 18.75041103363037
5708
5781
5791
5673
5819
5800
5785
5846
5752
5583
5518
5605
5522
5531
5517
5710
partition_len_list
[11924, 13933, 11871, 11461, 13587, 14315, 10173, 11216, 14384, 15748, 25132, 19108, 25891, 31879, 28129, 27875]
shared_neighbor_graph_partition_s0 selection method  spend 18.834776401519775
time for parepare:  0.01775193214416504
local_output_nid generation:  0.0011878013610839844
local_in_edges_tensor generation:  0.0015175342559814453
mini_batch_src_global generation:  0.0016789436340332031
r_  generation:  0.014250993728637695
local_output_nid generation:  0.001325368881225586
local_in_edges_tensor generation:  0.001397848129272461
mini_batch_src_global generation:  0.0016870498657226562
r_  generation:  0.0158233642578125
local_output_nid generation:  0.001493215560913086
local_in_edges_tensor generation:  0.0013620853424072266
mini_batch_src_global generation:  0.0015759468078613281
r_  generation:  0.015600919723510742
local_output_nid generation:  0.0014994144439697266
local_in_edges_tensor generation:  0.0012199878692626953
mini_batch_src_global generation:  0.0013997554779052734
r_  generation:  0.01458883285522461
local_output_nid generation:  0.0015232563018798828
local_in_edges_tensor generation:  0.0012674331665039062
mini_batch_src_global generation:  0.0014374256134033203
r_  generation:  0.01765131950378418
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0014586448669433594
mini_batch_src_global generation:  0.0014047622680664062
r_  generation:  0.015941143035888672
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0011751651763916016
mini_batch_src_global generation:  0.0011949539184570312
r_  generation:  0.01010274887084961
local_output_nid generation:  0.0015110969543457031
local_in_edges_tensor generation:  0.0011913776397705078
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.013972282409667969
local_output_nid generation:  0.0014841556549072266
local_in_edges_tensor generation:  0.0011827945709228516
mini_batch_src_global generation:  0.0010514259338378906
r_  generation:  0.013073444366455078
local_output_nid generation:  0.0014309883117675781
local_in_edges_tensor generation:  0.0011031627655029297
mini_batch_src_global generation:  0.0010833740234375
r_  generation:  0.011929988861083984
local_output_nid generation:  0.0014185905456542969
local_in_edges_tensor generation:  0.0012798309326171875
mini_batch_src_global generation:  0.0019278526306152344
r_  generation:  0.017687320709228516
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0012669563293457031
mini_batch_src_global generation:  0.0014922618865966797
r_  generation:  0.014281511306762695
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.001195669174194336
mini_batch_src_global generation:  0.0013167858123779297
r_  generation:  0.016202449798583984
local_output_nid generation:  0.0015189647674560547
local_in_edges_tensor generation:  0.0014460086822509766
mini_batch_src_global generation:  0.0019676685333251953
r_  generation:  0.020618200302124023
local_output_nid generation:  0.0016317367553710938
local_in_edges_tensor generation:  0.0014023780822753906
mini_batch_src_global generation:  0.001873016357421875
r_  generation:  0.0198516845703125
local_output_nid generation:  0.001720428466796875
local_in_edges_tensor generation:  0.0014035701751708984
mini_batch_src_global generation:  0.002184152603149414
r_  generation:  0.02451944351196289
----------------------check_connections_block total spend ----------------------------- 0.4125673770904541
generate_one_block  0.02555990219116211
generate_one_block  0.02295970916748047
generate_one_block  0.020699739456176758
generate_one_block  0.019509077072143555
generate_one_block  0.02436375617980957
generate_one_block  0.022003650665283203
generate_one_block  0.014632701873779297
generate_one_block  0.01678180694580078
generate_one_block  0.018179893493652344
generate_one_block  0.016869783401489258
generate_one_block  0.025330305099487305
generate_one_block  0.020214080810546875
generate_one_block  0.022703886032104492
generate_one_block  0.03099346160888672
generate_one_block  0.02740788459777832
generate_one_block  0.034444332122802734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07762575149536133
gen group dst list time:  0.009929418563842773
time for parepare:  0.02389240264892578
local_output_nid generation:  0.002249479293823242
local_in_edges_tensor generation:  0.014349222183227539
mini_batch_src_global generation:  0.002393960952758789
r_  generation:  0.025742053985595703
local_output_nid generation:  0.003883838653564453
local_in_edges_tensor generation:  0.0030469894409179688
mini_batch_src_global generation:  0.004145622253417969
r_  generation:  0.04637932777404785
local_output_nid generation:  0.00580596923828125
local_in_edges_tensor generation:  0.0055582523345947266
mini_batch_src_global generation:  0.005091428756713867
r_  generation:  0.03110480308532715
local_output_nid generation:  0.0043103694915771484
local_in_edges_tensor generation:  0.002756834030151367
mini_batch_src_global generation:  0.002269744873046875
r_  generation:  0.026346445083618164
local_output_nid generation:  0.004537820816040039
local_in_edges_tensor generation:  0.0031387805938720703
mini_batch_src_global generation:  0.0025908946990966797
r_  generation:  0.031159400939941406
local_output_nid generation:  0.0043659210205078125
local_in_edges_tensor generation:  0.0031843185424804688
mini_batch_src_global generation:  0.003239870071411133
r_  generation:  0.03412365913391113
local_output_nid generation:  0.0030434131622314453
local_in_edges_tensor generation:  0.0022389888763427734
mini_batch_src_global generation:  0.0019304752349853516
r_  generation:  0.01947498321533203
local_output_nid generation:  0.0032646656036376953
local_in_edges_tensor generation:  0.0024056434631347656
mini_batch_src_global generation:  0.0018343925476074219
r_  generation:  0.02308201789855957
local_output_nid generation:  0.003828763961791992
local_in_edges_tensor generation:  0.0030951499938964844
mini_batch_src_global generation:  0.003332853317260742
r_  generation:  0.05089139938354492
local_output_nid generation:  0.005995512008666992
local_in_edges_tensor generation:  0.004033327102661133
mini_batch_src_global generation:  0.004025936126708984
r_  generation:  0.0368499755859375
local_output_nid generation:  0.00709080696105957
local_in_edges_tensor generation:  0.006917476654052734
mini_batch_src_global generation:  0.00758051872253418
r_  generation:  0.06901311874389648
local_output_nid generation:  0.00546574592590332
local_in_edges_tensor generation:  0.0049436092376708984
mini_batch_src_global generation:  0.005661725997924805
r_  generation:  0.0487062931060791
local_output_nid generation:  0.007293701171875
local_in_edges_tensor generation:  0.0061109066009521484
mini_batch_src_global generation:  0.0074160099029541016
r_  generation:  0.07196831703186035
local_output_nid generation:  0.008418798446655273
local_in_edges_tensor generation:  0.008919239044189453
mini_batch_src_global generation:  0.02774953842163086
r_  generation:  0.09790706634521484
local_output_nid generation:  0.008560419082641602
local_in_edges_tensor generation:  0.009490728378295898
mini_batch_src_global generation:  0.009983539581298828
r_  generation:  0.08690214157104492
local_output_nid generation:  0.007304668426513672
local_in_edges_tensor generation:  0.008862972259521484
mini_batch_src_global generation:  0.011642694473266602
r_  generation:  0.08357787132263184
----------------------check_connections_block total spend ----------------------------- 1.289475440979004
generate_one_block  0.04997873306274414
generate_one_block  0.04225587844848633
generate_one_block  0.03683066368103027
generate_one_block  0.032572269439697266
generate_one_block  0.039078474044799805
generate_one_block  0.04584336280822754
generate_one_block  0.05267763137817383
generate_one_block  0.03202939033508301
generate_one_block  0.04061603546142578
generate_one_block  0.048880815505981445
generate_one_block  0.09705996513366699
generate_one_block  0.06328725814819336
generate_one_block  0.09675025939941406
generate_one_block  0.13301777839660645
generate_one_block  0.10705280303955078
generate_one_block  0.11308503150939941
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.289475440979004
block generation total time  1.0310163497924805
average batch blocks generation time:  0.06443852186203003
pseudo mini batch 0 input nodes size: 23124
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0311279296875 GB
    Memory Allocated: 0.014496326446533203  GigaBytes
Max Memory Allocated: 0.014496326446533203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0311279296875 GB
    Memory Allocated: 0.014539241790771484  GigaBytes
Max Memory Allocated: 0.014539241790771484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0311279296875 GB
    Memory Allocated: 0.014539241790771484  GigaBytes
Max Memory Allocated: 0.014539241790771484  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.01541280746459961  GigaBytes
Max Memory Allocated: 0.01541280746459961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.01541280746459961  GigaBytes
Max Memory Allocated: 0.01541280746459961  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.01541280746459961  GigaBytes
Max Memory Allocated: 0.01541280746459961  GigaBytes

torch.Size([23124, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.01541280746459961  GigaBytes
Max Memory Allocated: 0.01541280746459961  GigaBytes

m.shape torch.Size([1306, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.05219268798828125  GigaBytes
Max Memory Allocated: 0.052622318267822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.05219268798828125  GigaBytes
Max Memory Allocated: 0.052622318267822266  GigaBytes

 h.shape torch.Size([1, 1306, 128]), torch.Size([1, 1306, 128])
----------------------------------------3
 Nvidia-smi: 1.2362060546875 GB
    Memory Allocated: 0.05343818664550781  GigaBytes
Max Memory Allocated: 0.05343818664550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.06340217590332031  GigaBytes
Max Memory Allocated: 0.0640249252319336  GigaBytes

rst.shape  torch.Size([1, 1306, 128])
m.shape torch.Size([1292, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.0640115737915039  GigaBytes
Max Memory Allocated: 0.0640411376953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.0640115737915039  GigaBytes
Max Memory Allocated: 0.0640411376953125  GigaBytes

 h.shape torch.Size([1, 1292, 128]), torch.Size([1, 1292, 128])
----------------------------------------3
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.06524372100830078  GigaBytes
Max Memory Allocated: 0.06524372100830078  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08469486236572266  GigaBytes
Max Memory Allocated: 0.08592700958251953  GigaBytes

rst.shape  torch.Size([1, 1292, 128])
m.shape torch.Size([1105, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08565950393676758  GigaBytes
Max Memory Allocated: 0.08592700958251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08565950393676758  GigaBytes
Max Memory Allocated: 0.08592700958251953  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08671331405639648  GigaBytes
Max Memory Allocated: 0.08671331405639648  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.11027336120605469  GigaBytes
Max Memory Allocated: 0.11185407638549805  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([962, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.11158132553100586  GigaBytes
Max Memory Allocated: 0.11185407638549805  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.11158132553100586  GigaBytes
Max Memory Allocated: 0.11185407638549805  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.11249876022338867  GigaBytes
Max Memory Allocated: 0.11249876022338867  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.13946866989135742  GigaBytes
Max Memory Allocated: 0.14130353927612305  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([824, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.1409745216369629  GigaBytes
Max Memory Allocated: 0.14130353927612305  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.1409745216369629  GigaBytes
Max Memory Allocated: 0.14130353927612305  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.14176034927368164  GigaBytes
Max Memory Allocated: 0.14176034927368164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.17032098770141602  GigaBytes
Max Memory Allocated: 0.17256402969360352  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([685, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.17217111587524414  GigaBytes
Max Memory Allocated: 0.17256402969360352  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.17217111587524414  GigaBytes
Max Memory Allocated: 0.17256402969360352  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.17282438278198242  GigaBytes
Max Memory Allocated: 0.17282438278198242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.20091485977172852  GigaBytes
Max Memory Allocated: 0.20287466049194336  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([596, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.2025775909423828  GigaBytes
Max Memory Allocated: 0.20287466049194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.2025775909423828  GigaBytes
Max Memory Allocated: 0.20287466049194336  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.20314598083496094  GigaBytes
Max Memory Allocated: 0.20314598083496094  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.23261642456054688  GigaBytes
Max Memory Allocated: 0.2346057891845703  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([506, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.23426246643066406  GigaBytes
Max Memory Allocated: 0.2346057891845703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.23426246643066406  GigaBytes
Max Memory Allocated: 0.2346057891845703  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 1.4256591796875 GB
    Memory Allocated: 0.23474502563476562  GigaBytes
Max Memory Allocated: 0.23474502563476562  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.2622509002685547  GigaBytes
Max Memory Allocated: 0.26418113708496094  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([429, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.26385068893432617  GigaBytes
Max Memory Allocated: 0.26418113708496094  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.26385068893432617  GigaBytes
Max Memory Allocated: 0.26418113708496094  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.26425981521606445  GigaBytes
Max Memory Allocated: 0.26425981521606445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4803466796875 GB
    Memory Allocated: 0.29044389724731445  GigaBytes
Max Memory Allocated: 0.2922849655151367  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([4219, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.31035709381103516  GigaBytes
Max Memory Allocated: 0.31082916259765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.31035709381103516  GigaBytes
Max Memory Allocated: 0.31082916259765625  GigaBytes

 h.shape torch.Size([1, 4219, 128]), torch.Size([1, 4219, 128])
----------------------------------------3
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.31474924087524414  GigaBytes
Max Memory Allocated: 0.31474924087524414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6004214286804199  GigaBytes
Max Memory Allocated: 0.6205391883850098  GigaBytes

rst.shape  torch.Size([1, 4219, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.5687098503112793  GigaBytes
Max Memory Allocated: 0.6205391883850098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.5800814628601074  GigaBytes
Max Memory Allocated: 0.6205391883850098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.5914530754089355  GigaBytes
Max Memory Allocated: 0.6205391883850098  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.5799922943115234  GigaBytes
Max Memory Allocated: 0.6205391883850098  GigaBytes

torch.Size([11924, 256])
first layer input nodes number: 23124
first layer output nodes number: 11924
edges number: 73554
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.5916275978088379  GigaBytes
Max Memory Allocated: 0.6205391883850098  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.602999210357666  GigaBytes
Max Memory Allocated: 0.6205391883850098  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.8475341796875 GB
    Memory Allocated: 0.6061892509460449  GigaBytes
Max Memory Allocated: 0.6205391883850098  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.8475341796875 GB
    Memory Allocated: 0.6061892509460449  GigaBytes
Max Memory Allocated: 0.6205391883850098  GigaBytes

m.shape torch.Size([957, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.6492080688476562  GigaBytes
Max Memory Allocated: 0.6492118835449219  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.6492080688476562  GigaBytes
Max Memory Allocated: 0.6492118835449219  GigaBytes

 h.shape torch.Size([1, 957, 256]), torch.Size([1, 957, 256])
----------------------------------------3
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6510334014892578  GigaBytes
Max Memory Allocated: 0.6510334014892578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.6656360626220703  GigaBytes
Max Memory Allocated: 0.6665487289428711  GigaBytes

rst.shape  torch.Size([1, 957, 256])
m.shape torch.Size([796, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.6663193702697754  GigaBytes
Max Memory Allocated: 0.6665487289428711  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.6663193702697754  GigaBytes
Max Memory Allocated: 0.6665487289428711  GigaBytes

 h.shape torch.Size([1, 796, 256]), torch.Size([1, 796, 256])
----------------------------------------3
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.6678376197814941  GigaBytes
Max Memory Allocated: 0.6678376197814941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6906113624572754  GigaBytes
Max Memory Allocated: 0.6926465034484863  GigaBytes

rst.shape  torch.Size([1, 796, 256])
m.shape torch.Size([597, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6919007301330566  GigaBytes
Max Memory Allocated: 0.6926465034484863  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6919007301330566  GigaBytes
Max Memory Allocated: 0.6926465034484863  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6930394172668457  GigaBytes
Max Memory Allocated: 0.6930394172668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7180905342102051  GigaBytes
Max Memory Allocated: 0.7202615737915039  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([493, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7197070121765137  GigaBytes
Max Memory Allocated: 0.7202615737915039  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7197070121765137  GigaBytes
Max Memory Allocated: 0.7202615737915039  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7206473350524902  GigaBytes
Max Memory Allocated: 0.7206473350524902  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7489199638366699  GigaBytes
Max Memory Allocated: 0.750800609588623  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([385, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.750300407409668  GigaBytes
Max Memory Allocated: 0.750800609588623  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.750300407409668  GigaBytes
Max Memory Allocated: 0.750800609588623  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7510347366333008  GigaBytes
Max Memory Allocated: 0.7510347366333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.7775955200195312  GigaBytes
Max Memory Allocated: 0.7795028686523438  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([294, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.779149055480957  GigaBytes
Max Memory Allocated: 0.7795028686523438  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.779149055480957  GigaBytes
Max Memory Allocated: 0.7795028686523438  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.7797098159790039  GigaBytes
Max Memory Allocated: 0.7797098159790039  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.8091168403625488  GigaBytes
Max Memory Allocated: 0.8107991218566895  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([231, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.8103909492492676  GigaBytes
Max Memory Allocated: 0.8107991218566895  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.8103909492492676  GigaBytes
Max Memory Allocated: 0.8107991218566895  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.8108315467834473  GigaBytes
Max Memory Allocated: 0.8108315467834473  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.8328614234924316  GigaBytes
Max Memory Allocated: 0.8344035148620605  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([210, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.8342561721801758  GigaBytes
Max Memory Allocated: 0.8344035148620605  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.8342561721801758  GigaBytes
Max Memory Allocated: 0.8344035148620605  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.8346567153930664  GigaBytes
Max Memory Allocated: 0.8346567153930664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.857487678527832  GigaBytes
Max Memory Allocated: 0.8590898513793945  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([183, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8588705062866211  GigaBytes
Max Memory Allocated: 0.8590898513793945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8588705062866211  GigaBytes
Max Memory Allocated: 0.8590898513793945  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 2.0662841796875 GB
    Memory Allocated: 0.8592195510864258  GigaBytes
Max Memory Allocated: 0.8592195510864258  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.8815584182739258  GigaBytes
Max Memory Allocated: 0.8831291198730469  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([146, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.8827872276306152  GigaBytes
Max Memory Allocated: 0.8831291198730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.8827872276306152  GigaBytes
Max Memory Allocated: 0.8831291198730469  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.8830657005310059  GigaBytes
Max Memory Allocated: 0.8831291198730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.9028372764587402  GigaBytes
Max Memory Allocated: 0.9042296409606934  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.9038825035095215  GigaBytes
Max Memory Allocated: 0.9042296409606934  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.9038825035095215  GigaBytes
Max Memory Allocated: 0.9042296409606934  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.9040961265563965  GigaBytes
Max Memory Allocated: 0.9042296409606934  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1209716796875 GB
    Memory Allocated: 0.9207587242126465  GigaBytes
Max Memory Allocated: 0.921933650970459  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1209716796875 GB
    Memory Allocated: 0.9220590591430664  GigaBytes
Max Memory Allocated: 0.9220647811889648  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1209716796875 GB
    Memory Allocated: 0.9220590591430664  GigaBytes
Max Memory Allocated: 0.9220647811889648  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 2.1209716796875 GB
    Memory Allocated: 0.9222917556762695  GigaBytes
Max Memory Allocated: 0.9222917556762695  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.9420709609985352  GigaBytes
Max Memory Allocated: 0.9434671401977539  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.94305419921875  GigaBytes
Max Memory Allocated: 0.9434671401977539  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.94305419921875  GigaBytes
Max Memory Allocated: 0.9434671401977539  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.9432220458984375  GigaBytes
Max Memory Allocated: 0.9434671401977539  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9586639404296875  GigaBytes
Max Memory Allocated: 0.9597549438476562  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9597373008728027  GigaBytes
Max Memory Allocated: 0.9597549438476562  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9597373008728027  GigaBytes
Max Memory Allocated: 0.9597549438476562  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.9599013328552246  GigaBytes
Max Memory Allocated: 0.9599013328552246  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.9761404991149902  GigaBytes
Max Memory Allocated: 0.9772887229919434  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([64, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.9769811630249023  GigaBytes
Max Memory Allocated: 0.9772887229919434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.9769811630249023  GigaBytes
Max Memory Allocated: 0.9772887229919434  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.9771032333374023  GigaBytes
Max Memory Allocated: 0.9772887229919434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.9900426864624023  GigaBytes
Max Memory Allocated: 0.9909582138061523  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.990750789642334  GigaBytes
Max Memory Allocated: 0.9909582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.990750789642334  GigaBytes
Max Memory Allocated: 0.9909582138061523  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.9908461570739746  GigaBytes
Max Memory Allocated: 0.9909582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 1.0016226768493652  GigaBytes
Max Memory Allocated: 1.0023856163024902  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 1.0027518272399902  GigaBytes
Max Memory Allocated: 1.0027565956115723  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 1.0027518272399902  GigaBytes
Max Memory Allocated: 1.0027565956115723  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 1.0028891563415527  GigaBytes
Max Memory Allocated: 1.0028891563415527  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 1.0193686485290527  GigaBytes
Max Memory Allocated: 1.020535945892334  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 1.0203495025634766  GigaBytes
Max Memory Allocated: 1.020535945892334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 1.0203495025634766  GigaBytes
Max Memory Allocated: 1.020535945892334  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 1.0204639434814453  GigaBytes
Max Memory Allocated: 1.020535945892334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 1.0349979400634766  GigaBytes
Max Memory Allocated: 1.0360279083251953  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 1.0359086990356445  GigaBytes
Max Memory Allocated: 1.0360279083251953  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 1.0359086990356445  GigaBytes
Max Memory Allocated: 1.0360279083251953  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 1.0360097885131836  GigaBytes
Max Memory Allocated: 1.0360279083251953  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.049555778503418  GigaBytes
Max Memory Allocated: 1.050516128540039  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.050485610961914  GigaBytes
Max Memory Allocated: 1.050516128540039  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.050485610961914  GigaBytes
Max Memory Allocated: 1.050516128540039  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 1.0505828857421875  GigaBytes
Max Memory Allocated: 1.0505828857421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.0642986297607422  GigaBytes
Max Memory Allocated: 1.0652713775634766  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.0653605461120605  GigaBytes
Max Memory Allocated: 1.0653653144836426  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.0653605461120605  GigaBytes
Max Memory Allocated: 1.0653653144836426  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.0654654502868652  GigaBytes
Max Memory Allocated: 1.0654654502868652  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 1.080991268157959  GigaBytes
Max Memory Allocated: 1.0820927619934082  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 1.081573486328125  GigaBytes
Max Memory Allocated: 1.0820927619934082  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 1.081573486328125  GigaBytes
Max Memory Allocated: 1.0820927619934082  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 1.0816307067871094  GigaBytes
Max Memory Allocated: 1.0820927619934082  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 1.0904998779296875  GigaBytes
Max Memory Allocated: 1.0911293029785156  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([46, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 1.0914883613586426  GigaBytes
Max Memory Allocated: 1.0914926528930664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 1.0914883613586426  GigaBytes
Max Memory Allocated: 1.0914926528930664  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 1.091576099395752  GigaBytes
Max Memory Allocated: 1.091576099395752  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2947998046875 GB
    Memory Allocated: 1.1057896614074707  GigaBytes
Max Memory Allocated: 1.1067986488342285  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 1.1063227653503418  GigaBytes
Max Memory Allocated: 1.1067986488342285  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 1.1063227653503418  GigaBytes
Max Memory Allocated: 1.1067986488342285  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 1.106370449066162  GigaBytes
Max Memory Allocated: 1.1067986488342285  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 1.114428997039795  GigaBytes
Max Memory Allocated: 1.1150012016296387  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([502, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.1264677047729492  GigaBytes
Max Memory Allocated: 1.1265149116516113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.1264677047729492  GigaBytes
Max Memory Allocated: 1.1265149116516113  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 1.127425193786621  GigaBytes
Max Memory Allocated: 1.127425193786621  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.2986135482788086  GigaBytes
Max Memory Allocated: 1.310582160949707  GigaBytes

rst.shape  torch.Size([1, 502, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5213623046875 GB
    Memory Allocated: 1.2619118690490723  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5213623046875 GB
    Memory Allocated: 1.2627625465393066  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5213623046875 GB
    Memory Allocated: 1.263613224029541  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.5213623046875 GB
    Memory Allocated: 1.2627196311950684  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

torch.Size([5708, 40])
input nodes number: 11924
output nodes number: 5708
edges number: 43563
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5213623046875 GB
    Memory Allocated: 1.263702392578125  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.5213623046875 GB
    Memory Allocated: 1.2637033462524414  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 0.020743370056152344  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

pseudo mini batch 1 input nodes size: 24864
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 0.018166065216064453  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 0.018166065216064453  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 0.030022144317626953  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 0.030065536499023438  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 0.018303871154785156  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 0.01935291290283203  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 0.01935291290283203  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 0.01935291290283203  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

torch.Size([24864, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 0.01935291290283203  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

m.shape torch.Size([1091, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.06601142883300781  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.06601142883300781  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.06705188751220703  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.07537555694580078  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1256, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.07667112350463867  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.07667112350463867  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 1256, 128]), torch.Size([1, 1256, 128])
----------------------------------------3
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.07786893844604492  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09652090072631836  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 1256, 128])
m.shape torch.Size([1190, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09805822372436523  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09805822372436523  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 1190, 128]), torch.Size([1, 1190, 128])
----------------------------------------3
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09919309616088867  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.1241602897644043  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 1190, 128])
m.shape torch.Size([1069, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.12563180923461914  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.12563180923461914  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.12665128707885742  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.1571660041809082  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([950, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.1589212417602539  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.1589212417602539  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 950, 128]), torch.Size([1, 950, 128])
----------------------------------------3
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.15982723236083984  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.1924428939819336  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 950, 128])
m.shape torch.Size([840, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.19439315795898438  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.19439315795898438  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.19519424438476562  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.2303609848022461  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([730, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.23239707946777344  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.23239707946777344  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 730, 128]), torch.Size([1, 730, 128])
----------------------------------------3
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.23309326171875  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.2679595947265625  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 730, 128])
m.shape torch.Size([688, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.2702360153198242  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.2702360153198242  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 688, 128]), torch.Size([1, 688, 128])
----------------------------------------3
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.2708921432495117  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.3091115951538086  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 688, 128])
m.shape torch.Size([581, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.311276912689209  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.311276912689209  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.311830997467041  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.34752559661865234  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([5538, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.3736557960510254  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.3736557960510254  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 5538, 128]), torch.Size([1, 5538, 128])
----------------------------------------3
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.37988901138305664  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7560572624206543  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 5538, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7148714065551758  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7281589508056641  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7414464950561523  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7280550003051758  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

torch.Size([13933, 256])
first layer input nodes number: 24864
first layer output nodes number: 13933
edges number: 92462
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7416338920593262  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7549214363098145  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.758608341217041  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.758608341217041  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

m.shape torch.Size([742, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8067889213562012  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8067889213562012  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 742, 256]), torch.Size([1, 742, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.808204174041748  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8198018074035645  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 742, 256])
m.shape torch.Size([670, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8203821182250977  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8203821182250977  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.821660041809082  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8415803909301758  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 670, 256])
m.shape torch.Size([572, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8432788848876953  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8432788848876953  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8443698883056641  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8688526153564453  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 572, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.870079517364502  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.870079517364502  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8709588050842285  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8968091011047363  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([388, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8982343673706055  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8982343673706055  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.8989744186401367  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9263486862182617  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([323, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9278416633605957  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9278416633605957  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9284577369689941  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9560723304748535  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([298, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9577693939208984  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9577693939208984  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9583377838134766  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9873542785644531  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([248, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9889769554138184  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9889769554138184  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 0.9894499778747559  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0164122581481934  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([235, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0182089805603027  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0182089805603027  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0186572074890137  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0473437309265137  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([194, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0489845275878906  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0489845275878906  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0493545532226562  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0756263732910156  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([175, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0772919654846191  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0772919654846191  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.0776257514953613  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.103661060333252  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([140, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1051092147827148  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1051092147827148  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1053762435913086  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1280736923217773  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1293244361877441  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1293244361877441  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1295323371887207  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1486592292785645  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([110, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1500358581542969  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1500358581542969  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1502456665039062  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1710166931152344  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([106, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1724400520324707  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1724400520324707  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1726422309875488  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.19407320022583  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([90, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1953563690185547  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1953563690185547  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.1955280303955078  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.214925765991211  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([89, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.216294288635254  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.216294288635254  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2164640426635742  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2368345260620117  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2377686500549316  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2377686500549316  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2378792762756348  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2519288063049316  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.252713680267334  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.252713680267334  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2528014183044434  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2645583152770996  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2660884857177734  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2660884857177734  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2662029266357422  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.282339096069336  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2833008766174316  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2833008766174316  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2833943367004395  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2972264289855957  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2978777885437012  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.2978777885437012  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.297940731048584  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.30769681930542  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.308483600616455  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.308483600616455  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3085541725158691  GigaBytes
Max Memory Allocated: 1.3144865036010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3199868202209473  GigaBytes
Max Memory Allocated: 1.320798397064209  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3210058212280273  GigaBytes
Max Memory Allocated: 1.3210101127624512  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3210058212280273  GigaBytes
Max Memory Allocated: 1.3210101127624512  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.321091651916504  GigaBytes
Max Memory Allocated: 1.321091651916504  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.335597038269043  GigaBytes
Max Memory Allocated: 1.3366432189941406  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([503, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3476405143737793  GigaBytes
Max Memory Allocated: 1.3476877212524414  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.3476405143737793  GigaBytes
Max Memory Allocated: 1.3476877212524414  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 2.7049560546875 GB
    Memory Allocated: 1.348599910736084  GigaBytes
Max Memory Allocated: 1.348599910736084  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.5198979377746582  GigaBytes
Max Memory Allocated: 1.5318903923034668  GigaBytes

rst.shape  torch.Size([1, 503, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.4779324531555176  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.4787940979003906  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.4796557426452637  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.4787507057189941  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([5781, 40])
input nodes number: 13933
output nodes number: 5781
edges number: 48129
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.4789090156555176  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.4789094924926758  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.021335124969482422  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

pseudo mini batch 2 input nodes size: 23416
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.018314838409423828  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.018314838409423828  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.030033588409423828  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.030076980590820312  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.018177509307861328  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.01912069320678711  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.01912069320678711  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.01912069320678711  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([23416, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.01912069320678711  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

m.shape torch.Size([932, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.0583949089050293  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.0583949089050293  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.05928373336791992  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.06639432907104492  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([965, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.06687021255493164  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.06687021255493164  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.06779050827026367  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.08233308792114258  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([1008, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.08349943161010742  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.08349943161010742  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.08446073532104492  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.10590505599975586  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([915, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.10716962814331055  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.10716962814331055  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 915, 128]), torch.Size([1, 915, 128])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.10804224014282227  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.13427114486694336  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 915, 128])
m.shape torch.Size([845, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.1358494758605957  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.1358494758605957  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.13665533065795898  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.16605472564697266  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([756, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.1678147315979004  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.1678147315979004  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 756, 128]), torch.Size([1, 756, 128])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.16853570938110352  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.1995377540588379  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 756, 128])
m.shape torch.Size([643, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.2013235092163086  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.2013235092163086  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.2019367218017578  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.23332548141479492  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([589, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.23526573181152344  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.23526573181152344  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.23582744598388672  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.2680244445800781  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([455, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.2696962356567383  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.2696962356567383  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.2701301574707031  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.2979011535644531  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([4763, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.32039594650268555  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.32039594650268555  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 4763, 128]), torch.Size([1, 4763, 128])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.3249382972717285  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6474452018737793  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 4763, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6130962371826172  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6244173049926758  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6357383728027344  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.62432861328125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([11871, 256])
first layer input nodes number: 23416
first layer output nodes number: 11871
edges number: 79245
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6359148025512695  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6472358703613281  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6508688926696777  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6508688926696777  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

m.shape torch.Size([682, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6970696449279785  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6970696449279785  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 682, 256]), torch.Size([1, 682, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.6983704566955566  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7092342376708984  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 682, 256])
m.shape torch.Size([649, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7099556922912598  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7099556922912598  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 649, 256]), torch.Size([1, 649, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7111935615539551  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7312016487121582  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 649, 256])
m.shape torch.Size([611, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.732398509979248  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.732398509979248  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7335638999938965  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7592024803161621  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 611, 256])
m.shape torch.Size([480, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7605500221252441  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7605500221252441  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7614655494689941  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7884559631347656  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([442, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7901225090026855  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7901225090026855  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.7909655570983887  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.8218779563903809  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([398, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.8237519264221191  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.8237519264221191  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.8245110511779785  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.8571534156799316  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([291, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.858731746673584  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.858731746673584  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.8592867851257324  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.8915247917175293  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([234, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.8930468559265137  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.8930468559265137  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.8934931755065918  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9189333915710449  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([192, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9203710556030273  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9203710556030273  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9207372665405273  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9441747665405273  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([213, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9460391998291016  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9460391998291016  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9464454650878906  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9752902984619141  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([171, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9768953323364258  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9768953323364258  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 0.9772214889526367  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0026617050170898  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0039057731628418  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0039057731628418  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.004138469696045  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0239176750183105  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([135, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0254883766174316  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0254883766174316  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0257458686828613  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0494351387023926  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([118, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0508942604064941  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0508942604064941  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.051119327545166  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0734009742736816  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([96, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0752458572387695  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0752458572387695  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0754289627075195  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0948381423950195  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([78, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0959463119506836  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.0959463119506836  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.096095085144043  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1129064559936523  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([88, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1142702102661133  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1142702102661133  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1144380569458008  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1345796585083008  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([72, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1357417106628418  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1357417106628418  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1358790397644043  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1533198356628418  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1544017791748047  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1544017791748047  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1545219421386719  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.170623779296875  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([69, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1718902587890625  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1718902587890625  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1720218658447266  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1905784606933594  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.191643238067627  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.191643238067627  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.1917500495910645  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2075581550598145  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2083086967468262  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2083086967468262  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.208381175994873  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2196154594421387  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2202649116516113  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2202649116516113  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2203240394592285  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.229902744293213  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2307729721069336  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2307729721069336  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2308473587036133  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2434186935424805  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([423, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2535457611083984  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2535457611083984  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 2.8358154296875 GB
    Memory Allocated: 1.2543525695800781  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.3984375  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 423, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.3584723472595215  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.3593354225158691  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8553466796875 GB
    Memory Allocated: 1.3601984977722168  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8553466796875 GB
    Memory Allocated: 1.3592920303344727  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([5791, 40])
input nodes number: 11871
output nodes number: 5791
edges number: 47143
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8553466796875 GB
    Memory Allocated: 1.3594255447387695  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8553466796875 GB
    Memory Allocated: 1.3594260215759277  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.020923137664794922  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

pseudo mini batch 3 input nodes size: 22949
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.018178939819335938  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.018178939819335938  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.029897689819335938  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.029940128326416016  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.01817798614501953  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.019043922424316406  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.019043922424316406  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.019043922424316406  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([22949, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.019043922424316406  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

m.shape torch.Size([1056, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0556788444519043  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0556788444519043  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0566859245300293  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0647425651550293  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([1140, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.06532621383666992  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.06532621383666992  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.06641340255737305  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0829615592956543  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1079, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.08396148681640625  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.08396148681640625  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0849905014038086  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.10762882232666016  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([957, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.10893964767456055  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.10893964767456055  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.10985231399536133  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1371321678161621  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([769, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.13850927352905273  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.13850927352905273  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.13924264907836914  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.16564416885375977  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([690, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1672515869140625  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1672515869140625  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 690, 128]), torch.Size([1, 690, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1679096221923828  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.19652700424194336  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 690, 128])
m.shape torch.Size([643, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.19834423065185547  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.19834423065185547  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1989574432373047  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.2298440933227539  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([565, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.23169279098510742  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.23169279098510742  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.23223161697387695  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.2632918357849121  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([509, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.26520681381225586  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.26520681381225586  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.26569223403930664  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.29675912857055664  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([4053, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.31604766845703125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.31604766845703125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 4053, 128]), torch.Size([1, 4053, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.3202400207519531  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.5969276428222656  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 4053, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.5648789405822754  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.5758090019226074  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.5867390632629395  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.5757231712341309  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([11461, 256])
first layer input nodes number: 22949
first layer output nodes number: 11461
edges number: 72518
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.5869121551513672  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.5978422164916992  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6009783744812012  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6009783744812012  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

m.shape torch.Size([757, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6438159942626953  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6438159942626953  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 757, 256]), torch.Size([1, 757, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6452598571777344  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6568107604980469  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 757, 256])
m.shape torch.Size([683, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6575136184692383  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6575136184692383  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 683, 256]), torch.Size([1, 683, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6588163375854492  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6793961524963379  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 683, 256])
m.shape torch.Size([591, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6808958053588867  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6808958053588867  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6820230484008789  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.706822395324707  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([510, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7082195281982422  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7082195281982422  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 510, 256]), torch.Size([1, 510, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7091922760009766  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7374019622802734  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 510, 256])
m.shape torch.Size([396, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7388186454772949  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7388186454772949  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7395739555358887  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7674193382263184  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([326, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7689218521118164  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7689218521118164  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7695436477661133  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7973794937133789  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([278, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7989392280578613  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7989392280578613  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7994694709777832  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.826723575592041  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([252, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8283963203430176  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8283963203430176  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8288769721984863  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8562741279602051  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([228, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.858006477355957  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.858006477355957  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8584413528442383  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8862733840942383  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([163, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8876228332519531  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8876228332519531  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8879337310791016  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9100074768066406  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([187, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9118294715881348  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9118294715881348  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9121861457824707  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9400067329406738  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([151, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9415702819824219  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9415702819824219  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9418582916259766  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.966339111328125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([139, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9679322242736816  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9679322242736816  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9681973457336426  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9925885200500488  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([103, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9938421249389648  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9938421249389648  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9940385818481445  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0134878158569336  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.01462984085083  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.01462984085083  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.014793872833252  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0321812629699707  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([91, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.033498764038086  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.033498764038086  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0336723327636719  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0532855987548828  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0547165870666504  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0547165870666504  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.05485200881958  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0711026191711426  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([74, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0723152160644531  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0723152160644531  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0724563598632812  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0903816223144531  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.091242790222168  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.091242790222168  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0913400650024414  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.104374885559082  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.105499267578125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.105499267578125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1056156158447266  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1220207214355469  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.122973918914795  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.122973918914795  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1230692863464355  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.137183666229248  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1379609107971191  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1379609107971191  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1380352973937988  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1495652198791504  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.150235652923584  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.150235652923584  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.150296688079834  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.160184383392334  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.160822868347168  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.160822868347168  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1608781814575195  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1702260971069336  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([325, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1780076026916504  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1780076026916504  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1786274909973145  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2921366691589355  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 325, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2555584907531738  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.256403923034668  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.257249355316162  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.256361484527588  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([5673, 40])
input nodes number: 11461
output nodes number: 5673
edges number: 43573
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.256472110748291  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2564725875854492  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.020709991455078125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

pseudo mini batch 4 input nodes size: 28372
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.018160343170166016  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.018160343170166016  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.031832218170166016  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0318756103515625  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.020114421844482422  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.021088123321533203  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.021088123321533203  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.021088123321533203  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([28372, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.021088123321533203  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

m.shape torch.Size([1274, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.06389379501342773  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.06389379501342773  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1274, 128]), torch.Size([1, 1274, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0651087760925293  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0748286247253418  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1274, 128])
m.shape torch.Size([1410, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.07614803314208984  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.07614803314208984  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1410, 128]), torch.Size([1, 1410, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.07749271392822266  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.09862422943115234  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1410, 128])
m.shape torch.Size([1204, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.09969139099121094  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.09969139099121094  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1204, 128]), torch.Size([1, 1204, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.10083961486816406  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1261005401611328  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1204, 128])
m.shape torch.Size([1103, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.12763023376464844  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.12763023376464844  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.12868213653564453  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.15978431701660156  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([924, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.16146135330200195  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.16146135330200195  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.16234254837036133  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.19409990310668945  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([807, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1959681510925293  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1959681510925293  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.19673776626586914  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.23052072525024414  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([724, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.23255252838134766  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.23255252838134766  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 724, 128]), torch.Size([1, 724, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.23324298858642578  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.26815128326416016  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 724, 128])
m.shape torch.Size([691, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.27044200897216797  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.27044200897216797  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 691, 128]), torch.Size([1, 691, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.2711009979248047  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.3091135025024414  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 691, 128])
m.shape torch.Size([605, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.31138038635253906  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.31138038635253906  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.31195735931396484  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.3495049476623535  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([4845, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.37231922149658203  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.37231922149658203  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 4845, 128]), torch.Size([1, 4845, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.3769397735595703  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7055010795593262  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 4845, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6684622764587402  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.681419849395752  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6943774223327637  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6813182830810547  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([13587, 256])
first layer input nodes number: 28372
first layer output nodes number: 13587
edges number: 86071
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.6945910453796387  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7075486183166504  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7107882499694824  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7107882499694824  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

m.shape torch.Size([858, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7551493644714355  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7551493644714355  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 858, 256]), torch.Size([1, 858, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7567858695983887  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7699055671691895  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 858, 256])
m.shape torch.Size([765, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7705578804016113  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7705578804016113  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 765, 256]), torch.Size([1, 765, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7720170021057129  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7950234413146973  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 765, 256])
m.shape torch.Size([576, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7960867881774902  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7960867881774902  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7971854209899902  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8213553428649902  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([493, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8227739334106445  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8227739334106445  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8237142562866211  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8513917922973633  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([408, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8528823852539062  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8528823852539062  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8536605834960938  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8816757202148438  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([329, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8831839561462402  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8831839561462402  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8838114738464355  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.911252498626709  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([264, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.912714958190918  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.912714958190918  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9132184982299805  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9393448829650879  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([263, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9411153793334961  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9411153793334961  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9416170120239258  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9712514877319336  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([209, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.972808837890625  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.972808837890625  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9732074737548828  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9987201690673828  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([174, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0001935958862305  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0001935958862305  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0005254745483398  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0240888595581055  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([149, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.025498390197754  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.025498390197754  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.025782585144043  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0479497909545898  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([140, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0494227409362793  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0494227409362793  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.049689769744873  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0723872184753418  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([114, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0736784934997559  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0736784934997559  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0738959312438965  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.093900203704834  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0951910018920898  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0951910018920898  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0953893661499023  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1150274276733398  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1162114143371582  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1162114143371582  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1163811683654785  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1343750953674316  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1354589462280273  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1354589462280273  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.135603904724121  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1519842147827148  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.15313720703125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.15313720703125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.153280258178711  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1704463958740234  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1718292236328125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1718292236328125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1719512939453125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1874542236328125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1885075569152832  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1885075569152832  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1886239051818848  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2042145729064941  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.205214023590088  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.205214023590088  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2053189277648926  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2201104164123535  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2210674285888672  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2210674285888672  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2211627960205078  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2352771759033203  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2363080978393555  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2363080978393555  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.236405372619629  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2514829635620117  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.252274513244629  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.252274513244629  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2523469924926758  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2640886306762695  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2646756172180176  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2646756172180176  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2647271156311035  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.273430347442627  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([387, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2827038764953613  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2827038764953613  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2834420204162598  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.4149785041809082  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 387, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.377063274383545  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3779306411743164  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.378798007965088  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.37788724899292  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([5819, 40])
input nodes number: 13587
output nodes number: 5819
edges number: 44538
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.378054141998291  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3780546188354492  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.02299785614013672  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

pseudo mini batch 5 input nodes size: 33471
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.020136356353759766  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.020136356353759766  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.03609657287597656  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.03613996505737305  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.022424697875976562  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.02350902557373047  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.02350902557373047  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.02350902557373047  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([33471, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.02350902557373047  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

m.shape torch.Size([1095, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0721735954284668  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.0721735954284668  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.07321786880493164  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.08157205581665039  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1194, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.08253240585327148  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.08253240585327148  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1194, 128]), torch.Size([1, 1194, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.08367109298706055  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.10146093368530273  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1194, 128])
m.shape torch.Size([1124, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.10249948501586914  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.10249948501586914  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.10357141494750977  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.12796258926391602  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([1021, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.12937402725219727  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.12937402725219727  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 1021, 128]), torch.Size([1, 1021, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.13034772872924805  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1585850715637207  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 1021, 128])
m.shape torch.Size([952, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1603679656982422  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1603679656982422  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.16127586364746094  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.195068359375  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([794, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1968860626220703  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.1968860626220703  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 794, 128]), torch.Size([1, 794, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.19764328002929688  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.23089218139648438  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 794, 128])
m.shape torch.Size([743, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.23299360275268555  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.23299360275268555  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.2337021827697754  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.2691764831542969  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([676, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.27140092849731445  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.27140092849731445  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.2720456123352051  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.30938196182250977  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([585, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.3115701675415039  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.3115701675415039  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.31212806701660156  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.34894704818725586  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([6131, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.3779029846191406  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.3779029846191406  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 6131, 128]), torch.Size([1, 6131, 128])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.38382434844970703  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7989597320556641  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 6131, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7557144165039062  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7693662643432617  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7830181121826172  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7692594528198242  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

torch.Size([14315, 256])
first layer input nodes number: 33471
first layer output nodes number: 14315
edges number: 97647
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7832694053649902  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.7969212532043457  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8003344535827637  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8003344535827637  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

m.shape torch.Size([767, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8472490310668945  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8472490310668945  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 767, 256]), torch.Size([1, 767, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8487119674682617  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8604154586791992  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 767, 256])
m.shape torch.Size([712, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8611884117126465  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8611884117126465  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 712, 256]), torch.Size([1, 712, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.862546443939209  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8829169273376465  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 712, 256])
m.shape torch.Size([573, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8842363357543945  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8842363357543945  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.8853292465209961  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9100313186645508  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([469, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9114894866943359  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9114894866943359  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.912384033203125  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9401369094848633  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([404, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9421749114990234  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9421749114990234  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9429454803466797  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9710807800292969  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9725008010864258  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9725008010864258  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9730978012084961  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 0.9997844696044922  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([296, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0014777183532715  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0014777183532715  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.002042293548584  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.030271053314209  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([249, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0319037437438965  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0319037437438965  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0323786735534668  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0594496726989746  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([201, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0617761611938477  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0617761611938477  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.062159538269043  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.086695671081543  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([201, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0884361267089844  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0884361267089844  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.0888195037841797  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1160392761230469  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1173701286315918  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1173701286315918  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1176447868347168  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1390681266784668  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([145, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1406035423278809  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1406035423278809  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1408801078796387  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1643881797790527  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([120, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1657495498657227  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1657495498657227  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1659784317016602  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1870355606079102  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([112, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1884284019470215  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1884284019470215  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.1886420249938965  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2097907066345215  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([100, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2114157676696777  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2114157676696777  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.211606502532959  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2318243980407715  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2328672409057617  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2328672409057617  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2330083847045898  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.248957633972168  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2500801086425781  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2500801086425781  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2502193450927734  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.266927719116211  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2678098678588867  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2678098678588867  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2679147720336914  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2812376022338867  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2820801734924316  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2820801734924316  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2821736335754395  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2946972846984863  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2955541610717773  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2955541610717773  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.2956438064575195  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.308283805847168  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3090667724609375  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3090667724609375  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3091449737548828  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.320718765258789  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([52, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3217792510986328  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3217792510986328  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.321878433227539  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3372516632080078  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.337754726409912  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.337754726409912  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3378024101257324  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.345527172088623  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.346287727355957  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.346287727355957  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3463525772094727  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3573122024536133  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([544, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3703513145446777  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3703513145446777  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.3713889122009277  GigaBytes
Max Memory Allocated: 1.5359787940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.5549521446228027  GigaBytes
Max Memory Allocated: 1.5679221153259277  GigaBytes

rst.shape  torch.Size([1, 544, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.5142526626586914  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.5151171684265137  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.515981674194336  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.5150737762451172  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([5800, 40])
input nodes number: 14315
output nodes number: 5800
edges number: 47801
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.515221118927002  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8572998046875 GB
    Memory Allocated: 1.5152215957641602  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.025582313537597656  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

pseudo mini batch 6 input nodes size: 16971
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.022421836853027344  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.022421836853027344  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.030514240264892578  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.030557632446289062  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.014554023742675781  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.015149116516113281  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.015149116516113281  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.015149116516113281  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([16971, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.015149116516113281  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

m.shape torch.Size([1509, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.04036664962768555  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.04036664962768555  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1509, 128]), torch.Size([1, 1509, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.04180574417114258  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.05406665802001953  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1509, 128])
m.shape torch.Size([1615, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.05488729476928711  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.05488729476928711  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1615, 128]), torch.Size([1, 1615, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.0564274787902832  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.07953023910522461  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1615, 128])
m.shape torch.Size([1328, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.08123779296875  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.08123779296875  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1328, 128]), torch.Size([1, 1328, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.0825042724609375  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.1103668212890625  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1328, 128])
m.shape torch.Size([1014, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.11217880249023438  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.11217880249023438  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1014, 128]), torch.Size([1, 1014, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.11314582824707031  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.14211654663085938  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1014, 128])
m.shape torch.Size([860, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.14368343353271484  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.14368343353271484  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.14450359344482422  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.17402935028076172  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([698, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.17561626434326172  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.17561626434326172  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 698, 128]), torch.Size([1, 698, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.17628192901611328  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.20528888702392578  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 698, 128])
m.shape torch.Size([569, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.20685529708862305  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.20685529708862305  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 569, 128]), torch.Size([1, 569, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.2073979377746582  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.2350625991821289  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 569, 128])
m.shape torch.Size([448, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.23650026321411133  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.23650026321411133  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.23692750930786133  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.26128053665161133  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([362, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.2626204490661621  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.2626204490661621  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 362, 128]), torch.Size([1, 362, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.26296567916870117  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.28506040573120117  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 362, 128])
m.shape torch.Size([1770, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.29332780838012695  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.29332780838012695  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1770, 128]), torch.Size([1, 1770, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.295015811920166  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.41582727432250977  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1770, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.39589691162109375  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.40559864044189453  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.4153003692626953  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.40552282333374023  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([10173, 256])
first layer input nodes number: 16971
first layer output nodes number: 10173
edges number: 49792
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.4155569076538086  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.4252586364746094  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.4280376434326172  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.4280376434326172  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

m.shape torch.Size([1081, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.458158016204834  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.458158016204834  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1081, 256]), torch.Size([1, 1081, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.46079158782958984  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.4796156883239746  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1081, 256])
m.shape torch.Size([994, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.48066186904907227  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.48066186904907227  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 994, 256]), torch.Size([1, 994, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.4825577735900879  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5109963417053223  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 994, 256])
m.shape torch.Size([763, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5127167701721191  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5127167701721191  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5141720771789551  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.546471118927002  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([545, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5480947494506836  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5480947494506836  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 545, 256]), torch.Size([1, 545, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5491342544555664  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5809202194213867  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 545, 256])
m.shape torch.Size([501, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5828084945678711  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5828084945678711  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5837640762329102  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6181650161743164  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([366, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6197981834411621  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6197981834411621  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6204962730407715  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6517786979675293  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([305, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6534819602966309  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6534819602966309  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6540637016296387  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6841092109680176  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([235, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6856255531311035  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6856255531311035  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6860737800598145  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7116227149963379  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([166, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7128348350524902  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7128348350524902  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7131514549255371  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7334151268005371  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([145, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7346506118774414  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7346506118774414  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7349271774291992  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7545633316040039  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([105, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7555356025695801  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7555356025695801  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7557358741760254  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7713570594787598  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([94, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.772341251373291  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.772341251373291  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7725205421447754  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7877602577209473  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7885332107543945  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7885332107543945  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7886648178100586  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8007726669311523  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([71, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8016624450683594  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8016624450683594  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8017978668212891  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8152046203613281  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8161749839782715  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8161749839782715  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.816312313079834  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.830869197845459  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8315386772155762  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8315386772155762  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8316302299499512  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8419756889343262  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8425183296203613  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8425183296203613  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8425869941711426  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8508267402648926  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8514156341552734  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8514156341552734  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8514842987060547  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8602046966552734  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8605542182922363  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8605542182922363  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8605942726135254  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8659615516662598  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8661341667175293  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8661341667175293  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8661532402038574  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.868842601776123  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8691158294677734  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8691158294677734  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8691425323486328  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8730945587158203  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8732929229736328  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8732929229736328  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8733119964599609  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8762683868408203  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8765244483947754  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8765244483947754  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8765473365783691  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8802552223205566  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8805670738220215  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8805670738220215  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8805937767028809  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8851065635681152  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([72, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8875226974487305  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8875226974487305  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.887660026550293  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.911829948425293  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 72, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8885354995727539  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8893976211547852  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8902597427368164  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8893542289733887  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([5785, 40])
input nodes number: 10173
output nodes number: 5785
edges number: 30005
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8894710540771484  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8894715309143066  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.016386032104492188  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

pseudo mini batch 7 input nodes size: 19369
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.014551639556884766  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.014551639556884766  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.023787498474121094  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.02383136749267578  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.015695571899414062  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.01648712158203125  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.01648712158203125  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.01648712158203125  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([19369, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.01648712158203125  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

m.shape torch.Size([1211, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.04914522171020508  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.04914522171020508  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1211, 128]), torch.Size([1, 1211, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.05030012130737305  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.05971240997314453  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1211, 128])
m.shape torch.Size([1291, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.060814857482910156  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.060814857482910156  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1291, 128]), torch.Size([1, 1291, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.062046051025390625  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.08051395416259766  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1291, 128])
m.shape torch.Size([1159, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.08192014694213867  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.08192014694213867  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1159, 128]), torch.Size([1, 1159, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.08302545547485352  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.10775041580200195  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1159, 128])
m.shape torch.Size([1081, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.10925960540771484  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.10925960540771484  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.11029052734375  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.14101314544677734  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([900, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.14264345169067383  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.14264345169067383  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.14350175857543945  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.1747574806213379  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([734, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 734, 128]), torch.Size([1, 734, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.17739343643188477  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.20749330520629883  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 734, 128])
m.shape torch.Size([632, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.20925283432006836  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.20925283432006836  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.2098555564880371  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.24089574813842773  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([581, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.24281072616577148  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.24281072616577148  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.24336481094360352  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.276273250579834  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([479, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.27805185317993164  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.27805185317993164  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.27850866317749023  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.30774450302124023  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([3148, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.3225269317626953  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.3225269317626953  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 3148, 128]), torch.Size([1, 3148, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.3255290985107422  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5388889312744141  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 3148, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5118198394775391  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5225162506103516  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5332126617431641  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5224323272705078  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([11216, 256])
first layer input nodes number: 19369
first layer output nodes number: 11216
edges number: 65361
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5333590507507324  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5440554618835449  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.546729564666748  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.546729564666748  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

m.shape torch.Size([836, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5870156288146973  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5870156288146973  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.5886101722717285  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.602205753326416  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([790, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.603877067565918  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.603877067565918  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 790, 256]), torch.Size([1, 790, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6053838729858398  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.627985954284668  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 790, 256])
m.shape torch.Size([628, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6299209594726562  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6299209594726562  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6311187744140625  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.658294677734375  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 628, 256])
m.shape torch.Size([546, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6597952842712402  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6597952842712402  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 546, 256]), torch.Size([1, 546, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6608366966247559  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6911978721618652  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 546, 256])
m.shape torch.Size([435, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6927676200866699  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6927676200866699  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6935973167419434  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7234663963317871  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([352, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7250814437866211  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7250814437866211  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7257528305053711  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7559590339660645  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([315, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7577428817749023  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7577428817749023  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7583436965942383  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7884607315063477  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([263, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7901825904846191  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7901825904846191  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7906842231750488  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8199400901794434  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([218, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8215751647949219  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8215751647949219  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.821990966796875  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.848602294921875  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([202, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8503360748291016  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8503360748291016  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8507213592529297  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8780765533447266  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([172, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8797025680541992  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8797025680541992  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.880030632019043  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9056196212768555  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([131, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9069666862487793  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9069666862487793  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9072165489196777  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9284548759460449  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([123, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9298667907714844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9298667907714844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9301013946533203  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9516849517822266  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9528594017028809  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9528594017028809  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9530425071716309  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9711699485778809  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9723615646362305  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9723615646362305  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9725313186645508  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9905252456665039  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9915323257446289  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9915323257446289  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9916677474975586  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0069704055786133  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0077199935913086  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0077199935913086  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0078153610229492  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0192594528198242  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0199904441833496  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0199904441833496  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0200762748718262  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0309767723083496  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0319747924804688  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0319747924804688  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.032083511352539  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.046651840209961  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0474052429199219  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0474052429199219  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0474853515625  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0587806701660156  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0593667030334473  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0593667030334473  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0594258308410645  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0681767463684082  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.068887710571289  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.068887710571289  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0689544677734375  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0793018341064453  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0799541473388672  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0799541473388672  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0800132751464844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0895919799804688  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.090139389038086  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.090139389038086  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0901870727539062  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.098245620727539  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([263, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.104541301727295  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.104541301727295  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1050429344177246  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1951708793640137  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 263, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1614270210266113  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1622982025146484  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1631693840026855  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1622543334960938  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([5846, 40])
input nodes number: 11216
output nodes number: 5846
edges number: 40832
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.162391185760498  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1623916625976562  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.01805400848388672  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

pseudo mini batch 8 input nodes size: 31422
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.015704631805419922  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.015704631805419922  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.030687808990478516  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.030730724334716797  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.02145099639892578  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.022376060485839844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.022376060485839844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.022376060485839844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([31422, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.022376060485839844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

m.shape torch.Size([1519, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.06576824188232422  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.06576824188232422  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1519, 128]), torch.Size([1, 1519, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.06721687316894531  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.07880592346191406  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1519, 128])
m.shape torch.Size([1542, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.07957601547241211  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.07957601547241211  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1542, 128]), torch.Size([1, 1542, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.08104658126831055  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.10314702987670898  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1542, 128])
m.shape torch.Size([1423, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.10530710220336914  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.10530710220336914  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1423, 128]), torch.Size([1, 1423, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.10666418075561523  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.13662099838256836  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1423, 128])
m.shape torch.Size([1202, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.13853073120117188  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.13853073120117188  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1202, 128]), torch.Size([1, 1202, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.1396770477294922  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.1736888885498047  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1202, 128])
m.shape torch.Size([1163, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.1758885383605957  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.1758885383605957  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1163, 128]), torch.Size([1, 1163, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.17699766159057617  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.21778488159179688  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1163, 128])
m.shape torch.Size([911, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.21983671188354492  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.21983671188354492  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.22070550918579102  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.25915002822875977  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([761, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.26125574111938477  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.26125574111938477  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 761, 128]), torch.Size([1, 761, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.2619814872741699  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.29863452911376953  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 761, 128])
m.shape torch.Size([689, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.3008999824523926  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.3008999824523926  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.3015570640563965  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.3398098945617676  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([562, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.34189319610595703  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.34189319610595703  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.34242916107177734  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.3775482177734375  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([4612, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.39927196502685547  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.39927196502685547  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 4612, 128]), torch.Size([1, 4612, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.4036703109741211  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7159528732299805  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 4612, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6788616180419922  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.6925792694091797  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7062969207763672  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.692471981048584  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([14384, 256])
first layer input nodes number: 31422
first layer output nodes number: 14384
edges number: 86978
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7065329551696777  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7202506065368652  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7236800193786621  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7236800193786621  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

m.shape torch.Size([1018, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7604904174804688  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7604904174804688  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1018, 256]), torch.Size([1, 1018, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7624320983886719  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7779655456542969  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1018, 256])
m.shape torch.Size([811, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7789373397827148  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7789373397827148  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 811, 256]), torch.Size([1, 811, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.7804841995239258  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8036870956420898  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 811, 256])
m.shape torch.Size([674, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8048591613769531  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8048591613769531  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 674, 256]), torch.Size([1, 674, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8061447143554688  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8352470397949219  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 674, 256])
m.shape torch.Size([528, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.836723804473877  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.836723804473877  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.837730884552002  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8680901527404785  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([480, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8698935508728027  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8698935508728027  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.8708090782165527  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9053702354431152  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([339, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.906867504119873  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.906867504119873  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9075140953063965  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9369025230407715  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([271, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9384026527404785  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9384026527404785  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9389195442199707  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9653162956237793  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([228, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9670286178588867  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9670286178588867  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.967463493347168  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9922513961791992  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([181, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9935998916625977  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9935998916625977  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.9939451217651367  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0160398483276367  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0173091888427734  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0173091888427734  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0175952911376953  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0379085540771484  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.039140224456787  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.039140224456787  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0393881797790527  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0587286949157715  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.059896469116211  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.059896469116211  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.060110092163086  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.078268051147461  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0794110298156738  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0794110298156738  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.079601764678955  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.09714937210083  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0981440544128418  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0981440544128418  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.0982985496520996  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.113593578338623  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1144680976867676  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1144680976867676  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1145939826965332  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1279377937316895  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1287822723388672  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1287822723388672  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1288948059082031  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.141611099243164  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1422739028930664  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1422739028930664  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1423578262329102  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1524286270141602  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.153165340423584  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.153165340423584  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1532511711120605  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.164151668548584  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1648030281066895  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1648030281066895  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1648755073547363  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1745877265930176  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1752052307128906  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1752052307128906  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1752700805664062  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1844139099121094  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1847448348999023  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1847448348999023  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.184779167175293  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1898603439331055  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1902661323547363  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1902661323547363  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1903042793273926  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1962170600891113  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.196706771850586  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.196706771850586  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.1967506408691406  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.203857421875  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2042970657348633  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2042970657348633  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2043352127075195  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2107820510864258  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([282, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2175393104553223  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2175393104553223  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2180771827697754  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.3132967948913574  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 282, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2830653190612793  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2839226722717285  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2847800254821777  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2838797569274902  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([5752, 40])
input nodes number: 14384
output nodes number: 5752
edges number: 37037
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2840161323547363  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.2840166091918945  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.024184703826904297  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

pseudo mini batch 9 input nodes size: 42277
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.02143716812133789  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.02143716812133789  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.041596412658691406  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.04163837432861328  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.026612281799316406  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.027614593505859375  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.027614593505859375  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.027614593505859375  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([42277, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 0.027614593505859375  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

m.shape torch.Size([1496, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.07851028442382812  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.07851028442382812  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.07993698120117188  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.09135055541992188  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([1605, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.09216785430908203  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.09216785430908203  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1605, 128]), torch.Size([1, 1605, 128])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.09369850158691406  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.11665821075439453  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1605, 128])
m.shape torch.Size([1385, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.11842775344848633  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.11842775344848633  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1385, 128]), torch.Size([1, 1385, 128])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.11974859237670898  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.14927053451538086  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1385, 128])
m.shape torch.Size([1179, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.15085887908935547  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.15085887908935547  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1179, 128]), torch.Size([1, 1179, 128])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.15198326110839844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.1849527359008789  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1179, 128])
m.shape torch.Size([1068, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.1869368553161621  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.1869368553161621  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.18795537948608398  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.2253108024597168  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([839, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.2272019386291504  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.2272019386291504  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.22800207138061523  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.26300954818725586  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([785, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.2652297019958496  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.2652297019958496  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.2659783363342285  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.3035860061645508  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([658, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.3057217597961426  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.3057217597961426  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.3063492774963379  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.3432188034057617  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([584, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.3454113006591797  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.3454113006591797  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.34596824645996094  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.3825092315673828  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 584, 128])
m.shape torch.Size([6149, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.41155147552490234  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.41155147552490234  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 6149, 128]), torch.Size([1, 6149, 128])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.4174156188964844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8341851234436035  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 6149, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.7902183532714844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.80523681640625  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8202552795410156  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8051190376281738  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([15748, 256])
first layer input nodes number: 42277
first layer output nodes number: 15748
edges number: 101456
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8205723762512207  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8355908393859863  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8393454551696777  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8393454551696777  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

m.shape torch.Size([1058, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8731474876403809  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8731474876403809  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1058, 256]), torch.Size([1, 1058, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8770251274108887  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8969006538391113  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1058, 256])
m.shape torch.Size([903, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8969144821166992  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8969144821166992  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 903, 256]), torch.Size([1, 903, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8986368179321289  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9269437789916992  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 903, 256])
m.shape torch.Size([715, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9290022850036621  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9290022850036621  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 715, 256]), torch.Size([1, 715, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.930366039276123  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9603686332702637  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 715, 256])
m.shape torch.Size([527, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9620504379272461  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9620504379272461  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9630556106567383  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9932184219360352  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([417, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9947199821472168  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9947199821472168  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9955153465270996  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0261778831481934  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([303, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0275278091430664  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0275278091430664  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0281057357788086  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0543241500854492  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([239, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0556435585021973  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0556435585021973  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0560994148254395  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0788922309875488  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.080233097076416  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.080233097076416  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0806221961975098  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1028008460998535  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1041202545166016  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1041202545166016  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1044540405273438  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1258163452148438  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([154, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1271300315856934  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1271300315856934  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1274237632751465  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1482787132263184  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([120, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1501407623291016  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1501407623291016  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.150369644165039  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.168222427368164  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([95, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.169203758239746  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.169203758239746  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1693849563598633  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1847867965698242  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([82, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1857590675354004  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.1857590675354004  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.185915470123291  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2003045082092285  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.201101303100586  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.201101303100586  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2012252807617188  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2134990692138672  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.21417236328125  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.21417236328125  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2142696380615234  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2245807647705078  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2253012657165527  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2253012657165527  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2253966331481934  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.236173152923584  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2368121147155762  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2368121147155762  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2368922233581543  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2465052604675293  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2472095489501953  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2472095489501953  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2472915649414062  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2577075958251953  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2582693099975586  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2582693099975586  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2583322525024414  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2667665481567383  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2674078941345215  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2674078941345215  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.26747465133667  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2768874168395996  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.277237892150879  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.277237892150879  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2772741317749023  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.282637596130371  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2827887535095215  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2827887535095215  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.282804012298584  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2851691246032715  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.285515308380127  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.285515308380127  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.285545825958252  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.290489673614502  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.29093599319458  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.29093599319458  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2909741401672363  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.2974209785461426  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([209, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.3024239540100098  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.3024239540100098  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.3028225898742676  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.3729825019836426  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 209, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.3456735610961914  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.3465056419372559  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.3473377227783203  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.346463680267334  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([5583, 40])
input nodes number: 15748
output nodes number: 5583
edges number: 32904
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.3465981483459473  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.3465986251831055  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.029569625854492188  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

pseudo mini batch 10 input nodes size: 59462
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.02658700942993164  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.02658700942993164  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.05494070053100586  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.05498218536376953  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.03478097915649414  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.03664350509643555  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.03664350509643555  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.03664350509643555  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

torch.Size([59462, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.03664350509643555  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

m.shape torch.Size([1299, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.13431119918823242  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.13431119918823242  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1299, 128]), torch.Size([1, 1299, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.13555002212524414  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.1454606056213379  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1299, 128])
m.shape torch.Size([1388, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.14668846130371094  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.14668846130371094  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1388, 128]), torch.Size([1, 1388, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.1480121612548828  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.16786766052246094  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1388, 128])
m.shape torch.Size([1275, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.16902971267700195  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.16902971267700195  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1275, 128]), torch.Size([1, 1275, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.17024564743041992  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.19699621200561523  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1275, 128])
m.shape torch.Size([1103, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.19849205017089844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.19849205017089844  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.19954395294189453  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.23064613342285156  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1071, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.23267364501953125  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.23267364501953125  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.23369503021240234  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.2709174156188965  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([979, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.2732076644897461  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.2732076644897461  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.2741413116455078  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.3152318000793457  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([899, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.3177657127380371  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.3177657127380371  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.31862306594848633  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.3622860908508301  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([855, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.36511898040771484  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.36511898040771484  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.3659343719482422  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.4124116897583008  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([862, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.41570329666137695  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.41570329666137695  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.41652536392211914  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0506591796875 GB
    Memory Allocated: 0.46913766860961914  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([15401, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1248779296875 GB
    Memory Allocated: 0.542945384979248  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1248779296875 GB
    Memory Allocated: 0.542945384979248  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

 h.shape torch.Size([1, 15401, 128]), torch.Size([1, 15401, 128])
----------------------------------------3
 Nvidia-smi: 3.1248779296875 GB
    Memory Allocated: 0.5576329231262207  GigaBytes
Max Memory Allocated: 1.5710482597351074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6013073921203613  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

rst.shape  torch.Size([1, 15401, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.5110507011413574  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.5350184440612793  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.5589861869812012  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.5348310470581055  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

torch.Size([25132, 256])
first layer input nodes number: 59462
first layer output nodes number: 25132
edges number: 198442
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.559431552886963  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.5833992958068848  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.5896492004394531  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.5896492004394531  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

m.shape torch.Size([850, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6400752067565918  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6400752067565918  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

 h.shape torch.Size([1, 850, 256]), torch.Size([1, 850, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6416964530944824  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6546664237976074  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

rst.shape  torch.Size([1, 850, 256])
m.shape torch.Size([702, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6553120613098145  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6553120613098145  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

 h.shape torch.Size([1, 702, 256]), torch.Size([1, 702, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6566510200500488  GigaBytes
Max Memory Allocated: 1.6755261421203613  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.6772732734680176  GigaBytes
Max Memory Allocated: 1.6787190437316895  GigaBytes

rst.shape  torch.Size([1, 702, 256])
m.shape torch.Size([533, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.678208351135254  GigaBytes
Max Memory Allocated: 1.6787190437316895  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.678208351135254  GigaBytes
Max Memory Allocated: 1.6787190437316895  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.679224967956543  GigaBytes
Max Memory Allocated: 1.679224967956543  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.702155590057373  GigaBytes
Max Memory Allocated: 1.7036943435668945  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([395, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.703171730041504  GigaBytes
Max Memory Allocated: 1.7036943435668945  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.703171730041504  GigaBytes
Max Memory Allocated: 1.7036943435668945  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7039251327514648  GigaBytes
Max Memory Allocated: 1.7039251327514648  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7284150123596191  GigaBytes
Max Memory Allocated: 1.7302899360656738  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([319, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7299251556396484  GigaBytes
Max Memory Allocated: 1.7302899360656738  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7299251556396484  GigaBytes
Max Memory Allocated: 1.7302899360656738  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7305335998535156  GigaBytes
Max Memory Allocated: 1.7305335998535156  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7608757019042969  GigaBytes
Max Memory Allocated: 1.7627506256103516  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([254, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7624578475952148  GigaBytes
Max Memory Allocated: 1.7627506256103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7624578475952148  GigaBytes
Max Memory Allocated: 1.7627506256103516  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7629423141479492  GigaBytes
Max Memory Allocated: 1.7629423141479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7837743759155273  GigaBytes
Max Memory Allocated: 1.785649299621582  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([202, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7854180335998535  GigaBytes
Max Memory Allocated: 1.785649299621582  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7854180335998535  GigaBytes
Max Memory Allocated: 1.785649299621582  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.7858033180236816  GigaBytes
Max Memory Allocated: 1.7858033180236816  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.805067539215088  GigaBytes
Max Memory Allocated: 1.8064160346984863  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([161, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8061132431030273  GigaBytes
Max Memory Allocated: 1.8064160346984863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8061132431030273  GigaBytes
Max Memory Allocated: 1.8064160346984863  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8064203262329102  GigaBytes
Max Memory Allocated: 1.8064203262329102  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8239240646362305  GigaBytes
Max Memory Allocated: 1.8251523971557617  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([164, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8251895904541016  GigaBytes
Max Memory Allocated: 1.8251953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8251895904541016  GigaBytes
Max Memory Allocated: 1.8251953125  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8255023956298828  GigaBytes
Max Memory Allocated: 1.8255023956298828  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8455219268798828  GigaBytes
Max Memory Allocated: 1.8469295501708984  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([125, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.846567153930664  GigaBytes
Max Memory Allocated: 1.8469295501708984  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.846567153930664  GigaBytes
Max Memory Allocated: 1.8469295501708984  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8468055725097656  GigaBytes
Max Memory Allocated: 1.8469295501708984  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8637332916259766  GigaBytes
Max Memory Allocated: 1.8649253845214844  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([123, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.864914894104004  GigaBytes
Max Memory Allocated: 1.8649253845214844  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.864914894104004  GigaBytes
Max Memory Allocated: 1.8649253845214844  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8651494979858398  GigaBytes
Max Memory Allocated: 1.8651494979858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.883448600769043  GigaBytes
Max Memory Allocated: 1.8847389221191406  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8846230506896973  GigaBytes
Max Memory Allocated: 1.8847389221191406  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8846230506896973  GigaBytes
Max Memory Allocated: 1.8847389221191406  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.8848366737365723  GigaBytes
Max Memory Allocated: 1.8848366737365723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9029946327209473  GigaBytes
Max Memory Allocated: 1.9042763710021973  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([80, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9039840698242188  GigaBytes
Max Memory Allocated: 1.9042763710021973  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9039840698242188  GigaBytes
Max Memory Allocated: 1.9042763710021973  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9041366577148438  GigaBytes
Max Memory Allocated: 1.9042763710021973  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9181747436523438  GigaBytes
Max Memory Allocated: 1.9192728996276855  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9192051887512207  GigaBytes
Max Memory Allocated: 1.9192728996276855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9192051887512207  GigaBytes
Max Memory Allocated: 1.9192728996276855  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9193596839904785  GigaBytes
Max Memory Allocated: 1.9193596839904785  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.934654712677002  GigaBytes
Max Memory Allocated: 1.9358010292053223  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9353995323181152  GigaBytes
Max Memory Allocated: 1.9358010292053223  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9353995323181152  GigaBytes
Max Memory Allocated: 1.9358010292053223  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9355082511901855  GigaBytes
Max Memory Allocated: 1.9358010292053223  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9470324516296387  GigaBytes
Max Memory Allocated: 1.947847843170166  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([57, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.947854995727539  GigaBytes
Max Memory Allocated: 1.9478588104248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.947854995727539  GigaBytes
Max Memory Allocated: 1.9478588104248047  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9479637145996094  GigaBytes
Max Memory Allocated: 1.9479637145996094  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9602489471435547  GigaBytes
Max Memory Allocated: 1.9611186981201172  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9610610008239746  GigaBytes
Max Memory Allocated: 1.9611186981201172  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9610610008239746  GigaBytes
Max Memory Allocated: 1.9611186981201172  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9611620903015137  GigaBytes
Max Memory Allocated: 1.9611620903015137  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9732928276062012  GigaBytes
Max Memory Allocated: 1.9741520881652832  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.974142074584961  GigaBytes
Max Memory Allocated: 1.9741520881652832  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.974142074584961  GigaBytes
Max Memory Allocated: 1.9741520881652832  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9742412567138672  GigaBytes
Max Memory Allocated: 1.9742412567138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.986837387084961  GigaBytes
Max Memory Allocated: 1.9877300262451172  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.987943172454834  GigaBytes
Max Memory Allocated: 1.987947940826416  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.987943172454834  GigaBytes
Max Memory Allocated: 1.987947940826416  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 1.9880595207214355  GigaBytes
Max Memory Allocated: 1.9880595207214355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.003650188446045  GigaBytes
Max Memory Allocated: 2.0047554969787598  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0045342445373535  GigaBytes
Max Memory Allocated: 2.0047554969787598  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0045342445373535  GigaBytes
Max Memory Allocated: 2.0047554969787598  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0046277046203613  GigaBytes
Max Memory Allocated: 2.0047554969787598  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.017805576324463  GigaBytes
Max Memory Allocated: 2.018740177154541  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.018768310546875  GigaBytes
Max Memory Allocated: 2.018772602081299  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.018768310546875  GigaBytes
Max Memory Allocated: 2.018772602081299  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0188636779785156  GigaBytes
Max Memory Allocated: 2.0188636779785156  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.032978057861328  GigaBytes
Max Memory Allocated: 2.0339794158935547  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.033712863922119  GigaBytes
Max Memory Allocated: 2.0339794158935547  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.033712863922119  GigaBytes
Max Memory Allocated: 2.0339794158935547  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.033783435821533  GigaBytes
Max Memory Allocated: 2.0339794158935547  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.044722080230713  GigaBytes
Max Memory Allocated: 2.0454983711242676  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0454163551330566  GigaBytes
Max Memory Allocated: 2.0454983711242676  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0454163551330566  GigaBytes
Max Memory Allocated: 2.0454983711242676  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0454792976379395  GigaBytes
Max Memory Allocated: 2.0454983711242676  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.055675983428955  GigaBytes
Max Memory Allocated: 2.0563998222351074  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.056406021118164  GigaBytes
Max Memory Allocated: 2.0564093589782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.056406021118164  GigaBytes
Max Memory Allocated: 2.0564093589782715  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.056468963623047  GigaBytes
Max Memory Allocated: 2.056468963623047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.067106246948242  GigaBytes
Max Memory Allocated: 2.067861557006836  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([935, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0899810791015625  GigaBytes
Max Memory Allocated: 2.0900683403015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.0899810791015625  GigaBytes
Max Memory Allocated: 2.0900683403015137  GigaBytes

 h.shape torch.Size([1, 935, 256]), torch.Size([1, 935, 256])
----------------------------------------3
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.091764450073242  GigaBytes
Max Memory Allocated: 2.091764450073242  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.405637741088867  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 935, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.360887050628662  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.3617095947265625  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.362532138824463  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.361668109893799  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

torch.Size([5518, 40])
input nodes number: 25132
output nodes number: 5518
edges number: 51384
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.3618874549865723  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8553466796875 GB
    Memory Allocated: 2.3618879318237305  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.039948463439941406  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

pseudo mini batch 11 input nodes size: 43844
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.03477144241333008  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.03477144241333008  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.05625581741333008  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.05629777908325195  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.027902603149414062  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.02922821044921875  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.02922821044921875  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.02922821044921875  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

torch.Size([43844, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.02922821044921875  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

m.shape torch.Size([1462, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.0970621109008789  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.0970621109008789  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1462, 128]), torch.Size([1, 1462, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.09845638275146484  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.11006975173950195  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1462, 128])
m.shape torch.Size([1506, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.1108088493347168  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.1108088493347168  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1506, 128]), torch.Size([1, 1506, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.11224508285522461  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.1337885856628418  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1506, 128])
m.shape torch.Size([1221, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.13481712341308594  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.13481712341308594  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1221, 128]), torch.Size([1, 1221, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.13598155975341797  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.16159915924072266  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1221, 128])
m.shape torch.Size([1117, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.1631474494934082  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.1631474494934082  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.16421270370483398  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.1955571174621582  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1053, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.19753503799438477  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.19753503799438477  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.19853925704956055  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.23541927337646484  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([868, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.23740053176879883  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.23740053176879883  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.23822832107543945  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.2738327980041504  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([814, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.2761359214782715  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.2761359214782715  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.27691221237182617  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.31729745864868164  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([799, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.31995725631713867  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.31995725631713867  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 799, 128]), torch.Size([1, 799, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.32071924209594727  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.3641524314880371  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 799, 128])
m.shape torch.Size([707, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.3668055534362793  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.3668055534362793  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 707, 128]), torch.Size([1, 707, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.3674798011779785  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.4117255210876465  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 707, 128])
m.shape torch.Size([9561, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.45697879791259766  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.45697879791259766  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 9561, 128]), torch.Size([1, 9561, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.4660968780517578  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.113480567932129  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 9561, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.0522751808166504  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.070497989654541  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.0887207984924316  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.0703554153442383  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

torch.Size([19108, 256])
first layer input nodes number: 43844
first layer output nodes number: 19108
edges number: 137141
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.0890498161315918  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1072726249694824  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.111828327178955  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.111828327178955  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

m.shape torch.Size([998, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1520719528198242  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1520719528198242  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 998, 256]), torch.Size([1, 998, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.153975486755371  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1694765090942383  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 998, 256])
m.shape torch.Size([842, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1701436042785645  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1701436042785645  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 842, 256]), torch.Size([1, 842, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1717495918273926  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1968116760253906  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 842, 256])
m.shape torch.Size([583, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1980562210083008  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1980562210083008  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.1991682052612305  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2237043380737305  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([432, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2250685691833496  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2250685691833496  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2258925437927246  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.251197338104248  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([420, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2528038024902344  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2528038024902344  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2536048889160156  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2833476066589355  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([297, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2846598625183105  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2846598625183105  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.2852263450622559  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.312328815460205  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([233, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.3136134147644043  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.3136134147644043  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.3140578269958496  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.3362784385681152  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([235, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.3378634452819824  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.3378634452819824  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.3383116722106934  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.3638606071472168  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([176, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.365159034729004  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.365159034729004  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.365494728088379  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.386979103088379  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([145, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.3882050514221191  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.3882050514221191  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.388481616973877  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4081177711486816  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4092845916748047  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4092845916748047  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4095096588134766  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4270648956298828  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([95, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4280614852905273  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4280614852905273  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4282426834106445  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4436445236206055  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4444661140441895  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4444661140441895  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4446053504943848  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4574151039123535  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.458153247833252  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.458153247833252  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4582676887512207  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.469597339630127  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4703478813171387  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4703478813171387  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4704546928405762  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4817767143249512  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4825387001037598  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4825387001037598  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4826397895812988  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.494062900543213  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4949111938476562  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.4949111938476562  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.495016098022461  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5076045989990234  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5082788467407227  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5082788467407227  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5083589553833008  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5185327529907227  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5194244384765625  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5194244384765625  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.519521713256836  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5325565338134766  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5333733558654785  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5333733558654785  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.533459186553955  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5455613136291504  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5463662147521973  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5463662147521973  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5464463233947754  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.558302402496338  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.558875560760498  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.558875560760498  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5589308738708496  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5675044059753418  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5678529739379883  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5678529739379883  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.567885398864746  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5731382369995117  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.573906421661377  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.573906421661377  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5739712715148926  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5849308967590332  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([474, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5962882041931152  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5962882041931152  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5971922874450684  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7585301399230957  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 474, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7245473861694336  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7253828048706055  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7262182235717773  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7253408432006836  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

torch.Size([5605, 40])
input nodes number: 19108
output nodes number: 5605
edges number: 40638
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7255382537841797  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.725538730621338  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.03168821334838867  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

pseudo mini batch 12 input nodes size: 65034
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.027915477752685547  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.027915477752685547  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.05916547775268555  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.05920696258544922  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.037680625915527344  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.03951072692871094  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.03951072692871094  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.03951072692871094  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

torch.Size([65034, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.03951072692871094  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

m.shape torch.Size([1426, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.13835954666137695  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.13835954666137695  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1426, 128]), torch.Size([1, 1426, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.13971948623657227  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.15059900283813477  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1426, 128])
m.shape torch.Size([1557, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.15140390396118164  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.15140390396118164  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1557, 128]), torch.Size([1, 1557, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.15288877487182617  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.17516183853149414  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1557, 128])
m.shape torch.Size([1451, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.1772289276123047  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.1772289276123047  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1451, 128]), torch.Size([1, 1451, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.17861270904541016  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.20905590057373047  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1451, 128])
m.shape torch.Size([1284, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.21096563339233398  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.21096563339233398  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1284, 128]), torch.Size([1, 1284, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.2121901512145996  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.24770116806030273  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1284, 128])
m.shape torch.Size([1186, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.24991655349731445  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.24991655349731445  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1186, 128]), torch.Size([1, 1186, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.25104761123657227  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.292386531829834  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1186, 128])
m.shape torch.Size([1011, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.29471349716186523  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.29471349716186523  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1011, 128]), torch.Size([1, 1011, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.29567766189575195  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.3382277488708496  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1011, 128])
m.shape torch.Size([916, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.3408031463623047  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.3408031463623047  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.3416767120361328  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.38684654235839844  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([951, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.39003753662109375  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.39003753662109375  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 951, 128]), torch.Size([1, 951, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.3909444808959961  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.4426403045654297  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 951, 128])
m.shape torch.Size([826, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.44573163986206055  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.44573163986206055  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.4465193748474121  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.4985623359680176  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([15283, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.5710434913635254  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.5710434913635254  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 15283, 128]), torch.Size([1, 15283, 128])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.5856184959411621  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6204438209533691  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 15283, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.529308795928955  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5540003776550293  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.5786919593811035  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.553807258605957  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

torch.Size([25891, 256])
first layer input nodes number: 65034
first layer output nodes number: 25891
edges number: 200309
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.579178810119629  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6038703918457031  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6104016304016113  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6104016304016113  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

m.shape torch.Size([894, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.654996395111084  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.654996395111084  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 894, 256]), torch.Size([1, 894, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6567015647888184  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6703429222106934  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 894, 256])
m.shape torch.Size([757, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6710476875305176  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6710476875305176  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 757, 256]), torch.Size([1, 757, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6724915504455566  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6941494941711426  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 757, 256])
m.shape torch.Size([582, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.695509433746338  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.695509433746338  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.6966195106506348  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7213125228881836  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7228398323059082  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7228398323059082  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7237114906311035  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.753157138824463  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([346, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7548346519470215  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7548346519470215  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7554945945739746  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7850708961486816  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([246, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7868523597717285  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7868523597717285  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.7873215675354004  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.807497501373291  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([215, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8093743324279785  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8093743324279785  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8097844123840332  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8302884101867676  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([188, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8321948051452637  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8321948051452637  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8325533866882324  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8529925346374512  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([178, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8549256324768066  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8549256324768066  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8552651405334473  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8769936561584473  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8789353370666504  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8789353370666504  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.8792195320129395  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.899397373199463  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([108, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.900461196899414  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.900461196899414  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9006671905517578  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9167346954345703  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([104, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.918741226196289  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.918741226196289  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9189395904541016  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.935800552368164  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9369511604309082  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9369511604309082  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9371418952941895  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9546895027160645  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9557161331176758  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9557161331176758  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9558610916137695  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9702119827270508  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([74, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9716534614562988  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9716534614562988  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.971794605255127  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9867558479309082  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9877004623413086  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9877004623413086  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 1.9878263473510742  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.00205135345459  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0027236938476562  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0027236938476562  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.002809524536133  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0131092071533203  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.013896942138672  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.013896942138672  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.013988494873047  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.025615692138672  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.026373863220215  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.026373863220215  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0264577865600586  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.037703514099121  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.038546085357666  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.038546085357666  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0386338233947754  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0510048866271973  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0517687797546387  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0517687797546387  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.051845073699951  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.063136577606201  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.063754081726074  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.063754081726074  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0638132095336914  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0729780197143555  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0736780166625977  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0736780166625977  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0737409591674805  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.083937644958496  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0844831466674805  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0844831466674805  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.084530830383301  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.0925893783569336  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([670, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.1086645126342773  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.1086645126342773  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.1099424362182617  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.3348569869995117  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 670, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.2961902618408203  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.297013282775879  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.2978363037109375  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.2969717979431152  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

torch.Size([5522, 40])
input nodes number: 25891
output nodes number: 5522
edges number: 45271
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.297194004058838  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 2.297194480895996  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.04279327392578125  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

pseudo mini batch 13 input nodes size: 68057
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.03766822814941406  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.03766822814941406  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.07012033462524414  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.07016181945800781  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.03887033462524414  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.042029380798339844  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.042029380798339844  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.042029380798339844  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

torch.Size([68057, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9569091796875 GB
    Memory Allocated: 0.042029380798339844  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

m.shape torch.Size([1195, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.17272424697875977  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.17272424697875977  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1195, 128]), torch.Size([1, 1195, 128])
----------------------------------------3
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.17386388778686523  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.18298101425170898  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1195, 128])
m.shape torch.Size([1317, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.18366718292236328  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.18366718292236328  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1317, 128]), torch.Size([1, 1317, 128])
----------------------------------------3
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.1849231719970703  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.20376300811767578  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1317, 128])
m.shape torch.Size([1250, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.20492315292358398  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.20492315292358398  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1250, 128]), torch.Size([1, 1250, 128])
----------------------------------------3
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.2061152458190918  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.23234128952026367  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1250, 128])
m.shape torch.Size([1124, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.23388910293579102  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.23388910293579102  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.23496103286743164  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.26604700088500977  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([1181, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.2683267593383789  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.2683267593383789  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1181, 128]), torch.Size([1, 1181, 128])
----------------------------------------3
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.2694530487060547  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.3099994659423828  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1181, 128])
m.shape torch.Size([1167, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.313199520111084  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.313199520111084  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.3143124580383301  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.3621687889099121  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1110, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.36531734466552734  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.36531734466552734  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.3663759231567383  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.42057037353515625  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1096, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.42475223541259766  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.42475223541259766  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.4257974624633789  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.48681068420410156  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([1050, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.49079418182373047  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.49079418182373047  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.49179553985595703  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 0.5564498901367188  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([21389, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.6579399108886719  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.6579399108886719  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 21389, 128]), torch.Size([1, 21389, 128])
----------------------------------------3
 Nvidia-smi: 4.1873779296875 GB
    Memory Allocated: 0.6783380508422852  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1298961639404297  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 21389, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0073423385620117  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0385923385620117  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0698423385620117  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0383543968200684  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

torch.Size([31879, 256])
first layer input nodes number: 68057
first layer output nodes number: 31879
edges number: 264860
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0703516006469727  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1016016006469727  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.109633445739746  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.109633445739746  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

m.shape torch.Size([678, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.169088840484619  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.169088840484619  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 678, 256]), torch.Size([1, 678, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.170382022857666  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.180727481842041  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 678, 256])
m.shape torch.Size([576, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1814146041870117  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1814146041870117  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1825132369995117  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1989927291870117  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([431, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.199960231781006  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.199960231781006  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.200782299041748  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.219412326812744  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([306, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.220517635345459  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.220517635345459  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2211012840270996  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.240074634552002  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([313, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2412872314453125  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2412872314453125  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.241884231567383  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2646636962890625  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([253, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.265824317932129  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.265824317932129  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2663068771362305  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2870569229125977  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([195, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.288127899169922  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.288127899169922  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2884998321533203  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.307096481323242  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([189, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.308363914489746  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.308363914489746  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3087244033813477  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3292722702026367  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([144, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3303380012512207  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3303380012512207  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3306126594543457  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3481907844543457  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3494954109191895  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3494954109191895  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3497815132141113  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3700947761535645  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([121, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3712310791015625  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3712310791015625  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.371461868286133  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.389463424682617  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.390709400177002  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.390709400177002  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.390934467315674  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.410065174102783  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([97, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4111671447753906  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4111671447753906  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4113521575927734  GigaBytes
Max Memory Allocated: 2.4279298782348633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.428373336791992  GigaBytes
Max Memory Allocated: 2.4295759201049805  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4294381141662598  GigaBytes
Max Memory Allocated: 2.4295759201049805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4294381141662598  GigaBytes
Max Memory Allocated: 2.4295759201049805  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4296021461486816  GigaBytes
Max Memory Allocated: 2.4296021461486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4458413124084473  GigaBytes
Max Memory Allocated: 2.4469895362854004  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4472155570983887  GigaBytes
Max Memory Allocated: 2.447221279144287  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4472155570983887  GigaBytes
Max Memory Allocated: 2.447221279144287  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4474081993103027  GigaBytes
Max Memory Allocated: 2.4474081993103027  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4678282737731934  GigaBytes
Max Memory Allocated: 2.469273090362549  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4689621925354004  GigaBytes
Max Memory Allocated: 2.469273090362549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4689621925354004  GigaBytes
Max Memory Allocated: 2.469273090362549  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4691147804260254  GigaBytes
Max Memory Allocated: 2.469273090362549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4863572120666504  GigaBytes
Max Memory Allocated: 2.4875779151916504  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4874072074890137  GigaBytes
Max Memory Allocated: 2.4875779151916504  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4874072074890137  GigaBytes
Max Memory Allocated: 2.4875779151916504  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.487534999847412  GigaBytes
Max Memory Allocated: 2.4875779151916504  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.5028700828552246  GigaBytes
Max Memory Allocated: 2.5039563179016113  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([94, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.5044326782226562  GigaBytes
Max Memory Allocated: 2.504439353942871  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.5044326782226562  GigaBytes
Max Memory Allocated: 2.504439353942871  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.5046119689941406  GigaBytes
Max Memory Allocated: 2.5046119689941406  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.5273818969726562  GigaBytes
Max Memory Allocated: 2.5299363136291504  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([72, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.5286073684692383  GigaBytes
Max Memory Allocated: 2.5299363136291504  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.5286073684692383  GigaBytes
Max Memory Allocated: 2.5299363136291504  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.528744697570801  GigaBytes
Max Memory Allocated: 2.5299363136291504  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.547146797180176  GigaBytes
Max Memory Allocated: 2.5484514236450195  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.548337936401367  GigaBytes
Max Memory Allocated: 2.5484514236450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.548337936401367  GigaBytes
Max Memory Allocated: 2.5484514236450195  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.5484619140625  GigaBytes
Max Memory Allocated: 2.5484619140625  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.5659427642822266  GigaBytes
Max Memory Allocated: 2.5671825408935547  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.567193031311035  GigaBytes
Max Memory Allocated: 2.5671982765197754  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.567193031311035  GigaBytes
Max Memory Allocated: 2.5671982765197754  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.567317008972168  GigaBytes
Max Memory Allocated: 2.567317008972168  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.585665702819824  GigaBytes
Max Memory Allocated: 2.5869674682617188  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.586703300476074  GigaBytes
Max Memory Allocated: 2.5869674682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.586703300476074  GigaBytes
Max Memory Allocated: 2.5869674682617188  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.5868024826049805  GigaBytes
Max Memory Allocated: 2.5869674682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.602175712585449  GigaBytes
Max Memory Allocated: 2.603266716003418  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.6029000282287598  GigaBytes
Max Memory Allocated: 2.603266716003418  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.6029000282287598  GigaBytes
Max Memory Allocated: 2.603266716003418  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.602966785430908  GigaBytes
Max Memory Allocated: 2.603266716003418  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.613781452178955  GigaBytes
Max Memory Allocated: 2.614549160003662  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([50, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.614901542663574  GigaBytes
Max Memory Allocated: 2.6149063110351562  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.614901542663574  GigaBytes
Max Memory Allocated: 2.6149063110351562  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.614996910095215  GigaBytes
Max Memory Allocated: 2.614996910095215  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.6311140060424805  GigaBytes
Max Memory Allocated: 2.632258415222168  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([1193, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.6597323417663574  GigaBytes
Max Memory Allocated: 2.659843921661377  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.6597323417663574  GigaBytes
Max Memory Allocated: 2.659843921661377  GigaBytes

 h.shape torch.Size([1, 1193, 256]), torch.Size([1, 1193, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.662539005279541  GigaBytes
Max Memory Allocated: 2.662539005279541  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.072375774383545  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1193, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.0177369117736816  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.018561363220215  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.019385814666748  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.018519878387451  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5531, 40])
input nodes number: 31879
output nodes number: 5531
edges number: 60948
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.018800735473633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.018801212310791  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.04619884490966797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 14 input nodes size: 60450
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.03887176513671875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.03887176513671875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.06769657135009766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.06773805618286133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.03524446487426758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.037409305572509766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.037409305572509766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.037409305572509766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([60450, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.037409305572509766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1101, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.15187501907348633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.15187501907348633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.1529250144958496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.1616501808166504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1176, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.1622467041015625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.1622467041015625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1176, 128]), torch.Size([1, 1176, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.16336822509765625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.1801910400390625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1176, 128])
m.shape torch.Size([1148, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.18154144287109375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.18154144287109375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1148, 128]), torch.Size([1, 1148, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.18263626098632812  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.20781326293945312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1148, 128])
m.shape torch.Size([1071, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.20930862426757812  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.20930862426757812  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.21033000946044922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.23995018005371094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([994, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.24180936813354492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.24180936813354492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 994, 128]), torch.Size([1, 994, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.24275732040405273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.276883602142334  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 994, 128])
m.shape torch.Size([995, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.27925634384155273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.27925634384155273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 995, 128]), torch.Size([1, 995, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.28020524978637695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.3215785026550293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 995, 128])
m.shape torch.Size([962, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.32431507110595703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.32431507110595703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.32523250579833984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.3717203140258789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([859, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.3745384216308594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.3745384216308594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.37535762786865234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.4221172332763672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([864, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.4254155158996582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.4254155158996582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 864, 128]), torch.Size([1, 864, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.4262394905090332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.4789738655090332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 864, 128])
m.shape torch.Size([18959, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.5689654350280762  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.5689654350280762  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 18959, 128]), torch.Size([1, 18959, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.5870461463928223  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.870776653289795  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 18959, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.7634706497192383  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.7902965545654297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.817122459411621  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.7900867462158203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([28129, 256])
first layer input nodes number: 60450
first layer output nodes number: 28129
edges number: 233093
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.8175749778747559  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.8444008827209473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.851208209991455  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.851208209991455  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([684, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9071707725524902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9071707725524902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 684, 256]), torch.Size([1, 684, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.908475399017334  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.918912410736084  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 684, 256])
m.shape torch.Size([601, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9194517135620117  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9194517135620117  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.920598030090332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9383306503295898  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([458, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9391717910766602  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9391717910766602  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9400453567504883  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9608955383300781  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([362, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9618735313415527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9618735313415527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9625639915466309  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9840335845947266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([330, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9853739738464355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9853739738464355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9860033988952637  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.009767532348633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([265, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.011801242828369  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.011801242828369  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0123066902160645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0361032485961914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([231, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.037684440612793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.037684440612793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0381250381469727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.060154914855957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([167, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.061218738555908  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.061218738555908  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.061537265777588  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.07969331741333  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([171, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0810136795043945  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0810136795043945  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0813398361206055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1022138595581055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([141, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1041741371154785  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1041741371154785  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.104443073272705  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.123537540435791  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1248726844787598  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1248726844787598  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1251378059387207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.145817279815674  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.147091865539551  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.147091865539551  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.147324562072754  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1671037673950195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.168997287750244  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.168997287750244  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.169193744659424  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.187267780303955  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([82, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1882729530334473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1882729530334473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.188429355621338  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2039132118225098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2049598693847656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2049598693847656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.205108642578125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2208786010742188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([83, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.222080707550049  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.222080707550049  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2222390174865723  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2401280403137207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2414355278015137  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2414355278015137  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.241574764251709  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2582831382751465  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2592172622680664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2592172622680664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2593278884887695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2733774185180664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2744178771972656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2744178771972656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2745323181152344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.289867401123047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.290867805480957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.290867805480957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2909727096557617  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3057641983032227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3066000938415527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3066000938415527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3066840171813965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3191046714782715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.31978178024292  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.31978178024292  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3198466300964355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3298983573913574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3307723999023438  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3307723999023438  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.330850601196289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3435192108154297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.344310760498047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.344310760498047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.344379425048828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3559837341308594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([1099, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.382356643676758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.382356643676758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1099, 256]), torch.Size([1, 1099, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.384524345397949  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.7688145637512207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1099, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.7182540893554688  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.719076633453369  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.7198991775512695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.7190351486206055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5517, 40])
input nodes number: 28129
output nodes number: 5517
edges number: 57307
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.7192845344543457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.719285011291504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.04114198684692383  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 15 input nodes size: 52480
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.035242557525634766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.035242557525634766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.060266971588134766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.06030988693237305  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.03144359588623047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.033763885498046875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.033763885498046875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.033763885498046875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([52480, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.033763885498046875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([928, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.1505742073059082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.1505742073059082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 928, 128]), torch.Size([1, 928, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.1514592170715332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.1594548225402832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 928, 128])
m.shape torch.Size([946, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.15991449356079102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.15991449356079102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 946, 128]), torch.Size([1, 946, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.16081666946411133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.17524194717407227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 946, 128])
m.shape torch.Size([956, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.17615842819213867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.17615842819213867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.17707014083862305  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.1971278190612793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([899, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.19838666915893555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.19838666915893555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 899, 128]), torch.Size([1, 899, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.19924402236938477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.22507524490356445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 899, 128])
m.shape torch.Size([847, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.22666597366333008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.22666597366333008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.22747373580932617  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.25665283203125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([840, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.2596249580383301  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.2596249580383301  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.26042604446411133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.2951779365539551  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([863, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.29765796661376953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.29765796661376953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.2984809875488281  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.340085506439209  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([802, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.34273338317871094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.34273338317871094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.34349822998046875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.3875713348388672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([830, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.3907508850097656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.3907508850097656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.3915424346923828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.4438352584838867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([19964, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.5391426086425781  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.5391426086425781  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 19964, 128]), torch.Size([1, 19964, 128])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 0.5581817626953125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9148826599121094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 19964, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.8040895462036133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.8314485549926758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.8580322265625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.830465316772461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([27875, 256])
first layer input nodes number: 52480
first layer output nodes number: 27875
edges number: 238126
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.8584251403808594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.8850088119506836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.8918523788452148  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.8918523788452148  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([568, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.962963581085205  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.962963581085205  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9640469551086426  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9750256538391113  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([455, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9753589630126953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9753589630126953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.976226806640625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9892444610595703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([390, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9899945259094238  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9899945259094238  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 1.9907383918762207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0073113441467285  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([316, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.008179187774658  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.008179187774658  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.008781909942627  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.028463840484619  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([238, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0293731689453125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0293731689453125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.029827117919922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0461692810058594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([210, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0471534729003906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0471534729003906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0475540161132812  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.064777374267578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([181, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0657949447631836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0657949447631836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0661401748657227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.083401679992676  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([146, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.084439754486084  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.084439754486084  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.0847182273864746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1005911827087402  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([155, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.101792812347412  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.101792812347412  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.102088451385498  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.121009349822998  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([147, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.123000144958496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.123000144958496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1232805252075195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1431875228881836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([129, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.144411563873291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.144411563873291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.144657611846924  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.163849353790283  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([134, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1652722358703613  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1652722358703613  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.165527820587158  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1872525215148926  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([124, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.189140796661377  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.189140796661377  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.1893773078918457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2111363410949707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([103, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.212404251098633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.212404251098633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2126007080078125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2320499420166016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([104, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2334513664245605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2334513664245605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.233649730682373  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.254676342010498  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([85, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.256615161895752  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.256615161895752  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.256777286529541  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.275097370147705  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([97, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2766013145446777  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2766013145446777  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.2767863273620605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.298987865447998  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([102, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3006601333618164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3006601333618164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3008546829223633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3255624771118164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([76, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.327043056488037  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.327043056488037  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.327188014984131  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3466124534606934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([83, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.348135471343994  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.348135471343994  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3482937812805176  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3706154823303223  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([93, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3724136352539062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.3724136352539062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.372591018676758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.398843765258789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.399966239929199  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.399966239929199  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4000749588012695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.416926383972168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([69, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4183974266052246  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4183974266052246  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.4185290336608887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.439849376678467  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes
[05:34:08] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28447620 edges into 16 parts and get 7194483 edge cuts

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([69, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.441375255584717  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.441375255584717  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 2.441506862640381  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4637484550476074  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([1579, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5016231536865234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5016231536865234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1579, 256]), torch.Size([1, 1579, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5046348571777344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.03654146194458  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1579, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9705686569213867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9217529296875 GB
    Memory Allocated: 2.9714198112487793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9237060546875 GB
    Memory Allocated: 2.972270965576172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9237060546875 GB
    Memory Allocated: 2.971376895904541  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5710, 40])
input nodes number: 27875
output nodes number: 5710
edges number: 73177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9237060546875 GB
    Memory Allocated: 2.971656322479248  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9237060546875 GB
    Memory Allocated: 2.9716567993164062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.037737369537353516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04328775405883789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04328775405883789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014153674244880676 |0.025172889232635498 |0.1486259549856186 |0.00010050833225250244 |0.07760944962501526 |0.0058155059814453125 |
----------------------------------------------------------pseudo_mini_loss sum 5.330747604370117
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  902188
Number of first layer input nodes during this epoch:  615562
Number of first layer output nodes during this epoch:  286626
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04328727722167969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02019476890563965
global_2_local spend time (sec) 0.04940009117126465
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004183053970336914
A = g.adjacency_matrix() spent  0.008724451065063477
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08944296836853027
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3383309841156006
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2420790195465088

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432})
Convert a graph into a bidirected graph: 1.313 seconds
Metis partitioning: 5.606 seconds
Split the graph: 1.099 seconds
Construct subgraphs: 0.123 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.155251502990723
5558
5650
5747
5572
5794
5784
5843
5825
5721
5777
5546
5517
5661
5574
5854
5518
total k batches seeds list generation spend  19.2687771320343
after graph partition
graph partition algorithm spend time 19.35731267929077
5558
5650
5747
5572
5794
5784
5843
5825
5721
5777
5546
5517
5661
5574
5854
5518
partition_len_list
[10480, 11021, 13225, 12348, 10683, 11480, 13049, 14244, 14697, 14422, 19379, 21373, 29484, 26731, 30196, 25890]
shared_neighbor_graph_partition_s0 selection method  spend 19.462259531021118
time for parepare:  0.020311594009399414
local_output_nid generation:  0.0015587806701660156
local_in_edges_tensor generation:  0.001653909683227539
mini_batch_src_global generation:  0.0021381378173828125
r_  generation:  0.014912605285644531
local_output_nid generation:  0.0017011165618896484
local_in_edges_tensor generation:  0.0014486312866210938
mini_batch_src_global generation:  0.001688241958618164
r_  generation:  0.01613783836364746
local_output_nid generation:  0.0018312931060791016
local_in_edges_tensor generation:  0.0014023780822753906
mini_batch_src_global generation:  0.0014638900756835938
r_  generation:  0.015487194061279297
local_output_nid generation:  0.0017766952514648438
local_in_edges_tensor generation:  0.0014088153839111328
mini_batch_src_global generation:  0.0012564659118652344
r_  generation:  0.013252019882202148
local_output_nid generation:  0.0019876956939697266
local_in_edges_tensor generation:  0.0013489723205566406
mini_batch_src_global generation:  0.001230001449584961
r_  generation:  0.012656211853027344
local_output_nid generation:  0.0019180774688720703
local_in_edges_tensor generation:  0.001333475112915039
mini_batch_src_global generation:  0.0010693073272705078
r_  generation:  0.012843132019042969
local_output_nid generation:  0.0020661354064941406
local_in_edges_tensor generation:  0.0013947486877441406
mini_batch_src_global generation:  0.0013461112976074219
r_  generation:  0.015643596649169922
local_output_nid generation:  0.001989126205444336
local_in_edges_tensor generation:  0.0014033317565917969
mini_batch_src_global generation:  0.0014591217041015625
r_  generation:  0.01654338836669922
local_output_nid generation:  0.0019071102142333984
local_in_edges_tensor generation:  0.0012388229370117188
mini_batch_src_global generation:  0.001192331314086914
r_  generation:  0.013361454010009766
local_output_nid generation:  0.0018486976623535156
local_in_edges_tensor generation:  0.001207113265991211
mini_batch_src_global generation:  0.0011115074157714844
r_  generation:  0.01320195198059082
local_output_nid generation:  0.0017514228820800781
local_in_edges_tensor generation:  0.0011773109436035156
mini_batch_src_global generation:  0.0014126300811767578
r_  generation:  0.01047062873840332
local_output_nid generation:  0.0016810894012451172
local_in_edges_tensor generation:  0.0011708736419677734
mini_batch_src_global generation:  0.0013055801391601562
r_  generation:  0.016885757446289062
local_output_nid generation:  0.0019021034240722656
local_in_edges_tensor generation:  0.0013880729675292969
mini_batch_src_global generation:  0.0021317005157470703
r_  generation:  0.02211165428161621
local_output_nid generation:  0.001924753189086914
local_in_edges_tensor generation:  0.0012865066528320312
mini_batch_src_global generation:  0.0016775131225585938
r_  generation:  0.0173795223236084
local_output_nid generation:  0.0020112991333007812
local_in_edges_tensor generation:  0.0019638538360595703
mini_batch_src_global generation:  0.0025048255920410156
r_  generation:  0.026131391525268555
local_output_nid generation:  0.001958608627319336
local_in_edges_tensor generation:  0.0013918876647949219
mini_batch_src_global generation:  0.0020821094512939453
r_  generation:  0.020725011825561523
----------------------check_connections_block total spend ----------------------------- 0.42772889137268066
generate_one_block  0.02532362937927246
generate_one_block  0.02328968048095703
generate_one_block  0.021405458450317383
generate_one_block  0.01796412467956543
generate_one_block  0.016675472259521484
generate_one_block  0.017821311950683594
generate_one_block  0.020482301712036133
generate_one_block  0.022232770919799805
generate_one_block  0.01829385757446289
generate_one_block  0.017778635025024414
generate_one_block  0.017569541931152344
generate_one_block  0.02249288558959961
generate_one_block  0.0342409610748291
generate_one_block  0.025024890899658203
generate_one_block  0.039641618728637695
generate_one_block  0.02861618995666504
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029950857162475586
gen group dst list time:  0.007985353469848633
time for parepare:  0.02451491355895996
local_output_nid generation:  0.0022461414337158203
local_in_edges_tensor generation:  0.01237797737121582
mini_batch_src_global generation:  0.0022766590118408203
r_  generation:  0.0231015682220459
local_output_nid generation:  0.0032732486724853516
local_in_edges_tensor generation:  0.0025777816772460938
mini_batch_src_global generation:  0.002881765365600586
r_  generation:  0.03970050811767578
local_output_nid generation:  0.0066258907318115234
local_in_edges_tensor generation:  0.0055620670318603516
mini_batch_src_global generation:  0.00691986083984375
r_  generation:  0.034140825271606445
local_output_nid generation:  0.004923343658447266
local_in_edges_tensor generation:  0.003076791763305664
mini_batch_src_global generation:  0.0029108524322509766
r_  generation:  0.029493093490600586
local_output_nid generation:  0.003657102584838867
local_in_edges_tensor generation:  0.002426624298095703
mini_batch_src_global generation:  0.0022313594818115234
r_  generation:  0.02152276039123535
local_output_nid generation:  0.0035734176635742188
local_in_edges_tensor generation:  0.002454519271850586
mini_batch_src_global generation:  0.0019366741180419922
r_  generation:  0.023813486099243164
local_output_nid generation:  0.0037908554077148438
local_in_edges_tensor generation:  0.0029726028442382812
mini_batch_src_global generation:  0.002635478973388672
r_  generation:  0.029797792434692383
local_output_nid generation:  0.004167795181274414
local_in_edges_tensor generation:  0.0032660961151123047
mini_batch_src_global generation:  0.0034613609313964844
r_  generation:  0.03460812568664551
local_output_nid generation:  0.004144430160522461
local_in_edges_tensor generation:  0.0036029815673828125
mini_batch_src_global generation:  0.0029304027557373047
r_  generation:  0.03319740295410156
local_output_nid generation:  0.004033803939819336
local_in_edges_tensor generation:  0.0032300949096679688
mini_batch_src_global generation:  0.0028150081634521484
r_  generation:  0.03137707710266113
local_output_nid generation:  0.005539655685424805
local_in_edges_tensor generation:  0.005541563034057617
mini_batch_src_global generation:  0.004671335220336914
r_  generation:  0.04919624328613281
local_output_nid generation:  0.005875349044799805
local_in_edges_tensor generation:  0.005380392074584961
mini_batch_src_global generation:  0.009034395217895508
r_  generation:  0.05870175361633301
local_output_nid generation:  0.007283210754394531
local_in_edges_tensor generation:  0.008125066757202148
mini_batch_src_global generation:  0.009907960891723633
r_  generation:  0.08457732200622559
local_output_nid generation:  0.007585763931274414
local_in_edges_tensor generation:  0.007661342620849609
mini_batch_src_global generation:  0.00885915756225586
r_  generation:  0.07521843910217285
local_output_nid generation:  0.007765531539916992
local_in_edges_tensor generation:  0.007396221160888672
mini_batch_src_global generation:  0.01129460334777832
r_  generation:  0.08960151672363281
local_output_nid generation:  0.006989955902099609
local_in_edges_tensor generation:  0.0059964656829833984
mini_batch_src_global generation:  0.009096384048461914
r_  generation:  0.07487034797668457
----------------------check_connections_block total spend ----------------------------- 1.1804683208465576
generate_one_block  0.04027581214904785
generate_one_block  0.034990549087524414
generate_one_block  0.039206504821777344
generate_one_block  0.03452610969543457
generate_one_block  0.026634693145751953
generate_one_block  0.02973318099975586
generate_one_block  0.03641223907470703
generate_one_block  0.045653581619262695
generate_one_block  0.04389357566833496
generate_one_block  0.04046154022216797
generate_one_block  0.06294941902160645
generate_one_block  0.07462763786315918
generate_one_block  0.11862826347351074
generate_one_block  0.10086369514465332
generate_one_block  0.11678409576416016
generate_one_block  0.09729647636413574
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04328727722167969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

connection checking time:  1.1804683208465576
block generation total time  0.9429373741149902
average batch blocks generation time:  0.05893358588218689
block dataloader generation time/epoch 22.5784113407135
pseudo mini batch 0 input nodes size: 19856
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.037021636962890625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.037021636962890625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.046489715576171875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04653120040893555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.021463871002197266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.022305011749267578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.022305011749267578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.022305011749267578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([19856, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.022305011749267578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([930, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.055933475494384766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.055933475494384766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.05682039260864258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0643925666809082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([1007, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06490945816040039  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06490945816040039  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1007, 128]), torch.Size([1, 1007, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06586980819702148  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08061647415161133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1007, 128])
m.shape torch.Size([968, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08152103424072266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08152103424072266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0824441909790039  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1027536392211914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([826, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1038675308227539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1038675308227539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10465526580810547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12749958038330078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([668, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12869834899902344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12869834899902344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1293354034423828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15346527099609375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([598, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15485763549804688  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15485763549804688  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1554279327392578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1802082061767578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([571, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18182897567749023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18182897567749023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1823735237121582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.20985746383666992  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([516, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21155357360839844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21155357360839844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21204566955566406  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.24061203002929688  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([464, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2423572540283203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2423572540283203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2427997589111328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2711200714111328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([3932, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.29043006896972656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.29043006896972656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 3932, 128]), torch.Size([1, 3932, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.29417991638183594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5684375762939453  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 3932, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5382928848266602  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5482873916625977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5582818984985352  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5482091903686523  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([10480, 256])
first layer input nodes number: 19856
first layer output nodes number: 10480
edges number: 67701
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5584321022033691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5684266090393066  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.570925235748291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.570925235748291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([706, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.615142822265625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.615142822265625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 706, 256]), torch.Size([1, 706, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6164894104003906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6272621154785156  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 706, 256])
m.shape torch.Size([688, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6284379959106445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6284379959106445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6297502517700195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6494340896606445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([565, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6506295204162598  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6506295204162598  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6517071723937988  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6765484809875488  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([467, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6778626441955566  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6778626441955566  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6787533760070801  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7057356834411621  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([365, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7070446014404297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7070446014404297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7077407836914062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.733332633972168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7347149848937988  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7347149848937988  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7352871894836426  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7607426643371582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([272, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7622866630554199  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7622866630554199  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7628054618835449  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7903628349304199  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([238, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.791933536529541  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.791933536529541  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7923874855041504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8182625770568848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([223, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8199648857116699  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8199648857116699  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8203902244567871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8476119041442871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([175, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8490815162658691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8490815162658691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8494153022766113  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8731141090393066  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([167, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8747129440307617  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8747129440307617  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8750314712524414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.899876594543457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([163, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9015974998474121  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9015974998474121  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9019083976745605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9283347129821777  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([120, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9296789169311523  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9296789169311523  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9299077987670898  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9509649276733398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([102, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9522233009338379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9522233009338379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9524178504943848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9716782569885254  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9728355407714844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9728355407714844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9730014801025391  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9905910491943359  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9916768074035645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9916768074035645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9918217658996582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.008202075958252  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([76, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0093717575073242  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0093717575073242  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.009516716003418  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.026911735534668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([73, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0281023979187012  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0281023979187012  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0282416343688965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0459246635437012  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0476016998291016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0476016998291016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0477066040039062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0617637634277344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.062711238861084  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.062711238861084  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0628104209899902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0767951011657715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0778560638427734  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0778560638427734  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0779609680175781  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0934867858886719  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([43, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.094343662261963  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.094343662261963  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0944256782531738  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1071381568908691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1080036163330078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1080036163330078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1080818176269531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1207504272460938  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1214494705200195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1214494705200195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1215105056762695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1318254470825195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([417, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1418147087097168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1418147087097168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1426100730895996  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.284806728363037  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 417, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2466115951538086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2474398612976074  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2482681274414062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2473983764648438  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5558, 40])
input nodes number: 10480
output nodes number: 5558
edges number: 45065
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.247495174407959  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2474961280822754  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.023906230926513672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 1 input nodes size: 20177
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.021441936492919922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.021441936492919922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.031063079833984375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.031105518341064453  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02159595489501953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.022528648376464844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.022528648376464844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.022528648376464844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([20177, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.022528648376464844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([761, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.05984306335449219  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.05984306335449219  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 761, 128]), torch.Size([1, 761, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.060568809509277344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06702089309692383  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 761, 128])
m.shape torch.Size([885, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06750202178955078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06750202178955078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 885, 128]), torch.Size([1, 885, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06834602355957031  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08145952224731445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 885, 128])
m.shape torch.Size([858, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08226490020751953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08226490020751953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 858, 128]), torch.Size([1, 858, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0830831527709961  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10207939147949219  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 858, 128])
m.shape torch.Size([843, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10327816009521484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10327816009521484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10408210754394531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1282052993774414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([747, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12958431243896484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12958431243896484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 747, 128]), torch.Size([1, 747, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1302967071533203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1559429168701172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 747, 128])
m.shape torch.Size([675, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1575179100036621  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1575179100036621  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 675, 128]), torch.Size([1, 675, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15816164016723633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18697595596313477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 675, 128])
m.shape torch.Size([590, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18862342834472656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18862342834472656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18918609619140625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21803808212280273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([568, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2199234962463379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2199234962463379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22046518325805664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2522454261779785  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([439, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2538585662841797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2538585662841797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25427722930908203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.28107166290283203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([4655, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.30305910110473633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.30305910110473633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 4655, 128]), torch.Size([1, 4655, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.30775880813598633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6231274604797363  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 4655, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5899806022644043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6004910469055176  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6110014915466309  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6004085540771484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([11021, 256])
first layer input nodes number: 20177
first layer output nodes number: 11021
edges number: 75437
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6111540794372559  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6216645240783691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6242923736572266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6242923736572266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([572, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6726846694946289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6726846694946289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6737756729125977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6829490661621094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 572, 256])
m.shape torch.Size([568, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6839580535888672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6839580535888672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6850414276123047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7019691467285156  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([549, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7030258178710938  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7030258178710938  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7040729522705078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7277536392211914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 549, 256])
m.shape torch.Size([434, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7290172576904297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7290172576904297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7298450469970703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7552700042724609  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([415, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7568507194519043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7568507194519043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7576422691345215  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7876496315002441  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([372, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7893991470336914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7893991470336914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7901086807250977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.821263313293457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([300, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8229269981384277  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8229269981384277  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8234992027282715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8521971702575684  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([257, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8538875579833984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8538875579833984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8543777465820312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8831577301025391  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([201, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8846516609191895  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8846516609191895  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8850350379943848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9095711708068848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([218, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9114751815795898  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9114751815795898  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.911890983581543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9414129257202148  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([204, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9433622360229492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9433622360229492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.943751335144043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9741010665893555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([137, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9759206771850586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9759206771850586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9761819839477539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9983930587768555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([141, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0000243186950684  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0000243186950684  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.000293254852295  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0250353813171387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([122, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0265426635742188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0265426635742188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0267753601074219  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0498123168945312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([102, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0511665344238281  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0511665344238281  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.051361083984375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0719833374023438  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([97, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.073378086090088  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.073378086090088  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0735630989074707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0944695472717285  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([102, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0960440635681152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0960440635681152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.096238613128662  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.119584560394287  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1206812858581543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1206812858581543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1208128929138184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1375269889831543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1384658813476562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1384658813476562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.138570785522461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.152627944946289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([78, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1540751457214355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1540751457214355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.154223918914795  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1752009391784668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([67, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1764788627624512  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1764788627624512  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1766066551208496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1955199241638184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1964502334594727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1964502334594727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1965398788452148  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.210434913635254  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2111639976501465  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2111639976501465  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.211230754852295  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2220454216003418  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.223027229309082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.223027229309082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2231111526489258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2372941970825195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([464, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2484016418457031  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2484016418457031  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2492866516113281  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.406428337097168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 464, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3640079498291016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3648500442504883  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.365692138671875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3648076057434082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5650, 40])
input nodes number: 11021
output nodes number: 5650
edges number: 49537
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3649463653564453  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3649468421936035  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.024307727813720703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 2 input nodes size: 23739
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.021609783172607422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.021609783172607422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03332853317260742  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0333714485168457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.023707866668701172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.024708271026611328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.024708271026611328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.024708271026611328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([23739, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.024708271026611328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1119, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06831645965576172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06831645965576172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06938362121582031  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07792091369628906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1170, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07850313186645508  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07850313186645508  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1170, 128]), torch.Size([1, 1170, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07961893081665039  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09635591506958008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1170, 128])
m.shape torch.Size([1091, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09776639938354492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09776639938354492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09880685806274414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12212991714477539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([963, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12344646453857422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12344646453857422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12436485290527344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1516733169555664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([909, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15338134765625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15338134765625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15424823760986328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18591594696044922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([773, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18769407272338867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18769407272338867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1884312629699707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22013044357299805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([680, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2220315933227539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2220315933227539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 680, 128]), torch.Size([1, 680, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22268009185791016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25563716888427734  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 680, 128])
m.shape torch.Size([638, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25774669647216797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25774669647216797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 638, 128]), torch.Size([1, 638, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25835514068603516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.29306459426879883  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 638, 128])
m.shape torch.Size([545, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.29509925842285156  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.29509925842285156  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.29561901092529297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.33077096939086914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([5337, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3559598922729492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3559598922729492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 5337, 128]), torch.Size([1, 5337, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.36176109313964844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7238454818725586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 5337, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.684722900390625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6973352432250977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7099475860595703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6972365379333496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([13225, 256])
first layer input nodes number: 23739
first layer output nodes number: 13225
edges number: 87906
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7101263999938965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7227387428283691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7258920669555664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7258920669555664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([815, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7721719741821289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7721719741821289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 815, 256]), torch.Size([1, 815, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7737264633178711  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7861623764038086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 815, 256])
m.shape torch.Size([707, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7871131896972656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7871131896972656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 707, 256]), torch.Size([1, 707, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7884616851806641  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8104100227355957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 707, 256])
m.shape torch.Size([582, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8114662170410156  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8114662170410156  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8125762939453125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8379030227661133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([452, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8395447731018066  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8395447731018066  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8404068946838379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8666291236877441  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([383, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8686671257019043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8686671257019043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8693976402282715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8973078727722168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8987479209899902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8987479209899902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8993449211120605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9255385398864746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([289, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9271845817565918  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9271845817565918  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9277358055114746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9568943977355957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([236, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9584336280822754  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9584336280822754  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9588837623596191  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9845414161682129  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([219, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.986210823059082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.986210823059082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.986628532409668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.013361930847168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([188, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0149602890014648  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0149602890014648  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0153188705444336  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0407781600952148  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([166, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0423541069030762  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0423541069030762  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.042670726776123  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0673670768737793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0688939094543457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0688939094543457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0691380500793457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0898900032043457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([108, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0911173820495605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0911173820495605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0913233757019043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1102747917175293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([107, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1116118431091309  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1116118431091309  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1118159294128418  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1320204734802246  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1332740783691406  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1332740783691406  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.133453369140625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1524581909179688  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1536145210266113  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1536145210266113  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1537690162658691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.171226978302002  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([86, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1734228134155273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1734228134155273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1735868453979492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1932706832885742  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1941404342651367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1941404342651367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1942453384399414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2075681686401367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.208465576171875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.208465576171875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2085647583007812  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2218551635742188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2229013442993164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2229013442993164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2230100631713867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2383394241333008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2393145561218262  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2393145561218262  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2394118309020996  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2538084983825684  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.25435209274292  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.25435209274292  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2544054985046387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.262683391571045  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2634525299072266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2634525299072266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2635211944580078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2746448516845703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2755331993103027  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2755331993103027  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2756094932556152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2885031700134277  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([474, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2998547554016113  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2998547554016113  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3007588386535645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4624648094177246  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 474, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4224495887756348  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4233059883117676  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4241623878479004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4232630729675293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5747, 40])
input nodes number: 13225
output nodes number: 5747
edges number: 46213
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4234189987182617  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.42341947555542  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.026606082916259766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 3 input nodes size: 25398
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.023722171783447266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.023722171783447266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.035832881927490234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03587484359741211  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.024113178253173828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02494192123413086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02494192123413086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02494192123413086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([25398, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02494192123413086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1482, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06189584732055664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06189584732055664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1482, 128]), torch.Size([1, 1482, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0633091926574707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07474994659423828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1482, 128])
m.shape torch.Size([1366, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07560443878173828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07560443878173828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1366, 128]), torch.Size([1, 1366, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07690715789794922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09644794464111328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1366, 128])
m.shape torch.Size([1203, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09751749038696289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09751749038696289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09866476058959961  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12390470504760742  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([1037, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12551259994506836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12551259994506836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12650156021118164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15586614608764648  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([870, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15744590759277344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15744590759277344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15827560424804688  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18875598907470703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([759, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19051265716552734  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19051265716552734  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 759, 128]), torch.Size([1, 759, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1912364959716797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22236156463623047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 759, 128])
m.shape torch.Size([586, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22395563125610352  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22395563125610352  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22451448440551758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2531285285949707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([552, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25495481491088867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25495481491088867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2554812431335449  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.28681516647338867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([444, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.28845739364624023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.28845739364624023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 444, 128]), torch.Size([1, 444, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2888808250427246  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3159804344177246  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 444, 128])
m.shape torch.Size([4049, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3352999687194824  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3352999687194824  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 4049, 128]), torch.Size([1, 4049, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.33916139602661133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6157879829406738  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 4049, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5840554237365723  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5958313941955566  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.607607364654541  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5957393646240234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([12348, 256])
first layer input nodes number: 25398
first layer output nodes number: 12348
edges number: 73879
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6077985763549805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6195745468139648  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6225185394287109  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6225185394287109  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1056, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6596560478210449  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6596560478210449  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1056, 256]), torch.Size([1, 1056, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.663353443145752  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6801352500915527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1056, 256])
m.shape torch.Size([797, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6811542510986328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6811542510986328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 797, 256]), torch.Size([1, 797, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6826744079589844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7054767608642578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 797, 256])
m.shape torch.Size([661, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7066226005554199  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7066226005554199  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 661, 256]), torch.Size([1, 661, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.707883358001709  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7356200218200684  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 661, 256])
m.shape torch.Size([510, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7369503974914551  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7369503974914551  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 510, 256]), torch.Size([1, 510, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7379231452941895  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7664265632629395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 510, 256])
m.shape torch.Size([395, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7678384780883789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7678384780883789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7685918807983398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7960500717163086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([306, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7974381446838379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7974381446838379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7980217933654785  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8242058753967285  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([215, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8253607749938965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8253607749938965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8257708549499512  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8462748527526855  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([208, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8476691246032715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8476691246032715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8480658531188965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8706793785095215  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([165, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8719086647033691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8719086647033691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8722233772277832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8923649787902832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8936495780944824  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8936495780944824  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8939356803894043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9142489433288574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9153008460998535  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9153008460998535  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9155163764953613  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9323277473449707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([100, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9333734512329102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9333734512329102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9335641860961914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9497766494750977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([91, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9508185386657715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9508185386657715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9509921073913574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9669604301452637  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9678559303283691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9678559303283691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9679951667785645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9817795753479004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([58, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.982546329498291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.982546329498291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9826569557189941  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9943833351135254  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9948816299438477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9948816299438477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9949502944946289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0027093887329102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0034432411193848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0034432411193848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.003532886505127  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0142903327941895  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0150933265686035  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0150933265686035  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0151867866516113  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0270562171936035  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0277585983276367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0277585983276367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.027836799621582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.038315773010254  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0391035079956055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0391035079956055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0391855239868164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0507497787475586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0514559745788574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0514559745788574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0515265464782715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0619711875915527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.062443733215332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.062443733215332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0624895095825195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.069584846496582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0702033042907715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0702033042907715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.070258617401123  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0792193412780762  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0795841217041016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0795841217041016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0796165466308594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0850963592529297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([351, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0935144424438477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0935144424438477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0941839218139648  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2164382934570312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 351, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1853151321411133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1861457824707031  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.186976432800293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1861038208007812  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5572, 40])
input nodes number: 12348
output nodes number: 5572
edges number: 37207
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1862120628356934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1862125396728516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.026551246643066406  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 4 input nodes size: 18161
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02408742904663086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02408742904663086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03274726867675781  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0327906608581543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.020637989044189453  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.021326541900634766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.021326541900634766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.021326541900634766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([18161, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.021326541900634766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1397, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.050035953521728516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.050035953521728516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1397, 128]), torch.Size([1, 1397, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.05136823654174805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06242084503173828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1397, 128])
m.shape torch.Size([1461, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06314802169799805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06314802169799805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1461, 128]), torch.Size([1, 1461, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06454133987426758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08544111251831055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1461, 128])
m.shape torch.Size([1206, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08683204650878906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08683204650878906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1206, 128]), torch.Size([1, 1206, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.087982177734375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1135101318359375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1206, 128])
m.shape torch.Size([1059, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11510562896728516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11510562896728516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11611557006835938  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14591503143310547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([896, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14754629135131836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14754629135131836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14840078353881836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18004369735717773  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([718, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1816706657409668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1816706657409668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 718, 128]), torch.Size([1, 718, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18235540390014648  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21250486373901367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 718, 128])
m.shape torch.Size([625, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2142486572265625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2142486572265625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2148447036743164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2455306053161621  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([520, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.24807453155517578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.24807453155517578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.24857044219970703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2775239944458008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([434, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.27913856506347656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.27913856506347656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2795524597167969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3060417175292969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([2367, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3171215057373047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3171215057373047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 2367, 128]), torch.Size([1, 2367, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3196730613708496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.48303890228271484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 2367, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4592418670654297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.46942996978759766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4796180725097656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.46935033798217773  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([10683, 256])
first layer input nodes number: 18161
first layer output nodes number: 10683
edges number: 57072
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4797554016113281  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4899435043334961  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4924907684326172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4924907684326172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([969, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5276093482971191  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5276093482971191  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 969, 256]), torch.Size([1, 969, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5294575691223145  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.544243335723877  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 969, 256])
m.shape torch.Size([862, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5450339317321777  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5450339317321777  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5466780662536621  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5713400840759277  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([667, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5728917121887207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5728917121887207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 667, 256]), torch.Size([1, 667, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5741639137268066  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6023745536804199  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 667, 256])
m.shape torch.Size([519, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6037874221801758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6037874221801758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6047773361206055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6343545913696289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([448, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6360125541687012  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6360125541687012  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6368670463562012  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6679377555847168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([366, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.669621467590332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.669621467590332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6703195571899414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7012434005737305  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([318, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7030339241027832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7030339241027832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7036404609680176  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7340893745422363  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([274, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7358932495117188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7358932495117188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7364158630371094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7667446136474609  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([226, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7684383392333984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7684383392333984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7688694000244141  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7964572906494141  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([178, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7979526519775391  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7979526519775391  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7982921600341797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8223972320556641  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([127, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8235702514648438  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8235702514648438  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8238124847412109  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8427066802978516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8441543579101562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8441543579101562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8444137573242188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8664627075195312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.867607593536377  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.867607593536377  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8678021430969238  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8857007026672363  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8867206573486328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8867206573486328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8868789672851562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9025516510009766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9037070274353027  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9037070274353027  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9038558006286621  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9196257591247559  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9205665588378906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9205665588378906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9206924438476562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9349174499511719  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9356064796447754  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9356064796447754  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9356942176818848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9462227821350098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.946871280670166  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.946871280670166  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9469475746154785  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.956636905670166  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9572381973266602  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9572381973266602  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9573049545288086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9662504196166992  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9667553901672363  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9667553901672363  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9668087959289551  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9743390083312988  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9748373031616211  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9748373031616211  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9748868942260742  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9822263717651367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9827513694763184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9827513694763184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9828009605407715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9904875755310059  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9908609390258789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9908609390258789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9908952713012695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9964570999145508  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9968323707580566  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9968323707580566  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9968647956848145  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0023446083068848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([139, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0056686401367188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0056686401367188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0059337615966797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0525951385498047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 139, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0241732597351074  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0250368118286133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0259003639221191  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0249934196472168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5794, 40])
input nodes number: 10683
output nodes number: 5794
edges number: 35323
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0251493453979492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0251498222351074  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.022751331329345703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 5 input nodes size: 23255
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02067089080810547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02067089080810547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03238964080810547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03243303298950195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.023729801177978516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02447366714477539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02447366714477539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02447366714477539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([23255, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02447366714477539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1396, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.05729961395263672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.05729961395263672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1396, 128]), torch.Size([1, 1396, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.058630943298339844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06928157806396484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1396, 128])
m.shape torch.Size([1511, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07005691528320312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07005691528320312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1511, 128]), torch.Size([1, 1511, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07149791717529297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09311294555664062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1511, 128])
m.shape torch.Size([1323, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09453630447387695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09453630447387695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1323, 128]), torch.Size([1, 1323, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09579801559448242  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12389326095581055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1323, 128])
m.shape torch.Size([1042, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12555217742919922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12555217742919922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12654590606689453  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15577983856201172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([893, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15741205215454102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15741205215454102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1582636833190918  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18900775909423828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([732, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19067621231079102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19067621231079102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 732, 128]), torch.Size([1, 732, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1913743019104004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2218766212463379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 732, 128])
m.shape torch.Size([608, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2243046760559082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2243046760559082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2248845100402832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2548527717590332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([501, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25647401809692383  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25647401809692383  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25695180892944336  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.28418588638305664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([466, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2859468460083008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2859468460083008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2863912582397461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3148336410522461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([3008, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.32895469665527344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.32895469665527344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 3008, 128]), torch.Size([1, 3008, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.33182334899902344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5452327728271484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 3008, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5169186592102051  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5278668403625488  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5388150215148926  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5277810096740723  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([11480, 256])
first layer input nodes number: 23255
first layer output nodes number: 11480
edges number: 63950
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5389904975891113  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5499386787414551  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5530476570129395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5530476570129395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([979, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5885505676269531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5885505676269531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 979, 256]), torch.Size([1, 979, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5904178619384766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6062068939208984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 979, 256])
m.shape torch.Size([890, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6076059341430664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6076059341430664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 890, 256]), torch.Size([1, 890, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6093034744262695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6347665786743164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 890, 256])
m.shape torch.Size([716, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6359825134277344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6359825134277344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 716, 256]), torch.Size([1, 716, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6373481750488281  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6678047180175781  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 716, 256])
m.shape torch.Size([561, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6692790985107422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6692790985107422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.67034912109375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7016506195068359  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([452, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7032880783081055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7032880783081055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7041501998901367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.735560417175293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([368, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7372517585754395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7372517585754395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7379536628723145  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7690091133117676  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([286, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7705826759338379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7705826759338379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7711281776428223  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7993569374084473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([208, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8006834983825684  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8006834983825684  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8010802268981934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8236937522888184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([198, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8252081871032715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8252081871032715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8255858421325684  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8497557640075684  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([151, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8510184288024902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8510184288024902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8513064384460449  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8717551231384277  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.872859001159668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.872859001159668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8730840682983398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8906393051147461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([86, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8915190696716309  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8915190696716309  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8916831016540527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9056258201599121  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([89, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9066562652587891  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9066562652587891  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9068260192871094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9224433898925781  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9235830307006836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9235830307006836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9237565994262695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9409399032592773  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9419059753417969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9419059753417969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9420452117919922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9568042755126953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9574422836303711  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9574422836303711  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9575300216674805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9674444198608398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9680380821228027  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9680380821228027  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9681124687194824  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9770388603210449  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9779014587402344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9779014587402344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9780006408691406  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9905967712402344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9911866188049316  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9911866188049316  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9912533760070801  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0001988410949707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0007805824279785  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0007805824279785  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0008416175842285  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0094475746154785  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0097804069519043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0097804069519043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.009814739227295  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0148959159851074  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0153651237487793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0153651237487793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.015408992767334  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0222086906433105  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0226731300354004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0226731300354004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0227150917053223  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.029512882232666  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0300688743591309  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0300688743591309  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0301165580749512  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.038175106048584  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([226, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0435819625854492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0435819625854492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0440130233764648  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1198797225952148  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 226, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0909943580627441  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0918564796447754  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0927186012268066  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.091813087463379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5784, 40])
input nodes number: 11480
output nodes number: 5784
edges number: 35713
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0919408798217773  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0919413566589355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02597951889038086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 6 input nodes size: 25669
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.023728370666503906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.023728370666503906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03596830368041992  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03601217269897461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.024250030517578125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0251922607421875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0251922607421875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0251922607421875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([25669, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0251922607421875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1263, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06575965881347656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06575965881347656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1263, 128]), torch.Size([1, 1263, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06696414947509766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0766000747680664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1263, 128])
m.shape torch.Size([1306, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07742977142333984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07742977142333984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1306, 128]), torch.Size([1, 1306, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0786752700805664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09735774993896484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1306, 128])
m.shape torch.Size([1230, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09873580932617188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09873580932617188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1230, 128]), torch.Size([1, 1230, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.09990882873535156  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1257152557373047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1230, 128])
m.shape torch.Size([1077, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12727928161621094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12727928161621094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12830638885498047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15809249877929688  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([991, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1599416732788086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1599416732788086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1608867645263672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1950669288635254  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([780, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19682598114013672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19682598114013672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1975698471069336  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.23029041290283203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([700, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.23308467864990234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.23308467864990234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 700, 128]), torch.Size([1, 700, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.23375225067138672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.26797008514404297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 700, 128])
m.shape torch.Size([676, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2702150344848633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2702150344848633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2708597183227539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3077974319458008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([570, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3099212646484375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3099212646484375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.31046485900878906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.34532737731933594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([4456, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.36653995513916016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.36653995513916016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 4456, 128]), torch.Size([1, 4456, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3708009719848633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6786432266235352  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 4456, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6444907188415527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6569352149963379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.669379711151123  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6568379402160645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([13049, 256])
first layer input nodes number: 25669
first layer output nodes number: 13049
edges number: 81506
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6695733070373535  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6820178031921387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6851291656494141  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6851291656494141  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([857, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7294902801513672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7294902801513672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7311248779296875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.74444580078125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([751, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7450723648071289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7450723648071289  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 751, 256]), torch.Size([1, 751, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7465047836303711  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7689437866210938  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 751, 256])
m.shape torch.Size([599, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7699551582336426  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7699551582336426  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 599, 256]), torch.Size([1, 599, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7710976600646973  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7962327003479004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 599, 256])
m.shape torch.Size([475, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.797487735748291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.797487735748291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.798393726348877  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8246674537658691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([443, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8263435363769531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8263435363769531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8271884918212891  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8586635589599609  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([299, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8599658012390137  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8599658012390137  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8605360984802246  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8863463401794434  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([275, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8879117965698242  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8879117965698242  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8884363174438477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9158334732055664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([276, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9176936149597168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9176936149597168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.918220043182373  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9488177299499512  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([199, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9502758979797363  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9502758979797363  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.950655460357666  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.974947452545166  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([192, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9766030311584473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9766030311584473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9769692420959473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0029702186584473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([157, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0044469833374023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0044469833374023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.004746437072754  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0281038284301758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0294303894042969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0294303894042969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0296745300292969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0504264831542969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([120, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0518040657043457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0518040657043457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0520329475402832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0730900764465332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([89, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0742840766906738  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0742840766906738  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0744538307189941  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.091259479522705  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([96, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0925588607788086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0925588607788086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0927419662475586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1121511459350586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1132898330688477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1132898330688477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1134424209594727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1306848526000977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([62, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.131659984588623  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.131659984588623  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1317782402038574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1459689140319824  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1468615531921387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1468615531921387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1469664573669434  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1602892875671387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([64, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1614055633544922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1614055633544922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1615276336669922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1778850555419922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1789774894714355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1789774894714355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1790919303894043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.195228099822998  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([47, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.196119785308838  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.196119785308838  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.19620943069458  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2094769477844238  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2103204727172852  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2103204727172852  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2104005813598633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2228174209594727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2235069274902344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2235069274902344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2235698699951172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2337665557861328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2344732284545898  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2344732284545898  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2345342636108398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2448492050170898  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([412, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.25471830368042  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.25471830368042  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2555041313171387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.393989086151123  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 412, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3560757637023926  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3569464683532715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3578171730041504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3569025993347168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5843, 40])
input nodes number: 13049
output nodes number: 5843
edges number: 44896
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3570523262023926  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3570528030395508  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.027027130126953125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 7 input nodes size: 33415
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02425861358642578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02425861358642578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0401921272277832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04023599624633789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.027952194213867188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02904796600341797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02904796600341797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02904796600341797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([33415, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02904796600341797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1062, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07769775390625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07769775390625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07871055603027344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08681297302246094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1154, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08787870407104492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08787870407104492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1154, 128]), torch.Size([1, 1154, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08897924423217773  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10548734664916992  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1154, 128])
m.shape torch.Size([1102, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10651350021362305  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10651350021362305  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10756444931030273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.13068532943725586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1102, 128])
m.shape torch.Size([988, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.13204431533813477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.13204431533813477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.13298654556274414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.16035699844360352  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([942, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.16213178634643555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.16213178634643555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.16303014755249023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1957840919494629  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([813, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1976609230041504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1976609230041504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19843626022338867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.23250341415405273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([743, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.23459577560424805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.23459577560424805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 743, 128]), torch.Size([1, 743, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2353043556213379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2707986831665039  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 743, 128])
m.shape torch.Size([685, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2730574607849121  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2730574607849121  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2737107276916504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.31141233444213867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([563, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.31350183486938477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.31350183486938477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 563, 128]), torch.Size([1, 563, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3140387535095215  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3494853973388672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 563, 128])
m.shape torch.Size([6192, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.37874269485473633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.37874269485473633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 6192, 128]), torch.Size([1, 6192, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.38464784622192383  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8039135932922363  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 6192, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7624630928039551  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7760472297668457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7896313667297363  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7759408950805664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([14244, 256])
first layer input nodes number: 33415
first layer output nodes number: 14244
edges number: 97884
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7898826599121094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.803466796875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8075485229492188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8075485229492188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([733, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8557295799255371  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8557295799255371  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 733, 256]), torch.Size([1, 733, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8571276664733887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8683123588562012  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 733, 256])
m.shape torch.Size([684, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8693480491638184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8693480491638184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 684, 256]), torch.Size([1, 684, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8706526756286621  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8902220726013184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 684, 256])
m.shape torch.Size([564, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8913984298706055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8913984298706055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8924741744995117  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9178152084350586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([475, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9191074371337891  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9191074371337891  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.920013427734375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9466381072998047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([410, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9481558799743652  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9481558799743652  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9489378929138184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9774718284606934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([325, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9789552688598633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9789552688598633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9795751571655273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.007308006286621  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([299, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.009009838104248  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.009009838104248  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.009580135345459  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0408425331115723  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([267, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0434041023254395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0434041023254395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0439133644104004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0734734535217285  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([204, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0749835968017578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0749835968017578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0753726959228516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1002750396728516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([191, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1019163131713867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1019163131713867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.102280616760254  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1281461715698242  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1293597221374512  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1293597221374512  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1296114921569824  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.14924955368042  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([157, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1509346961975098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1509346961975098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1512341499328613  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1766877174377441  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([119, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.178025245666504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.178025245666504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1782522201538086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1991338729858398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([121, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2006487846374512  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2006487846374512  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2008795738220215  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2237277030944824  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([100, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2250542640686035  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2250542640686035  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2252449989318848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2454628944396973  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2465519905090332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2465519905090332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2466988563537598  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2632946968078613  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([80, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.264528751373291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.264528751373291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.264681339263916  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.282991886138916  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2839713096618652  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2839713096618652  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2840876579284668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2988638877868652  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2996826171875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2996826171875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.299774169921875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.312042236328125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3128809928894043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3128809928894043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3129687309265137  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3253397941589355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3262248039245605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3262248039245605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.32631254196167  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3392977714538574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.340226650238037  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.340226650238037  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3403143882751465  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3539137840270996  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3546218872070312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3546218872070312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3546867370605469  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3651924133300781  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.366152286529541  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.366152286529541  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.366234302520752  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3800950050354004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([563, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3935818672180176  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3935818672180176  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.394655704498291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5847992897033691  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 563, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5428171157836914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5436854362487793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5445537567138672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5436415672302246  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5825, 40])
input nodes number: 14244
output nodes number: 5825
edges number: 49134
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5437893867492676  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5437898635864258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.031142234802246094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 8 input nodes size: 34643
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.027949810028076172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.027949810028076172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04446887969970703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04451179504394531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.028534412384033203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.029480457305908203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.029480457305908203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.029480457305908203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([34643, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.029480457305908203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1430, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07451534271240234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07451534271240234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1430, 128]), torch.Size([1, 1430, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07587909698486328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08707380294799805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1430, 128])
m.shape torch.Size([1661, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08819055557250977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08819055557250977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08977460861206055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11353540420532227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
m.shape torch.Size([1414, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11495780944824219  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11495780944824219  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1414, 128]), torch.Size([1, 1414, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11630630493164062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1465587615966797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1414, 128])
m.shape torch.Size([1239, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14824771881103516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14824771881103516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1239, 128]), torch.Size([1, 1239, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1494293212890625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18398761749267578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1239, 128])
m.shape torch.Size([1051, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18590259552001953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18590259552001953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1869049072265625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2238297462463379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([863, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2257976531982422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2257976531982422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22662067413330078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.26276111602783203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([787, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.26497650146484375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.26497650146484375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.26572704315185547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3033566474914551  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([678, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.30556774139404297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.30556774139404297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3062143325805664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.34375667572021484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([620, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.34609413146972656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.34609413146972656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.34668540954589844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.38574981689453125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([4954, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4090766906738281  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4090766906738281  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 4954, 128]), torch.Size([1, 4954, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4138011932373047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7611713409423828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 4954, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7217793464660645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7357954978942871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7498116493225098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7356858253479004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([14697, 256])
first layer input nodes number: 34643
first layer output nodes number: 14697
edges number: 90436
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7500720024108887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7640881538391113  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7675924301147461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7675924301147461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([988, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8042001724243164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8042001724243164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 988, 256]), torch.Size([1, 988, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8060846328735352  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8211603164672852  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 988, 256])
m.shape torch.Size([896, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8219776153564453  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8219776153564453  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 896, 256]), torch.Size([1, 896, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8236865997314453  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8493213653564453  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 896, 256])
m.shape torch.Size([667, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8507513999938965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8507513999938965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 667, 256]), torch.Size([1, 667, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8520236015319824  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.880012035369873  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 667, 256])
m.shape torch.Size([557, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8816618919372559  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8816618919372559  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8827242851257324  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9135336875915527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([424, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9150404930114746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9150404930114746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9158492088317871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9456357955932617  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([317, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9470596313476562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9470596313476562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9476642608642578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9739799499511719  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([235, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9752588272094727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9752588272094727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9757070541381836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9981184005737305  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([220, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9995861053466797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9995861053466797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0000057220458984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0239238739013672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([200, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.025444507598877  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.025444507598877  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0258259773254395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0502400398254395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0515871047973633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0515871047973633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0518922805786133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0735597610473633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0746550559997559  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0746550559997559  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0748801231384277  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.092435359954834  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([110, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0935916900634766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0935916900634766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.093801498413086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1116352081298828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.112804889678955  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.112804889678955  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.112999439239502  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1308979988098145  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1319599151611328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1319599151611328  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1321182250976562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1477909088134766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1486492156982422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1486492156982422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.148773193359375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1619148254394531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1627602577209473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1627602577209473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1628727912902832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1755890846252441  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.176447868347168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.176447868347168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1765546798706055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1893720626831055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.190218448638916  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.190218448638916  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1903176307678223  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.202913761138916  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.203521728515625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.203521728515625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2035903930664062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2127914428710938  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.213334083557129  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.213334083557129  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2133913040161133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2214593887329102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2221980094909668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2221980094909668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2222704887390137  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2329974174499512  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.233342170715332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.233342170715332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2333765029907227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2386980056762695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2392115592956543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2392115592956543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2392573356628418  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2466731071472168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.24708890914917  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.24708890914917  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2471251487731934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2532496452331543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([247, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2591667175292969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2591667175292969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2596378326416016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3425540924072266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 247, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3124957084655762  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3133482933044434  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3142008781433105  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.313305377960205  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5721, 40])
input nodes number: 14697
output nodes number: 5721
edges number: 36410
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3134422302246094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3134427070617676  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03133440017700195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 9 input nodes size: 30699
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0285186767578125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0285186767578125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.043157100677490234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04320049285888672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.026638507843017578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02754068374633789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02754068374633789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02754068374633789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([30699, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02754068374633789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1634, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0705113410949707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0705113410949707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1634, 128]), torch.Size([1, 1634, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07206964492797852  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08453607559204102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1634, 128])
m.shape torch.Size([1616, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08553314208984375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08553314208984375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1616, 128]), torch.Size([1, 1616, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.08707427978515625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11019134521484375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1616, 128])
m.shape torch.Size([1501, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11182403564453125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11182403564453125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1501, 128]), torch.Size([1, 1501, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11325550079345703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14474773406982422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1501, 128])
m.shape torch.Size([1251, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14650392532348633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14650392532348633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1251, 128]), torch.Size([1, 1251, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14769697189331055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1827378273010254  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1251, 128])
m.shape torch.Size([1159, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1849045753479004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1849045753479004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1159, 128]), torch.Size([1, 1159, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18600988388061523  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22581052780151367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1159, 128])
m.shape torch.Size([959, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22800159454345703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22800159454345703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22891616821289062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.26824283599853516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([768, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.27034902572631836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.27034902572631836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 768, 128]), torch.Size([1, 768, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.27108144760131836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.30937719345092773  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 768, 128])
m.shape torch.Size([711, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3117232322692871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3117232322692871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 711, 128]), torch.Size([1, 711, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.31240129470825195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3516383171081543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 711, 128])
m.shape torch.Size([541, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3536210060119629  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3536210060119629  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.35413694381713867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.38855981826782227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([4282, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4087200164794922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4087200164794922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 4282, 128]), torch.Size([1, 4282, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.41280364990234375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7027416229248047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 4282, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.666689395904541  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.680443286895752  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6941971778869629  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.680335521697998  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([14422, 256])
first layer input nodes number: 30699
first layer output nodes number: 14422
edges number: 84675
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6944279670715332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7081818580627441  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7122654914855957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7122654914855957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1075, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.749000072479248  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.749000072479248  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1075, 256]), torch.Size([1, 1075, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.751309871673584  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7682318687438965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1075, 256])
m.shape torch.Size([834, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7687664031982422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7687664031982422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7703571319580078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7947320938110352  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 834, 256])
m.shape torch.Size([679, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7965478897094727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7965478897094727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 679, 256]), torch.Size([1, 679, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.7978429794311523  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8263349533081055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 679, 256])
m.shape torch.Size([510, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8279190063476562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8279190063476562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 510, 256]), torch.Size([1, 510, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8288917541503906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8572769165039062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 510, 256])
m.shape torch.Size([496, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8591742515563965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8591742515563965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8601202964782715  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.894315242767334  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([359, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8959126472473145  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8959126472473145  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.8965973854064941  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9273018836975098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([252, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9286551475524902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9286551475524902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.929135799407959  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9531683921813965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([236, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9547429084777832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9547429084777832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.955193042755127  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9808506965637207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([181, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9821915626525879  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.9821915626525879  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.982536792755127  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.004631519317627  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([140, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0058846473693848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0058846473693848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0061516761779785  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0251107215881348  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([100, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0261406898498535  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0261406898498535  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0263314247131348  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0412087440490723  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0423593521118164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0423593521118164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0425653457641602  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.060074806213379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0612215995788574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0612215995788574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0614123344421387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0789599418640137  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0800280570983887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0800280570983887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0801825523376465  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.09547758102417  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([57, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0962224006652832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0962224006652832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0963311195373535  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1078553199768066  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1086468696594238  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1086468696594238  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1087517738342285  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1206059455871582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1212725639343262  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1212725639343262  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.12135648727417  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.13142728805542  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.132181167602539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.132181167602539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1322689056396484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.143411636352539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1440801620483398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1440801620483398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1441545486450195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1541223526000977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1546621322631836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1546621322631836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.154719352722168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1627874374389648  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.163102149963379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.163102149963379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1631345748901367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.167933464050293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1682982444763184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1682982444763184  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.168332576751709  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1736540794372559  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.174079418182373  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.174079418182373  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1741175651550293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1802973747253418  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1807169914245605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1807169914245605  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.180753231048584  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.186877727508545  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1936116218566895  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1936116218566895  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1941475868225098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2899212837219238  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2597522735595703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2606134414672852  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.261474609375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2605700492858887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5777, 40])
input nodes number: 14422
output nodes number: 5777
edges number: 36311
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2607297897338867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.260730266571045  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.02933979034423828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 10 input nodes size: 52920
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.026647090911865234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.026647090911865234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.05188131332397461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.05192279815673828  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03724098205566406  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.038451194763183594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.038451194763183594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.038451194763183594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([52920, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.038451194763183594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1703, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10322237014770508  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10322237014770508  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1703, 128]), torch.Size([1, 1703, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.10484647750854492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11783933639526367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1703, 128])
m.shape torch.Size([1882, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11979484558105469  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.11979484558105469  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1882, 128]), torch.Size([1, 1882, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12158966064453125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15041160583496094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1882, 128])
m.shape torch.Size([1530, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.151702880859375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.151702880859375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1530, 128]), torch.Size([1, 1530, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15316200256347656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18526268005371094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1530, 128])
m.shape torch.Size([1330, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18726158142089844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18726158142089844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1330, 128]), torch.Size([1, 1330, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18852996826171875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2253131866455078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1330, 128])
m.shape torch.Size([1145, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22740888595581055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22740888595581055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1145, 128]), torch.Size([1, 1145, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2285008430480957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.26781129837036133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1145, 128])
m.shape torch.Size([945, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.26996898651123047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.26996898651123047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2708702087402344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3106822967529297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([818, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.31296205520629883  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.31296205520629883  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.31374216079711914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.35376977920532227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([766, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.35630178451538086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.35630178451538086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 766, 128]), torch.Size([1, 766, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.35703229904174805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.39936017990112305  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 766, 128])
m.shape torch.Size([663, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4018402099609375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4018402099609375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.40247249603271484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4441695213317871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([8597, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.48486900329589844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.48486900329589844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 8597, 128]), torch.Size([1, 8597, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.49306774139404297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0751781463623047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 8597, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.017695426940918  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0361766815185547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0546579360961914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0360321998596191  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([19379, 256])
first layer input nodes number: 52920
first layer output nodes number: 19379
edges number: 130563
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0550541877746582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.073535442352295  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0781559944152832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.0781559944152832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1114, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1099624633789062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1099624633789062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1114, 256]), torch.Size([1, 1114, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1121373176574707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1294355392456055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1114, 256])
m.shape torch.Size([1042, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1303763389587402  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1303763389587402  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1042, 256]), torch.Size([1, 1042, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1323962211608887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1643152236938477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1042, 256])
m.shape torch.Size([688, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1654772758483887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1654772758483887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.1667895317077637  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.200242519378662  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([516, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2015705108642578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2015705108642578  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.202554702758789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2310962677001953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([380, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2324304580688477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2324304580688477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2331552505493164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2592477798461914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([285, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2605290412902832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2605290412902832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2610726356506348  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2867426872253418  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([241, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2880926132202148  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2880926132202148  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2885522842407227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3115358352661133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([157, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3125133514404297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3125133514404297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3128128051757812  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3298816680908203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([160, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3311161994934082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3311161994934082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3314213752746582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3509526252746582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([121, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3519630432128906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3519630432128906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.352193832397461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3685798645019531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([120, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3697333335876465  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3697333335876465  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.369962215423584  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.387814998626709  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3885540962219238  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3885540962219238  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.388695240020752  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4006924629211426  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4013590812683105  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4013590812683105  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4014716148376465  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4118247032165527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4124412536621094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4124412536621094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.41253662109375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4219779968261719  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4226369857788086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4226369857788086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4227304458618164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4326372146606445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4331903457641602  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4331903457641602  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4332647323608398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4416704177856445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4422545433044434  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4422545433044434  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4423270225524902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4510245323181152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4514904022216797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4514904022216797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4515457153320312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4585704803466797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.459200382232666  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.459200382232666  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4592690467834473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4684700965881348  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4691858291625977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4691858291625977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4692602157592773  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4797487258911133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.480135440826416  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.480135440826416  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.480175495147705  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4861035346984863  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.486485481262207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.486485481262207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4865217208862305  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4921388626098633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.492408275604248  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.492408275604248  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4924330711364746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4964499473571777  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4966683387756348  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4966683387756348  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.496687412261963  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.499910831451416  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([246, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.505812644958496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.505812644958496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.506281852722168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.588862419128418  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 246, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5635228157043457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.56434965133667  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5651764869689941  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5643081665039062  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5546, 40])
input nodes number: 19379
output nodes number: 5546
edges number: 31743
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5644598007202148  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.564460277557373  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04075431823730469  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 11 input nodes size: 49005
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03720664978027344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03720664978027344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06057405471801758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06061553955078125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0353398323059082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0368800163269043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0368800163269043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0368800163269043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([49005, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0368800163269043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1342, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1164865493774414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1164865493774414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1342, 128]), torch.Size([1, 1342, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1177663803100586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12820863723754883  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1342, 128])
m.shape torch.Size([1368, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12887334823608398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.12887334823608398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1368, 128]), torch.Size([1, 1368, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.13017797470092773  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14974737167358398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1368, 128])
m.shape torch.Size([1194, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15168142318725586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15168142318725586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1194, 128]), torch.Size([1, 1194, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15282011032104492  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17787885665893555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1194, 128])
m.shape torch.Size([1109, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17942476272583008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17942476272583008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1804823875427246  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21180963516235352  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([1076, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21384620666503906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21384620666503906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2148723602294922  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25229835510253906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([930, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2548980712890625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2548980712890625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2557849884033203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2939887046813965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([915, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2965993881225586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2965993881225586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 915, 128]), torch.Size([1, 915, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2974720001220703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.34203481674194336  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 915, 128])
m.shape torch.Size([833, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3447761535644531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3447761535644531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.34557056427001953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3923015594482422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([788, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.39528608322143555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.39528608322143555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.39603757858276367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.44448041915893555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([11818, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5004572868347168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5004572868347168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 11818, 128]), torch.Size([1, 11818, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5117278099060059  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3119349479675293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 11818, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2391252517700195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2595081329345703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.279891014099121  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.2593488693237305  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([21373, 256])
first layer input nodes number: 49005
first layer output nodes number: 21373
edges number: 161397
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.280508041381836  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3008909225463867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3059868812561035  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3059868812561035  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([893, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3506031036376953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3506031036376953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 893, 256]), torch.Size([1, 893, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3523063659667969  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3659324645996094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 893, 256])
m.shape torch.Size([701, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3665614128112793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3665614128112793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3678984642028809  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.389967441558838  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([543, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3910365104675293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3910365104675293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.3920722007751465  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4148573875427246  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([410, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4159159660339355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4159159660339355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4166979789733887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4393763542175293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([363, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.440730094909668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.440730094909668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.441422462463379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4673223495483398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([310, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.468764305114746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.468764305114746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.469355583190918  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4955720901489258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([244, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4969182014465332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4969182014465332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.4973835945129395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.520653247833252  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([208, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.522019863128662  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.522019863128662  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.522416591644287  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.545030117034912  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([169, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5462937355041504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5462937355041504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5466160774230957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5672459602355957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([151, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5685362815856934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5685362815856934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.568824291229248  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5892729759216309  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([153, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5907468795776367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.5907468795776367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.591038703918457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6138010025024414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([110, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6149239540100098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6149239540100098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6151337623596191  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.632967472076416  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([82, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.63397216796875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.63397216796875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6341285705566406  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6485176086425781  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6494216918945312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6494216918945312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6495609283447266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6633453369140625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6642861366271973  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6642861366271973  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6644196510314941  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.678572177886963  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6796822547912598  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6796822547912598  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6798138618469238  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.694685459136963  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6956491470336914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6956491470336914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6957693099975586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.710188865661621  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7110977172851562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7110977172851562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7112045288085938  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7247695922851562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7256293296813965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7256293296813965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.725724697113037  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7385039329528809  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7392830848693848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7392830848693848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7393651008605957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.750929355621338  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7517566680908203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7517566680908203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7518386840820312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.76397705078125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.764739990234375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.764739990234375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7648124694824219  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7760467529296875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.776585578918457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.776585578918457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7766351699829102  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7846689224243164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7856545448303223  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7856545448303223  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7857365608215332  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7995972633361816  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([606, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.814117431640625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.814117431640625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8152732849121094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0187034606933594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 606, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9800705909729004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9808931350708008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9817156791687012  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.980851650238037  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5517, 40])
input nodes number: 21373
output nodes number: 5517
edges number: 45295
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9810481071472168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.981048583984375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03965902328491211  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 12 input nodes size: 60312
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.035335540771484375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.035335540771484375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06409454345703125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.06413698196411133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.040728092193603516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0430598258972168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0430598258972168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0430598258972168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([60312, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0430598258972168  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1054, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.16391706466674805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.16391706466674805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.16492223739624023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17344427108764648  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([1149, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17403745651245117  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17403745651245117  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17513322830200195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19160890579223633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1138, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1926889419555664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1926889419555664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19377422332763672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21851634979248047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1079, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22003173828125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22003173828125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.22106075286865234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.25177574157714844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1090, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2538599967956543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2538599967956543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2548995018005371  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2935471534729004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1014, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2959284782409668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2959284782409668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1014, 128]), torch.Size([1, 1014, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.29689550399780273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.33939123153686523  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1014, 128])
m.shape torch.Size([1023, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.34232234954833984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.34232234954833984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1023, 128]), torch.Size([1, 1023, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.34329795837402344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3926558494567871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1023, 128])
m.shape torch.Size([963, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3958415985107422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3958415985107422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 963, 128]), torch.Size([1, 963, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3967599868774414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4495849609375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 963, 128])
m.shape torch.Size([985, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4533529281616211  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4533529281616211  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 985, 128]), torch.Size([1, 985, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.45429229736328125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5162577629089355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 985, 128])
m.shape torch.Size([19989, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6114912033081055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6114912033081055  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 19989, 128]), torch.Size([1, 19989, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.63055419921875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9887094497680664  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 19989, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8747987747192383  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9029169082641602  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.931035041809082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9026970863342285  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([29484, 256])
first layer input nodes number: 60312
first layer output nodes number: 29484
edges number: 246236
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9314866065979004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9596047401428223  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9666342735290527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9666342735290527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([590, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0314722061157227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0314722061157227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.032597541809082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0435171127319336  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([531, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0440540313720703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0440540313720703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 531, 256]), torch.Size([1, 531, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0450668334960938  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0654430389404297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 531, 256])
m.shape torch.Size([429, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.066270351409912  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.066270351409912  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0670886039733887  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0853018760681152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([331, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0862274169921875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0862274169921875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0868587493896484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.107436180114746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([307, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.108595848083496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.108595848083496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1091814041137695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1326446533203125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([223, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1336379051208496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1336379051208496  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.134063243865967  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.152352809906006  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([207, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1535329818725586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1535329818725586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.153927803039551  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.17366886138916  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([184, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1748862266540527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1748862266540527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1752371788024902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1952414512634277  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([152, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1964869499206543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1964869499206543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.196776866912842  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.215331554412842  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.2166285514831543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.2166285514831543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.216914653778076  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.2372279167175293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.238502025604248  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.238502025604248  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.238757610321045  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.258693218231201  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([129, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.2600536346435547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.2600536346435547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.2602996826171875  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.2812137603759766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.282477855682373  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.282477855682373  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.2826895713806152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3021674156188965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3033533096313477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3033533096313477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3035364151000977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3216638565063477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.32291316986084  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.32291316986084  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3230905532836914  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.341893196105957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([92, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.34321928024292  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.34321928024292  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3433947563171387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3632235527038574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.364345073699951  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.364345073699951  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3644862174987793  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3814234733581543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([82, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3827719688415527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3827719688415527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3829283714294434  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4027915000915527  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([76, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4048500061035156  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4048500061035156  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4049949645996094  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.424419403076172  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.425654411315918  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.425654411315918  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.425784111022949  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4440717697143555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([67, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.445359230041504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.445359230041504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4454870223999023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.464400291442871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([53, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4655089378356934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4655089378356934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4656100273132324  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.481278896331787  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4821791648864746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4821791648864746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4822611808776855  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4955477714538574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4966225624084473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4966225624084473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4967141151428223  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.5121865272521973  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([1391, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.5455641746520996  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.5455641746520996  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1391, 256]), torch.Size([1, 1391, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.5488829612731934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 3.0363574028015137  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1391, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.9764866828918457  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.9773306846618652  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.9781746864318848  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.977288246154785  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5661, 40])
input nodes number: 29484
output nodes number: 5661
edges number: 66628
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.977571964263916  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.977572441101074  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.047083377838134766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 13 input nodes size: 65894
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.040749549865722656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.040749549865722656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07217025756835938  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07221221923828125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0434107780456543  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.045320987701416016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.045320987701416016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.045320987701416016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([65894, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.045320987701416016  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([1349, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14826393127441406  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.14826393127441406  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1349, 128]), torch.Size([1, 1349, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1495504379272461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.15984249114990234  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1349, 128])
m.shape torch.Size([1532, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1606602668762207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1606602668762207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1532, 128]), torch.Size([1, 1532, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.16212129592895508  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1840672492980957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1532, 128])
m.shape torch.Size([1394, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18533086776733398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18533086776733398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1394, 128]), torch.Size([1, 1394, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.1866602897644043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21628522872924805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1394, 128])
m.shape torch.Size([1255, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21801424026489258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21801424026489258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1255, 128]), torch.Size([1, 1255, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21921110153198242  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2543015480041504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1255, 128])
m.shape torch.Size([1226, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2566261291503906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2566261291503906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1226, 128]), torch.Size([1, 1226, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2577953338623047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.30071067810058594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1226, 128])
m.shape torch.Size([1091, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.30324745178222656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.30324745178222656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3042879104614258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.35034942626953125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1027, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3532571792602539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3532571792602539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3542366027832031  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.40320777893066406  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([1003, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.40654420852661133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.40654420852661133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1003, 128]), torch.Size([1, 1003, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4075007438659668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.46268701553344727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 1003, 128])
m.shape torch.Size([879, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.46598100662231445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.46598100662231445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.46681928634643555  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5223903656005859  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([15975, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5981459617614746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.5981459617614746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 15975, 128]), torch.Size([1, 15975, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.6133809089660645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.71144437789917  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 15975, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6163311004638672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6418237686157227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6673164367675781  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6416244506835938  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([26731, 256])
first layer input nodes number: 65894
first layer output nodes number: 26731
edges number: 209165
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6678094863891602  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.6933021545410156  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.700087070465088  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.700087070465088  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([841, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7463951110839844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7463951110839844  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7479991912841797  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7608318328857422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 841, 256])
m.shape torch.Size([746, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.76157808303833  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.76157808303833  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 746, 256]), torch.Size([1, 746, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.7630009651184082  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.784839153289795  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 746, 256])
m.shape torch.Size([543, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.785693645477295  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.785693645477295  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.786729335784912  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8106465339660645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([434, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8117976188659668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8117976188659668  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8126254081726074  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8375053405761719  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([381, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8389225006103516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8389225006103516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8396492004394531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8661823272705078  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([279, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8674283027648926  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8674283027648926  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8679604530334473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.892096996307373  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([228, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8933649063110352  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8933649063110352  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.8937997817993164  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.915543556213379  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([203, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9168872833251953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9168872833251953  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9172744750976562  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9393444061279297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([166, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9409713745117188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9409713745117188  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9412879943847656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9615516662597656  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([148, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9628162384033203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9628162384033203  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9630985260009766  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9831409454345703  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([137, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9844484329223633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9844484329223633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9847097396850586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.005091667175293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0063223838806152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0063223838806152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.006547451019287  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0256781578063965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0267152786254883  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0267152786254883  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.026890754699707  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.043034553527832  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0439977645874023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0439977645874023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0441465377807617  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.05887508392334  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([81, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0599684715270996  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0599684715270996  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0601229667663574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0764994621276855  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([72, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0775294303894043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0775294303894043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.077666759490967  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0931849479675293  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0938191413879395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0938191413879395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0939011573791504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.103743076324463  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1047921180725098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1047921180725098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.104912281036377  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1201729774475098  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1209897994995117  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1209897994995117  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1210813522338867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1333494186401367  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.134369373321533  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.134369373321533  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.134472370147705  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1489949226379395  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.149831771850586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.149831771850586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1499156951904297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1623363494873047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.162971019744873  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.162971019744873  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.163032054901123  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.172492504119873  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1732139587402344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1732139587402344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.17327880859375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1837844848632812  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.184236526489258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.184236526489258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.184276580810547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.1910457611083984  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([688, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.207557201385498  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.207557201385498  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.208869457244873  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4403300285339355  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 688, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.3999462127685547  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4007768630981445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4016075134277344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4007349014282227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([5574, 40])
input nodes number: 26731
output nodes number: 5574
edges number: 47020
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.4009628295898438  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.400963306427002  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.0487208366394043  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

pseudo mini batch 14 input nodes size: 56268
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04339742660522461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04339742660522461  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07022809982299805  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.07027196884155273  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.03880929946899414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04134798049926758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04134798049926758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04134798049926758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([56268, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.04134798049926758  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([911, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.16933059692382812  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.16933059692382812  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17019939422607422  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17883825302124023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([909, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17927074432373047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.17927074432373047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.18013763427734375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19314098358154297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([916, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19402360916137695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19402360916137695  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.19489717483520508  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21411561965942383  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([929, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21545076370239258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21545076370239258  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.21633672714233398  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.24202966690063477  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([917, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2437729835510254  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2437729835510254  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.24464750289916992  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.27613019943237305  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([896, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2782564163208008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2782564163208008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.2791109085083008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3165864944458008  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([894, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.31914329528808594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.31914329528808594  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3199958801269531  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3633995056152344  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([868, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3662843704223633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3662843704223633  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.3671121597290039  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4152688980102539  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([881, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.41863584518432617  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.41863584518432617  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 881, 128]), torch.Size([1, 881, 128])
----------------------------------------3
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4194760322570801  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 0.4738750457763672  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 881, 128])
m.shape torch.Size([22075, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 0.5789237022399902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 0.5789237022399902  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 22075, 128]), torch.Size([1, 22075, 128])
----------------------------------------3
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 0.5999760627746582  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.106893539428711  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 22075, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 1.9857258796691895  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.0145230293273926  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.0433201789855957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.0142979621887207  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

torch.Size([30196, 256])
first layer input nodes number: 56268
first layer output nodes number: 30196
edges number: 261035
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.0437417030334473  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.0725388526916504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.0803074836730957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.0803074836730957  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

m.shape torch.Size([536, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.1575098037719727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.1575098037719727  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 536, 256]), torch.Size([1, 536, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.15853214263916  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.167935371398926  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 536, 256])
m.shape torch.Size([421, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.168233871459961  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.168233871459961  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.169036865234375  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.181081771850586  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([333, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.181640625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.181640625  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.1822757720947266  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.1979079246520996  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([290, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.198777198791504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.198777198791504  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.1993303298950195  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2168169021606445  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([235, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.21766996383667  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.21766996383667  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.218118190765381  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2342543601989746  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([204, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2352070808410645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2352070808410645  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.235596179962158  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2523274421691895  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([175, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2538809776306152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2538809776306152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2542147636413574  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.270904064178467  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([158, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2719521522521973  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2719521522521973  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2722535133361816  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.289431095123291  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([158, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.290647506713867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.290647506713867  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.2909488677978516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.3102359771728516  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([147, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.3114981651306152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.3114981651306152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.3117785453796387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.3316855430603027  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.332973003387451  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.332973003387451  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.333230495452881  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.3533148765563965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.35475492477417  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.35475492477417  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.3550143241882324  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.377063274383545  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([126, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.3785080909729004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.3785080909729004  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.3787484169006348  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4008584022521973  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([116, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.402299404144287  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.402299404144287  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4025206565856934  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.424424648284912  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([113, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.425943374633789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.425943374633789  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.426158905029297  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.449005126953125  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([95, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4513015747070312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4513015747070312  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4514827728271484  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4719581604003906  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([99, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4734854698181152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4734854698181152  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4736742973327637  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.496333599090576  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([99, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4979519844055176  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.4979519844055176  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.498140811920166  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.5221219062805176  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([99, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.5238356590270996  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.5238356590270996  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.524024486541748  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.5493273735046387  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([92, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.55100154876709  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.55100154876709  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.5511770248413086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.5759191513061523  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([83, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.5776681900024414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.5776681900024414  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.577826499938965  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.6012563705444336  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.6025304794311523  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.6025304794311523  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.6026391983032227  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.619490623474121  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([77, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.621138572692871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.621138572692871  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.6212854385375977  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.645077705383301  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([74, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.6467113494873047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.6467113494873047  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.6365966796875 GB
    Memory Allocated: 2.646852493286133  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6561279296875 GB
    Memory Allocated: 2.670705795288086  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([1796, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.6580810546875 GB
    Memory Allocated: 2.713789939880371  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6580810546875 GB
    Memory Allocated: 2.713789939880371  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

 h.shape torch.Size([1, 1796, 256]), torch.Size([1, 1796, 256])
----------------------------------------3
 Nvidia-smi: 5.6580810546875 GB
    Memory Allocated: 2.7172155380249023  GigaBytes
Max Memory Allocated: 3.1008191108703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6580810546875 GB
    Memory Allocated: 3.3387961387634277  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1796, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6580810546875 GB
    Memory Allocated: 3.266237735748291  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6580810546875 GB
    Memory Allocated: 3.2671103477478027  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6600341796875 GB
    Memory Allocated: 3.2679829597473145  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6600341796875 GB
    Memory Allocated: 3.267066478729248  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5854, 40])
input nodes number: 30196
output nodes number: 5854
edges number: 79541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6600341796875 GB
    Memory Allocated: 3.2673773765563965  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6600341796875 GB
    Memory Allocated: 3.2673778533935547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.045682430267333984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 15 input nodes size: 54196
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.038851261138916016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.038851261138916016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06469392776489258  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06473541259765625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.037860870361328125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.039882659912109375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.039882659912109375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.039882659912109375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([54196, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.039882659912109375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1076, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1445474624633789  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1445474624633789  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14557361602783203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15378284454345703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([1176, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1545724868774414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1545724868774414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1176, 128]), torch.Size([1, 1176, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15569400787353516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17321109771728516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1176, 128])
m.shape torch.Size([1084, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1745758056640625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1745758056640625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17560958862304688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19835281372070312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([979, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19970321655273438  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19970321655273438  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2006368637084961  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22831344604492188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([965, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2301473617553711  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2301473617553711  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23106765747070312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26470327377319336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([866, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2667207717895508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2667207717895508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2675466537475586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30321788787841797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([892, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3058185577392578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3058185577392578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 892, 128]), torch.Size([1, 892, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3066692352294922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3500194549560547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 892, 128])
m.shape torch.Size([779, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3525657653808594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3525657653808594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 779, 128]), torch.Size([1, 779, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.35330867767333984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3958702087402344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 779, 128])
m.shape torch.Size([773, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3988161087036133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3988161087036133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3995532989501953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4473247528076172  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([17300, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5294489860534668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5294489860534668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 17300, 128]), torch.Size([1, 17300, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5459475517272949  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7173457145690918  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 17300, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6193609237670898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6440515518188477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6687421798706055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6438584327697754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([25890, 256])
first layer input nodes number: 54196
first layer output nodes number: 25890
edges number: 213050
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6691479682922363  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6938385963439941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7003979682922363  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7003979682922363  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([704, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7572517395019531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7572517395019531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7585945129394531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7703781127929688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([588, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.770841121673584  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.770841121673584  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7719626426696777  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.790839672088623  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([492, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7917604446411133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7917604446411133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.792698860168457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8147516250610352  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([379, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8160161972045898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8160161972045898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8167390823364258  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8411636352539062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([325, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8423643112182617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8423643112182617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8429841995239258  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8665838241577148  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([242, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8676695823669434  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8676695823669434  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.868131160736084  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8879790306091309  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([209, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8894338607788086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8894338607788086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8898324966430664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.909764289855957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([142, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.910801887512207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.910801887512207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9110727310180664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9265108108520508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([155, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9277162551879883  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9277162551879883  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9280118942260742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9469327926635742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([139, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9481210708618164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9481210708618164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9483861923217773  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.967209815979004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.968367099761963  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.968367099761963  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.968599796295166  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9867501258850098  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.987983226776123  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.987983226776123  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.988206386566162  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0071749687194824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0082383155822754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0082383155822754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0084176063537598  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0249123573303223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([69, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0257515907287598  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0257515907287598  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.025883197784424  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.038912296295166  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.040433406829834  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.040433406829834  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0405726432800293  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0553317070007324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.05635404586792  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.05635404586792  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0564894676208496  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0717921257019043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0729498863220215  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0729498863220215  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0730929374694824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.090259075164795  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([67, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0913467407226562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0913467407226562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0914745330810547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1077041625976562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([67, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1088638305664062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1088638305664062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1089916229248047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1261157989501953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1271095275878906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1271095275878906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1272144317626953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1420059204101562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([57, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.143104076385498  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.143104076385498  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1432127952575684  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1593031883239746  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.160137176513672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.160137176513672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.16021728515625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1726341247558594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1733460426330566  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1733460426330566  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1734108924865723  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1839165687561035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1848301887512207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1848301887512207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.184908390045166  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.198124408721924  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([1159, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2259340286254883  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2259340286254883  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1159, 256]), torch.Size([1, 1159, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.228203773498535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.631389617919922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1159, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5796260833740234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.580448627471924  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.581271171569824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.58040714263916  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5518, 40])
input nodes number: 25890
output nodes number: 5518
edges number: 58214
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5805916786193848  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.580592155456543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0433344841003418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0433344841003418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0433344841003418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01148386299610138 |0.0024586617946624756 |0.11971957981586456 |9.237229824066162e-05 |0.0786527693271637 |0.004869937896728516 |
----------------------------------------------------------pseudo_mini_loss sum 4.788090705871582
Total (block generation + training)time/epoch 26.074340105056763
Training time/epoch 3.4954230785369873
Training time without block to device /epoch 3.4560844898223877
Training time without total dataloading part /epoch 3.1803054809570312
load block tensor time/epoch 0.18374180793762207
block to device time/epoch 0.03933858871459961
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  872309
Number of first layer input nodes during this epoch:  593607
Number of first layer output nodes during this epoch:  278702
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.043334007263183594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025228500366210938
global_2_local spend time (sec) 0.05160856246948242
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004361867904663086
A = g.adjacency_matrix() spent  0.010784149169921875
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})[05:34:33] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28452268 edges into 16 parts and get 7389891 edge cuts

get remove nodes spent  0.09222221374511719
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3057405948638916
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1654996871948242

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096})
Convert a graph into a bidirected graph: 1.262 seconds
Metis partitioning: 5.458 seconds
Split the graph: 1.020 seconds
Construct subgraphs: 0.052 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.806898593902588
5746
5803
5854
5854
5845
5530
5655
5836
5740
5638
5554
5562
5517
5773
5517
5517
total k batches seeds list generation spend  18.545646905899048
after graph partition
graph partition algorithm spend time 18.640546798706055
5746
5803
5854
5854
5845
5530
5655
5836
5740
5638
5554
5562
5517
5773
5517
5517
partition_len_list
[9845, 13303, 14051, 11556, 13655, 11726, 10467, 10891, 13826, 13389, 20671, 24172, 28522, 29150, 30903, 26796]
shared_neighbor_graph_partition_s0 selection method  spend 18.750712871551514
time for parepare:  0.017589807510375977
local_output_nid generation:  0.001416921615600586
local_in_edges_tensor generation:  0.001474618911743164
mini_batch_src_global generation:  0.0015492439270019531
r_  generation:  0.010403156280517578
local_output_nid generation:  0.00153350830078125
local_in_edges_tensor generation:  0.001440286636352539
mini_batch_src_global generation:  0.0016336441040039062
r_  generation:  0.014862537384033203
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0014243125915527344
mini_batch_src_global generation:  0.0015604496002197266
r_  generation:  0.016857624053955078
local_output_nid generation:  0.0017614364624023438
local_in_edges_tensor generation:  0.0013799667358398438
mini_batch_src_global generation:  0.0013680458068847656
r_  generation:  0.014850616455078125
local_output_nid generation:  0.0017876625061035156
local_in_edges_tensor generation:  0.0014841556549072266
mini_batch_src_global generation:  0.0016183853149414062
r_  generation:  0.01689743995666504
local_output_nid generation:  0.0017800331115722656
local_in_edges_tensor generation:  0.001287698745727539
mini_batch_src_global generation:  0.0011913776397705078
r_  generation:  0.013487577438354492
local_output_nid generation:  0.0018100738525390625
local_in_edges_tensor generation:  0.0014200210571289062
mini_batch_src_global generation:  0.0012166500091552734
r_  generation:  0.013462543487548828
local_output_nid generation:  0.0017979145050048828
local_in_edges_tensor generation:  0.0014464855194091797
mini_batch_src_global generation:  0.0014255046844482422
r_  generation:  0.016363859176635742
local_output_nid generation:  0.0017688274383544922
local_in_edges_tensor generation:  0.0013191699981689453
mini_batch_src_global generation:  0.0011820793151855469
r_  generation:  0.012746095657348633
local_output_nid generation:  0.0016908645629882812
local_in_edges_tensor generation:  0.0012884140014648438
mini_batch_src_global generation:  0.0010135173797607422
r_  generation:  0.01257777214050293
local_output_nid generation:  0.0016853809356689453
local_in_edges_tensor generation:  0.0013630390167236328
mini_batch_src_global generation:  0.0012722015380859375
r_  generation:  0.014293193817138672
local_output_nid generation:  0.0017206668853759766
local_in_edges_tensor generation:  0.0012867450714111328
mini_batch_src_global generation:  0.0013613700866699219
r_  generation:  0.015813112258911133
local_output_nid generation:  0.0017807483673095703
local_in_edges_tensor generation:  0.0013797283172607422
mini_batch_src_global generation:  0.015447616577148438
r_  generation:  0.019913911819458008
local_output_nid generation:  0.0019147396087646484
local_in_edges_tensor generation:  0.00156402587890625
mini_batch_src_global generation:  0.0024878978729248047
r_  generation:  0.025470256805419922
local_output_nid generation:  0.001903533935546875
local_in_edges_tensor generation:  0.0014982223510742188
mini_batch_src_global generation:  0.002037525177001953
r_  generation:  0.021936655044555664
local_output_nid generation:  0.001992464065551758
local_in_edges_tensor generation:  0.0014853477478027344
mini_batch_src_global generation:  0.0016574859619140625
r_  generation:  0.018101930618286133
----------------------check_connections_block total spend ----------------------------- 0.4316568374633789
generate_one_block  0.020774364471435547
generate_one_block  0.020326852798461914
generate_one_block  0.023590564727783203
generate_one_block  0.01935124397277832
generate_one_block  0.022825241088867188
generate_one_block  0.018048524856567383
generate_one_block  0.017757177352905273
generate_one_block  0.02178025245666504
generate_one_block  0.017458438873291016
generate_one_block  0.01707315444946289
generate_one_block  0.021420955657958984
generate_one_block  0.022273778915405273
generate_one_block  0.02777695655822754
generate_one_block  0.03707098960876465
generate_one_block  0.03470206260681152
generate_one_block  0.025144338607788086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026560544967651367
gen group dst list time:  0.008289098739624023
time for parepare:  0.01965618133544922
local_output_nid generation:  0.002119302749633789
local_in_edges_tensor generation:  0.010277271270751953
mini_batch_src_global generation:  0.0016829967498779297
r_  generation:  0.018115520477294922
local_output_nid generation:  0.0036957263946533203
local_in_edges_tensor generation:  0.0028476715087890625
mini_batch_src_global generation:  0.0027647018432617188
r_  generation:  0.028905630111694336
local_output_nid generation:  0.004155158996582031
local_in_edges_tensor generation:  0.003941774368286133
mini_batch_src_global generation:  0.00400543212890625
r_  generation:  0.04543185234069824
local_output_nid generation:  0.0033774375915527344
local_in_edges_tensor generation:  0.0025315284729003906
mini_batch_src_global generation:  0.0025894641876220703
r_  generation:  0.025363445281982422
local_output_nid generation:  0.0037622451782226562
local_in_edges_tensor generation:  0.002846240997314453
mini_batch_src_global generation:  0.0029680728912353516
r_  generation:  0.047567129135131836
local_output_nid generation:  0.0047986507415771484
local_in_edges_tensor generation:  0.0039370059967041016
mini_batch_src_global generation:  0.004139423370361328
r_  generation:  0.026900529861450195
local_output_nid generation:  0.0029096603393554688
local_in_edges_tensor generation:  0.0022025108337402344
mini_batch_src_global generation:  0.0019161701202392578
r_  generation:  0.03379106521606445
local_output_nid generation:  0.0052356719970703125
local_in_edges_tensor generation:  0.0032181739807128906
mini_batch_src_global generation:  0.005848884582519531
r_  generation:  0.028692245483398438
local_output_nid generation:  0.005040645599365234
local_in_edges_tensor generation:  0.0030281543731689453
mini_batch_src_global generation:  0.002760171890258789
r_  generation:  0.05313849449157715
local_output_nid generation:  0.004999637603759766
local_in_edges_tensor generation:  0.004195690155029297
mini_batch_src_global generation:  0.0027294158935546875
r_  generation:  0.0305938720703125
local_output_nid generation:  0.006535768508911133
local_in_edges_tensor generation:  0.005470991134643555
mini_batch_src_global generation:  0.0055081844329833984
r_  generation:  0.054250240325927734
local_output_nid generation:  0.007256507873535156
local_in_edges_tensor generation:  0.0072019100189208984
mini_batch_src_global generation:  0.0076465606689453125
r_  generation:  0.06804633140563965
local_output_nid generation:  0.008140087127685547
local_in_edges_tensor generation:  0.0075643062591552734
mini_batch_src_global generation:  0.00917673110961914
r_  generation:  0.0822744369506836
local_output_nid generation:  0.007487773895263672
local_in_edges_tensor generation:  0.006882190704345703
mini_batch_src_global generation:  0.010210752487182617
r_  generation:  0.0887901782989502
local_output_nid generation:  0.008191108703613281
local_in_edges_tensor generation:  0.007399082183837891
mini_batch_src_global generation:  0.01158285140991211
r_  generation:  0.08962869644165039
local_output_nid generation:  0.007580280303955078
local_in_edges_tensor generation:  0.006301403045654297
mini_batch_src_global generation:  0.009380102157592773
r_  generation:  0.07682585716247559
----------------------check_connections_block total spend ----------------------------- 1.2541577816009521
generate_one_block  0.039357662200927734
generate_one_block  0.039350032806396484
generate_one_block  0.045061349868774414
generate_one_block  0.03267621994018555
generate_one_block  0.040741920471191406
generate_one_block  0.03314781188964844
generate_one_block  0.02781224250793457
generate_one_block  0.03228402137756348
generate_one_block  0.03838682174682617
generate_one_block  0.03898453712463379
generate_one_block  0.07433700561523438
generate_one_block  0.08892965316772461
generate_one_block  0.11011219024658203
generate_one_block  0.11467552185058594
generate_one_block  0.12171792984008789
generate_one_block  0.1042335033416748
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.043334007263183594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

connection checking time:  1.2541577816009521
block generation total time  0.9818084239959717
average batch blocks generation time:  0.06136302649974823
block dataloader generation time/epoch 22.277472734451294
pseudo mini batch 0 input nodes size: 15934
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03780984878540039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03780984878540039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.045407772064208984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.045450687408447266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.01956653594970703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.020165443420410156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.020165443420410156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.020165443420410156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([15934, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.020165443420410156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1432, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04483604431152344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04483604431152344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1432, 128]), torch.Size([1, 1432, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04620170593261719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05712699890136719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1432, 128])
m.shape torch.Size([1534, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0579071044921875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0579071044921875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1534, 128]), torch.Size([1, 1534, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05937004089355469  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.081329345703125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1534, 128])
m.shape torch.Size([1234, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08236312866210938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08236312866210938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1234, 128]), torch.Size([1, 1234, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08353996276855469  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10943031311035156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1234, 128])
m.shape torch.Size([1018, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11078357696533203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11078357696533203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1117544174194336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1399087905883789  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([833, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14140939712524414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14140939712524414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14220380783081055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17111730575561523  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([671, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1727743148803711  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1727743148803711  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1734142303466797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20144176483154297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([562, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20299768447875977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20299768447875977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20353364944458008  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23084640502929688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([446, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23227977752685547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23227977752685547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23270511627197266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25694942474365234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([355, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25826025009155273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25826025009155273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25859880447387695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.28026628494262695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([1760, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.28848934173583984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.28848934173583984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1760, 128]), torch.Size([1, 1760, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.29016780853271484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.40933895111083984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1760, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3897533416748047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39989566802978516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4100379943847656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3998222351074219  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([9845, 256])
first layer input nodes number: 15934
first layer output nodes number: 9845
edges number: 48762
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4094052314758301  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.41954755783081055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4215407371520996  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4215407371520996  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1014, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45308494567871094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45308494567871094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1014, 256]), torch.Size([1, 1014, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4550189971923828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.47131776809692383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1014, 256])
m.shape torch.Size([958, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.47277116775512695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.47277116775512695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 958, 256]), torch.Size([1, 958, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.47459840774536133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.502007007598877  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 958, 256])
m.shape torch.Size([728, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5038566589355469  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5038566589355469  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 728, 256]), torch.Size([1, 728, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5052452087402344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5359411239624023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 728, 256])
m.shape torch.Size([535, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5373992919921875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5373992919921875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5384197235107422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.57012939453125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([489, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5719695091247559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5719695091247559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5729022026062012  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6068902015686035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([372, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6085691452026367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6085691452026367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.609278678894043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6403226852416992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([303, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6420068740844727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6420068740844727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6425848007202148  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6719274520874023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([237, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6734609603881836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6734609603881836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6739130020141602  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6996793746948242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7010884284973145  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7010884284973145  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.701448917388916  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.724520206451416  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7257723808288574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7257723808288574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7260565757751465  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7462344169616699  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([121, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7473716735839844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7473716735839844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7476024627685547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7656040191650391  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([106, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7667112350463867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7667112350463867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7669134140014648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7840986251831055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7850689888000488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7850689888000488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.785219669342041  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7990822792053223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([70, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7999491691589355  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7999491691589355  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8000826835632324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.813300609588623  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8143253326416016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8143253326416016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8144588470458984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8286113739013672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8292522430419922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8292522430419922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8293399810791016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8392543792724609  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8399295806884766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8399295806884766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8400135040283203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8500843048095703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8506999015808105  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8506999015808105  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8507723808288574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8599772453308105  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8602519035339355  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8602519035339355  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8602843284606934  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8646292686462402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8649015426635742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8649015426635742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8649301528930664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8689641952514648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8693537712097168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8693537712097168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.869391918182373  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.875037670135498  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8753781318664551  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8753781318664551  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8754105567932129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8804364204406738  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8807520866394043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8807520866394043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8807806968688965  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8854155540466309  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8857474327087402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8857474327087402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8857760429382324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8906111717224121  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([99, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8929758071899414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8929758071899414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8931646347045898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9263982772827148  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 99, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9015569686889648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9024133682250977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9032697677612305  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9023704528808594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5746, 40])
input nodes number: 9845
output nodes number: 5746
edges number: 31564
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9025206565856934  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9025216102600098  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021438121795654297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 1 input nodes size: 27186
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.01960134506225586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.01960134506225586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03327322006225586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.033316612243652344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.02567577362060547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026617050170898438  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026617050170898438  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026617050170898438  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([27186, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026617050170898438  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1261, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06761646270751953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06761646270751953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1261, 128]), torch.Size([1, 1261, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06881904602050781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07843971252441406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1261, 128])
m.shape torch.Size([1436, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0795750617980957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0795750617980957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1436, 128]), torch.Size([1, 1436, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08094453811645508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1022496223449707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1436, 128])
m.shape torch.Size([1295, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10341739654541016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10341739654541016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1295, 128]), torch.Size([1, 1295, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10465240478515625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1318225860595703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1295, 128])
m.shape torch.Size([1155, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1334080696105957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1334080696105957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1155, 128]), torch.Size([1, 1155, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13450956344604492  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16675806045532227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1155, 128])
m.shape torch.Size([904, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16836261749267578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16836261749267578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16922473907470703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20090579986572266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([812, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20279788970947266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20279788970947266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20357227325439453  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23843050003051758  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([717, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24043655395507812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24043655395507812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2411203384399414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.27567434310913086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([670, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.27788829803466797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.27788829803466797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.27852725982666016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3159646987915039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([565, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3180699348449707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3180699348449707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.31860876083374023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.35364437103271484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([4488, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3748593330383301  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3748593330383301  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 4488, 128]), torch.Size([1, 4488, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37913942337036133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6870884895324707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 4488, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6517558097839355  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6649436950683594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6776304244995117  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6643433570861816  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([13303, 256])
first layer input nodes number: 27186
first layer output nodes number: 13303
edges number: 82374
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6778349876403809  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6905217170715332  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6936936378479004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6936936378479004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([823, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7368340492248535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7368340492248535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 823, 256]), torch.Size([1, 823, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7384037971496582  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7515273094177246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 823, 256])
m.shape torch.Size([795, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7522706985473633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7522706985473633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 795, 256]), torch.Size([1, 795, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7537870407104492  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7765321731567383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 795, 256])
m.shape torch.Size([603, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7779765129089355  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7779765129089355  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7791266441345215  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8054714202880859  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 603, 256])
m.shape torch.Size([539, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8069686889648438  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8069686889648438  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8079967498779297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8378105163574219  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([391, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8391757011413574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8391757011413574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8399214744567871  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8678345680236816  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([324, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8693304061889648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8693304061889648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8699483871459961  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.897191047668457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([269, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8986921310424805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8986921310424805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.899205207824707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9257621765136719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([262, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9275202751159668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9275202751159668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9280200004577637  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9567523002624512  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([196, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.958198070526123  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.958198070526123  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9585719108581543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9824976921081543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([186, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9840989112854004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9840989112854004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9844536781311035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0096421241760254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0110173225402832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0110173225402832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0112767219543457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0315098762512207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0327873229980469  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0327873229980469  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.03302001953125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0527992248535156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([120, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.054182529449463  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.054182529449463  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0544114112854004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0754685401916504  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([103, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0767402648925781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0767402648925781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0769367218017578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0963859558105469  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0975708961486816  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0975708961486816  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.097740650177002  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.115734577178955  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([67, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1166801452636719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1166801452636719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1168079376220703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1312484741210938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.132214069366455  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.132214069366455  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1323342323303223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1467537879943848  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1476974487304688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1476974487304688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1478080749511719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1618576049804688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1628432273864746  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1628432273864746  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.162951946258545  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1775202751159668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1782927513122559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1782927513122559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1783747673034668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.189939022064209  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.190786361694336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.190786361694336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1908702850341797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2032909393310547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2041163444519043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2041163444519043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2041945457458496  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.216315746307373  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.21720552444458  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.21720552444458  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2172856330871582  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2302632331848145  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2309846878051758  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2309846878051758  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2310476303100586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.241684913635254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([397, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2511930465698242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2511930465698242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2519502639770508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3885173797607422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 397, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.351759433746338  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3526244163513184  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3534893989562988  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3525810241699219  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5803, 40])
input nodes number: 13303
output nodes number: 5803
edges number: 43816
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3527321815490723  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3527326583862305  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.028459548950195312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 2 input nodes size: 32784
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.025684356689453125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.025684356689453125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.041316986083984375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04136085510253906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027645587921142578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.028742313385009766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.028742313385009766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.028742313385009766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([32784, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.028742313385009766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1057, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07737445831298828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07737445831298828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1057, 128]), torch.Size([1, 1057, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07838249206542969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08644676208496094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1057, 128])
m.shape torch.Size([1137, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08782529830932617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08782529830932617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08890962600708008  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10517454147338867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1080, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10617733001708984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10617733001708984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1072072982788086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1298666000366211  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([955, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13117313385009766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13117313385009766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13208389282226562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15894031524658203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 955, 128])
m.shape torch.Size([908, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16064977645874023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16064977645874023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1615157127380371  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19317007064819336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([795, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19501161575317383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19501161575317383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1957697868347168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22846269607543945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([705, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2304368019104004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2304368019104004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 705, 128]), torch.Size([1, 705, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2311091423034668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2662038803100586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 705, 128])
m.shape torch.Size([683, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26847314834594727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26847314834594727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 683, 128]), torch.Size([1, 683, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26912450790405273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3062615394592285  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 683, 128])
m.shape torch.Size([566, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3083648681640625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3083648681640625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30890464782714844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34423160552978516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([6165, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37335872650146484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37335872650146484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 6165, 128]), torch.Size([1, 6165, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3792381286621094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7966756820678711  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 6165, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7532920837402344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7666921615600586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7800922393798828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7665872573852539  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([14051, 256])
first layer input nodes number: 32784
first layer output nodes number: 14051
edges number: 96844
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7803387641906738  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.793738842010498  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7970890998840332  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7970890998840332  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([732, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8472318649291992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8472318649291992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 732, 256]), torch.Size([1, 732, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.848628044128418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.859797477722168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 732, 256])
m.shape torch.Size([652, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8608860969543457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8608860969543457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 652, 256]), torch.Size([1, 652, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8621296882629395  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8811001777648926  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 652, 256])
m.shape torch.Size([563, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8823442459106445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8823442459106445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.883418083190918  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9070825576782227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([455, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9084525108337402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9084525108337402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9093203544616699  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9359040260314941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([418, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9380512237548828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9380512237548828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9388484954833984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9675502777099609  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([322, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9690089225769043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9690089225769043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9696230888366699  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9975371360778809  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([286, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9991545677185059  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9991545677185059  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9997000694274902  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.027580738067627  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([257, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0292844772338867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0292844772338867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0297746658325195  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0596923828125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([231, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.061445713043213  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.061445713043213  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0618863105773926  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0900845527648926  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([194, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0917291641235352  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0917291641235352  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0920991897583008  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1183710098266602  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([157, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1198458671569824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1198458671569824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.120145320892334  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1435027122497559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([150, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1450834274291992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1450834274291992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.145369529724121  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1696882247924805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([123, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1710820198059082  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1710820198059082  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1713166236877441  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1929001808166504  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([119, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1950616836547852  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1950616836547852  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1952886581420898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.217759132385254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([109, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.219217300415039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.219217300415039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2194252014160156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2414627075195312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2425737380981445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2425737380981445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2427244186401367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.259751319885254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([86, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2610812187194824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2610812187194824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2612452507019043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2809290885925293  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2819371223449707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2819371223449707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.282057285308838  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2973179817199707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2982988357543945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2982988357543945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2984075546264648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3129758834838867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3139595985412598  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3139595985412598  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3140625953674316  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.328585147857666  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3295230865478516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3295230865478516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3296165466308594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3434486389160156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([58, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3446283340454102  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3446283340454102  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3447389602661133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3618860244750977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3625164031982422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3625164031982422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3625755310058594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3721542358398438  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3729782104492188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3729782104492188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3730487823486328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3849754333496094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([572, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3986845016479492  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3986845016479492  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.399775505065918  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5947561264038086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 572, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5508389472961426  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5517115592956543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.552584171295166  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5516676902770996  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5854, 40])
input nodes number: 14051
output nodes number: 5854
edges number: 50300
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5518240928649902  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5518245697021484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.030846595764160156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 3 input nodes size: 20896
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027653217315673828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027653217315673828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03761720657348633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.037661075592041016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021984577178955078  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.022817134857177734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.022817134857177734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.022817134857177734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([20896, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.022817134857177734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1183, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05746650695800781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05746650695800781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1183, 128]), torch.Size([1, 1183, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.058594703674316406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06762027740478516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1183, 128])
m.shape torch.Size([1255, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06881093978881836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06881093978881836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1255, 128]), torch.Size([1, 1255, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0700078010559082  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08812284469604492  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1255, 128])
m.shape torch.Size([1117, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0895528793334961  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0895528793334961  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.09061813354492188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11494255065917969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1042, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11639738082885742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11639738082885742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11739110946655273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1462092399597168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([927, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14792251586914062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14792251586914062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 927, 128]), torch.Size([1, 927, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14880657196044922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18100500106811523  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 927, 128])
m.shape torch.Size([773, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18277454376220703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18277454376220703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 773, 128]), torch.Size([1, 773, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18351173400878906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2152109146118164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 773, 128])
m.shape torch.Size([634, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21695852279663086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21695852279663086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 634, 128]), torch.Size([1, 634, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21756315231323242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24794340133666992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 634, 128])
m.shape torch.Size([593, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24990320205688477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24990320205688477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 593, 128]), torch.Size([1, 593, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25046873092651367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.28326845169067383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 593, 128])
m.shape torch.Size([513, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2851872444152832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2851872444152832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2856764793395996  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.31763362884521484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([3519, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3341689109802246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3341689109802246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 3519, 128]), torch.Size([1, 3519, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3375248908996582  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5757994651794434  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 3519, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5474743843078613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.558495044708252  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5695157051086426  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5584087371826172  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([11556, 256])
first layer input nodes number: 20896
first layer output nodes number: 11556
edges number: 69474
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5696735382080078  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5806941986083984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5834493637084961  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5834493637084961  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([827, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6258111000061035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6258111000061035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6273884773254395  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.640204906463623  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([772, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6409006118774414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6409006118774414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 772, 256]), torch.Size([1, 772, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6423730850219727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6649103164672852  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 772, 256])
m.shape torch.Size([606, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.665921688079834  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.665921688079834  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6670775413513184  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6925063133239746  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 606, 256])
m.shape torch.Size([514, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6940059661865234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6940059661865234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 514, 256]), torch.Size([1, 514, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6949863433837891  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7234172821044922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 514, 256])
m.shape torch.Size([422, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7249550819396973  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7249550819396973  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7257599830627441  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7560467720031738  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([352, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7576742172241211  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7576742172241211  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7583456039428711  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7877492904663086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([313, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7895197868347168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7895197868347168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7901167869567871  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8206577301025391  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([273, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8224587440490723  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8224587440490723  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8229794502258301  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8542490005493164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([232, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8559956550598145  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8559956550598145  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.856438159942627  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.884758472442627  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([210, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8865556716918945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8865556716918945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8869562149047852  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9153947830200195  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([172, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9170131683349609  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9170131683349609  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9173412322998047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9429302215576172  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([144, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9444270133972168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9444270133972168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9447016716003418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9680476188659668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([122, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9694347381591797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9694347381591797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9696674346923828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9910755157470703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.992250919342041  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.992250919342041  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.992434024810791  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.010561466217041  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0118107795715332  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0118107795715332  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0119881629943848  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0307908058166504  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([82, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0319633483886719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0319633483886719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0321197509765625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0497932434082031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0505485534667969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0505485534667969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0506458282470703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0623188018798828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0631699562072754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0631699562072754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0632691383361816  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0758652687072754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.076765537261963  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.076765537261963  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0768647193908691  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0901551246643066  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0912013053894043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0912013053894043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0913100242614746  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1066393852233887  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1073322296142578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1073322296142578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1074028015136719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1178474426269531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1184678077697754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1184678077697754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1185269355773926  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1276917457580566  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1283254623413086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1283254623413086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.128382682800293  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1376523971557617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1381316184997559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1381316184997559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1381735801696777  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1452651023864746  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([292, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1522607803344727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1522607803344727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.152817726135254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2529945373535156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 292, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2171564102172852  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2180290222167969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2189016342163086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2179851531982422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5854, 40])
input nodes number: 11556
output nodes number: 5854
edges number: 42195
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2181153297424316  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2181158065795898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.024445533752441406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 4 input nodes size: 24348
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021984577178955078  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021984577178955078  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03370332717895508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.033747196197509766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.023739337921142578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.024799823760986328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.024799823760986328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.024799823760986328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([24348, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.024799823760986328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1070, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07031631469726562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07031631469726562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07133674621582031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07950019836425781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([1180, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08011531829833984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08011531829833984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1180, 128]), torch.Size([1, 1180, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08124065399169922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.09812068939208984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1180, 128])
m.shape torch.Size([1127, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0997781753540039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0997781753540039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10085296630859375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.12554168701171875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([974, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1268620491027832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1268620491027832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1277909278869629  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15509843826293945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([947, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1568918228149414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1568918228149414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15779495239257812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19106721878051758  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([796, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19289302825927734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19289302825927734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19365215301513672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22655963897705078  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([703, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22852659225463867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22852659225463867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22919702529907227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26360559463500977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([643, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26572322845458984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26572322845458984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26633644104003906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3020811080932617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([568, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3042120933532715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3042120933532715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30475378036499023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34049320220947266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([5647, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.36714935302734375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.36714935302734375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 5647, 128]), torch.Size([1, 5647, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37253475189208984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7589921951293945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 5647, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7187442779541016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7317667007446289  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7447891235351562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7316646575927734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([13655, 256])
first layer input nodes number: 24348
first layer output nodes number: 13655
edges number: 91865
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7449727058410645  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7579951286315918  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7612509727478027  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7612509727478027  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([753, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8114142417907715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8114142417907715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8128504753112793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8244833946228027  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 753, 256])
m.shape torch.Size([668, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8254055976867676  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8254055976867676  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 668, 256]), torch.Size([1, 668, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8266797065734863  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8457913398742676  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 668, 256])
m.shape torch.Size([592, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8468704223632812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8468704223632812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 592, 256]), torch.Size([1, 592, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8479995727539062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8728408813476562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 592, 256])
m.shape torch.Size([451, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.874239444732666  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.874239444732666  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8750996589660645  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9020571708679199  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([388, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9034919738769531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9034919738769531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9042320251464844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9313831329345703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([303, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9327607154846191  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9327607154846191  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9333386421203613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9602112770080566  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([284, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9618334770202637  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9618334770202637  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9623751640319824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9899821281433105  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([242, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.991572380065918  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.991572380065918  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9920339584350586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0183439254760742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([214, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0199646949768066  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0199646949768066  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0203728675842285  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0464959144592285  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([183, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.048050880432129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.048050880432129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0483999252319336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0731821060180664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([167, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0747733116149902  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0747733116149902  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.07509183883667  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0999369621276855  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([138, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1013693809509277  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1013693809509277  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1016325950622559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1240057945251465  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([123, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1257333755493164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1257333755493164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1259679794311523  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1475515365600586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.148942470550537  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.148942470550537  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1491427421569824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1689696311950684  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([97, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1702680587768555  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1702680587768555  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1704530715942383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1900644302368164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([92, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1913866996765137  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1913866996765137  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1915621757507324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2113909721374512  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([90, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2127737998962402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2127737998962402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2129454612731934  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2335448265075684  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2345490455627441  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2345490455627441  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2346692085266113  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2499299049377441  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2509841918945312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2509841918945312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2511005401611328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2666912078857422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([67, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.267920970916748  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.267920970916748  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2680487632751465  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2860674858093262  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2870936393737793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2870936393737793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2871966361999512  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3024401664733887  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3031501770019531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3031501770019531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3032188415527344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3138618469238281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3147339820861816  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3147339820861816  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.314812183380127  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3274807929992676  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3284659385681152  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3284659385681152  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.328549861907959  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3427329063415527  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([589, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3568439483642578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3568439483642578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3579673767089844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5566291809082031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 589, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5126876831054688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5135588645935059  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.514430046081543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5135149955749512  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5845, 40])
input nodes number: 13655
output nodes number: 5845
edges number: 50409
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5136594772338867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.513659954071045  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.02678823471069336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 5 input nodes size: 22647
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.02373790740966797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.02373790740966797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03545665740966797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03549814224243164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.023735523223876953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.024555683135986328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.024555683135986328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.024555683135986328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([22647, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.024555683135986328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1352, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.060326576232910156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.060326576232910156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1352, 128]), torch.Size([1, 1352, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.061615943908691406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0719308853149414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1352, 128])
m.shape torch.Size([1250, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0724782943725586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0724782943725586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1250, 128]), torch.Size([1, 1250, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0736703872680664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.09195804595947266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1250, 128])
m.shape torch.Size([1105, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.09311294555664062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.09311294555664062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.09416675567626953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11735057830810547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([942, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11862039566040039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11862039566040039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11951875686645508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14620256423950195  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([819, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1477060317993164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1477060317993164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14848709106445312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1771550178527832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([694, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17911243438720703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17911243438720703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 694, 128]), torch.Size([1, 694, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17977428436279297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20823383331298828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 694, 128])
m.shape torch.Size([587, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20986223220825195  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20986223220825195  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21042203903198242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23841238021850586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([528, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24014663696289062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24014663696289062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24065017700195312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26961374282836914  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([407, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.27110862731933594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.27110862731933594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2714967727661133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2963380813598633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([4042, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3156752586364746  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3156752586364746  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 4042, 128]), torch.Size([1, 4042, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.31953001022338867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5963072776794434  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 4042, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5653409957885742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5765237808227539  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5877065658569336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5764360427856445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([11726, 256])
first layer input nodes number: 22647
first layer output nodes number: 11726
edges number: 71610
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5878772735595703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.59906005859375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6018557548522949  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6018557548522949  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1007, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6399044990539551  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6399044990539551  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1007, 256]), torch.Size([1, 1007, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6418251991271973  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6580033302307129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1007, 256])
m.shape torch.Size([792, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6587262153625488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6587262153625488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 792, 256]), torch.Size([1, 792, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6602368354797363  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6828961372375488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 792, 256])
m.shape torch.Size([606, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6844606399536133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6844606399536133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6856164932250977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7117490768432617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 606, 256])
m.shape torch.Size([492, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7134919166564941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7134919166564941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7144303321838379  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7425446510314941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([378, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7438921928405762  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7438921928405762  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7446131706237793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7708334922790527  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([308, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7727146148681641  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7727146148681641  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7733020782470703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7991909980773926  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([244, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8008174896240234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8008174896240234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8012828826904297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8245525360107422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([207, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8259115219116211  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8259115219116211  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8263063430786133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.848811149597168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([164, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8500328063964844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8500328063964844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8503456115722656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8703651428222656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([145, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8716025352478027  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8716025352478027  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8718791007995605  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8915152549743652  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([125, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8926987648010254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8926987648010254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.892937183380127  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9115338325500488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([99, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9125566482543945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9125566482543945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.912745475769043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9287958145141602  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9297089576721191  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9297089576721191  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9298596382141113  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9437222480773926  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9447641372680664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9447641372680664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9449224472045898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9605951309204102  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9616408348083496  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9616408348083496  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.961789608001709  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9775595664978027  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.978177547454834  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.978177547454834  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9782633781433105  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9879622459411621  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9889650344848633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9889650344848633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9890871047973633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0037355422973633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0045051574707031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0045051574707031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0045967102050781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0162239074707031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0170001983642578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0170001983642578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0170860290527344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0285873413085938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0294098854064941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0294098854064941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0294957160949707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.041597843170166  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.042342185974121  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.042342185974121  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0424165725708008  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0534257888793945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.053917407989502  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.053917407989502  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0539650917053223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0613560676574707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0619072914123535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0619072914123535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0619568824768066  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.069990634918213  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0704965591430664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0704965591430664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.070540428161621  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0779542922973633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([363, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0874557495117188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0874557495117188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0881481170654297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2107295989990234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 363, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1789665222167969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.17979097366333  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1806154251098633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1797494888305664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5530, 40])
input nodes number: 11726
output nodes number: 5530
edges number: 38348
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1798319816589355  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1798324584960938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026109695434570312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 6 input nodes size: 19329
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.023688793182373047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.023688793182373047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03290557861328125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03294801712036133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021187782287597656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021933555603027344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021933555603027344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021933555603027344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([19329, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021933555603027344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1242, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.052466392517089844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.052466392517089844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1242, 128]), torch.Size([1, 1242, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.053650856018066406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06325960159301758  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1242, 128])
m.shape torch.Size([1289, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06482934951782227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06482934951782227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1289, 128]), torch.Size([1, 1289, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06605863571166992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08449792861938477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1289, 128])
m.shape torch.Size([1112, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08594703674316406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08594703674316406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1112, 128]), torch.Size([1, 1112, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08700752258300781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11128425598144531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1112, 128])
m.shape torch.Size([906, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11248207092285156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11248207092285156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11334609985351562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13840293884277344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([735, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1397233009338379  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1397233009338379  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 735, 128]), torch.Size([1, 735, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14042425155639648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1667633056640625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 735, 128])
m.shape torch.Size([612, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16816377639770508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16816377639770508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1687474250793457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1948075294494629  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([501, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19618797302246094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19618797302246094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19666576385498047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22055530548095703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([462, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22207880020141602  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22207880020141602  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 462, 128]), torch.Size([1, 462, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2225193977355957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2476334571838379  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 462, 128])
m.shape torch.Size([408, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24950218200683594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24950218200683594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2498912811279297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2747936248779297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([3200, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2898578643798828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2898578643798828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 3200, 128]), torch.Size([1, 3200, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2929096221923828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5095844268798828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 3200, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.48375940322875977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.493741512298584  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5037236213684082  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.49366331100463867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([10467, 256])
first layer input nodes number: 19329
first layer output nodes number: 10467
edges number: 61002
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5038700103759766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5138521194458008  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5163478851318359  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5163478851318359  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([913, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.554865837097168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.554865837097168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 913, 256]), torch.Size([1, 913, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5566072463989258  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5709514617919922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 913, 256])
m.shape torch.Size([819, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5724263191223145  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5724263191223145  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 819, 256]), torch.Size([1, 819, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5739884376525879  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5977730751037598  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 819, 256])
m.shape torch.Size([657, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5995020866394043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5995020866394043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6007552146911621  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6284012794494629  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([509, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6298203468322754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6298203468322754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.630791187286377  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6589455604553223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([402, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6605315208435059  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6605315208435059  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6612982749938965  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.688901424407959  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([318, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6903519630432129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6903519630432129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6909584999084473  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7171311378479004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([248, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7184967994689941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7184967994689941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7189698219299316  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7426209449768066  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([218, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7440609931945801  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7440609931945801  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7444767951965332  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7681775093078613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7704963684082031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7704963684082031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7708568572998047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7939281463623047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7952761650085449  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7952761650085449  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7955794334411621  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8171114921569824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([156, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8186092376708984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8186092376708984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8189067840576172  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8421154022216797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([142, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.843604564666748  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.843604564666748  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8438754081726074  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8668971061706543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([104, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8680615425109863  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8680615425109863  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8682599067687988  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8865094184875488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8875484466552734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8875484466552734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8877086639404297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9035701751708984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9046730995178223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9046730995178223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9048104286193848  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9193673133850098  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9200830459594727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9200830459594727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9201803207397461  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9311723709106445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9319901466369629  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9319901466369629  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.932091236114502  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9442219734191895  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9450192451477051  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9450192451477051  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9451127052307129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9569821357727051  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9576845169067383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9576845169067383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9577627182006836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9682416915893555  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9688563346862793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9688563346862793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9689211845397949  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.978065013885498  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9787998199462891  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9787998199462891  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9788722991943359  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9895992279052734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9902396202087402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9902396202087402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9903006553649902  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9997611045837402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0004162788391113  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0004162788391113  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0004754066467285  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.010054111480713  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.01060152053833  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.01060152053833  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0106492042541504  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0187077522277832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([311, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0261569023132324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0261569023132324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.026750087738037  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.13346529006958  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 311, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1013188362121582  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1021618843078613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1030049324035645  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1021194458007812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5655, 40])
input nodes number: 10467
output nodes number: 5655
edges number: 38923
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1022586822509766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1022591590881348  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.023431777954101562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 7 input nodes size: 20018
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021206378936767578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021206378936767578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.030751705169677734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.030795574188232422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.02153635025024414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.02245950698852539  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.02245950698852539  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.02245950698852539  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([20018, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.02245950698852539  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([717, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05896139144897461  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05896139144897461  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05964517593383789  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06592130661010742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([898, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0664358139038086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0664358139038086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 898, 128]), torch.Size([1, 898, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0672922134399414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0801382064819336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 898, 128])
m.shape torch.Size([890, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08108186721801758  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08108186721801758  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08193063735961914  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10069513320922852  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([850, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10189199447631836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10189199447631836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10270261764526367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.12691259384155273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([765, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.12833118438720703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.12833118438720703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1290607452392578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15617132186889648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([720, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1578664779663086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1578664779663086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 720, 128]), torch.Size([1, 720, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1585531234741211  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18868732452392578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 720, 128])
m.shape torch.Size([622, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19042015075683594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19042015075683594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19101333618164062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22151851654052734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([546, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22330474853515625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22330474853515625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22382545471191406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2543182373046875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([469, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2569265365600586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2569265365600586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2573738098144531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2859992980957031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([4414, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30726003646850586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30726003646850586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 4414, 128]), torch.Size([1, 4414, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.31146955490112305  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6197600364685059  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 4414, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5868544578552246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5972409248352051  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6076273918151855  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5971593856811523  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([10891, 256])
first layer input nodes number: 20018
first layer output nodes number: 10891
edges number: 73811
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6077785491943359  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6181650161743164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6207618713378906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6207618713378906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([549, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.66961669921875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.66961669921875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6706638336181641  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6796503067016602  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 549, 256])
m.shape torch.Size([581, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6802468299865723  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6802468299865723  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6813549995422363  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6991395950317383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([539, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7001399993896484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7001399993896484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7011680603027344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.724705696105957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([491, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7260794639587402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7260794639587402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7270159721374512  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7544264793395996  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([435, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7560486793518066  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7560486793518066  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7568783760070801  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7867474555969238  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([399, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7886338233947754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7886338233947754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7893948554992676  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8224873542785645  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([328, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8243136405944824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8243136405944824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8249392509460449  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8565330505371094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([281, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8583812713623047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8583812713623047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.858917236328125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8908147811889648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([250, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8927097320556641  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8927097320556641  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8931865692138672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9237041473388672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([237, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9257440567016602  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9257440567016602  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9261960983276367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9582910537719727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([209, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9602746963500977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9602746963500977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9606733322143555  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9917669296264648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([151, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.993309497833252  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.993309497833252  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9935975074768066  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.018078327178955  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([154, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0198588371276855  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0198588371276855  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0201525688171387  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0471758842468262  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([134, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0488324165344238  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0488324165344238  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0490880012512207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0743908882141113  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.075575351715088  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.075575351715088  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0757489204406738  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0941472053527832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([105, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0956754684448242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0956754684448242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0958757400512695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1185064315795898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([98, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1200079917907715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1200079917907715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.120194911956787  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.142625331878662  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([79, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1438989639282227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1438989639282227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1440496444702148  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1631860733032227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.164194107055664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.164194107055664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1643047332763672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.179128646850586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([77, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.180553913116455  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.180553913116455  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1807007789611816  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.201408863067627  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([64, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.202627182006836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.202627182006836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.202749252319336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.220815658569336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2216854095458984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2216854095458984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2217693328857422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2347774505615234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2355756759643555  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2355756759643555  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2356481552124023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.247389793395996  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2482762336730957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2482762336730957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2483525276184082  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2612462043762207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([404, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2709155082702637  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2709155082702637  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.27168607711792  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.40730619430542  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 404, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3646421432495117  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3655118942260742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3663816452026367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3654680252075195  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5836, 40])
input nodes number: 10891
output nodes number: 5836
edges number: 50035
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3656201362609863  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3656206130981445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.024242401123046875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 8 input nodes size: 30189
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021563053131103516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.021563053131103516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.035958290100097656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03600120544433594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026412010192871094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027274131774902344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027274131774902344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027274131774902344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([30189, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027274131774902344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1581, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06770706176757812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06770706176757812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1581, 128]), torch.Size([1, 1581, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0692148208618164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08127689361572266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1581, 128])
m.shape torch.Size([1571, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08264350891113281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08264350891113281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1571, 128]), torch.Size([1, 1571, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08414173126220703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10661506652832031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1571, 128])
m.shape torch.Size([1453, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10832834243774414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10832834243774414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1453, 128]), torch.Size([1, 1453, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10971403121948242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1401991844177246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1453, 128])
m.shape torch.Size([1207, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14209270477294922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14209270477294922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1207, 128]), torch.Size([1, 1207, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14324378967285156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17744159698486328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1207, 128])
m.shape torch.Size([1134, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17956972122192383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17956972122192383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18065118789672852  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22050046920776367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([863, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2224287986755371  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2224287986755371  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2232518196105957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2594943046569824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([748, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2615795135498047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2615795135498047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26229286193847656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2988624572753906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([654, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30100059509277344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30100059509277344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 654, 128]), torch.Size([1, 654, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3016242980957031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.33823490142822266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 654, 128])
m.shape torch.Size([524, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34017181396484375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34017181396484375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 524, 128]), torch.Size([1, 524, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3406715393066406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.37366676330566406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 524, 128])
m.shape torch.Size([4091, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3929481506347656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3929481506347656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 4091, 128]), torch.Size([1, 4091, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3968496322631836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6741409301757812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 4091, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6399416923522949  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6531271934509277  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6663126945495605  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6530237197875977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([13826, 256])
first layer input nodes number: 30189
first layer output nodes number: 13826
edges number: 80852
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6665396690368652  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.679725170135498  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6836504936218262  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6836504936218262  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1091, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7193083763122559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7193083763122559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1091, 256]), torch.Size([1, 1091, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7213892936706543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7389435768127441  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1091, 256])
m.shape torch.Size([845, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7400999069213867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7400999069213867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 845, 256]), torch.Size([1, 845, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7417116165161133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7673358917236328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 845, 256])
m.shape torch.Size([697, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7685399055480957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7685399055480957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 697, 256]), torch.Size([1, 697, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.769869327545166  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7994256019592285  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 697, 256])
m.shape torch.Size([513, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8007335662841797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8007335662841797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8017120361328125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8304538726806641  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([488, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8323101997375488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8323101997375488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8332409858703613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8671612739562988  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([330, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8685989379882812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8685989379882812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8692283630371094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8964729309082031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([270, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.897974967956543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.897974967956543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8984899520874023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9246969223022461  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([228, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9261927604675293  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9261927604675293  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9266276359558105  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9514155387878418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9528331756591797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9528331756591797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9531936645507812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9762649536132812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([144, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9774689674377441  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9774689674377441  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9777436256408691  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9972443580627441  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([99, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9981541633605957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9981541633605957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9983429908752441  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0130715370178223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([109, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0142345428466797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0142345428466797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0144424438476562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.032114028930664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0331597328186035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0331597328186035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0333352088928223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0494790077209473  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0503911972045898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0503911972045898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.050532341003418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0645055770874023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0653290748596191  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0653290748596191  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0654473304748535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0779824256896973  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0787386894226074  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0787386894226074  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0788397789001465  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0902628898620605  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0908660888671875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0908660888671875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0909423828125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.10009765625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1007518768310547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1007518768310547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1008281707763672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1105175018310547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.111283302307129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.111283302307129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1113672256469727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1226129531860352  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1231861114501953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1231861114501953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1232471466064453  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1318531036376953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1322064399719238  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1322064399719238  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1322426795959473  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.137606143951416  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1379475593566895  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1379475593566895  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1379799842834473  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1430058479309082  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1433658599853516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1433658599853516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1433982849121094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.148651123046875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1492118835449219  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1492118835449219  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1492595672607422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.157318115234375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([222, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1626286506652832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1626286506652832  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1630520820617676  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2375760078430176  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 222, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2100276947021484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2108831405639648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2117385864257812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2108402252197266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5740, 40])
input nodes number: 13826
output nodes number: 5740
edges number: 34796
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2109723091125488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.210972785949707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.028981685638427734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 9 input nodes size: 31095
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026397705078125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026397705078125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04122495651245117  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04126739501953125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026829242706298828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027684688568115234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027684688568115234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027684688568115234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([31095, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.027684688568115234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1362, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06781768798828125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06781768798828125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1362, 128]), torch.Size([1, 1362, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06911659240722656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07954978942871094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1362, 128])
m.shape torch.Size([1547, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08100652694702148  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08100652694702148  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1547, 128]), torch.Size([1, 1547, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.08248186111450195  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10488080978393555  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1547, 128])
m.shape torch.Size([1358, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1070098876953125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1070098876953125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1358, 128]), torch.Size([1, 1358, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.10830497741699219  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13751792907714844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1358, 128])
m.shape torch.Size([1158, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13907909393310547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13907909393310547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1158, 128]), torch.Size([1, 1158, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1401834487915039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1722097396850586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1158, 128])
m.shape torch.Size([999, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17403936386108398  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17403936386108398  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 999, 128]), torch.Size([1, 999, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17499208450317383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21045970916748047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 999, 128])
m.shape torch.Size([829, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2123551368713379  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2123551368713379  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21314573287963867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2474217414855957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([716, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24941635131835938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24941635131835938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 716, 128]), torch.Size([1, 716, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25009918212890625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2850475311279297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 716, 128])
m.shape torch.Size([644, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.28716278076171875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.28716278076171875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2877769470214844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.32334136962890625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([575, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3255019187927246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3255019187927246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3260502815246582  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3617734909057617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([4201, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3815312385559082  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3815312385559082  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 4201, 128]), torch.Size([1, 4201, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.38553762435913086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6705422401428223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 4201, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6362900733947754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6490588188171387  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.661827564239502  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.648958683013916  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([13389, 256])
first layer input nodes number: 31095
first layer output nodes number: 13389
edges number: 80480
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6620612144470215  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6748299598693848  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6783356666564941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6783356666564941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([984, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7123942375183105  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7123942375183105  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 984, 256]), torch.Size([1, 984, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.714271068572998  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.729285717010498  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 984, 256])
m.shape torch.Size([873, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7303638458251953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7303638458251953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 873, 256]), torch.Size([1, 873, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7320289611816406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7572097778320312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 873, 256])
m.shape torch.Size([706, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7589235305786133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7589235305786133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 706, 256]), torch.Size([1, 706, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7602701187133789  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7909641265869141  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 706, 256])
m.shape torch.Size([542, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7924051284790039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7924051284790039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.7934389114379883  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.823981761932373  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([464, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8256950378417969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8256950378417969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8265800476074219  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8585014343261719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([310, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8598470687866211  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8598470687866211  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.860438346862793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.891657829284668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([262, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.893125057220459  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.893125057220459  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.8936247825622559  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9186978340148926  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([221, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9201474189758301  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9201474189758301  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9205689430236816  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9445958137512207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([192, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9460458755493164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9460458755493164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9464120864868164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9698495864868164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([142, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.971031665802002  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.971031665802002  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9713025093078613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.990532398223877  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([128, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9917502403259277  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9917502403259277  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.9919943809509277  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0110373497009277  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([97, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0120344161987305  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0120344161987305  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0122194290161133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0279455184936523  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([90, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.028977870941162  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.028977870941162  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0291495323181152  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0449423789978027  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([77, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0458927154541016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0458927154541016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0460395812988281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0605792999267578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0612845420837402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0612845420837402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.061387538909912  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0723052024841309  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0731611251831055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0731611251831055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0732736587524414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0859899520874023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0867018699645996  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0867018699645996  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0867915153503418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0975489616394043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0982656478881836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0982656478881836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.0983495712280273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1090078353881836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1095504760742188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1095504760742188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1096115112304688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1177902221679688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1183366775512695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1183366775512695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.118393898010254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1264619827270508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1269383430480957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1269383430480957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.126986026763916  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1340432167053223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1344003677368164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1344003677368164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.134434700012207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.139756202697754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1401371955871582  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1401371955871582  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1401715278625488  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.14573335647583  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1461315155029297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1461315155029297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1461658477783203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.151968002319336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([205, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.156877040863037  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.156877040863037  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1572680473327637  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2260851860046387  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 205, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1985158920288086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1993560791015625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2001962661743164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1993136405944824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5638, 40])
input nodes number: 13389
output nodes number: 5638
edges number: 34211
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1994409561157227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1994414329528809  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.029376506805419922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 10 input nodes size: 49358
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026813983917236328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.026813983917236328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.05034971237182617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.050391197204589844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.035521507263183594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.036955833435058594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.036955833435058594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.036955833435058594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([49358, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.036955833435058594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1492, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11157512664794922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11157512664794922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1492, 128]), torch.Size([1, 1492, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.11299800872802734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.12438106536865234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1492, 128])
m.shape torch.Size([1473, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.12569236755371094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.12569236755371094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1473, 128]), torch.Size([1, 1473, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.12709712982177734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14861297607421875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1473, 128])
m.shape torch.Size([1283, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15012550354003906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15012550354003906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1283, 128]), torch.Size([1, 1283, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15134906768798828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17911052703857422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1283, 128])
m.shape torch.Size([1189, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18076658248901367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18076658248901367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1189, 128]), torch.Size([1, 1189, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1819005012512207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2147841453552246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1189, 128])
m.shape torch.Size([1103, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21684694290161133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21684694290161133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21789884567260742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2563643455505371  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([948, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25855064392089844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25855064392089844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 948, 128]), torch.Size([1, 948, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25945472717285156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.29833030700683594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 948, 128])
m.shape torch.Size([876, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30080223083496094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30080223083496094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3016376495361328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34363603591918945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([850, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34646081924438477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34646081924438477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3472714424133301  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3936295509338379  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([745, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3964214324951172  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3964214324951172  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 745, 128]), torch.Size([1, 745, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39713191986083984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4429497718811035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 745, 128])
m.shape torch.Size([10712, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.49367332458496094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.49367332458496094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 10712, 128]), torch.Size([1, 10712, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5038890838623047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2362957000732422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 10712, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1699681282043457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1905522346496582  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2102656364440918  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.1895275115966797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([20671, 256])
first layer input nodes number: 49358
first layer output nodes number: 20671
edges number: 151003
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2097649574279785  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.230349063873291  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2345309257507324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2345309257507324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([998, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2755160331726074  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2755160331726074  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 998, 256]), torch.Size([1, 998, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2774195671081543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2926478385925293  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 998, 256])
m.shape torch.Size([794, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2932319641113281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2932319641113281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 794, 256]), torch.Size([1, 794, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.2947463989257812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3185920715332031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 794, 256])
m.shape torch.Size([572, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3195796012878418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3195796012878418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3206706047058105  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.344672679901123  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 572, 256])
m.shape torch.Size([428, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3462305068969727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3462305068969727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3470468521118164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3716516494750977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([362, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.372983455657959  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.372983455657959  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.373673915863037  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.399552822113037  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([299, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4009323120117188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4009323120117188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4015026092529297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4261913299560547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([255, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.427621841430664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.427621841430664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4281082153320312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4524269104003906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([216, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4538445472717285  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4538445472717285  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.454256534576416  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4777398109436035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4791078567504883  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4791078567504883  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4794111251831055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4988203048706055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.500196933746338  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.500196933746338  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.500500202178955  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5220322608947754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.523308277130127  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.523308277130127  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5235657691955566  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5436501502990723  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([94, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5446057319641113  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5446057319641113  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5447850227355957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5600247383117676  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5608725547790527  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5608725547790527  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5610156059265137  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.57417631149292  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5750064849853516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5750064849853516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.57513427734375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5877857208251953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5886735916137695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5886735916137695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5887994766235352  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6021432876586914  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6028800010681152  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6028800010681152  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6029791831970215  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6141867637634277  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6151013374328613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6151013374328613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6152138710021973  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6287178993225098  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6295270919799805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6295270919799805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.629622459411621  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6417341232299805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6424903869628906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6424903869628906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6425743103027344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6538200378417969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6547203063964844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6547203063964844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6548137664794922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6679916381835938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.668792724609375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.668792724609375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6688728332519531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6807289123535156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.681386947631836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.681386947631836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6814498901367188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6912059783935547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.691572666168213  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.691572666168213  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6916069984436035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6971688270568848  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6978669166564941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6978669166564941  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6979260444641113  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.707918643951416  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([497, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7198314666748047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7198314666748047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7207794189453125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.891754150390625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 497, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.856964111328125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8577919006347656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8586196899414062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.857750415802002  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5554, 40])
input nodes number: 20671
output nodes number: 5554
edges number: 41410
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.857933521270752  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8579339981079102  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03957986831665039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 11 input nodes size: 60887
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03550910949707031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03550910949707031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06454229354858398  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06458377838134766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04100656509399414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04267263412475586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04267263412475586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04267263412475586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([60887, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04267263412475586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1551, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13165998458862305  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13165998458862305  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1551, 128]), torch.Size([1, 1551, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.13313913345336914  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14580440521240234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1551, 128])
m.shape torch.Size([1650, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14728164672851562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14728164672851562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1650, 128]), torch.Size([1, 1650, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14885520935058594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17245864868164062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1650, 128])
m.shape torch.Size([1486, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1739492416381836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1739492416381836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1486, 128]), torch.Size([1, 1486, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17536640167236328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2065439224243164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1486, 128])
m.shape torch.Size([1261, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20824050903320312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20824050903320312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1261, 128]), torch.Size([1, 1261, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2094430923461914  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24431800842285156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1261, 128])
m.shape torch.Size([1290, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24679231643676758  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24679231643676758  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1290, 128]), torch.Size([1, 1290, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.24802255630493164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.29254579544067383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1290, 128])
m.shape torch.Size([1050, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2949347496032715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2949347496032715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1050, 128]), torch.Size([1, 1050, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.29593610763549805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3405489921569824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1050, 128])
m.shape torch.Size([995, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3433694839477539  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3433694839477539  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 995, 128]), torch.Size([1, 995, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3443183898925781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3927149772644043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 995, 128])
m.shape torch.Size([887, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39562416076660156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39562416076660156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3964700698852539  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.44728946685791016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([837, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4504585266113281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4504585266113281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45125675201416016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5027170181274414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([13165, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5650935173034668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5650935173034668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 13165, 128]), torch.Size([1, 13165, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5781307220458984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4730372428894043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 13165, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.3918323516845703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4148845672607422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.437936782836914  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4147043228149414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([24172, 256])
first layer input nodes number: 60887
first layer output nodes number: 24172
edges number: 180347
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4383926391601562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4614448547363281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4675846099853516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.4675846099853516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([976, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5102171897888184  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5102171897888184  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 976, 256]), torch.Size([1, 976, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5120787620544434  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5283288955688477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 976, 256])
m.shape torch.Size([826, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5292320251464844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5292320251464844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 826, 256]), torch.Size([1, 826, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5308074951171875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5548381805419922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 826, 256])
m.shape torch.Size([591, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5557546615600586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5557546615600586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5568819046020508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5838842391967773  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([430, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5849738121032715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5849738121032715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.5857939720153809  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6095786094665527  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([370, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6109466552734375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6109466552734375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6116523742675781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6387042999267578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([295, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6402702331542969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6402702331542969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6408329010009766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6671876907348633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([224, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6684136390686035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6684136390686035  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6688408851623535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6902031898498535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([173, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6913199424743652  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6913199424743652  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6916499137878418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7104582786560059  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([145, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7115478515625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7115478515625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7118244171142578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7295246124267578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([122, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.731475830078125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.731475830078125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7317085266113281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.74822998046875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([113, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7493085861206055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7493085861206055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7495241165161133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7663354873657227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([92, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.767289161682129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.767289161682129  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7674646377563477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7823801040649414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([77, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.783254623413086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.783254623413086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7834014892578125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7969131469726562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7978086471557617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7978086471557617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7979459762573242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8115415573120117  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8125977516174316  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8125977516174316  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.812746524810791  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8285164833068848  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8293342590332031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8293342590332031  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8294448852539062  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8419456481933594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8425931930541992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8425931930541992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8426752090454102  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8525171279907227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.853445053100586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.853445053100586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8535518646240234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.867116928100586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8679218292236328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8679218292236328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.868011474609375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8800239562988281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8807868957519531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8807868957519531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8808670043945312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8921623229980469  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.892869472503662  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.892869472503662  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8929400444030762  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9033846855163574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9038782119750977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9038782119750977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.903925895690918  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9113168716430664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9118456840515137  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9118456840515137  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.911893367767334  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9196181297302246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9201712608337402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9201712608337402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9202189445495605  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9282774925231934  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([620, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9431514739990234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9431514739990234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 620, 256]), torch.Size([1, 620, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9443340301513672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1547155380249023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 620, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1181607246398926  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.118989944458008  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.119819164276123  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.118948459625244  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5562, 40])
input nodes number: 24172
output nodes number: 5562
edges number: 43146
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.119171619415283  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1191720962524414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04571962356567383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 12 input nodes size: 61675
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04100799560546875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04100799560546875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07041692733764648  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07045841217041016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04138374328613281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.043541908264160156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.043541908264160156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.043541908264160156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([61675, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.043541908264160156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1178, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15842008590698242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15842008590698242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1178, 128]), torch.Size([1, 1178, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15954351425170898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16853094100952148  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1178, 128])
m.shape torch.Size([1258, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16981029510498047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16981029510498047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1258, 128]), torch.Size([1, 1258, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17101001739501953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18918514251708984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1258, 128])
m.shape torch.Size([1255, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1907062530517578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1907062530517578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1255, 128]), torch.Size([1, 1255, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.19190311431884766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21823406219482422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1255, 128])
m.shape torch.Size([1108, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21974897384643555  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21974897384643555  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22080564498901367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2521052360534668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1082, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25415658950805664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25415658950805664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1082, 128]), torch.Size([1, 1082, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2551884651184082  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2934870719909668  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1082, 128])
m.shape torch.Size([1055, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2959895133972168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2959895133972168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2969956398010254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34051942825317383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
m.shape torch.Size([975, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34327077865600586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34327077865600586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34420061111450195  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39253997802734375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([907, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3955349922180176  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3955349922180176  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39639997482299805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.44670724868774414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([912, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45018863677978516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45018863677978516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45105838775634766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5071191787719727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 912, 128])
m.shape torch.Size([18792, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5962915420532227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5962915420532227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 18792, 128]), torch.Size([1, 18792, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6142129898071289  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.886754035949707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 18792, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7793512344360352  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8065519332885742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8337526321411133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8063392639160156  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([28522, 256])
first layer input nodes number: 61675
first layer output nodes number: 28522
edges number: 233840
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.834214210510254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.861414909362793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8685407638549805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8685407638549805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([745, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9230132102966309  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9230132102966309  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 745, 256]), torch.Size([1, 745, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9244341850280762  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9358019828796387  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 745, 256])
m.shape torch.Size([628, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9363083839416504  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9363083839416504  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9375061988830566  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.956617832183838  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 628, 256])
m.shape torch.Size([460, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9574503898620605  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9574503898620605  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9583277702331543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9779467582702637  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([366, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9789724349975586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9789724349975586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.979670524597168  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0025854110717773  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([357, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.003952980041504  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.003952980041504  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.004633903503418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0300893783569336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([249, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0311851501464844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0311851501464844  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0316600799560547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.052082061767578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([204, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0532174110412598  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0532174110412598  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0536065101623535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.073061466217041  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([171, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0741820335388184  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0741820335388184  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0745081901550293  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0930991172790527  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([146, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0941991806030273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0941991806030273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.094477653503418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.112299919128418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([148, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.113583564758301  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.113583564758301  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.113865852355957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.133908271789551  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([110, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.134983539581299  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.134983539581299  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.135193347930908  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1515583992004395  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([125, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.152895450592041  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.152895450592041  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1531338691711426  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1733994483947754  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([121, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1747922897338867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1747922897338867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.175023078918457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.196255683898926  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([82, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1973562240600586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1973562240600586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.197512626647949  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.212996482849121  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2142014503479004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2142014503479004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2143712043762207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.232365131378174  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([72, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2333874702453613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2333874702453613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.233524799346924  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2490429878234863  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2502846717834473  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2502846717834473  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.250427722930908  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2675938606262207  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.268491268157959  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.268491268157959  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2685980796813965  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.282163143157959  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2833151817321777  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2833151817321777  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2834410667419434  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.300309658050537  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3011693954467773  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3011693954467773  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3012609481811523  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3141698837280273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3152098655700684  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3152098655700684  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.315303325653076  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3291354179382324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.329807758331299  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.329807758331299  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3298726081848145  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3399243354797363  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3407320976257324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3407320976257324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3408045768737793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.352546215057373  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.353271484375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.353271484375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.353334426879883  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.363971710205078  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([1045, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.389050006866455  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.389050006866455  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1045, 256]), torch.Size([1, 1045, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.391218662261963  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.747936725616455  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1045, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.698965072631836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6997876167297363  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.7006101608276367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6997461318969727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5517, 40])
input nodes number: 28522
output nodes number: 5517
edges number: 55697
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.69999361038208  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.6999940872192383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.047269344329833984  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 13 input nodes size: 53243
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04137706756591797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04137706756591797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06676530838012695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06680870056152344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03735828399658203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.039829254150390625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.039829254150390625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.039829254150390625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([53243, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.039829254150390625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([849, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16376590728759766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16376590728759766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16457557678222656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1710529327392578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([871, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1714787483215332  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1714787483215332  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17230939865112305  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1847691535949707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([869, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18576908111572266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18576908111572266  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1865978240966797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20493507385253906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([871, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20618200302124023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20618200302124023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 871, 128]), torch.Size([1, 871, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20701265335083008  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23159170150756836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 871, 128])
m.shape torch.Size([848, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2331981658935547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2331981658935547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2340068817138672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2633171081542969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([869, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2653989791870117  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2653989791870117  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26622772216796875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3024158477783203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([849, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30483531951904297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30483531951904297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3056449890136719  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3464646339416504  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([823, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3491992950439453  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3491992950439453  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34998416900634766  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39581298828125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([853, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3990812301635742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3990812301635742  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39989471435546875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.45203161239624023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([21448, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5538969039916992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5538969039916992  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 21448, 128]), torch.Size([1, 21448, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5743513107299805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0282163619995117  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 21448, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.91078519821167  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.938584804534912  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9663844108581543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9383673667907715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([29150, 256])
first layer input nodes number: 53243
first layer output nodes number: 29150
edges number: 252820
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.966783046722412  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9945826530456543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0022597312927246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0022597312927246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([503, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.078584671020508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.078584671020508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0795440673828125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0876426696777344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([398, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.087928295135498  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.087928295135498  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0886874198913574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1033244132995605  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([351, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1041040420532227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1041040420532227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.10477352142334  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1239309310913086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([276, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1248483657836914  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1248483657836914  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1253747940063477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1418685913085938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([236, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.142739772796631  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.142739772796631  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1431899070739746  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1593947410583496  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([208, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.160369396209717  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.160369396209717  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.160766124725342  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.177825450897217  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([168, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1788463592529297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1788463592529297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.179166793823242  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.195188522338867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([149, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.196174144744873  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.196174144744873  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.196458339691162  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2126574516296387  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.214029312133789  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.214029312133789  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2143630981445312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2357254028320312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([153, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2370290756225586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2370290756225586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.237320899963379  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.258040428161621  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([131, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2597737312316895  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2597737312316895  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.260023593902588  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.279512882232666  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([158, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.281210422515869  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.281210422515869  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2815117835998535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3071274757385254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([124, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3085265159606934  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3085265159606934  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.308763027191162  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.330522060394287  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.331803321838379  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.331803321838379  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3320016860961914  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.351639747619629  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.35288143157959  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.35288143157959  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3530588150024414  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.371861457824707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([106, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3734030723571777  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3734030723571777  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.373605251312256  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.396451473236084  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.397984504699707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.397984504699707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3981618881225586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.419447898864746  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([103, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4211411476135254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4211411476135254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.421337604522705  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4462876319885254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([81, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.44766902923584  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.44766902923584  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4478235244750977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4685258865356445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([105, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4704670906066895  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4704670906066895  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4706673622131348  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.498905658721924  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([76, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5003395080566406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5003395080566406  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5004844665527344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5219383239746094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([63, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.523198127746582  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.523198127746582  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.523318290710449  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5419435501098633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5434532165527344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5434532165527344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.543588638305664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5655269622802734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([77, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5672354698181152  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5672354698181152  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.567382335662842  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.592202663421631  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([1771, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.634683132171631  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.634683132171631  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1771, 256]), torch.Size([1, 1771, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.638061046600342  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.2604079246520996  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1771, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.1886396408081055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.189500331878662  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.1903610229492188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.1894569396972656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5773, 40])
input nodes number: 29150
output nodes number: 5773
edges number: 78665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.189755916595459  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.189756393432617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.044039249420166016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 14 input nodes size: 65988
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03739643096923828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.03739643096923828  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0688619613647461  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.06890344619750977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.0434718132019043  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.045855045318603516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.045855045318603516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.045855045318603516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([65988, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.045855045318603516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1131, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.172271728515625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.172271728515625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.17335033416748047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18197917938232422  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1250, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18297338485717773  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18297338485717773  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1250, 128]), torch.Size([1, 1250, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18416547775268555  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2020716667175293  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1250, 128])
m.shape torch.Size([1231, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20347213745117188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20347213745117188  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1231, 128]), torch.Size([1, 1231, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.20464611053466797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23047351837158203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1231, 128])
m.shape torch.Size([1129, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23214101791381836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23214101791381836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1129, 128]), torch.Size([1, 1129, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.23321771621704102  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2648043632507324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1129, 128])
m.shape torch.Size([1142, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26698875427246094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.26698875427246094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1142, 128]), torch.Size([1, 1142, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2680778503417969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.30741119384765625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1142, 128])
m.shape torch.Size([1026, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3098020553588867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3098020553588867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1026, 128]), torch.Size([1, 1026, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.31078052520751953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.35285472869873047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1026, 128])
m.shape torch.Size([1010, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.35573673248291016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.35573673248291016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.35669994354248047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4058818817138672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([1029, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.40932559967041016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.40932559967041016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1029, 128]), torch.Size([1, 1029, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4103069305419922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.46624279022216797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1029, 128])
m.shape torch.Size([1029, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4701681137084961  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4701681137084961  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1029, 128]), torch.Size([1, 1029, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.4711494445800781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5339546203613281  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1029, 128])
m.shape torch.Size([20926, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.633246898651123  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.633246898651123  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 20926, 128]), torch.Size([1, 20926, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.6532034873962402  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0701212882995605  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 20926, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9514961242675781  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9809675216674805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.010438919067383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9807372093200684  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([30903, 256])
first layer input nodes number: 65988
first layer output nodes number: 30903
edges number: 257529
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0109329223632812  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0404043197631836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0477724075317383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0477724075317383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([651, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.108527183532715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.108527183532715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.109768867492676  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1214189529418945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 651, 256])
m.shape torch.Size([566, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1219091415405273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1219091415405273  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.122988700866699  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1436901092529297  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([443, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1445088386535645  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1445088386535645  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1453537940979004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1653761863708496  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([337, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1663408279418945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1663408279418945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1669836044311523  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.188976287841797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([304, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1901159286499023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1901159286499023  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1906957626342773  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.212137222290039  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([216, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2133870124816895  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2133870124816895  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.213798999786377  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2315144538879395  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([182, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2325329780578613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2325329780578613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.232880115509033  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.250236988067627  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([166, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.251339912414551  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.251339912414551  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2516565322875977  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2697038650512695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([168, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.270998954772949  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.270998954772949  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2713193893432617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2918272018432617  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([140, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2930126190185547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2930126190185547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2932796478271484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3122386932373047  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([116, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3138179779052734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3138179779052734  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3140392303466797  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.331296920776367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([109, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3324437141418457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3324437141418457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3326516151428223  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.35032320022583  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.351418972015381  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.351418972015381  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.351602077484131  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.368447780609131  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3695406913757324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3695406913757324  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.36970853805542  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.3863253593444824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([74, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.387352466583252  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.387352466583252  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.38749361038208  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4024548530578613  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([83, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.403660774230957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.403660774230957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4038190841674805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.421708106994629  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([62, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4226927757263184  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4226927757263184  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4228110313415527  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4370017051696777  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([87, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.438447952270508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.438447952270508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4386138916015625  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.459688186645508  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([74, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.460956573486328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.460956573486328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4610977172851562  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.480010986328125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4817895889282227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4817895889282227  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.481905937194824  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4983110427856445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([69, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.499645709991455  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.499645709991455  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.499777317047119  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5192551612854004  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([55, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.520352363586426  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.520352363586426  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5204572677612305  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.536717414855957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.537571430206299  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.537571430206299  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.537649631500244  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5503182411193848  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5511560440063477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5511560440063477  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5512285232543945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5634775161743164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([1291, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5949320793151855  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5949320793151855  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1291, 256]), torch.Size([1, 1291, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.5973944664001465  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 3.0477147102355957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.992184638977051  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.993007183074951  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9938297271728516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9929656982421875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5517, 40])
input nodes number: 30903
output nodes number: 5517
edges number: 62327
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.993199348449707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.9931998252868652  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.049910545349121094  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

pseudo mini batch 15 input nodes size: 64575
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04343366622924805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04343366622924805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07468366622924805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.07472515106201172  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.043218135833740234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04515504837036133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04515504837036133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04515504837036133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([64575, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.04515504837036133  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([1405, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14921045303344727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.14921045303344727  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1405, 128]), torch.Size([1, 1405, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.15055036544799805  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1612987518310547  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1405, 128])
m.shape torch.Size([1465, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16202592849731445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.16202592849731445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1465, 128]), torch.Size([1, 1465, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1634230613708496  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.1849217414855957  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1465, 128])
m.shape torch.Size([1381, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18639087677001953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18639087677001953  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1381, 128]), torch.Size([1, 1381, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.18770790100097656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21752548217773438  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1381, 128])
m.shape torch.Size([1210, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21917486190795898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.21917486190795898  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1210, 128]), torch.Size([1, 1210, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.22032880783081055  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.25379323959350586  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1210, 128])
m.shape torch.Size([1129, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2559080123901367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2559080123901367  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1129, 128]), torch.Size([1, 1129, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2569847106933594  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.2958965301513672  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1129, 128])
m.shape torch.Size([1013, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.29825639724731445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.29825639724731445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.299222469329834  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3412642478942871  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([960, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34398555755615234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34398555755615234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 960, 128]), torch.Size([1, 960, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.34490108489990234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39067745208740234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 960, 128])
m.shape torch.Size([936, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39379024505615234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.39379024505615234  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 936, 128]), torch.Size([1, 936, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.3946828842163086  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.44556331634521484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 936, 128])
m.shape torch.Size([812, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.44860172271728516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.44860172271728516  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.44937610626220703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5001420974731445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([16485, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5783615112304688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.5783615112304688  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 16485, 128]), torch.Size([1, 16485, 128])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.594912052154541  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7111258506774902  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 16485, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.615434169769287  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.640988826751709  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6665434837341309  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6407890319824219  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([26796, 256])
first layer input nodes number: 64575
first layer output nodes number: 26796
edges number: 211407
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6670265197753906  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6925811767578125  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6993350982666016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.6993350982666016  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

m.shape torch.Size([862, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7476229667663574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7476229667663574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7492671012878418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7635517120361328  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([739, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.764453411102295  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.764453411102295  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 739, 256]), torch.Size([1, 739, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7658629417419434  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7888612747192383  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 739, 256])
m.shape torch.Size([563, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.789881706237793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.789881706237793  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.7909555435180664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8153676986694336  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([442, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.816556453704834  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.816556453704834  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.817399501800537  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8421626091003418  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([318, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8432693481445312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8432693481445312  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8438758850097656  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8673210144042969  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([263, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8685345649719238  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8685345649719238  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8690361976623535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8921074867248535  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([205, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8932361602783203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8932361602783203  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.8936271667480469  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.913177490234375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([171, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.914297103881836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.914297103881836  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9146232604980469  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9332141876220703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([137, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9342365264892578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9342365264892578  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9344978332519531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9512214660644531  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([128, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9523210525512695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9523210525512695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9525651931762695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.9698991775512695  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([128, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.97113037109375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.97113037109375  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.97137451171875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.99041748046875  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([101, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.992408275604248  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.992408275604248  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 1.992600917816162  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0089755058288574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([77, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0098414421081543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0098414421081543  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.009988307952881  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0234999656677246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.024449348449707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.024449348449707  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.024594306945801  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.038945198059082  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([74, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0399398803710938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0399398803710938  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.040081024169922  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.055042266845703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.055910110473633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.055910110473633  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0560264587402344  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.069173812866211  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.070128917694092  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.070128917694092  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.070247173309326  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.084437847137451  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.085451602935791  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.085451602935791  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.0855698585510254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.100588321685791  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1016249656677246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1016249656677246  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1017394065856934  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.117074489593506  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1179399490356445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1179399490356445  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1180315017700195  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1309404373168945  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.132005214691162  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.132005214691162  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.132110118865967  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1476359367370605  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1481547355651855  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1481547355651855  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1482062339782715  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.156188488006592  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1569809913635254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1569809913635254  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1570515632629395  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1684842109680176  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.16934871673584  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.16934871673584  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1694231033325195  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.1819944381713867  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([782, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.201634407043457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.201634407043457  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

 h.shape torch.Size([1, 782, 256]), torch.Size([1, 782, 256])
----------------------------------------3
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.2031259536743164  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4656381607055664  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

rst.shape  torch.Size([1, 782, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.4231600761413574  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.423982620239258  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes
Using backend: pytorch

----------------------------------------after rst
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.424805164337158  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.423941135406494  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

torch.Size([5517, 40])
input nodes number: 26796
output nodes number: 5517
edges number: 48408
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.424182415008545  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 2.424182891845703  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.048596858978271484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.048596858978271484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.7401123046875 GB
    Memory Allocated: 0.048596858978271484  GigaBytes
Max Memory Allocated: 3.3816161155700684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011768743395805359 |0.0016635209321975708 |0.11842213571071625 |8.87066125869751e-05 |0.07546161115169525 |0.004834651947021484 |
----------------------------------------------------------pseudo_mini_loss sum 3.8099472522735596
Total (block generation + training)time/epoch 25.7321058511734
Training time/epoch 3.413034439086914
Training time without block to device /epoch 3.386418104171753
Training time without total dataloading part /epoch 3.108393907546997
load block tensor time/epoch 0.18829989433288574
block to device time/epoch 0.026616334915161133
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  883075
Number of first layer input nodes during this epoch:  600152
Number of first layer output nodes during this epoch:  282923
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
