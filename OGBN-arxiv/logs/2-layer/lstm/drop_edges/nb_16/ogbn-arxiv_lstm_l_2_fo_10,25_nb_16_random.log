main start at this time 1651556677.473739
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02921772003173828
number of batches is  16
batch size is  5684
random selection method spend 0.006580352783203125
time for parepare:  0.018610715866088867
local_output_nid generation:  0.0023508071899414062
local_in_edges_tensor generation:  0.00453948974609375
mini_batch_src_global generation:  0.0016169548034667969
r_  generation:  0.018206119537353516
local_output_nid generation:  0.0027246475219726562
local_in_edges_tensor generation:  0.001615285873413086
mini_batch_src_global generation:  0.0019364356994628906
r_  generation:  0.016030073165893555
local_output_nid generation:  0.0027840137481689453
local_in_edges_tensor generation:  0.0014696121215820312
mini_batch_src_global generation:  0.0012030601501464844
r_  generation:  0.016100406646728516
local_output_nid generation:  0.0028085708618164062
local_in_edges_tensor generation:  0.0014200210571289062
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.016039371490478516
local_output_nid generation:  0.0028121471405029297
local_in_edges_tensor generation:  0.0013854503631591797
mini_batch_src_global generation:  0.0011806488037109375
r_  generation:  0.016269445419311523
local_output_nid generation:  0.002756357192993164
local_in_edges_tensor generation:  0.0013642311096191406
mini_batch_src_global generation:  0.0012688636779785156
r_  generation:  0.01707601547241211
local_output_nid generation:  0.002797842025756836
local_in_edges_tensor generation:  0.0013916492462158203
mini_batch_src_global generation:  0.0012900829315185547
r_  generation:  0.017153501510620117
local_output_nid generation:  0.002819538116455078
local_in_edges_tensor generation:  0.0013928413391113281
mini_batch_src_global generation:  0.0012655258178710938
r_  generation:  0.01690506935119629
local_output_nid generation:  0.0028045177459716797
local_in_edges_tensor generation:  0.0013587474822998047
mini_batch_src_global generation:  0.0012497901916503906
r_  generation:  0.017194032669067383
local_output_nid generation:  0.0027625560760498047
local_in_edges_tensor generation:  0.0013802051544189453
mini_batch_src_global generation:  0.0012745857238769531
r_  generation:  0.01671910285949707
local_output_nid generation:  0.0027468204498291016
local_in_edges_tensor generation:  0.0013098716735839844
mini_batch_src_global generation:  0.0012638568878173828
r_  generation:  0.017398834228515625
local_output_nid generation:  0.0027997493743896484
local_in_edges_tensor generation:  0.001348733901977539
mini_batch_src_global generation:  0.001295328140258789
r_  generation:  0.01749277114868164
local_output_nid generation:  0.002849102020263672
local_in_edges_tensor generation:  0.0013723373413085938
mini_batch_src_global generation:  0.0013213157653808594
r_  generation:  0.017148971557617188
local_output_nid generation:  0.0027925968170166016
local_in_edges_tensor generation:  0.0013928413391113281
mini_batch_src_global generation:  0.0012853145599365234
r_  generation:  0.01723790168762207
local_output_nid generation:  0.0027904510498046875
local_in_edges_tensor generation:  0.0013663768768310547
mini_batch_src_global generation:  0.0013537406921386719
r_  generation:  0.017490863800048828
local_output_nid generation:  0.0028076171875
local_in_edges_tensor generation:  0.0013232231140136719
mini_batch_src_global generation:  0.0013132095336914062
r_  generation:  0.016812801361083984
----------------------check_connections_block total spend ----------------------------- 0.452023983001709
generate_one_block  0.02446269989013672
generate_one_block  0.0276944637298584
generate_one_block  0.025147438049316406
generate_one_block  0.02448439598083496
generate_one_block  0.02457714080810547
generate_one_block  0.0248563289642334
generate_one_block  0.025423526763916016
generate_one_block  0.024693965911865234
generate_one_block  0.025141000747680664
generate_one_block  0.02417612075805664
generate_one_block  0.025129318237304688
generate_one_block  0.02556920051574707
generate_one_block  0.02512836456298828
generate_one_block  0.024701356887817383
generate_one_block  0.025372982025146484
generate_one_block  0.024172544479370117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02222156524658203
gen group dst list time:  0.01742076873779297
time for parepare:  0.018345117568969727
local_output_nid generation:  0.007613182067871094
local_in_edges_tensor generation:  0.013924360275268555
mini_batch_src_global generation:  0.008891820907592773
r_  generation:  0.1013185977935791
local_output_nid generation:  0.010703802108764648
local_in_edges_tensor generation:  0.010593652725219727
mini_batch_src_global generation:  0.01135563850402832
r_  generation:  0.10744118690490723
local_output_nid generation:  0.010728597640991211
local_in_edges_tensor generation:  0.009101629257202148
mini_batch_src_global generation:  0.010613441467285156
r_  generation:  0.11068415641784668
local_output_nid generation:  0.010803937911987305
local_in_edges_tensor generation:  0.009140253067016602
mini_batch_src_global generation:  0.011027097702026367
r_  generation:  0.1099097728729248
local_output_nid generation:  0.010846138000488281
local_in_edges_tensor generation:  0.009174108505249023
mini_batch_src_global generation:  0.012299537658691406
r_  generation:  0.11344265937805176
local_output_nid generation:  0.011137008666992188
local_in_edges_tensor generation:  0.009650707244873047
mini_batch_src_global generation:  0.013512134552001953
r_  generation:  0.11615133285522461
local_output_nid generation:  0.011059045791625977
local_in_edges_tensor generation:  0.009225130081176758
mini_batch_src_global generation:  0.013182878494262695
r_  generation:  0.11398530006408691
local_output_nid generation:  0.011003971099853516
local_in_edges_tensor generation:  0.009685277938842773
mini_batch_src_global generation:  0.012945890426635742
r_  generation:  0.11379432678222656
local_output_nid generation:  0.011104583740234375
local_in_edges_tensor generation:  0.009673118591308594
mini_batch_src_global generation:  0.013141393661499023
r_  generation:  0.11636948585510254
local_output_nid generation:  0.010901689529418945
local_in_edges_tensor generation:  0.009476900100708008
mini_batch_src_global generation:  0.012772321701049805
r_  generation:  0.11510443687438965
local_output_nid generation:  0.011245489120483398
local_in_edges_tensor generation:  0.009799957275390625
mini_batch_src_global generation:  0.013532400131225586
r_  generation:  0.11593127250671387
local_output_nid generation:  0.010959625244140625
local_in_edges_tensor generation:  0.009711503982543945
mini_batch_src_global generation:  0.01306772232055664
r_  generation:  0.11699223518371582
local_output_nid generation:  0.011040925979614258
local_in_edges_tensor generation:  0.009610652923583984
mini_batch_src_global generation:  0.013427734375
r_  generation:  0.11595892906188965
local_output_nid generation:  0.010901212692260742
local_in_edges_tensor generation:  0.009669065475463867
mini_batch_src_global generation:  0.01298379898071289
r_  generation:  0.11402177810668945
local_output_nid generation:  0.011090278625488281
local_in_edges_tensor generation:  0.010258197784423828
mini_batch_src_global generation:  0.014003276824951172
r_  generation:  0.1181640625
local_output_nid generation:  0.01096200942993164
local_in_edges_tensor generation:  0.009510517120361328
mini_batch_src_global generation:  0.012953996658325195
r_  generation:  0.11324357986450195
----------------------check_connections_block total spend ----------------------------- 2.794142961502075
generate_one_block  0.13598084449768066
generate_one_block  0.13114333152770996
generate_one_block  0.14808058738708496
generate_one_block  0.13296842575073242
generate_one_block  0.13386893272399902
generate_one_block  0.1375432014465332
generate_one_block  0.13723540306091309
generate_one_block  0.1338653564453125
generate_one_block  0.13645243644714355
generate_one_block  0.13233256340026855
generate_one_block  0.13773250579833984
generate_one_block  0.1367330551147461
generate_one_block  0.13870906829833984
generate_one_block  0.1324632167816162
generate_one_block  0.1360313892364502
generate_one_block  0.13248777389526367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  2.794142961502075
block generation total time  2.173628091812134
average batch blocks generation time:  0.13585175573825836
pseudo mini batch 0 input nodes size: 97673
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0662841796875 GB
    Memory Allocated: 0.0496525764465332  GigaBytes
Max Memory Allocated: 0.0496525764465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0662841796875 GB
    Memory Allocated: 0.04969501495361328  GigaBytes
Max Memory Allocated: 0.04969501495361328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0662841796875 GB
    Memory Allocated: 0.04969501495361328  GigaBytes
Max Memory Allocated: 0.04969501495361328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.052206993103027344  GigaBytes
Max Memory Allocated: 0.052206993103027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.052206993103027344  GigaBytes
Max Memory Allocated: 0.052206993103027344  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.052206993103027344  GigaBytes
Max Memory Allocated: 0.052206993103027344  GigaBytes

torch.Size([97673, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.052206993103027344  GigaBytes
Max Memory Allocated: 0.052206993103027344  GigaBytes

m.shape torch.Size([1677, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.19526100158691406  GigaBytes
Max Memory Allocated: 0.19887447357177734  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.19526100158691406  GigaBytes
Max Memory Allocated: 0.19887447357177734  GigaBytes

 h.shape torch.Size([1, 1677, 128]), torch.Size([1, 1677, 128])
----------------------------------------3
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.19686031341552734  GigaBytes
Max Memory Allocated: 0.19887447357177734  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.2096548080444336  GigaBytes
Max Memory Allocated: 0.21045446395874023  GigaBytes

rst.shape  torch.Size([1, 1677, 128])
m.shape torch.Size([2080, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.21083879470825195  GigaBytes
Max Memory Allocated: 0.21088552474975586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.21083879470825195  GigaBytes
Max Memory Allocated: 0.21088552474975586  GigaBytes

 h.shape torch.Size([1, 2080, 128]), torch.Size([1, 2080, 128])
----------------------------------------3
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.21282243728637695  GigaBytes
Max Memory Allocated: 0.21282243728637695  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.2439122200012207  GigaBytes
Max Memory Allocated: 0.2458958625793457  GigaBytes

rst.shape  torch.Size([1, 2080, 128])
m.shape torch.Size([2210, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.24608182907104492  GigaBytes
Max Memory Allocated: 0.2461562156677246  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.24608182907104492  GigaBytes
Max Memory Allocated: 0.2461562156677246  GigaBytes

 h.shape torch.Size([1, 2210, 128]), torch.Size([1, 2210, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.24905729293823242  GigaBytes
Max Memory Allocated: 0.24905729293823242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.29680299758911133  GigaBytes
Max Memory Allocated: 0.29996442794799805  GigaBytes

rst.shape  torch.Size([1, 2210, 128])
m.shape torch.Size([2139, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.29996442794799805  GigaBytes
Max Memory Allocated: 0.3000602722167969  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.29996442794799805  GigaBytes
Max Memory Allocated: 0.3000602722167969  GigaBytes

 h.shape torch.Size([1, 2139, 128]), torch.Size([1, 2139, 128])
----------------------------------------3
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.302004337310791  GigaBytes
Max Memory Allocated: 0.302004337310791  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.36240100860595703  GigaBytes
Max Memory Allocated: 0.36648082733154297  GigaBytes

rst.shape  torch.Size([1, 2139, 128])
m.shape torch.Size([2062, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.36648082733154297  GigaBytes
Max Memory Allocated: 0.36659669876098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.36648082733154297  GigaBytes
Max Memory Allocated: 0.36659669876098633  GigaBytes

 h.shape torch.Size([1, 2062, 128]), torch.Size([1, 2062, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.36844730377197266  GigaBytes
Max Memory Allocated: 0.36844730377197266  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.44208860397338867  GigaBytes
Max Memory Allocated: 0.4470047950744629  GigaBytes

rst.shape  torch.Size([1, 2062, 128])
m.shape torch.Size([1938, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.4458003044128418  GigaBytes
Max Memory Allocated: 0.4470047950744629  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.4458003044128418  GigaBytes
Max Memory Allocated: 0.4470047950744629  GigaBytes

 h.shape torch.Size([1, 1938, 128]), torch.Size([1, 1938, 128])
----------------------------------------3
 Nvidia-smi: 1.6580810546875 GB
    Memory Allocated: 0.4476485252380371  GigaBytes
Max Memory Allocated: 0.4476485252380371  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5271220207214355  GigaBytes
Max Memory Allocated: 0.5326666831970215  GigaBytes

rst.shape  torch.Size([1, 1938, 128])
m.shape torch.Size([1709, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5319023132324219  GigaBytes
Max Memory Allocated: 0.5326666831970215  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5319023132324219  GigaBytes
Max Memory Allocated: 0.5326666831970215  GigaBytes

 h.shape torch.Size([1, 1709, 128]), torch.Size([1, 1709, 128])
----------------------------------------3
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5335321426391602  GigaBytes
Max Memory Allocated: 0.5335321426391602  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.615811824798584  GigaBytes
Max Memory Allocated: 0.621516227722168  GigaBytes

rst.shape  torch.Size([1, 1709, 128])
m.shape torch.Size([1606, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.6211233139038086  GigaBytes
Max Memory Allocated: 0.621516227722168  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.6211233139038086  GigaBytes
Max Memory Allocated: 0.621516227722168  GigaBytes

 h.shape torch.Size([1, 1606, 128]), torch.Size([1, 1606, 128])
----------------------------------------3
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.622654914855957  GigaBytes
Max Memory Allocated: 0.622654914855957  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9412841796875 GB
    Memory Allocated: 0.711421012878418  GigaBytes
Max Memory Allocated: 0.7175474166870117  GigaBytes

rst.shape  torch.Size([1, 1606, 128])
m.shape torch.Size([1441, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9412841796875 GB
    Memory Allocated: 0.7168393135070801  GigaBytes
Max Memory Allocated: 0.7175474166870117  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9412841796875 GB
    Memory Allocated: 0.7168393135070801  GigaBytes
Max Memory Allocated: 0.7175474166870117  GigaBytes

 h.shape torch.Size([1, 1441, 128]), torch.Size([1, 1441, 128])
----------------------------------------3
 Nvidia-smi: 1.9412841796875 GB
    Memory Allocated: 0.7182135581970215  GigaBytes
Max Memory Allocated: 0.7182135581970215  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0389404296875 GB
    Memory Allocated: 0.8071894645690918  GigaBytes
Max Memory Allocated: 0.8133735656738281  GigaBytes

rst.shape  torch.Size([1, 1441, 128])
m.shape torch.Size([20961, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.9064521789550781  GigaBytes
Max Memory Allocated: 0.9090662002563477  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.9064521789550781  GigaBytes
Max Memory Allocated: 0.9090662002563477  GigaBytes

 h.shape torch.Size([1, 20961, 128]), torch.Size([1, 20961, 128])
----------------------------------------3
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.9264421463012695  GigaBytes
Max Memory Allocated: 0.9264421463012695  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.3457298278808594  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

rst.shape  torch.Size([1, 20961, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.2143845558166504  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.250455379486084  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.2865262031555176  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.250173568725586  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

torch.Size([37823, 256])
first layer input nodes number: 97673
first layer output nodes number: 37823
edges number: 290351
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.2872562408447266  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.32332706451416  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.3323450088500977  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 2.3323450088500977  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

m.shape torch.Size([859, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 2.378669261932373  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 2.378669261932373  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

 h.shape torch.Size([1, 859, 256]), torch.Size([1, 859, 256])
----------------------------------------3
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 2.380307674407959  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 2.3944082260131836  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

rst.shape  torch.Size([1, 859, 256])
m.shape torch.Size([760, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 2.3950862884521484  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 2.3950862884521484  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

 h.shape torch.Size([1, 760, 256]), torch.Size([1, 760, 256])
----------------------------------------3
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 2.396535873413086  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.4184017181396484  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

rst.shape  torch.Size([1, 760, 256])
m.shape torch.Size([534, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.419301986694336  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.419301986694336  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.420320510864258  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.4433746337890625  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([447, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.4446024894714355  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.4446024894714355  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 2.4454550743103027  GigaBytes
Max Memory Allocated: 2.4456796646118164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.4704031944274902  GigaBytes
Max Memory Allocated: 2.4721269607543945  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([379, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.4718241691589355  GigaBytes
Max Memory Allocated: 2.4721269607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.4718241691589355  GigaBytes
Max Memory Allocated: 2.4721269607543945  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.4725470542907715  GigaBytes
Max Memory Allocated: 2.4725470542907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.501816749572754  GigaBytes
Max Memory Allocated: 2.5036239624023438  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([325, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.5033297538757324  GigaBytes
Max Memory Allocated: 2.5036239624023438  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.5033297538757324  GigaBytes
Max Memory Allocated: 2.5036239624023438  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.5039496421813965  GigaBytes
Max Memory Allocated: 2.5039496421813965  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.530604839324951  GigaBytes
Max Memory Allocated: 2.5324645042419434  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([242, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.531923294067383  GigaBytes
Max Memory Allocated: 2.5324645042419434  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.531923294067383  GigaBytes
Max Memory Allocated: 2.5324645042419434  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.5323848724365234  GigaBytes
Max Memory Allocated: 2.5324645042419434  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8260498046875 GB
    Memory Allocated: 2.5554637908935547  GigaBytes
Max Memory Allocated: 2.557079315185547  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([229, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8260498046875 GB
    Memory Allocated: 2.5569939613342285  GigaBytes
Max Memory Allocated: 2.557079315185547  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8260498046875 GB
    Memory Allocated: 2.5569939613342285  GigaBytes
Max Memory Allocated: 2.557079315185547  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.8260498046875 GB
    Memory Allocated: 2.5574307441711426  GigaBytes
Max Memory Allocated: 2.5574307441711426  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8533935546875 GB
    Memory Allocated: 2.582327365875244  GigaBytes
Max Memory Allocated: 2.5840744972229004  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([212, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8533935546875 GB
    Memory Allocated: 2.5839428901672363  GigaBytes
Max Memory Allocated: 2.5840744972229004  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8533935546875 GB
    Memory Allocated: 2.5839428901672363  GigaBytes
Max Memory Allocated: 2.5840744972229004  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.8533935546875 GB
    Memory Allocated: 2.5843472480773926  GigaBytes
Max Memory Allocated: 2.5843472480773926  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.6102261543273926  GigaBytes
Max Memory Allocated: 2.6120457649230957  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.611510753631592  GigaBytes
Max Memory Allocated: 2.6120457649230957  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.611510753631592  GigaBytes
Max Memory Allocated: 2.6120457649230957  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.8787841796875 GB
    Memory Allocated: 2.6117968559265137  GigaBytes
Max Memory Allocated: 2.6120457649230957  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 2.632110118865967  GigaBytes
Max Memory Allocated: 2.633540630340576  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 2.6332569122314453  GigaBytes
Max Memory Allocated: 2.633540630340576  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 2.6332569122314453  GigaBytes
Max Memory Allocated: 2.633540630340576  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 2.6334896087646484  GigaBytes
Max Memory Allocated: 2.633540630340576  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9178466796875 GB
    Memory Allocated: 2.651639938354492  GigaBytes
Max Memory Allocated: 2.6529197692871094  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9178466796875 GB
    Memory Allocated: 2.652803897857666  GigaBytes
Max Memory Allocated: 2.6529197692871094  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9178466796875 GB
    Memory Allocated: 2.652803897857666  GigaBytes
Max Memory Allocated: 2.6529197692871094  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.9178466796875 GB
    Memory Allocated: 2.653015613555908  GigaBytes
Max Memory Allocated: 2.653015613555908  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9354248046875 GB
    Memory Allocated: 2.671011447906494  GigaBytes
Max Memory Allocated: 2.6722817420959473  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9354248046875 GB
    Memory Allocated: 2.67218017578125  GigaBytes
Max Memory Allocated: 2.6722817420959473  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9354248046875 GB
    Memory Allocated: 2.67218017578125  GigaBytes
Max Memory Allocated: 2.6722817420959473  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.9354248046875 GB
    Memory Allocated: 2.672374725341797  GigaBytes
Max Memory Allocated: 2.672374725341797  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9510498046875 GB
    Memory Allocated: 2.6902732849121094  GigaBytes
Max Memory Allocated: 2.691537857055664  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9510498046875 GB
    Memory Allocated: 2.691347122192383  GigaBytes
Max Memory Allocated: 2.691537857055664  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9510498046875 GB
    Memory Allocated: 2.691347122192383  GigaBytes
Max Memory Allocated: 2.691537857055664  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9510498046875 GB
    Memory Allocated: 2.6915130615234375  GigaBytes
Max Memory Allocated: 2.691537857055664  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9686279296875 GB
    Memory Allocated: 2.7079410552978516  GigaBytes
Max Memory Allocated: 2.7091026306152344  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9686279296875 GB
    Memory Allocated: 2.7091126441955566  GigaBytes
Max Memory Allocated: 2.709117889404297  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9686279296875 GB
    Memory Allocated: 2.7091126441955566  GigaBytes
Max Memory Allocated: 2.709117889404297  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9686279296875 GB
    Memory Allocated: 2.7092785835266113  GigaBytes
Max Memory Allocated: 2.7092785835266113  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9862060546875 GB
    Memory Allocated: 2.726868152618408  GigaBytes
Max Memory Allocated: 2.7281126976013184  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9862060546875 GB
    Memory Allocated: 2.7279458045959473  GigaBytes
Max Memory Allocated: 2.7281126976013184  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9862060546875 GB
    Memory Allocated: 2.7279458045959473  GigaBytes
Max Memory Allocated: 2.7281126976013184  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9862060546875 GB
    Memory Allocated: 2.728081226348877  GigaBytes
Max Memory Allocated: 2.7281126976013184  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9998779296875 GB
    Memory Allocated: 2.7433838844299316  GigaBytes
Max Memory Allocated: 2.7445359230041504  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9998779296875 GB
    Memory Allocated: 2.7443785667419434  GigaBytes
Max Memory Allocated: 2.7445359230041504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9998779296875 GB
    Memory Allocated: 2.7443785667419434  GigaBytes
Max Memory Allocated: 2.7445359230041504  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9998779296875 GB
    Memory Allocated: 2.744502544403076  GigaBytes
Max Memory Allocated: 2.7445359230041504  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0155029296875 GB
    Memory Allocated: 2.7593798637390137  GigaBytes
Max Memory Allocated: 2.7605319023132324  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0155029296875 GB
    Memory Allocated: 2.760234832763672  GigaBytes
Max Memory Allocated: 2.7605319023132324  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0155029296875 GB
    Memory Allocated: 2.760234832763672  GigaBytes
Max Memory Allocated: 2.7605319023132324  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0155029296875 GB
    Memory Allocated: 2.760335922241211  GigaBytes
Max Memory Allocated: 2.7605319023132324  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0291748046875 GB
    Memory Allocated: 2.773174285888672  GigaBytes
Max Memory Allocated: 2.7740840911865234  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0291748046875 GB
    Memory Allocated: 2.774000644683838  GigaBytes
Max Memory Allocated: 2.7740840911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0291748046875 GB
    Memory Allocated: 2.774000644683838  GigaBytes
Max Memory Allocated: 2.7740840911865234  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.0291748046875 GB
    Memory Allocated: 2.774092197418213  GigaBytes
Max Memory Allocated: 2.774092197418213  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0408935546875 GB
    Memory Allocated: 2.786360263824463  GigaBytes
Max Memory Allocated: 2.7872300148010254  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0408935546875 GB
    Memory Allocated: 2.7871413230895996  GigaBytes
Max Memory Allocated: 2.7872300148010254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0408935546875 GB
    Memory Allocated: 2.7871413230895996  GigaBytes
Max Memory Allocated: 2.7872300148010254  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0408935546875 GB
    Memory Allocated: 2.7872233390808105  GigaBytes
Max Memory Allocated: 2.7872300148010254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0526123046875 GB
    Memory Allocated: 2.7987875938415527  GigaBytes
Max Memory Allocated: 2.799607753753662  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0526123046875 GB
    Memory Allocated: 2.799614906311035  GigaBytes
Max Memory Allocated: 2.799618721008301  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0526123046875 GB
    Memory Allocated: 2.799614906311035  GigaBytes
Max Memory Allocated: 2.799618721008301  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.0526123046875 GB
    Memory Allocated: 2.799696922302246  GigaBytes
Max Memory Allocated: 2.799696922302246  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 2.811835289001465  GigaBytes
Max Memory Allocated: 2.8126964569091797  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 2.8123865127563477  GigaBytes
Max Memory Allocated: 2.8126964569091797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 2.8123865127563477  GigaBytes
Max Memory Allocated: 2.8126964569091797  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 2.8124399185180664  GigaBytes
Max Memory Allocated: 2.8126964569091797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0740966796875 GB
    Memory Allocated: 2.8207178115844727  GigaBytes
Max Memory Allocated: 2.821305274963379  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 2.8213768005371094  GigaBytes
Max Memory Allocated: 2.8213796615600586  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 2.8213768005371094  GigaBytes
Max Memory Allocated: 2.8213796615600586  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 2.8214359283447266  GigaBytes
Max Memory Allocated: 2.8214359283447266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.831014633178711  GigaBytes
Max Memory Allocated: 2.8316946029663086  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.831723213195801  GigaBytes
Max Memory Allocated: 2.83172607421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.831723213195801  GigaBytes
Max Memory Allocated: 2.83172607421875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.831784248352051  GigaBytes
Max Memory Allocated: 2.831784248352051  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 2.842099189758301  GigaBytes
Max Memory Allocated: 2.842831611633301  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([624, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 2.857062339782715  GigaBytes
Max Memory Allocated: 2.8571205139160156  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 2.857062339782715  GigaBytes
Max Memory Allocated: 2.8571205139160156  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 2.85825252532959  GigaBytes
Max Memory Allocated: 2.85825252532959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3221435546875 GB
    Memory Allocated: 3.07163143157959  GigaBytes
Max Memory Allocated: 3.08725643157959  GigaBytes

rst.shape  torch.Size([1, 624, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3416748046875 GB
    Memory Allocated: 3.0314130783081055  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3416748046875 GB
    Memory Allocated: 3.0322604179382324  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.0331077575683594  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.0322179794311523  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([5684, 40])
input nodes number: 37823
output nodes number: 5684
edges number: 46638
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.0333895683288574  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.033390522003174  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.06032848358154297  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

pseudo mini batch 1 input nodes size: 96742
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.09944868087768555  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.09949111938476562  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.055056095123291016  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.055056095123291016  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.055056095123291016  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([96742, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.055056095123291016  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

m.shape torch.Size([1621, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.19696807861328125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.19696807861328125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1621, 128]), torch.Size([1, 1621, 128])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.19851398468017578  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.21111392974853516  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1621, 128])
m.shape torch.Size([2107, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.2124347686767578  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.2124347686767578  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2107, 128]), torch.Size([1, 2107, 128])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.21444416046142578  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.24650859832763672  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2107, 128])
m.shape torch.Size([2113, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.24785947799682617  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.24785947799682617  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2113, 128]), torch.Size([1, 2113, 128])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.25053882598876953  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.29678964614868164  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2113, 128])
m.shape torch.Size([2080, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.29974937438964844  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.29974937438964844  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2080, 128]), torch.Size([1, 2080, 128])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.3017587661743164  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.36223602294921875  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2080, 128])
m.shape torch.Size([2052, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.3661365509033203  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.3661365509033203  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2052, 128]), torch.Size([1, 2052, 128])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.3681068420410156  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.4420051574707031  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2052, 128])
m.shape torch.Size([1828, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.4462566375732422  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.4462566375732422  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1828, 128]), torch.Size([1, 1828, 128])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.4479999542236328  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.5257930755615234  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1828, 128])
m.shape torch.Size([1641, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.5303988456726074  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.5303988456726074  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.5319638252258301  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.6117157936096191  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
m.shape torch.Size([1637, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.6171779632568359  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.6171779632568359  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1637, 128]), torch.Size([1, 1637, 128])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.618739128112793  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.7116737365722656  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1637, 128])
m.shape torch.Size([1492, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.7172961235046387  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.7172961235046387  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1492, 128]), torch.Size([1, 1492, 128])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.7187190055847168  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.8099322319030762  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1492, 128])
m.shape torch.Size([20725, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.9080452919006348  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.9080452919006348  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 20725, 128]), torch.Size([1, 20725, 128])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 0.9278101921081543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.331118106842041  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 20725, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.1999974250793457  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.235565662384033  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.2711338996887207  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.235287666320801  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([37296, 256])
first layer input nodes number: 96742
first layer output nodes number: 37296
edges number: 286983
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.2718567848205566  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.307425022125244  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3167786598205566  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3167786598205566  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

m.shape torch.Size([869, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3620681762695312  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3620681762695312  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 869, 256]), torch.Size([1, 869, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3637256622314453  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3774547576904297  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 869, 256])
m.shape torch.Size([714, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.378105640411377  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.378105640411377  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.379467487335205  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4007959365844727  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 714, 256])
m.shape torch.Size([566, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4017996788024902  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4017996788024902  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.402879238128662  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4275221824645996  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([466, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4287972450256348  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4287972450256348  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4296860694885254  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.457073211669922  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([379, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4584503173828125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4584503173828125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4591732025146484  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4857897758483887  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([295, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4871888160705566  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4871888160705566  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4877514839172363  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.518772602081299  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([261, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.520247459411621  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.520247459411621  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.520745277404785  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.5469512939453125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([235, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.54939603805542  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.54939603805542  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.549844264984131  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.5753931999206543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([191, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.5768213272094727  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.5768213272094727  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.57718563079834  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.60050106048584  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6018567085266113  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6018567085266113  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6021618843078613  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6238293647766113  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([150, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.62526273727417  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.62526273727417  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.625548839569092  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.647864818572998  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([116, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.649059772491455  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.649059772491455  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6492810249328613  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6680874824523926  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6691765785217285  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6691765785217285  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6693596839904785  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6862053871154785  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([95, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.687392234802246  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.687392234802246  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6875734329223633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.705512046813965  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.706554412841797  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.706554412841797  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7067031860351562  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.72247314453125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7235522270202637  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7235522270202637  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7236952781677246  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7398600578308105  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7408509254455566  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7408509254455566  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7409749031066895  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.755852222442627  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7569150924682617  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7569150924682617  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7570390701293945  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7727842330932617  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7737088203430176  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7737088203430176  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7738118171691895  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7876133918762207  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.788580894470215  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.788580894470215  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.788681983947754  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8029356002807617  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8038744926452637  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8038744926452637  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8039679527282715  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8178000450134277  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8185572624206543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8185572624206543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.818629741668701  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.829864025115967  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8306236267089844  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8306236267089844  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8306922912597656  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.841815948486328  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.842519760131836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.842519760131836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.842580795288086  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.852895736694336  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([546, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8659849166870117  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8659849166870117  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 546, 256]), torch.Size([1, 546, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8670263290405273  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 3.0522584915161133  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 546, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 3.0131540298461914  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 3.0140013694763184  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 3.0148487091064453  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 3.0139589309692383  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([5684, 40])
input nodes number: 37296
output nodes number: 5684
edges number: 46012
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 3.014279365539551  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 3.014279842376709  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.060259342193603516  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

pseudo mini batch 2 input nodes size: 97057
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.09944868087768555  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.09949111938476562  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.055814266204833984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.055814266204833984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.055814266204833984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([97057, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.055814266204833984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

m.shape torch.Size([1638, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.19878435134887695  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.19878435134887695  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1638, 128]), torch.Size([1, 1638, 128])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.2003464698791504  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.21304941177368164  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1638, 128])
m.shape torch.Size([2068, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.21424055099487305  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.21424055099487305  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2068, 128]), torch.Size([1, 2068, 128])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.21622943878173828  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.2482614517211914  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2068, 128])
m.shape torch.Size([2173, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.25023365020751953  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.25023365020751953  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2173, 128]), torch.Size([1, 2173, 128])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.2523059844970703  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.29911041259765625  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2173, 128])
m.shape torch.Size([2119, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.30211591720581055  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.30211591720581055  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2119, 128]), torch.Size([1, 2119, 128])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.30450916290283203  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.36471986770629883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2119, 128])
m.shape torch.Size([2021, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.3679237365722656  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.3679237365722656  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2021, 128]), torch.Size([1, 2021, 128])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.36985111236572266  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.44000911712646484  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2021, 128])
m.shape torch.Size([1886, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.4444413185119629  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.4444413185119629  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1886, 128]), torch.Size([1, 1886, 128])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.4462399482727051  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.5246224403381348  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1886, 128])
m.shape torch.Size([1666, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.5292840003967285  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.5292840003967285  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1666, 128]), torch.Size([1, 1666, 128])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.5308728218078613  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.6121306419372559  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1666, 128])
m.shape torch.Size([1567, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.6173138618469238  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.6173138618469238  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1567, 128]), torch.Size([1, 1567, 128])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.6188082695007324  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.7039895057678223  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1567, 128])
m.shape torch.Size([1505, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.7097010612487793  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.7097010612487793  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1505, 128]), torch.Size([1, 1505, 128])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.7111363410949707  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.8029942512512207  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1505, 128])
m.shape torch.Size([20878, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.901885986328125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.901885986328125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 20878, 128]), torch.Size([1, 20878, 128])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 0.9217967987060547  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3354644775390625  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 20878, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.205024242401123  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.240807056427002  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.276589870452881  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.2405271530151367  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([37521, 256])
first layer input nodes number: 97057
first layer output nodes number: 37521
edges number: 288713
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.277315139770508  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3130979537963867  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.322237014770508  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.322237014770508  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

m.shape torch.Size([830, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3685293197631836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3685293197631836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 830, 256]), torch.Size([1, 830, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.370112419128418  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3839149475097656  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 830, 256])
m.shape torch.Size([713, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3845438957214355  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.3845438957214355  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 713, 256]), torch.Size([1, 713, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.385903835296631  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.406980514526367  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 713, 256])
m.shape torch.Size([619, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4086227416992188  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4086227416992188  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4098033905029297  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4360389709472656  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 619, 256])
m.shape torch.Size([456, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.43723726272583  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.43723726272583  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4381070137023926  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4659132957458496  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([376, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4681105613708496  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4681105613708496  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.468827724456787  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.496809482574463  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([311, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4982447624206543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.4982447624206543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.498837947845459  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.524482250213623  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([236, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.525773525238037  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.525773525238037  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.526223659515381  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.5487303733825684  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([223, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.550220012664795  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.550220012664795  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.550645351409912  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.574889659881592  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([192, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.576340675354004  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.576340675354004  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.576706886291504  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.600144386291504  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([181, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.601701259613037  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.601701259613037  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.602046489715576  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6265578269958496  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6278023719787598  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6278023719787598  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6280579566955566  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.647993564605713  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6494345664978027  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6494345664978027  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6496939659118652  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6717429161071777  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([85, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6728157997131348  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6728157997131348  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.672977924346924  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6878933906555176  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6890158653259277  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6890158653259277  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.6891818046569824  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7056097984313965  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([94, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7068824768066406  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7068824768066406  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.707061767578125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7260665893554688  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.727180004119873  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.727180004119873  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.727323055267334  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.74348783493042  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7444605827331543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7444605827331543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7445807456970215  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.759000301361084  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7601428031921387  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7601428031921387  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.760261058807373  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7752795219421387  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7764225006103516  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7764225006103516  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.776529312133789  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.790842056274414  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.791769027709961  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.791769027709961  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.7918663024902344  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.805582046508789  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.806300640106201  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.806300640106201  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.806373119354248  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8171000480651855  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8177828788757324  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8177828788757324  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.817847728729248  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.82789945602417  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.828662872314453  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.828662872314453  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8287315368652344  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.839855194091797  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8407435417175293  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8407435417175293  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.840819835662842  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.8537135124206543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([556, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.867035388946533  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.867035388946533  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 4.5350341796875 GB
    Memory Allocated: 2.868095874786377  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5623779296875 GB
    Memory Allocated: 3.0551838874816895  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 556, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5623779296875 GB
    Memory Allocated: 3.0150303840637207  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5623779296875 GB
    Memory Allocated: 3.0158777236938477  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5623779296875 GB
    Memory Allocated: 3.0167250633239746  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5623779296875 GB
    Memory Allocated: 3.0158352851867676  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([5684, 40])
input nodes number: 37521
output nodes number: 5684
edges number: 46201
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5623779296875 GB
    Memory Allocated: 3.016157627105713  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5623779296875 GB
    Memory Allocated: 3.016158103942871  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.06124305725097656  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

pseudo mini batch 3 input nodes size: 97029
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.09958553314208984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.09962797164916992  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.052710533142089844  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05518817901611328  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05518817901611328  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05518817901611328  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([97029, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05518817901611328  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

m.shape torch.Size([1646, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.19711589813232422  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.19711589813232422  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.1986856460571289  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.21137523651123047  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1646, 128])
m.shape torch.Size([2107, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.2126927375793457  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.2126927375793457  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2107, 128]), torch.Size([1, 2107, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.21470212936401367  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.2467188835144043  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2107, 128])
m.shape torch.Size([2243, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.24825572967529297  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.24825572967529297  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2243, 128]), torch.Size([1, 2243, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.2519369125366211  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.2992100715637207  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2243, 128])
m.shape torch.Size([2083, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.30211353302001953  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.30211353302001953  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2083, 128]), torch.Size([1, 2083, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.30416011810302734  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.3634910583496094  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2083, 128])
m.shape torch.Size([2049, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.3665900230407715  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.3665900230407715  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2049, 128]), torch.Size([1, 2049, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.3693532943725586  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.4439568519592285  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2049, 128])
m.shape torch.Size([1865, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.4483156204223633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.4483156204223633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1865, 128]), torch.Size([1, 1865, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.45009422302246094  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.5289907455444336  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1865, 128])
m.shape torch.Size([1703, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.5337858200073242  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.5337858200073242  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1703, 128]), torch.Size([1, 1703, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.5354099273681641  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.6175532341003418  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1703, 128])
m.shape torch.Size([1619, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.6229171752929688  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.6229171752929688  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1619, 128]), torch.Size([1, 1619, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.6244611740112305  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.7126712799072266  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1619, 128])
m.shape torch.Size([1503, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.7183494567871094  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.7183494567871094  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1503, 128]), torch.Size([1, 1503, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.719782829284668  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.811518669128418  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1503, 128])
m.shape torch.Size([20601, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.9090352058410645  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.9090352058410645  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 20601, 128]), torch.Size([1, 20601, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.9286818504333496  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3235936164855957  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 20601, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.1926589012145996  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.228344440460205  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.2640299797058105  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.2280654907226562  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([37419, 256])
first layer input nodes number: 97029
first layer output nodes number: 37419
edges number: 286766
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.2647552490234375  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.300440788269043  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3096771240234375  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3096771240234375  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

m.shape torch.Size([854, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.354557514190674  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.354557514190674  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 854, 256]), torch.Size([1, 854, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3561863899230957  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.369288921356201  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 854, 256])
m.shape torch.Size([753, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3701577186584473  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3701577186584473  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.371593952178955  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3934574127197266  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 753, 256])
m.shape torch.Size([611, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3950839042663574  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3950839042663574  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.396249294281006  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.4228458404541016  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 611, 256])
m.shape torch.Size([450, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.423999309539795  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.423999309539795  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.4248576164245605  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.449817180633545  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([367, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.452117443084717  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.452117443084717  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.452817440032959  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.4824395179748535  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.483941078186035  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.483941078186035  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.484553337097168  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.515103340148926  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([276, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5166544914245605  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5166544914245605  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.517180919647217  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5446505546569824  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([214, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5460329055786133  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5460329055786133  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.546441078186035  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.569706916809082  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.571051597595215  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.571051597595215  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5713930130004883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5932435989379883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([173, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.594736099243164  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.594736099243164  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5950660705566406  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6184940338134766  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([137, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6197776794433594  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6197776794433594  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6200389862060547  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.640420913696289  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.641585350036621  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.641585350036621  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.641791343688965  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6593008041381836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([87, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.660284996032715  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.660284996032715  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6604509353637695  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.675717353820801  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6766357421875  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6766357421875  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.676776885986328  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6907501220703125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.691862106323242  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.691862106323242  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.692018508911133  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.708597183227539  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.709411144256592  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.709411144256592  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.709521770477295  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.722022533416748  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([62, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.723175525665283  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.723175525665283  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7232937812805176  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7374844551086426  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.738186836242676  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.738186836242676  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7382707595825195  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.748929023742676  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.749818801879883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.749818801879883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7499160766601562  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.762950897216797  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7639598846435547  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7639598846435547  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7640647888183594  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7788562774658203  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.779712200164795  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.779712200164795  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7797980308532715  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7925009727478027  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.793198585510254  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.793198585510254  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7932653427124023  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.80361270904541  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.804220676422119  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.804220676422119  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8042759895324707  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.813236713409424  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8140859603881836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8140859603881836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8141584396362305  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8264074325561523  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([581, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.840331554412842  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.840331554412842  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.841439723968506  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.046696186065674  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 581, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0079503059387207  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0087976455688477  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0096449851989746  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0087552070617676  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([5684, 40])
input nodes number: 37419
output nodes number: 5684
edges number: 45601
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0090765953063965  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0090770721435547  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.06049346923828125  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

pseudo mini batch 4 input nodes size: 97848
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.052710533142089844  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.052710533142089844  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.09958553314208984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.09962797164916992  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([97848, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05581808090209961  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

m.shape torch.Size([1673, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.1997966766357422  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.1997966766357422  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1673, 128]), torch.Size([1, 1673, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.20139217376708984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.21424293518066406  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1673, 128])
m.shape torch.Size([2180, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.21552419662475586  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.21552419662475586  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2180, 128]), torch.Size([1, 2180, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.21760320663452148  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.2492842674255371  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2180, 128])
m.shape torch.Size([2217, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.2514162063598633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.2514162063598633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2217, 128]), torch.Size([1, 2217, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.2537264823913574  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.30067014694213867  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2217, 128])
m.shape torch.Size([2104, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.30362606048583984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.30362606048583984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2104, 128]), torch.Size([1, 2104, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.305722713470459  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.3648829460144043  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2104, 128])
m.shape torch.Size([2021, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.36823081970214844  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.36823081970214844  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2021, 128]), torch.Size([1, 2021, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.37015819549560547  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.44016170501708984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2021, 128])
m.shape torch.Size([1814, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.44438791275024414  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.44438791275024414  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1814, 128]), torch.Size([1, 1814, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.4461178779602051  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.522219181060791  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1814, 128])
m.shape torch.Size([1730, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.5271286964416504  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.5271286964416504  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1730, 128]), torch.Size([1, 1730, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.5287785530090332  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.611508846282959  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1730, 128])
m.shape torch.Size([1628, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.6170163154602051  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.6170163154602051  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1628, 128]), torch.Size([1, 1628, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.6185688972473145  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.7106671333312988  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1628, 128])
m.shape torch.Size([1423, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.7159976959228516  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.7159976959228516  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1423, 128]), torch.Size([1, 1423, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.7173547744750977  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.8069138526916504  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1423, 128])
m.shape torch.Size([20937, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.9060707092285156  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.9060707092285156  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 20937, 128]), torch.Size([1, 20937, 128])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.9260377883911133  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.343700408935547  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 20937, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.2122325897216797  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.2482118606567383  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.284191131591797  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.2479305267333984  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([37727, 256])
first layer input nodes number: 97848
first layer output nodes number: 37727
edges number: 289400
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.2849221229553223  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.320901393890381  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.330449104309082  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.330449104309082  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

m.shape torch.Size([885, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3758034706115723  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3758034706115723  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 885, 256]), torch.Size([1, 885, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3774914741516113  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3913121223449707  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 885, 256])
m.shape torch.Size([714, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3919496536254883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3919496536254883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.3933115005493164  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.4152822494506836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 714, 256])
m.shape torch.Size([597, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.416341781616211  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.416341781616211  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.41748046875  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.4436984062194824  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([444, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.44492769241333  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.44492769241333  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.445774555206299  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.471100330352783  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([364, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.472426414489746  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.472426414489746  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.47312068939209  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.4992899894714355  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([329, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.500840187072754  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.500840187072754  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.501467704772949  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5299758911132812  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([258, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.531398296356201  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.531398296356201  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.531890392303467  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.558401584625244  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5597243309020996  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5597243309020996  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5601134300231934  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.582292079925537  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([158, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5834646224975586  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.5834646224975586  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.583765983581543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.603053092956543  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.604440212249756  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.604440212249756  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.604745388031006  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.626412868499756  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([157, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6284050941467285  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6284050941467285  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.62870454788208  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.652061939239502  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.65329647064209  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.65329647064209  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6535253524780273  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.672980308532715  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6741528511047363  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6741528511047363  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.674349308013916  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6924233436584473  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6937246322631836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.6937246322631836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.693922996520996  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7135610580444336  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7145934104919434  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7145934104919434  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.714738368988037  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7301039695739746  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7311878204345703  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7311878204345703  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7313308715820312  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.747495651245117  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.748513698577881  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.748513698577881  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.748633861541748  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7630534172058105  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.763841152191162  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.763841152191162  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.76393461227417  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.775804042816162  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.776670455932617  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.776670455932617  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.776765823364258  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7895450592041016  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.790477752685547  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.790477752685547  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.7905750274658203  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.804290771484375  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.805069923400879  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.805069923400879  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.805148124694824  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8167219161987305  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8176345825195312  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8176345825195312  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.817720413208008  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.831024169921875  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.831423759460449  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.831423759460449  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8314619064331055  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.837641716003418  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8383378982543945  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8383378982543945  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8383970260620117  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.8483896255493164  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([586, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.862440586090088  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.862440586090088  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 2.863558292388916  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0663352012634277  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 586, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0271430015563965  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0279903411865234  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0288376808166504  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0279479026794434  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([5684, 40])
input nodes number: 37727
output nodes number: 5684
edges number: 46064
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0282716751098633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 3.0282721519470215  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.06123542785644531  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

pseudo mini batch 5 input nodes size: 98532
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.10030221939086914  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.10034465789794922  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05342721939086914  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05598878860473633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05598878860473633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05598878860473633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([98532, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5643310546875 GB
    Memory Allocated: 0.05598878860473633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

m.shape torch.Size([1581, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.20186281204223633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.20186281204223633  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1581, 128]), torch.Size([1, 1581, 128])
----------------------------------------3
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.2033705711364746  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.21602964401245117  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1581, 128])
m.shape torch.Size([2050, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.21723079681396484  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.21723079681396484  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2050, 128]), torch.Size([1, 2050, 128])
----------------------------------------3
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.2199845314025879  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.25212526321411133  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2050, 128])
m.shape torch.Size([2211, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.25408029556274414  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.25408029556274414  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2211, 128]), torch.Size([1, 2211, 128])
----------------------------------------3
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.25618886947631836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.3033261299133301  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2211, 128])
m.shape torch.Size([2158, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.30638790130615234  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.30638790130615234  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2158, 128]), torch.Size([1, 2158, 128])
----------------------------------------3
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.30861806869506836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.36929750442504883  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2158, 128])
m.shape torch.Size([2100, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.3728756904602051  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.3728756904602051  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 2100, 128]), torch.Size([1, 2100, 128])
----------------------------------------3
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.3753056526184082  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.44989919662475586  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 2100, 128])
m.shape torch.Size([1901, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.45433664321899414  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.45433664321899414  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1901, 128]), torch.Size([1, 1901, 128])
----------------------------------------3
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.4561495780944824  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.5346798896789551  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1901, 128])
m.shape torch.Size([1848, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.5399417877197266  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.5399417877197266  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1848, 128]), torch.Size([1, 1848, 128])
----------------------------------------3
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.5417041778564453  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.6298236846923828  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1848, 128])
m.shape torch.Size([1657, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.6352634429931641  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.6352634429931641  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1657, 128]), torch.Size([1, 1657, 128])
----------------------------------------3
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.6368436813354492  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.7291908264160156  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1657, 128])
m.shape torch.Size([1534, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.7349839210510254  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.7349839210510254  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 1534, 128]), torch.Size([1, 1534, 128])
----------------------------------------3
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.7364468574523926  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.8300747871398926  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 1534, 128])
m.shape torch.Size([21364, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.9312148094177246  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.9312148094177246  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 21364, 128]), torch.Size([1, 21364, 128])
----------------------------------------3
 Nvidia-smi: 4.7069091796875 GB
    Memory Allocated: 0.9515891075134277  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.406175136566162  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 21364, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.271895408630371  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3085203170776367  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3451452255249023  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3082337379455566  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

torch.Size([38404, 256])
first layer input nodes number: 98532
first layer output nodes number: 38404
edges number: 296490
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.345881462097168  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3825063705444336  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.391850471496582  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.391850471496582  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

m.shape torch.Size([802, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4381303787231445  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4381303787231445  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 802, 256]), torch.Size([1, 802, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.43966007232666  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.451897621154785  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 802, 256])
m.shape torch.Size([690, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.452545166015625  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.452545166015625  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 690, 256]), torch.Size([1, 690, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4538612365722656  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.474163055419922  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 690, 256])
m.shape torch.Size([592, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.475360870361328  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.475360870361328  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 592, 256]), torch.Size([1, 592, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.476490020751953  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5021657943725586  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 592, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5035223960876465  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5035223960876465  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.504401683807373  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.53090238571167  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([394, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5323562622070312  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5323562622070312  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5331077575683594  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5615787506103516  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([290, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.562875747680664  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.562875747680664  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5634288787841797  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5889463424682617  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([280, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5905537605285645  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5905537605285645  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.591087818145752  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.619389057159424  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([230, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6208906173706055  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6208906173706055  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6213293075561523  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.646334648132324  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([187, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.647733211517334  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.647733211517334  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.64808988571167  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.67091703414917  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([156, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.672238349914551  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.672238349914551  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6725358963012695  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.693661689758301  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([166, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.695268154144287  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.695268154144287  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.695584774017334  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7202811241149902  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([129, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7216110229492188  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7216110229492188  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7218570709228516  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7427711486816406  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([117, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.744110107421875  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.744110107421875  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.744333267211914  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.764863967895508  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7660398483276367  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7660398483276367  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7661924362182617  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7812986373901367  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7824478149414062  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7824478149414062  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7826099395751953  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.799795150756836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8008828163146973  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8008828163146973  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.801027774810791  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8174080848693848  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.818234443664551  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.818234443664551  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8183393478393555  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.830927848815918  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.831911563873291  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.831911563873291  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.832024097442627  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.846315860748291  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([43, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8470449447631836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8470449447631836  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8471269607543945  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.85811710357666  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.858902931213379  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.858902931213379  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.85898494720459  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.870549201965332  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.871255397796631  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.871255397796631  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.871325969696045  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.881770610809326  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8826026916503906  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8826026916503906  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.882680892944336  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8948020935058594  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8953380584716797  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8953380584716797  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.895387649536133  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.903421401977539  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9040656089782715  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9040656089782715  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.904120922088623  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.913468837738037  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([616, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9282426834106445  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9282426834106445  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.929417610168457  GigaBytes
Max Memory Allocated: 3.0873193740844727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.138880729675293  GigaBytes
Max Memory Allocated: 3.153567314147949  GigaBytes

rst.shape  torch.Size([1, 616, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.098663330078125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.099510669708252  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.100358009338379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.099468231201172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 38404
output nodes number: 5684
edges number: 47108
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.099797248840332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0997977256774902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06065654754638672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 6 input nodes size: 98026
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05342721939086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05342721939086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10030221939086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10034465789794922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05586862564086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05586862564086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05586862564086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([98026, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05586862564086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1732, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20163965225219727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20163965225219727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1732, 128]), torch.Size([1, 1732, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2032914161682129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2165055274963379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1732, 128])
m.shape torch.Size([2052, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21767425537109375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21767425537109375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2052, 128]), torch.Size([1, 2052, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21963119506835938  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2514677047729492  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2052, 128])
m.shape torch.Size([2144, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25260066986083984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25260066986083984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2144, 128]), torch.Size([1, 2144, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25649166107177734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3030691146850586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2144, 128])
m.shape torch.Size([2074, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3060026168823242  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3060026168823242  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2074, 128]), torch.Size([1, 2074, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3085203170776367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.368133544921875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2074, 128])
m.shape torch.Size([2044, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37117767333984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37117767333984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2044, 128]), torch.Size([1, 2044, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3731269836425781  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4434165954589844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2044, 128])
m.shape torch.Size([1810, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4476203918457031  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4476203918457031  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1810, 128]), torch.Size([1, 1810, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.44934654235839844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5246353149414062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1810, 128])
m.shape torch.Size([1720, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5295133590698242  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5295133590698242  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1720, 128]), torch.Size([1, 1720, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.531153678894043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6134939193725586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1720, 128])
m.shape torch.Size([1644, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6190824508666992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6190824508666992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1644, 128]), torch.Size([1, 1644, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6206502914428711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.712885856628418  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1644, 128])
m.shape torch.Size([1491, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7185006141662598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7185006141662598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1491, 128]), torch.Size([1, 1491, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7199225425720215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8120684623718262  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1491, 128])
m.shape torch.Size([21457, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9136724472045898  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9136724472045898  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21457, 128]), torch.Size([1, 21457, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9341354370117188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3896970748901367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21457, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2554073333740234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.291807174682617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.328207015991211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.29152250289917  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([38168, 256])
first layer input nodes number: 98026
first layer output nodes number: 38168
edges number: 294825
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.328939437866211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3653392791748047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3746390342712402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3746390342712402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([880, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.421138286590576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.421138286590576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 880, 256]), torch.Size([1, 880, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.422816753387451  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.436694622039795  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 880, 256])
m.shape torch.Size([748, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.437623977661133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.437623977661133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 748, 256]), torch.Size([1, 748, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4390506744384766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.461190700531006  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 748, 256])
m.shape torch.Size([544, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4622979164123535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4622979164123535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4633355140686035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.488496780395508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([448, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.48980712890625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.48980712890625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.49066162109375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.51693058013916  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([383, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.518343925476074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.518343925476074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5190744400024414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5464401245117188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([268, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5476207733154297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5476207733154297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5481319427490234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5722169876098633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([238, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5735630989074707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5735630989074707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.57401704788208  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.596714496612549  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([210, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.598102569580078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.598102569580078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5985031127929688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6213340759277344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([187, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6227517127990723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6227517127990723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.623108386993408  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.645935535430908  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([169, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6473817825317383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6473817825317383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6477041244506836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.670590400695801  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.671962261199951  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.671962261199951  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.672238826751709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6938109397888184  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6949644088745117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6949644088745117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6951780319213867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7133359909057617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([114, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.714653968811035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.714653968811035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.714871406555176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7348756790161133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.736642360687256  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.736642360687256  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.736794948577881  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.751901149749756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.752920627593994  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.752920627593994  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.753065586090088  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7684311866760254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7693428993225098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7693428993225098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7694649696350098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7832589149475098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7842273712158203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7842273712158203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7843475341796875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.79876708984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.799849033355713  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.799849033355713  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7999749183654785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.815962314605713  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.816739559173584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.816739559173584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8168272972106934  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8285841941833496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.829578399658203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.829578399658203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.829681396484375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8442039489746094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.845242500305176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.845242500305176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8453454971313477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.860589027404785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8612141609191895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8612141609191895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8612751960754395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8707356452941895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.871567726135254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.871567726135254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8716421127319336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.883692741394043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8843936920166016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8843936920166016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8844547271728516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8947696685791016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([632, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9099249839782715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9099249839782715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.911130428314209  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.124433994293213  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 632, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0840578079223633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0849051475524902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.085752487182617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.08486270904541  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 38168
output nodes number: 5684
edges number: 47263
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0851898193359375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0851902961730957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06115388870239258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 7 input nodes size: 97298
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09971380233764648  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09975624084472656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.052838802337646484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05534219741821289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05534219741821289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05534219741821289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97298, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05534219741821289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1675, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.19931793212890625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.19931793212890625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1675, 128]), torch.Size([1, 1675, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20091533660888672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.213775634765625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1675, 128])
m.shape torch.Size([2076, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21495676040649414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21495676040649414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2076, 128]), torch.Size([1, 2076, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21693658828735352  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24806833267211914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2076, 128])
m.shape torch.Size([2192, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2502140998840332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2502140998840332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2192, 128]), torch.Size([1, 2192, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25285768508911133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30000925064086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2192, 128])
m.shape torch.Size([2189, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30313920974731445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30313920974731445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2189, 128]), torch.Size([1, 2189, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30522823333740234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36645078659057617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2189, 128])
m.shape torch.Size([2014, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.370208740234375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.370208740234375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2014, 128]), torch.Size([1, 2014, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3721294403076172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.44205284118652344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2014, 128])
m.shape torch.Size([1869, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4464397430419922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4464397430419922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1869, 128]), torch.Size([1, 1869, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.44822216033935547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5253372192382812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1869, 128])
m.shape torch.Size([1724, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5302004814147949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5302004814147949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1724, 128]), torch.Size([1, 1724, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5318446159362793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6145224571228027  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1724, 128])
m.shape torch.Size([1609, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6200785636901855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6200785636901855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1609, 128]), torch.Size([1, 1609, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6216130256652832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7091259956359863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1609, 128])
m.shape torch.Size([1456, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7146072387695312  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7146072387695312  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1456, 128]), torch.Size([1, 1456, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7159957885742188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8051671981811523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1456, 128])
m.shape torch.Size([20893, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9040985107421875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9040985107421875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20893, 128]), torch.Size([1, 20893, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9240236282348633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3387069702148438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20893, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.207115650177002  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2430663108825684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2790169715881348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2427849769592285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37697, 256])
first layer input nodes number: 97298
first layer output nodes number: 37697
edges number: 289417
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2797441482543945  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.315694808959961  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.325263500213623  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.325263500213623  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([861, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.371588706970215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.371588706970215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3732309341430664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3864526748657227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 861, 256])
m.shape torch.Size([686, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.387007713317871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.387007713317871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 686, 256]), torch.Size([1, 686, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3883161544799805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.407942771911621  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 686, 256])
m.shape torch.Size([562, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.409008502960205  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.409008502960205  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4100804328918457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4336628913879395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 562, 256])
m.shape torch.Size([475, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.434995174407959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.434995174407959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.435901165008545  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.46315336227417  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([407, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.464656352996826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.464656352996826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.465432643890381  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.493793487548828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([324, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.495274066925049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.495274066925049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.49589204788208  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.524977684020996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([253, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5263710021972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5263710021972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.526853561401367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5509815216064453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([195, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5522398948669434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5522398948669434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.552611827850342  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5738120079040527  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([186, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.575235366821289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.575235366821289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.575590133666992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.598295211791992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([181, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.599857807159424  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.599857807159424  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.600203037261963  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6247143745422363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6259799003601074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6259799003601074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.62623929977417  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.646472454071045  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6479969024658203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6479969024658203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6482372283935547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6686649322509766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.669732093811035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.669732093811035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6699132919311523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6865835189819336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.687619209289551  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.687619209289551  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6877737045288086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.703068733215332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.704216957092285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.704216957092285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.704379081726074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.721564292907715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7224674224853516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7224674224853516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7225894927978516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7363834381103516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([84, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7376952171325684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7376952171325684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7378554344177246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7570815086364746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7581276893615723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7581276893615723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7582459449768066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7732644081115723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([68, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.774447441101074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.774447441101074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7745771408081055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.791956901550293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7926034927368164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7926034927368164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7926740646362305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8026247024536133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8034372329711914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8034372329711914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8035173416137695  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.815373420715332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8161582946777344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8161582946777344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.816232681274414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8277626037597656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.828521251678467  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.828521251678467  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.828589916229248  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8397135734558105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.840463638305664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.840463638305664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8405284881591797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8514881134033203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([565, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8650317192077637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8650317192077637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8661093711853027  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.065802574157715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 565, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.025951385498047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.026798725128174  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.027646064758301  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0267562866210938  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37697
output nodes number: 5684
edges number: 46374
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0270800590515137  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.027080535888672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06075859069824219  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 8 input nodes size: 97997
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.052838802337646484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.052838802337646484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09971380233764648  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09975624084472656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0558629035949707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0558629035949707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0558629035949707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97997, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0558629035949707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1583, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2006216049194336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2006216049194336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1583, 128]), torch.Size([1, 1583, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2021312713623047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2146759033203125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1583, 128])
m.shape torch.Size([2051, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21587705612182617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21587705612182617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2051, 128]), torch.Size([1, 2051, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2178330421447754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24813365936279297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2051, 128])
m.shape torch.Size([2106, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2501683235168457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2501683235168457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2106, 128]), torch.Size([1, 2106, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2531113624572754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3003273010253906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2106, 128])
m.shape torch.Size([2098, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30265235900878906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30265235900878906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2098, 128]), torch.Size([1, 2098, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3053293228149414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36614513397216797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2098, 128])
m.shape torch.Size([2101, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37015390396118164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37015390396118164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2101, 128]), torch.Size([1, 2101, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3728618621826172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4477882385253906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2101, 128])
m.shape torch.Size([1882, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45217084884643555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45217084884643555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1882, 128]), torch.Size([1, 1882, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4539656639099121  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.531989574432373  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1882, 128])
m.shape torch.Size([1751, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5369367599487305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5369367599487305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1751, 128]), torch.Size([1, 1751, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5386066436767578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6224284172058105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1751, 128])
m.shape torch.Size([1684, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6280174255371094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6280174255371094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1684, 128]), torch.Size([1, 1684, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6296234130859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7219467163085938  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1684, 128])
m.shape torch.Size([1586, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7279500961303711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7279500961303711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1586, 128]), torch.Size([1, 1586, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7294626235961914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8275222778320312  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1586, 128])
m.shape torch.Size([21219, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9283285140991211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9283285140991211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21219, 128]), torch.Size([1, 21219, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9489026069641113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4019675254821777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21219, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.267495632171631  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.303793430328369  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3400912284851074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3035097122192383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([38061, 256])
first layer input nodes number: 97997
first layer output nodes number: 38061
edges number: 294385
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3408236503601074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3771214485168457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3865346908569336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3865346908569336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([818, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4328231811523438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4328231811523438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 818, 256]), torch.Size([1, 818, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4343833923339844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4468650817871094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 818, 256])
m.shape torch.Size([745, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4476795196533203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4476795196533203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 745, 256]), torch.Size([1, 745, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4491004943847656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4719114303588867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 745, 256])
m.shape torch.Size([571, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4731698036193848  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4731698036193848  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4742588996887207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.501913070678711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([444, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.503596782684326  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.503596782684326  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.504443645477295  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5308918952941895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([401, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.532395839691162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.532395839691162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.53316068649292  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.561218738555908  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([323, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.562699317932129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.562699317932129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5633153915405273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5913634300231934  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([227, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5925827026367188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5925827026367188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.593015670776367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.614664077758789  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([235, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6162548065185547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6162548065185547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6167030334472656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.642251968383789  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([178, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6435680389404297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6435680389404297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6439075469970703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6656360626220703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([151, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6669178009033203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6669178009033203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.667205810546875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.687654495239258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([128, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6894259452819824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6894259452819824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6896700859069824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7087130546569824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([133, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.710124969482422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.710124969482422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.710378646850586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7319412231445312  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.732964038848877  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.732964038848877  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7331395149230957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7492833137512207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([106, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.750622272491455  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.750622272491455  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.750824451446533  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7708401679992676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7718496322631836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7718496322631836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.77199649810791  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.787564277648926  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.788675308227539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.788675308227539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7888221740722656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.805418014526367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8063249588012695  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8063249588012695  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8064393997192383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8201723098754883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.820997714996338  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.820997714996338  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8210949897766113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.833448886871338  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8342223167419434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8342223167419434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.83430814743042  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8458094596862793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([69, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.847093105316162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.847093105316162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.847224712371826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.865781307220459  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8666443824768066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8666443824768066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.866732120513916  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8797173500061035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8804774284362793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8804774284362793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.880549907684326  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.891784191131592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8926544189453125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8926544189453125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.892732620239258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9054012298583984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9059853553771973  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9059853553771973  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.906036853790283  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9147400856018066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([601, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9291553497314453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9291553497314453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9303016662597656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.1346120834350586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 601, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.094414710998535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.095262050628662  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.096109390258789  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.095219612121582  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 38061
output nodes number: 5684
edges number: 46983
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.095545768737793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.095546245574951  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06041526794433594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 9 input nodes size: 97099
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09961891174316406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09966135025024414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05274391174316406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0552215576171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0552215576171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0552215576171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97099, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0552215576171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1650, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.19714975357055664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.19714975357055664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1650, 128]), torch.Size([1, 1650, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.19872331619262695  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2114253044128418  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1650, 128])
m.shape torch.Size([2134, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21274518966674805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21274518966674805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2134, 128]), torch.Size([1, 2134, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21478033065795898  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24678945541381836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2134, 128])
m.shape torch.Size([2177, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24836063385009766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24836063385009766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2177, 128]), torch.Size([1, 2177, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25094175338745117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.29759883880615234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2177, 128])
m.shape torch.Size([2145, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30065202713012695  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30065202713012695  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2145, 128]), torch.Size([1, 2145, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3030281066894531  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3636326789855957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2145, 128])
m.shape torch.Size([2086, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36711549758911133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36711549758911133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2086, 128]), torch.Size([1, 2086, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36960315704345703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4435133934020996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2086, 128])
m.shape torch.Size([1815, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4477114677429199  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4477114677429199  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1815, 128]), torch.Size([1, 1815, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.44944238662719727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.525968074798584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1815, 128])
m.shape torch.Size([1725, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.530860424041748  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.530860424041748  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1725, 128]), torch.Size([1, 1725, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5325055122375488  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6153726577758789  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1725, 128])
m.shape torch.Size([1591, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6206192970275879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6206192970275879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6221365928649902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7095723152160645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([1502, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7152595520019531  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7152595520019531  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1502, 128]), torch.Size([1, 1502, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7166919708251953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8084936141967773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1502, 128])
m.shape torch.Size([20597, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9059915542602539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9059915542602539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20597, 128]), torch.Size([1, 20597, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9256343841552734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.32027530670166  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20597, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.1903882026672363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.226076602935791  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2617650032043457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.225797653198242  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37422, 256])
first layer input nodes number: 97099
first layer output nodes number: 37422
edges number: 286640
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.262490749359131  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2981791496276855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.307412624359131  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.307412624359131  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([826, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.352433681488037  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.352433681488037  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 826, 256]), torch.Size([1, 826, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3540091514587402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3671956062316895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 826, 256])
m.shape torch.Size([729, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.367875099182129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.367875099182129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 729, 256]), torch.Size([1, 729, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.369265556335449  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.390122413635254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 729, 256])
m.shape torch.Size([567, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.391127109527588  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.391127109527588  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3922085762023926  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.416656970977783  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([498, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4181876182556152  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4181876182556152  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.419137477874756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.447105884552002  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([427, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.448683261871338  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.448683261871338  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.449497699737549  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4803338050842285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([280, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4816694259643555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4816694259643555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.482203483581543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5144872665405273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([258, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5159640312194824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5159640312194824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.516456127166748  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.544492721557617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([211, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5458693504333496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5458693504333496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.546271800994873  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.569211483001709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([184, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5706019401550293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5706019401550293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.570952892303467  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.593413829803467  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.594776153564453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.594776153564453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.595081329345703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.616748809814453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.618013381958008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.618013381958008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6182689666748047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.638204574584961  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([131, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.639587879180908  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.639587879180908  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6398377418518066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.661076068878174  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([114, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6623759269714355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6623759269714355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.662593364715576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6825976371765137  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6837406158447266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6837406158447266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.683917999267578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.701478958129883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.702615737915039  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.702615737915039  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.702777862548828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7199630737304688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([67, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7209482192993164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7209482192993164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.721076011657715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7355165481567383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7366127967834473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7366127967834473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.736748218536377  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7529988288879395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7547221183776855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7547221183776855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7548365592956543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7693705558776855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7702999114990234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7702999114990234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7704029083251953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7842044830322266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7850184440612793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7850184440612793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.785104274749756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.797206401824951  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7981929779052734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7981929779052734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.798290252685547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8126869201660156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8134422302246094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8134422302246094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8135147094726562  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.824748992919922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.825376033782959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.825376033782959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8254332542419434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.834702968597412  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.835343360900879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.835343360900879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8353986740112305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8447465896606445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([542, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8577423095703125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8577423095703125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.858776092529297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0430569648742676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 542, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.004181385040283  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.00502872467041  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.005876064300537  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.00498628616333  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37422
output nodes number: 5684
edges number: 45775
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.005307674407959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.005308151245117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.060588836669921875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 10 input nodes size: 97987
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05274391174316406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05274391174316406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09961891174316406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09966135025024414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05587053298950195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05587053298950195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05587053298950195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97987, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05587053298950195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1651, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20176410675048828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20176410675048828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1651, 128]), torch.Size([1, 1651, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.203338623046875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21623611450195312  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1651, 128])
m.shape torch.Size([2157, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21750593185424805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21750593185424805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2157, 128]), torch.Size([1, 2157, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22035694122314453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2523641586303711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2157, 128])
m.shape torch.Size([2169, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2544212341308594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2544212341308594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2169, 128]), torch.Size([1, 2169, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25648975372314453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3030514717102051  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2169, 128])
m.shape torch.Size([2087, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3059978485107422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3059978485107422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2087, 128]), torch.Size([1, 2087, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.308408260345459  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3681306838989258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2087, 128])
m.shape torch.Size([2036, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3712177276611328  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3712177276611328  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2036, 128]), torch.Size([1, 2036, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37315940856933594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4434032440185547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2036, 128])
m.shape torch.Size([1899, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.44786548614501953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.44786548614501953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1899, 128]), torch.Size([1, 1899, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.449676513671875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5288095474243164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1899, 128])
m.shape torch.Size([1766, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5337986946105957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5337986946105957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1766, 128]), torch.Size([1, 1766, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5354828834533691  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.619692325592041  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1766, 128])
m.shape torch.Size([1626, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6250529289245605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6250529289245605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1626, 128]), torch.Size([1, 1626, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6266036033630371  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7186846733093262  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1626, 128])
m.shape torch.Size([1518, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.724423885345459  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.724423885345459  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1518, 128]), torch.Size([1, 1518, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7258715629577637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8186516761779785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1518, 128])
m.shape torch.Size([21376, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9198565483093262  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9198565483093262  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21376, 128]), torch.Size([1, 21376, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9402422904968262  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.394954204559326  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21376, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2615442276000977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.298055648803711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.334567070007324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2977700233459473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([38285, 256])
first layer input nodes number: 97987
first layer output nodes number: 38285
edges number: 295186
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.335299491882324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3718109130859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3811492919921875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3811492919921875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([836, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4274721145629883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4274721145629883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4290666580200195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4423913955688477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([724, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.443026065826416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.443026065826416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 724, 256]), torch.Size([1, 724, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4444069862365723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.465242862701416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 724, 256])
m.shape torch.Size([573, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.46633243560791  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.46633243560791  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4674253463745117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4939613342285156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4954609870910645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4954609870910645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4963173866271973  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.523712635040283  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([384, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.525129795074463  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.525129795074463  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.525862216949463  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5530648231506348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([304, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5547266006469727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5547266006469727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5553064346313477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.580477237701416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([248, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5818562507629395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5818562507629395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.582329273223877  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.605980396270752  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([224, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.607466220855713  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.607466220855713  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.607893466949463  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.632246494293213  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([187, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.633650779724121  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.633650779724121  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.634007453918457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.656834602355957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.65818452835083  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.65818452835083  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6584877967834473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6800198554992676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.681572437286377  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.681572437286377  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6818299293518066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7019143104553223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([127, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7032504081726074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7032504081726074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7034926414489746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7240824699401855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([125, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7255234718322754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7255234718322754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.725761890411377  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7476963996887207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.748723030090332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.748723030090332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7488813400268555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.764554023742676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([64, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.765397548675537  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.765397548675537  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.765519618988037  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.778459072113037  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.779336452484131  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.779336452484131  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7794528007507324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.792600154876709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7937674522399902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7937674522399902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.793910503387451  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8110766410827637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.812166213989258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.812166213989258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8122901916503906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.828035354614258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8290157318115234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8290157318115234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8291244506835938  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8436927795410156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.844715118408203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.844715118408203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8448219299316406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.859882354736328  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.86045503616333  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.86045503616333  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8605141639709473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.869265079498291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8698277473449707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8698277473449707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8698811531066895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8781590461730957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.878795623779297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.878795623779297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8788528442382812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.88812255859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.888878345489502  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.888878345489502  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8889431953430176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.899902820587158  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([625, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.914888381958008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.914888381958008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 625, 256]), torch.Size([1, 625, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9160804748535156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.127498149871826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 625, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0873117446899414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0881590843200684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0890064239501953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0881166458129883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 38285
output nodes number: 5684
edges number: 47122
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.088444709777832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0884451866149902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06114530563354492  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 11 input nodes size: 97362
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09974431991577148  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09978675842285156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.052869319915771484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05540609359741211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05540609359741211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05540609359741211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97362, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05540609359741211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1529, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2001347541809082  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2001347541809082  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1529, 128]), torch.Size([1, 1529, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20159292221069336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21404123306274414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1529, 128])
m.shape torch.Size([2044, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21526145935058594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21526145935058594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2044, 128]), torch.Size([1, 2044, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2172107696533203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2464733123779297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2044, 128])
m.shape torch.Size([2127, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24854135513305664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24854135513305664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2127, 128]), torch.Size([1, 2127, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2515277862548828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.29727840423583984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2127, 128])
m.shape torch.Size([2122, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3003115653991699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3003115653991699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2122, 128]), torch.Size([1, 2122, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3029022216796875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3633260726928711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2122, 128])
m.shape torch.Size([2141, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36683034896850586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36683034896850586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2141, 128]), torch.Size([1, 2141, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36945152282714844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4454822540283203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2141, 128])
m.shape torch.Size([1825, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.44968271255493164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.44968271255493164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1825, 128]), torch.Size([1, 1825, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45142316818237305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5273995399475098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1825, 128])
m.shape torch.Size([1726, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5322904586791992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5322904586791992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1726, 128]), torch.Size([1, 1726, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5339365005493164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.616612434387207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1726, 128])
m.shape torch.Size([1686, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6222209930419922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6222209930419922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1686, 128]), torch.Size([1, 1686, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6238288879394531  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7161960601806641  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1686, 128])
m.shape torch.Size([1538, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7219924926757812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7219924926757812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1538, 128]), torch.Size([1, 1538, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7234592437744141  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8182621002197266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1538, 128])
m.shape torch.Size([21189, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9190912246704102  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9190912246704102  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21189, 128]), torch.Size([1, 21189, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9392986297607422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3920488357543945  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21189, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2589025497436523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.295072555541992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.331242561340332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2947897911071777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37927, 256])
first layer input nodes number: 97362
first layer output nodes number: 37927
edges number: 293443
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.33197021484375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.36814022064209  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.377567768096924  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.377567768096924  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([773, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.423811435699463  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.423811435699463  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 773, 256]), torch.Size([1, 773, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.425285816192627  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4376773834228516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 773, 256])
m.shape torch.Size([730, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4383974075317383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4383974075317383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 730, 256]), torch.Size([1, 730, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4397897720336914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.461306571960449  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 730, 256])
m.shape torch.Size([573, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4625535011291504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4625535011291504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.463646411895752  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.488804817199707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([485, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.490203380584717  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.490203380584717  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.491128444671631  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.518488883972168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([409, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.519991874694824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.519991874694824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5207719802856445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.549776077270508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.551116466522217  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.551116466522217  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5516886711120605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5777645111083984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([247, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5791406631469727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5791406631469727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5796117782592773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6031675338745117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([231, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.604708194732666  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.604708194732666  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6051487922668457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.630262851715088  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([217, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6319198608398438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6319198608398438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.632333755493164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.658823013305664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([158, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6604928970336914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6604928970336914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.660794258117676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6821908950805664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([151, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6836366653442383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6836366653442383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.683924674987793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7063894271850586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7074222564697266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7074222564697266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7076168060302734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.724153518676758  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([112, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7254557609558105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7254557609558105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7256693840026855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7453227043151855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7465076446533203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7465076446533203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7466907501220703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7648181915283203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([88, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.765995502471924  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.765995502471924  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7661633491516113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7839550971984863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([57, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.784748077392578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.784748077392578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7848567962646484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7971420288085938  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7979049682617188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7979049682617188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7980003356933594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8094444274902344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8103137016296387  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8103137016296387  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8104147911071777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8232531547546387  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8242225646972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8242225646972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8243255615234375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8381271362304688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.838883399963379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.838883399963379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.838963508605957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8502588272094727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.851248264312744  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.851248264312744  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8513455390930176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8657422065734863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.86637020111084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.86637020111084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.86643123626709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.87589168548584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8765244483947754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8765244483947754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8765816688537598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8858513832092285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8867688179016113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8867688179016113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8868470191955566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9000630378723145  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([602, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.914489269256592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.914489269256592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.915637493133545  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.120851516723633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 602, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0806541442871094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0815014839172363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0823488235473633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0814590454101562  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37927
output nodes number: 5684
edges number: 46933
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.081784248352051  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.081784725189209  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.060398101806640625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 12 input nodes size: 98018
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.052869319915771484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.052869319915771484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09974431991577148  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09978675842285156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055852413177490234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055852413177490234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055852413177490234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([98018, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055852413177490234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1647, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20064353942871094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20064353942871094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1647, 128]), torch.Size([1, 1647, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20221424102783203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2148914337158203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1647, 128])
m.shape torch.Size([2117, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2161250114440918  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2161250114440918  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21814393997192383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24904251098632812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([2274, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25128602981567383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25128602981567383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2274, 128]), torch.Size([1, 2274, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2539944648742676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3048868179321289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2274, 128])
m.shape torch.Size([2139, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3070068359375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3070068359375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2139, 128]), torch.Size([1, 2139, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3109264373779297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3715815544128418  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2139, 128])
m.shape torch.Size([2095, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3750572204589844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3750572204589844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2095, 128]), torch.Size([1, 2095, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37758588790893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45182371139526367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2095, 128])
m.shape torch.Size([1873, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45618343353271484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45618343353271484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1873, 128]), torch.Size([1, 1873, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45796966552734375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5357046127319336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1873, 128])
m.shape torch.Size([1740, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5406193733215332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5406193733215332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1740, 128]), torch.Size([1, 1740, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5422787666320801  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6254429817199707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1740, 128])
m.shape torch.Size([1585, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6306595802307129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6306595802307129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1585, 128]), torch.Size([1, 1585, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6321711540222168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7188363075256348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1585, 128])
m.shape torch.Size([1477, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.724419116973877  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.724419116973877  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1477, 128]), torch.Size([1, 1477, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.725827693939209  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8163371086120605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1477, 128])
m.shape torch.Size([21183, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9171953201293945  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9171953201293945  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21183, 128]), torch.Size([1, 21183, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9373970031738281  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3900842666625977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21183, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.257756233215332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2941198348999023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3304834365844727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2938356399536133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([38130, 256])
first layer input nodes number: 98018
first layer output nodes number: 38130
edges number: 292955
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3312158584594727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.367579460144043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.377009868621826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.377009868621826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([804, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4232873916625977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4232873916625977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.424820899963379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.438228130340576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 804, 256])
m.shape torch.Size([740, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4390711784362793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4390711784362793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 740, 256]), torch.Size([1, 740, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4404826164245605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.462705612182617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 740, 256])
m.shape torch.Size([600, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.463937759399414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.463937759399414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4650821685791016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.49196195602417  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([465, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.493177890777588  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.493177890777588  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4940648078918457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.520392894744873  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([392, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.522299289703369  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.522299289703369  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5230469703674316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.55122709274292  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([282, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5524797439575195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5524797439575195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5530176162719727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5791454315185547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([264, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5806527137756348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5806527137756348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5811562538146973  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6073336601257324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([194, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6085739135742188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6085739135742188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6089439392089844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.630035400390625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.631364345550537  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.631364345550537  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6316981315612793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6530604362487793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.654489040374756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.654489040374756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6548056602478027  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.677285671234131  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.678982734680176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.678982734680176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6792478561401367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.69992733001709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([109, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.701052188873291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.701052188873291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7012600898742676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7189316749572754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7201523780822754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7201523780822754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7203545570373535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.738955020904541  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([101, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.740213394165039  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.740213394165039  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.740406036376953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7594776153564453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.760563850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.760563850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7607202529907227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.777298927307129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7784509658813477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7784509658813477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7786035537719727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7958459854125977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([69, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7968974113464355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7968974113464355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7970290184020996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.812821865081787  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.814772605895996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.814772605895996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.814894676208496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.830397605895996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.831249713897705  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.831249713897705  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8313450813293457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8441243171691895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8450188636779785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8450188636779785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8451123237609863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.858290195465088  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.859111785888672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.859111785888672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.859193801879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8713321685791016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8719677925109863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8719677925109863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8720288276672363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8814892768859863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8824095726013184  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8824095726013184  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8824915885925293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.895778179168701  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.896360397338867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.896360397338867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.896411895751953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9051151275634766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([608, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.919698715209961  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.919698715209961  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.920858383178711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.1274046897888184  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 608, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.087198257446289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.088045597076416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.088892936706543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.088003158569336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 38130
output nodes number: 5684
edges number: 47069
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.088329792022705  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0883302688598633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.061087608337402344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 13 input nodes size: 96875
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09951210021972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09955453872680664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05263710021972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0551300048828125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0551300048828125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0551300048828125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([96875, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0551300048828125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1606, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.19704484939575195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.19704484939575195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1606, 128]), torch.Size([1, 1606, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.1985764503479004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21113920211791992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1606, 128])
m.shape torch.Size([2163, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21243715286254883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21243715286254883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2163, 128]), torch.Size([1, 2163, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21449995040893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24659299850463867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2163, 128])
m.shape torch.Size([2208, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24834680557250977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24834680557250977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2208, 128]), torch.Size([1, 2208, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25080442428588867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.29762792587280273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2208, 128])
m.shape torch.Size([2104, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30058813095092773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30058813095092773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2104, 128]), torch.Size([1, 2104, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30265092849731445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36267900466918945  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2104, 128])
m.shape torch.Size([1970, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36637258529663086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36637258529663086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1970, 128]), torch.Size([1, 1970, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36825132369995117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.43811750411987305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1970, 128])
m.shape torch.Size([1825, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4423995018005371  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4423995018005371  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1825, 128]), torch.Size([1, 1825, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4441399574279785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5198264122009277  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1825, 128])
m.shape torch.Size([1749, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5247941017150879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5247941017150879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1749, 128]), torch.Size([1, 1749, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5264620780944824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6100654602050781  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1749, 128])
m.shape torch.Size([1604, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6153502464294434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6153502464294434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1604, 128]), torch.Size([1, 1604, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.616879940032959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7044177055358887  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1604, 128])
m.shape torch.Size([1549, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7103004455566406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7103004455566406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1549, 128]), torch.Size([1, 1549, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7117776870727539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8064374923706055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1549, 128])
m.shape torch.Size([20709, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.904447078704834  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.904447078704834  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20709, 128]), torch.Size([1, 20709, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.924196720123291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3264212608337402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20709, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.1953887939453125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2311391830444336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2668895721435547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2308597564697266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37487, 256])
first layer input nodes number: 96875
first layer output nodes number: 37487
edges number: 287878
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.267613410949707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.303363800048828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.312535285949707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.312535285949707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([826, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.358828067779541  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.358828067779541  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 826, 256]), torch.Size([1, 826, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.360403537750244  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3736038208007812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 826, 256])
m.shape torch.Size([759, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3743438720703125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3743438720703125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 759, 256]), torch.Size([1, 759, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.375791549682617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.399447441101074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 759, 256])
m.shape torch.Size([563, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.400392532348633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.400392532348633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4014663696289062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4291324615478516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([447, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.430413246154785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.430413246154785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4312658309936523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.456610679626465  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([375, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.457986831665039  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.457986831665039  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4587020874023438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4857306480407715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([318, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.488140106201172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.488140106201172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4887466430664062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.519698143005371  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([279, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5212721824645996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5212721824645996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5218043327331543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.550384044647217  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([212, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.552337169647217  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.552337169647217  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.552741527557373  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5757899284362793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([183, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5771708488464355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5771708488464355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5775198936462402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5998587608337402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.601126194000244  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.601126194000244  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.601412296295166  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.621725559234619  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([129, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6229467391967773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6229467391967773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.62319278717041  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6423845291137695  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([134, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6438074111938477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6438074111938477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6440629959106445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.665787696838379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.667022228240967  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.667022228240967  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6672301292419434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.686357021331787  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([89, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.687450885772705  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.687450885772705  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6876206398010254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7044262886047363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.705321788787842  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.705321788787842  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.705451488494873  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7191996574401855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.72019624710083  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.72019624710083  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.720327854156494  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.735199451446533  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7363710403442383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7363710403442383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.736496925354004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.751603126525879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7526473999023438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7526473999023438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7527694702148438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7682723999023438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7692341804504395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7692341804504395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.769340991973877  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.783653736114502  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.784907817840576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.784907817840576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7850375175476074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8033251762390137  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.804269790649414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.804269790649414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8043651580810547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.818479537963867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.819087505340576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.819087505340576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8191466331481934  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8283114433288574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.829033851623535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.829033851623535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.829098701477051  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.839604377746582  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.840240955352783  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.840240955352783  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8402962684631348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.849644184112549  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([576, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8634567260742188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8634567260742188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8645553588867188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0693116188049316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 576, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.02913761138916  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.029984951019287  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.030832290649414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.029942512512207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37487
output nodes number: 5684
edges number: 46522
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.030264377593994  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0302648544311523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.059922218322753906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 14 input nodes size: 98005
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05263710021972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05263710021972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09951210021972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09955453872680664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055849552154541016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055849552154541016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055849552154541016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([98005, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055849552154541016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1661, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20064496994018555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20064496994018555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20222902297973633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2149348258972168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
m.shape torch.Size([2100, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21614551544189453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21614551544189453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2100, 128]), torch.Size([1, 2100, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21814823150634766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.24889278411865234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2100, 128])
m.shape torch.Size([2183, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25101423263549805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25101423263549805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2183, 128]), torch.Size([1, 2183, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25376033782958984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.301149845123291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2183, 128])
m.shape torch.Size([2119, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3038821220397949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3038821220397949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2119, 128]), torch.Size([1, 2119, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3062019348144531  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36670398712158203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2119, 128])
m.shape torch.Size([2073, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.370635986328125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.370635986328125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2073, 128]), torch.Size([1, 2073, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.372647762298584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.44658613204956055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2073, 128])
m.shape torch.Size([1882, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45031213760375977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45031213760375977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1882, 128]), torch.Size([1, 1882, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45210695266723633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5308327674865723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1882, 128])
m.shape torch.Size([1727, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5356998443603516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5356998443603516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1727, 128]), torch.Size([1, 1727, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5373468399047852  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6202874183654785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1727, 128])
m.shape torch.Size([1621, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6256475448608398  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6256475448608398  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1621, 128]), torch.Size([1, 1621, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6271934509277344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.715886116027832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1621, 128])
m.shape torch.Size([1464, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7222771644592285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7222771644592285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1464, 128]), torch.Size([1, 1464, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7236733436584473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.813835620880127  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1464, 128])
m.shape torch.Size([21188, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9147000312805176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9147000312805176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21188, 128]), torch.Size([1, 21188, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9349064826965332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.387646198272705  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21188, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2548022270202637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2910590171813965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3273158073425293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2907752990722656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([38018, 256])
first layer input nodes number: 98005
first layer output nodes number: 38018
edges number: 292656
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3280482292175293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.364305019378662  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3737330436706543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3737330436706543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([847, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.420050621032715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.420050621032715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 847, 256]), torch.Size([1, 847, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.421666145324707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.434994697570801  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 847, 256])
m.shape torch.Size([725, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.435600757598877  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.435600757598877  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.436983585357666  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4577717781066895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([601, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4592971801757812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4592971801757812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4604434967041016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4863243103027344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([436, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.488314628601074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.488314628601074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4891462326049805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5132627487182617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([407, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.514802932739258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.514802932739258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5155792236328125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5439186096191406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([287, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5451855659484863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5451855659484863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5457329750061035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5702767372131348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([240, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.57161808013916  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.57161808013916  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.572075843811035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.594964027404785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([211, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.596357822418213  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.596357822418213  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5967602729797363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6196999549865723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([181, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6213479042053223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6213479042053223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6216931343078613  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6437878608703613  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.645143508911133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.645143508911133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.64544677734375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6669788360595703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6682019233703613  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6682019233703613  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.668449878692627  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6877903938293457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([124, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6890969276428223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6890969276428223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.689333438873291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7094368934631348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7104806900024414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7104806900024414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.710658073425293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7269773483276367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([97, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.728194236755371  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.728194236755371  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.728379249572754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7466955184936523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7477564811706543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7477564811706543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7479090690612793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7640833854675293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7650561332702637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7650561332702637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.765185832977295  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.779841899871826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7813220024108887  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7813220024108887  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7814478874206543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7965540885925293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([68, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.797667980194092  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.797667980194092  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.797797679901123  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.814269542694092  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.815062999725342  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.815062999725342  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.815152645111084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.827165126800537  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.828023910522461  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.828023910522461  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.828113555908203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8407535552978516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([59, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.841899871826172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.841899871826172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.842012405395508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8586673736572266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.859309196472168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.859309196472168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.859372138977051  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8691282272338867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8697824478149414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8697824478149414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8698415756225586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.879420280456543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8801984786987305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8801984786987305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.880265235900879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.891547203063965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([612, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.906219482421875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.906219482421875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9073867797851562  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.1148386001586914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 612, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0746288299560547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0754761695861816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0763235092163086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0754337310791016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 38018
output nodes number: 5684
edges number: 46958
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0757598876953125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0757603645324707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06122446060180664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 15 input nodes size: 96917
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0995321273803711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.09957456588745117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.052657127380371094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055133819580078125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055133819580078125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055133819580078125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([96917, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.055133819580078125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1591, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.19702863693237305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.19702863693237305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.1985459327697754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21102285385131836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([2110, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2123708724975586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2123708724975586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2110, 128]), torch.Size([1, 2110, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21438312530517578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2465047836303711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2110, 128])
m.shape torch.Size([2131, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2478957176208496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2478957176208496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2131, 128]), torch.Size([1, 2131, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25056934356689453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.29694318771362305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2131, 128])
m.shape torch.Size([2140, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30000877380371094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30000877380371094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2140, 128]), torch.Size([1, 2140, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30258655548095703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36328792572021484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2140, 128])
m.shape torch.Size([1999, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3670334815979004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3670334815979004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1999, 128]), torch.Size([1, 1999, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3689398765563965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.43897199630737305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1999, 128])
m.shape torch.Size([1841, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4432859420776367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4432859420776367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1841, 128]), torch.Size([1, 1841, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4450416564941406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5206689834594727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1841, 128])
m.shape torch.Size([1658, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5253252983093262  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5253252983093262  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1658, 128]), torch.Size([1, 1658, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5269064903259277  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6082863807678223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1658, 128])
m.shape torch.Size([1622, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6136832237243652  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6136832237243652  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1622, 128]), torch.Size([1, 1622, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6152300834655762  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7072081565856934  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1622, 128])
m.shape torch.Size([1494, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7128462791442871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7128462791442871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.714271068572998  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8055696487426758  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([20677, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9034528732299805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9034528732299805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20677, 128]), torch.Size([1, 20677, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9231719970703125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3232297897338867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20677, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.1931233406066895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2286601066589355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2641968727111816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.228382110595703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37263, 256])
first layer input nodes number: 96917
first layer output nodes number: 37263
edges number: 286603
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.264921188354492  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3004579544067383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.309843063354492  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.309843063354492  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([858, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.354750633239746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.354750633239746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 858, 256]), torch.Size([1, 858, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.356387138366699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3697614669799805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 858, 256])
m.shape torch.Size([776, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.370532512664795  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.370532512664795  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 776, 256]), torch.Size([1, 776, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3720126152038574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3950119018554688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 776, 256])
m.shape torch.Size([604, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3960485458374023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3960485458374023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.397200584411621  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4239487648010254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 604, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.425149440765381  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.425149440765381  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4260058403015137  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4514222145080566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([378, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.452810764312744  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.452810764312744  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4535317420959473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4813880920410156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([311, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4837727546691895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4837727546691895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.484365940093994  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5168046951293945  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([238, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5181097984313965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5181097984313965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.518563747406006  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5412611961364746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([214, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.542679786682129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.542679786682129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.543087959289551  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5663537979125977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5676984786987305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5676984786987305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.568039894104004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.589890480041504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.591315269470215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.591315269470215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5916318893432617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.61411190032959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([110, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.615147113800049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.615147113800049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.615356922149658  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6317219734191895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([119, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6329898834228516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6329898834228516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6332168579101562  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6525096893310547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6543755531311035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6543755531311035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6545777320861816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.673178195953369  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6741933822631836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6741933822631836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6743478775024414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.689642906188965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6907482147216797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6907482147216797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6909046173095703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7074832916259766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.708543300628662  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.708543300628662  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7086844444274902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7246336936950684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7254295349121094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7254295349121094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7255306243896484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.737661361694336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7387008666992188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7387008666992188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.738821029663086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7540817260742188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7550625801086426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7550625801086426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.755171298980713  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7697396278381348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.770531177520752  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.770531177520752  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7706151008605957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7824482917785645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.783153533935547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.783153533935547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.783224105834961  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.793668746948242  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7943100929260254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7943100929260254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7943711280822754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8038315773010254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8043980598449707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8043980598449707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8044495582580566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8127923011779785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8135743141174316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8135743141174316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.81364107131958  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.824923038482666  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([588, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8390183448791504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8390183448791504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.840139865875244  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.048912525177002  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 588, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.010788917541504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0116357803344727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0124826431274414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0115933418273926  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5681, 40])
input nodes number: 37263
output nodes number: 5681
edges number: 45627
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.011913299560547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.011913776397705  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06051206588745117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06606245040893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06606245040893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02944059669971466 |0.02411705255508423 |0.15338103473186493 |9.922683238983154e-05 |0.07343079149723053 |0.006013631820678711 |
----------------------------------------------------------pseudo_mini_loss sum 5.336330413818359
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2165113
Number of first layer input nodes during this epoch:  1560465
Number of first layer output nodes during this epoch:  604648
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06606197357177734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029443740844726562
number of batches is  16
batch size is  5684
random selection method spend 0.008157968521118164
time for parepare:  0.02249884605407715
local_output_nid generation:  0.0022847652435302734
local_in_edges_tensor generation:  0.010485172271728516
mini_batch_src_global generation:  0.002795696258544922
r_  generation:  0.016892433166503906
local_output_nid generation:  0.0032215118408203125
local_in_edges_tensor generation:  0.0019626617431640625
mini_batch_src_global generation:  0.0018672943115234375
r_  generation:  0.016533374786376953
local_output_nid generation:  0.003047466278076172
local_in_edges_tensor generation:  0.0014865398406982422
mini_batch_src_global generation:  0.0011990070343017578
r_  generation:  0.016512393951416016
local_output_nid generation:  0.0029840469360351562
local_in_edges_tensor generation:  0.001481771469116211
mini_batch_src_global generation:  0.0012021064758300781
r_  generation:  0.016604900360107422
local_output_nid generation:  0.002917051315307617
local_in_edges_tensor generation:  0.0014448165893554688
mini_batch_src_global generation:  0.0012497901916503906
r_  generation:  0.017207622528076172
local_output_nid generation:  0.0028891563415527344
local_in_edges_tensor generation:  0.0013959407806396484
mini_batch_src_global generation:  0.0012371540069580078
r_  generation:  0.01714038848876953
local_output_nid generation:  0.002869844436645508
local_in_edges_tensor generation:  0.001432657241821289
mini_batch_src_global generation:  0.0013039112091064453
r_  generation:  0.017552614212036133
local_output_nid generation:  0.0028696060180664062
local_in_edges_tensor generation:  0.001476287841796875
mini_batch_src_global generation:  0.0013208389282226562
r_  generation:  0.018091440200805664
local_output_nid generation:  0.0028867721557617188
local_in_edges_tensor generation:  0.0014650821685791016
mini_batch_src_global generation:  0.0013134479522705078
r_  generation:  0.01711440086364746
local_output_nid generation:  0.0028913021087646484
local_in_edges_tensor generation:  0.0014393329620361328
mini_batch_src_global generation:  0.0013191699981689453
r_  generation:  0.018032312393188477
local_output_nid generation:  0.0028874874114990234
local_in_edges_tensor generation:  0.001444101333618164
mini_batch_src_global generation:  0.0013554096221923828
r_  generation:  0.01771688461303711
local_output_nid generation:  0.002899169921875
local_in_edges_tensor generation:  0.0014781951904296875
mini_batch_src_global generation:  0.001383066177368164
r_  generation:  0.01814413070678711
local_output_nid generation:  0.0029833316802978516
local_in_edges_tensor generation:  0.001516580581665039
mini_batch_src_global generation:  0.0013709068298339844
r_  generation:  0.018124818801879883
local_output_nid generation:  0.002910137176513672
local_in_edges_tensor generation:  0.001443624496459961
mini_batch_src_global generation:  0.0013523101806640625
r_  generation:  0.018103599548339844
local_output_nid generation:  0.002895832061767578
local_in_edges_tensor generation:  0.0014226436614990234
mini_batch_src_global generation:  0.0013799667358398438
r_  generation:  0.018126726150512695
local_output_nid generation:  0.0029039382934570312
local_in_edges_tensor generation:  0.0014281272888183594
mini_batch_src_global generation:  0.0013890266418457031
r_  generation:  0.017668962478637695
----------------------check_connections_block total spend ----------------------------- 0.4784977436065674
generate_one_block  0.03396129608154297
generate_one_block  0.026682376861572266
generate_one_block  0.025533676147460938
generate_one_block  0.025815486907958984
generate_one_block  0.026665687561035156
generate_one_block  0.025171518325805664
generate_one_block  0.025985240936279297
generate_one_block  0.025685787200927734
generate_one_block  0.02579951286315918
generate_one_block  0.026083707809448242
generate_one_block  0.02565145492553711
generate_one_block  0.029622793197631836
generate_one_block  0.02643895149230957
generate_one_block  0.025979995727539062
generate_one_block  0.026225566864013672
generate_one_block  0.025415420532226562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022522926330566406
gen group dst list time:  0.018504619598388672
time for parepare:  0.01861095428466797
local_output_nid generation:  0.007843255996704102
local_in_edges_tensor generation:  0.01686716079711914
mini_batch_src_global generation:  0.008763790130615234
r_  generation:  0.10136866569519043
local_output_nid generation:  0.013381242752075195
local_in_edges_tensor generation:  0.012521028518676758
mini_batch_src_global generation:  0.014922857284545898
r_  generation:  0.10911297798156738
local_output_nid generation:  0.01168370246887207
local_in_edges_tensor generation:  0.009832143783569336
mini_batch_src_global generation:  0.012924671173095703
r_  generation:  0.10984206199645996
local_output_nid generation:  0.011323690414428711
local_in_edges_tensor generation:  0.008902788162231445
mini_batch_src_global generation:  0.012855768203735352
r_  generation:  0.11379671096801758
local_output_nid generation:  0.011334896087646484
local_in_edges_tensor generation:  0.008646488189697266
mini_batch_src_global generation:  0.015114784240722656
r_  generation:  0.11522889137268066
local_output_nid generation:  0.011211633682250977
local_in_edges_tensor generation:  0.010841131210327148
mini_batch_src_global generation:  0.012599468231201172
r_  generation:  0.11458587646484375
local_output_nid generation:  0.01143193244934082
local_in_edges_tensor generation:  0.010209083557128906
mini_batch_src_global generation:  0.013426542282104492
r_  generation:  0.11983966827392578
local_output_nid generation:  0.011369943618774414
local_in_edges_tensor generation:  0.009048223495483398
mini_batch_src_global generation:  0.015806913375854492
r_  generation:  0.12714099884033203
local_output_nid generation:  0.014546394348144531
local_in_edges_tensor generation:  0.011093378067016602
mini_batch_src_global generation:  0.013424873352050781
r_  generation:  0.11828851699829102
local_output_nid generation:  0.011642932891845703
local_in_edges_tensor generation:  0.009067058563232422
mini_batch_src_global generation:  0.013082742691040039
r_  generation:  0.11765408515930176
local_output_nid generation:  0.011594533920288086
local_in_edges_tensor generation:  0.008905172348022461
mini_batch_src_global generation:  0.014441967010498047
r_  generation:  0.11718368530273438
local_output_nid generation:  0.011740446090698242
local_in_edges_tensor generation:  0.008763790130615234
mini_batch_src_global generation:  0.01345062255859375
r_  generation:  0.11765098571777344
local_output_nid generation:  0.011720418930053711
local_in_edges_tensor generation:  0.009549617767333984
mini_batch_src_global generation:  0.013412952423095703
r_  generation:  0.11771464347839355
local_output_nid generation:  0.011629343032836914
local_in_edges_tensor generation:  0.008968591690063477
mini_batch_src_global generation:  0.013286352157592773
r_  generation:  0.11658191680908203
local_output_nid generation:  0.011904716491699219
local_in_edges_tensor generation:  0.009096622467041016
mini_batch_src_global generation:  0.015533208847045898
r_  generation:  0.12077927589416504
local_output_nid generation:  0.01160883903503418
local_in_edges_tensor generation:  0.008823156356811523
mini_batch_src_global generation:  0.031514883041381836
r_  generation:  0.11878371238708496
----------------------check_connections_block total spend ----------------------------- 2.905851125717163
generate_one_block  0.15170645713806152
generate_one_block  0.13731050491333008
generate_one_block  0.13555145263671875
generate_one_block  0.13912057876586914
generate_one_block  0.13813185691833496
generate_one_block  0.13581156730651855
generate_one_block  0.1415266990661621
generate_one_block  0.13807344436645508
generate_one_block  0.13786983489990234
generate_one_block  0.14002084732055664
generate_one_block  0.14286208152770996
generate_one_block  0.13919830322265625
generate_one_block  0.1456451416015625
generate_one_block  0.15964055061340332
generate_one_block  0.14243865013122559
generate_one_block  0.13896822929382324
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06606197357177734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

connection checking time:  2.905851125717163
block generation total time  2.26387619972229
average batch blocks generation time:  0.14149226248264313
block dataloader generation time/epoch 6.319405794143677
pseudo mini batch 0 input nodes size: 96926
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05820608139038086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05820608139038086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10508108139038086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10512351989746094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.058867454528808594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06134605407714844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06134605407714844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06134605407714844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([96926, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06134605407714844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1640, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2032642364501953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2032642364501953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1640, 128]), torch.Size([1, 1640, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20482826232910156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21749305725097656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1640, 128])
m.shape torch.Size([2095, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21881675720214844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21881675720214844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2095, 128]), torch.Size([1, 2095, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22081470489501953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25284290313720703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2095, 128])
m.shape torch.Size([2156, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2541980743408203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2541980743408203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2156, 128]), torch.Size([1, 2156, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25792503356933594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3045063018798828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2156, 128])
m.shape torch.Size([2125, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30753135681152344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30753135681152344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2125, 128]), torch.Size([1, 2125, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30999755859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37036752700805664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2125, 128])
m.shape torch.Size([2015, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37358570098876953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37358570098876953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2015, 128]), torch.Size([1, 2015, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3755073547363281  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4456310272216797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2015, 128])
m.shape torch.Size([1751, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4496798515319824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4496798515319824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1751, 128]), torch.Size([1, 1751, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45134973526000977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5240025520324707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1751, 128])
m.shape torch.Size([1697, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.528831958770752  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.528831958770752  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1697, 128]), torch.Size([1, 1697, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5304503440856934  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.612518310546875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1697, 128])
m.shape torch.Size([1619, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6178851127624512  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6178851127624512  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1619, 128]), torch.Size([1, 1619, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6194291114807129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7074370384216309  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1619, 128])
m.shape torch.Size([1460, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7129306793212891  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7129306793212891  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1460, 128]), torch.Size([1, 1460, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7143230438232422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.803673267364502  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1460, 128])
m.shape torch.Size([20731, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9025864601135254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9025864601135254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20731, 128]), torch.Size([1, 20731, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9223570823669434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.326071262359619  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20731, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.195845603942871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2314071655273438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2669687271118164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2311291694641113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37289, 256])
first layer input nodes number: 96926
first layer output nodes number: 37289
edges number: 286660
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.267693042755127  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3032546043395996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.312614917755127  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.312614917755127  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([845, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3577370643615723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3577370643615723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 845, 256]), torch.Size([1, 845, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.359348773956299  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3734846115112305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 845, 256])
m.shape torch.Size([730, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.37416410446167  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.37416410446167  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 730, 256]), torch.Size([1, 730, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.375556468963623  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3970093727111816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 730, 256])
m.shape torch.Size([591, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3980259895324707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3980259895324707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.399153232574463  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.424689769744873  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([442, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.425868511199951  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.425868511199951  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4267115592956543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4519357681274414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([402, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.453446388244629  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.453446388244629  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4542131423950195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.482313632965088  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([291, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.483922004699707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.483922004699707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4844770431518555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5141377449035645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([256, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.51558256149292  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.51558256149292  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.51607084274292  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.54048490524292  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([238, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5420708656311035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5420708656311035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.542524814605713  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5683999061584473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([171, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5696592330932617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5696592330932617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5699853897094727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5908594131469727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([172, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5923495292663574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5923495292663574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.592677593231201  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6159701347351074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([164, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6175403594970703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6175403594970703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6178531646728516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.642251968383789  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([132, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.643627643585205  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.643627643585205  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6438794136047363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6652798652648926  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6666393280029297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6666393280029297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.666851043701172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.686328887939453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([82, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6877059936523438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6877059936523438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6878623962402344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7033462524414062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([69, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7042794227600098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7042794227600098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.704411029815674  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7183613777160645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([61, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.719233989715576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.719233989715576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7193503379821777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7324976921081543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7333383560180664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7333383560180664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.733443260192871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7460317611694336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7474617958068848  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7474617958068848  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7475762367248535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7621102333068848  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7635369300842285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7635369300842285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.763662815093994  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.780531406402588  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7812376022338867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7812376022338867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.781313896179199  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7920713424682617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.793002128601074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.793002128601074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.793093681335449  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.806643486022949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.807401657104492  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.807401657104492  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.807474136352539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8187084197998047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.819401741027832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.819401741027832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.819464683532715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8296613693237305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8303680419921875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8303680419921875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8304290771484375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8407440185546875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([555, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8540492057800293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8540492057800293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 555, 256]), torch.Size([1, 555, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8551077842712402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0430145263671875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 555, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.004045009613037  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.004892349243164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.005739688873291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.004849910736084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37289
output nodes number: 5684
edges number: 45862
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0051708221435547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.005171775817871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06670284271240234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 1 input nodes size: 97353
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10529041290283203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10533285140991211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05841541290283203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06094551086425781  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06094551086425781  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06094551086425781  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97353, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06094551086425781  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1606, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20571088790893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20571088790893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1606, 128]), torch.Size([1, 1606, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20724248886108398  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21984529495239258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1606, 128])
m.shape torch.Size([2089, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22107172012329102  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22107172012329102  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22306394577026367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2537088394165039  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
m.shape torch.Size([2150, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25578832626342773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25578832626342773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2150, 128]), torch.Size([1, 2150, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25857114791870117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30582427978515625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2150, 128])
m.shape torch.Size([2123, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3084068298339844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3084068298339844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2123, 128]), torch.Size([1, 2123, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3108859062194824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37171459197998047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2123, 128])
m.shape torch.Size([2056, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37560415267944336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37560415267944336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2056, 128]), torch.Size([1, 2056, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3776125907897949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45104360580444336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2056, 128])
m.shape torch.Size([1900, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4548201560974121  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4548201560974121  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1900, 128]), torch.Size([1, 1900, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.456632137298584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5363097190856934  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1900, 128])
m.shape torch.Size([1765, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.541295051574707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.541295051574707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1765, 128]), torch.Size([1, 1765, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5429782867431641  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6273140907287598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1765, 128])
m.shape torch.Size([1600, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6325759887695312  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6325759887695312  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1600, 128]), torch.Size([1, 1600, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6341018676757812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7216682434082031  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1600, 128])
m.shape torch.Size([1498, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7282295227050781  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7282295227050781  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1498, 128]), torch.Size([1, 1498, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7296581268310547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8210887908935547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1498, 128])
m.shape torch.Size([21140, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9219369888305664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9219369888305664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21140, 128]), torch.Size([1, 21140, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9429769515991211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3952131271362305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21140, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.262472629547119  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.298642635345459  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.334812641143799  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2983598709106445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37927, 256])
first layer input nodes number: 97353
first layer output nodes number: 37927
edges number: 292443
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.335540294647217  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3717103004455566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3811612129211426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3811612129211426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([828, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.427459239959717  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.427459239959717  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4290385246276855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.442134380340576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([729, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4427671432495117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4427671432495117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 729, 256]), torch.Size([1, 729, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.444157600402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4650144577026367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 729, 256])
m.shape torch.Size([586, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4667205810546875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4667205810546875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4678382873535156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4948835372924805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([445, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.496035575866699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.496035575866699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.496884346008301  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5228872299194336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([400, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5251388549804688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5251388549804688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5259017944335938  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.55416202545166  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([314, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.555591583251953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.555591583251953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5561904907226562  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.582613468170166  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([242, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.583942413330078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.583942413330078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5844039916992188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.60748291015625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([202, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6088056564331055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6088056564331055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6091909408569336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6311521530151367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([182, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6325340270996094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6325340270996094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6328811645507812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6550979614257812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6564526557922363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6564526557922363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6567559242248535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.678287982940674  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6801657676696777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6801657676696777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6804213523864746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.700356960296631  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7015786170959473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7015786170959473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7018017768859863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7207703590393066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.721820831298828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.721820831298828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7219982147216797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7383174896240234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([104, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.739628314971924  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.739628314971924  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7398266792297363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.759464740753174  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7604827880859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7604827880859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.760629653930664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7761974334716797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.777240753173828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.777240753173828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.777374267578125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.792461395263672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.793468952178955  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.793468952178955  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.793591022491455  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.808239459991455  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8094067573547363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8094067573547363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.809542179107666  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8267407417297363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8276047706604004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8276047706604004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.827702045440674  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8407368659973145  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([63, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8418993949890137  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8418993949890137  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.842019557952881  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8589625358581543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.859935760498047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.859935760498047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8600311279296875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8741455078125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.874838352203369  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.874838352203369  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8749051094055176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8852524757385254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8861255645751953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8861255645751953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8862037658691406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8988723754882812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8995485305786133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8995485305786133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8996076583862305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.909600257873535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([596, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.923891544342041  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.923891544342041  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9250283241271973  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.1297225952148438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 596, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0895299911499023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0903773307800293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0912246704101562  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.090334892272949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37927
output nodes number: 5684
edges number: 47066
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0906600952148438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.090660572052002  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06641626358032227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 2 input nodes size: 97661
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05841541290283203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05841541290283203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10529041290283203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10533285140991211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.061357975006103516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.061357975006103516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.061357975006103516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97661, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.061357975006103516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1633, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20328378677368164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20328378677368164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1633, 128]), torch.Size([1, 1633, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20484113693237305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21750688552856445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1633, 128])
m.shape torch.Size([2071, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21879196166992188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21879196166992188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2071, 128]), torch.Size([1, 2071, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22076702117919922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2528085708618164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2071, 128])
m.shape torch.Size([2157, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25405073165893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25405073165893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2157, 128]), torch.Size([1, 2157, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25786924362182617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3045034408569336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2157, 128])
m.shape torch.Size([2145, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30756616592407227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30756616592407227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2145, 128]), torch.Size([1, 2145, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.310028076171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3707089424133301  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2145, 128])
m.shape torch.Size([2030, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37405824661254883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37405824661254883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2030, 128]), torch.Size([1, 2030, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3759942054748535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.44620370864868164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2030, 128])
m.shape torch.Size([1781, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4503312110900879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4503312110900879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1781, 128]), torch.Size([1, 1781, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4520297050476074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5254826545715332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1781, 128])
m.shape torch.Size([1804, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5306549072265625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5306549072265625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1804, 128]), torch.Size([1, 1804, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5323753356933594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6183967590332031  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1804, 128])
m.shape torch.Size([1605, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6236591339111328  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6236591339111328  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1605, 128]), torch.Size([1, 1605, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6251897811889648  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7128152847290039  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1605, 128])
m.shape torch.Size([1514, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7185473442077637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7185473442077637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1514, 128]), torch.Size([1, 1514, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7199912071228027  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8123984336853027  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1514, 128])
m.shape torch.Size([20714, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9112858772277832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9112858772277832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20714, 128]), torch.Size([1, 20714, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9310402870178223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3336033821105957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20714, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2027463912963867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2384653091430664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.274184226989746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2381858825683594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37454, 256])
first layer input nodes number: 97661
first layer output nodes number: 37454
edges number: 287896
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.274913787841797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3106327056884766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.319835662841797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.319835662841797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([851, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.365097999572754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.365097999572754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 851, 256]), torch.Size([1, 851, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3667211532592773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3799962997436523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 851, 256])
m.shape torch.Size([688, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.380678176879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.380678176879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.381990432739258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4018373489379883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([560, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4028658866882324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4028658866882324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 560, 256]), torch.Size([1, 560, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4039340019226074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.428811550140381  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 560, 256])
m.shape torch.Size([489, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4303293228149414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4303293228149414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4312620162963867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.458693504333496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([391, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.460106372833252  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.460106372833252  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4608521461486816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.487928867340088  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([299, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4893503189086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4893503189086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4899206161499023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5192975997924805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([269, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5208702087402344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5208702087402344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.521383285522461  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5503897666931152  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([237, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5519556999206543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5519556999206543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.552407741546631  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.578174114227295  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([203, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5797042846679688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5797042846679688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5800914764404297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6048717498779297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([197, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.606571674346924  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.606571674346924  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.606947422027588  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6336255073547363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.634854793548584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.634854793548584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.635110378265381  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.655045986175537  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([110, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.656187057495117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.656187057495117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6563968658447266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6742305755615234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6752877235412598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6752877235412598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6754651069641113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.691784381866455  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6929874420166016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6929874420166016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6931705474853516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7112979888916016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7123889923095703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7123889923095703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.712545394897461  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.729124069213867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7302002906799316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7302002906799316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.730329990386963  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.744986057281494  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([69, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.746048927307129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.746048927307129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.746180534362793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7619733810424805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.762876510620117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.762876510620117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7629833221435547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.776548385620117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7773900032043457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7773900032043457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7774834632873535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7900071144104004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.790825843811035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.790825843811035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7909116744995117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.803013801574707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8036575317382812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8036575317382812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.803722381591797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8133201599121094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.81392240524292  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.81392240524292  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8139796257019043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8228487968444824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.823395252227783  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.823395252227783  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8234448432922363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8314785957336426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8323073387145996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8323073387145996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8323779106140137  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8443045616149902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([571, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.85798978805542  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.85798978805542  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.859078884124756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0640225410461426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 571, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.024904251098633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0257515907287598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0265989303588867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0257091522216797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37454
output nodes number: 5684
edges number: 46000
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.026031017303467  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.026031494140625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06613969802856445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 3 input nodes size: 97046
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10514402389526367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10518646240234375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05826902389526367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.060770511627197266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.060770511627197266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.060770511627197266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97046, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.060770511627197266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1586, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20470333099365234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20470333099365234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1586, 128]), torch.Size([1, 1586, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20621585845947266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21873092651367188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1586, 128])
m.shape torch.Size([2046, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2199258804321289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2199258804321289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2046, 128]), torch.Size([1, 2046, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2218770980834961  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2511568069458008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2046, 128])
m.shape torch.Size([2131, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25409507751464844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25409507751464844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2131, 128]), torch.Size([1, 2131, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25693511962890625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30272769927978516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2131, 128])
m.shape torch.Size([2148, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30580854415893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30580854415893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2148, 128]), torch.Size([1, 2148, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30839014053344727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3691849708557129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2148, 128])
m.shape torch.Size([2127, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3732318878173828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3732318878173828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2127, 128]), torch.Size([1, 2127, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.375272274017334  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45076751708984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2127, 128])
m.shape torch.Size([1915, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4552321434020996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4552321434020996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1915, 128]), torch.Size([1, 1915, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4570584297180176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5355887413024902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1915, 128])
m.shape torch.Size([1714, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5403966903686523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5403966903686523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1714, 128]), torch.Size([1, 1714, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5420312881469727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6267814636230469  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1714, 128])
m.shape torch.Size([1541, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6318426132202148  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6318426132202148  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1541, 128]), torch.Size([1, 1541, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6333122253417969  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7175722122192383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1541, 128])
m.shape torch.Size([1467, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7231330871582031  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7231330871582031  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1467, 128]), torch.Size([1, 1467, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7245321273803711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8141136169433594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1467, 128])
m.shape torch.Size([20889, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9130206108093262  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9130206108093262  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20889, 128]), torch.Size([1, 20889, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9329419136047363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3473544120788574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20889, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2154455184936523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2512693405151367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.287093162536621  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2509894371032715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37564, 256])
first layer input nodes number: 97046
first layer output nodes number: 37564
edges number: 289207
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.287818431854248  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3236422538757324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.332740306854248  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.332740306854248  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([831, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3790364265441895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3790364265441895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 831, 256]), torch.Size([1, 831, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3806214332580566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.393301486968994  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 831, 256])
m.shape torch.Size([745, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3941397666931152  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3941397666931152  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 745, 256]), torch.Size([1, 745, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3955607414245605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4175920486450195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 745, 256])
m.shape torch.Size([555, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.418790340423584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.418790340423584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 555, 256]), torch.Size([1, 555, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.419848918914795  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4457850456237793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 555, 256])
m.shape torch.Size([450, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4471654891967773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4471654891967773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.448023796081543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4743080139160156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([426, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4765992164611816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4765992164611816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4774117469787598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5066628456115723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([298, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5079751014709473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5079751014709473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5085434913635254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5336365699768066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([270, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5351691246032715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5351691246032715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.535684108734131  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5651259422302246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([211, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.56649112701416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.56649112701416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5668935775756836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5898332595825195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([174, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5920372009277344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5920372009277344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5923690795898438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6136093139648438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([162, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6150007247924805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6150007247924805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.615309715270996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6372480392456055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.638383388519287  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.638383388519287  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6386160850524902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.656766414642334  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6581034660339355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6581034660339355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.65834379196167  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.678771495819092  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([105, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6799635887145996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6799635887145996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.680163860321045  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6985888481140137  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([89, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6996865272521973  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6996865272521973  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6998562812805176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7166619300842285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([83, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.717773914337158  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.717773914337158  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7179322242736816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.734713077545166  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([82, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7362704277038574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7362704277038574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.736426830291748  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7541003227233887  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.755067825317383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.755067825317383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.755189895629883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.769838333129883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([66, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7709193229675293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7709193229675293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.771045207977295  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7870326042175293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7879014015197754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7879014015197754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.787998676300049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8010334968566895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.801927089691162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.801927089691162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.80202054977417  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8151984214782715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.815979480743408  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.815979480743408  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8160576820373535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8276314735412598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8283963203430176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8283963203430176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8284687995910645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.83970308303833  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.84037446975708  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.84037446975708  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.84043550491333  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.85032320022583  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.851077079772949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.851077079772949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.851141929626465  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8621015548706055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([580, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8760056495666504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8760056495666504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8771119117736816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0805020332336426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 580, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0403246879577637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0411720275878906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0420193672180176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0411295890808105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37564
output nodes number: 5684
edges number: 46464
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.041451930999756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.041452407836914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06618881225585938  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 4 input nodes size: 97797
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05826902389526367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05826902389526367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10514402389526367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10518646240234375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06137800216674805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06137800216674805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06137800216674805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97797, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06137800216674805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1593, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20529699325561523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20529699325561523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1593, 128]), torch.Size([1, 1593, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2068161964416504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21937799453735352  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1593, 128])
m.shape torch.Size([2077, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22059917449951172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22059917449951172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2077, 128]), torch.Size([1, 2077, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2225799560546875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.253873348236084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2077, 128])
m.shape torch.Size([2200, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2560300827026367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2560300827026367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2200, 128]), torch.Size([1, 2200, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.25865936279296875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30588293075561523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2200, 128])
m.shape torch.Size([2146, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.308927059173584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.308927059173584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2146, 128]), torch.Size([1, 2146, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.31099939346313477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37122297286987305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2146, 128])
m.shape torch.Size([2106, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37522077560424805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.37522077560424805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2106, 128]), torch.Size([1, 2106, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3777298927307129  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45226526260375977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2106, 128])
m.shape torch.Size([1961, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45635175704956055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45635175704956055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1961, 128]), torch.Size([1, 1961, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4582219123840332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5402979850769043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1961, 128])
m.shape torch.Size([1761, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5452408790588379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5452408790588379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1761, 128]), torch.Size([1, 1761, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5469202995300293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6334133148193359  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1761, 128])
m.shape torch.Size([1609, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6387114524841309  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6387114524841309  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1609, 128]), torch.Size([1, 1609, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6402459144592285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7279582023620605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1609, 128])
m.shape torch.Size([1509, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7336668968200684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7336668968200684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1509, 128]), torch.Size([1, 1509, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7351059913635254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8272080421447754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1509, 128])
m.shape torch.Size([20805, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9260978698730469  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9260978698730469  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20805, 128]), torch.Size([1, 20805, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9459390640258789  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.354663848876953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20805, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2231898307800293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.259207248687744  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.295224666595459  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.258925437927246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37767, 256])
first layer input nodes number: 97797
first layer output nodes number: 37767
edges number: 290057
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2959556579589844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.331973075866699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.341583728790283  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.341583728790283  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([805, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3878560066223145  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3878560066223145  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 805, 256]), torch.Size([1, 805, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3893914222717285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4024548530578613  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 805, 256])
m.shape torch.Size([702, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4032201766967773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4032201766967773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 702, 256]), torch.Size([1, 702, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4045591354370117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.425595283508301  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 702, 256])
m.shape torch.Size([612, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.426816463470459  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.426816463470459  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4279837608337402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4539365768432617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 612, 256])
m.shape torch.Size([478, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.455348014831543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.455348014831543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4562597274780273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.485292434692383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([402, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4867687225341797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4867687225341797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4875354766845703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5166807174682617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([330, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.518200397491455  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.518200397491455  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.518829822540283  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5472092628479004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([238, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5484962463378906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5484962463378906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5489501953125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5716476440429688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([189, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.572956085205078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.572956085205078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5733165740966797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5938644409179688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([207, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.595475196838379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.595475196838379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.595870018005371  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.621138572692871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6225366592407227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6225366592407227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6228532791137695  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6453332901000977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([146, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.646718978881836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.646718978881836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6469974517822266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6687183380126953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([124, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6700096130371094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6700096130371094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.670246124267578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.690349578857422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6914520263671875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6914520263671875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.691631317138672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7081260681152344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7092742919921875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7092742919921875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7094478607177734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7266311645507812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7277960777282715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7277960777282715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.727952480316162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7445311546325684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.745579719543457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.745579719543457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7457189559936523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7614526748657227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.76224946975708  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.76224946975708  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.762350559234619  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7744812965393066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.775226593017578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.775226593017578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7753143310546875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.786457061767578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7875399589538574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7875399589538574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.787656307220459  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8032469749450684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.804131031036377  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.804131031036377  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8042244911193848  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8174023628234863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.818183422088623  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.818183422088623  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8182616233825684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8298354148864746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8305368423461914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8305368423461914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.83060359954834  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8409509658813477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.841625213623047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.841625213623047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.841686248779297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.851573944091797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8523740768432617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8523740768432617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.852442741394043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.864047050476074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([592, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.878237724304199  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.878237724304199  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 592, 256]), torch.Size([1, 592, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.879366874694824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.085604190826416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 592, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0454154014587402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.046262741088867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.047110080718994  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.046220302581787  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37767
output nodes number: 5684
edges number: 46535
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0465445518493652  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.0465450286865234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06678295135498047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 5 input nodes size: 96728
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10499238967895508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10503482818603516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05811738967895508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0605778694152832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0605778694152832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0605778694152832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([96728, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0605778694152832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1619, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20141172409057617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20141172409057617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1619, 128]), torch.Size([1, 1619, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2029557228088379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21564149856567383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1619, 128])
m.shape torch.Size([2142, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21691226959228516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21691226959228516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2142, 128]), torch.Size([1, 2142, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.21895503997802734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2500801086425781  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2142, 128])
m.shape torch.Size([2192, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2521944046020508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2521944046020508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2192, 128]), torch.Size([1, 2192, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2547445297241211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3019294738769531  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2192, 128])
m.shape torch.Size([2029, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3045330047607422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3045330047607422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2029, 128]), torch.Size([1, 2029, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.30646800994873047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3630180358886719  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2029, 128])
m.shape torch.Size([1986, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36678552627563477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.36678552627563477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1986, 128]), torch.Size([1, 1986, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3686795234680176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.43863725662231445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1986, 128])
m.shape torch.Size([1843, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4429631233215332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4429631233215332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1843, 128]), torch.Size([1, 1843, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4447207450866699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5202984809875488  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1843, 128])
m.shape torch.Size([1647, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5249171257019043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5249171257019043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1647, 128]), torch.Size([1, 1647, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5264878273010254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6066040992736816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1647, 128])
m.shape torch.Size([1559, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6117658615112305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6117658615112305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1559, 128]), torch.Size([1, 1559, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6132526397705078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6981391906738281  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1559, 128])
m.shape torch.Size([1418, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7034811973571777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7034811973571777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1418, 128]), torch.Size([1, 1418, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7048335075378418  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7934041023254395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1418, 128])
m.shape torch.Size([20625, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.891075611114502  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.891075611114502  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20625, 128]), torch.Size([1, 20625, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9107451438903809  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.307281970977783  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20625, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.1787142753601074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.214057445526123  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2494006156921387  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2137808799743652  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37060, 256])
first layer input nodes number: 96728
first layer output nodes number: 37060
edges number: 284596
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2501235008239746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2854666709899902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2950453758239746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2950453758239746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([854, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.339792251586914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.339792251586914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 854, 256]), torch.Size([1, 854, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.341421127319336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.354551315307617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 854, 256])
m.shape torch.Size([757, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3552165031433105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3552165031433105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 757, 256]), torch.Size([1, 757, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3566603660583496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3791909217834473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 757, 256])
m.shape torch.Size([584, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3801589012145996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3801589012145996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.381272792816162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4071874618530273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 584, 256])
m.shape torch.Size([453, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.408504009246826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.408504009246826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4093680381774902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.434871196746826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([420, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.437239170074463  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.437239170074463  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.438040256500244  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4679951667785645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([324, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.469463348388672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.469463348388672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.470081329345703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.50343656539917  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([252, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.504830837249756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.504830837249756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5053114891052246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.529344081878662  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([200, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.530792236328125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.530792236328125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5311737060546875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.55291748046875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([165, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5544281005859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5544281005859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5547428131103516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5748844146728516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([154, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5764288902282715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5764288902282715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5767226219177246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5975775718688965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5988264083862305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5988264083862305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5990781784057617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.618716239929199  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([116, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6199283599853516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6199283599853516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.620149612426758  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.638956069946289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([93, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6400275230407715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6400275230407715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.640204906463623  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.656524181365967  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([95, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6577138900756836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6577138900756836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.657895088195801  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6758337020874023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6769542694091797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6769542694091797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.677114486694336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6940975189208984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.695058822631836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.695058822631836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6951847076416016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.709409713745117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.710542678833008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.710542678833008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.710681915283203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7273902893066406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7285022735595703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7285022735595703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7286243438720703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7441272735595703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7451305389404297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7451305389404297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7452335357666016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.759035110473633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.759810447692871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.759810447692871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.759892463684082  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.771456718444824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([53, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.772597312927246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.772597312927246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.772698402404785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7876596450805664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.788285732269287  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.788285732269287  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.788346767425537  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.797807216644287  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.798506259918213  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.798506259918213  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7985692024230957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8087658882141113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8094959259033203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8094959259033203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.809558868408203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8201961517333984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([550, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8333802223205566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8333802223205566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 550, 256]), torch.Size([1, 550, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8344292640686035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 3.019746780395508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 550, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9811630249023438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9820103645324707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9828577041625977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9819679260253906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37060
output nodes number: 5684
edges number: 45461
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9822869300842285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9822874069213867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06583738327026367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 6 input nodes size: 98256
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05811738967895508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.05811738967895508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10499238967895508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.10503482818603516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06142091751098633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06142091751098633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06142091751098633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([98256, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.06142091751098633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1670, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2072763442993164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2072763442993164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1670, 128]), torch.Size([1, 1670, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.20886898040771484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22183609008789062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1670, 128])
m.shape torch.Size([2099, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22304153442382812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22304153442382812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2099, 128]), torch.Size([1, 2099, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.22591733932495117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.2578883171081543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2099, 128])
m.shape torch.Size([2208, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.259890079498291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.259890079498291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2208, 128]), torch.Size([1, 2208, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.261995792388916  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3089933395385742  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2208, 128])
m.shape torch.Size([2168, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3120756149291992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3120756149291992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2168, 128]), torch.Size([1, 2168, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3143186569213867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3751668930053711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2168, 128])
m.shape torch.Size([2025, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3786139488220215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.3786139488220215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2025, 128]), torch.Size([1, 2025, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.38054513931274414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4507260322570801  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2025, 128])
m.shape torch.Size([1846, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45504188537597656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.45504188537597656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1846, 128]), torch.Size([1, 1846, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.4568023681640625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5325031280517578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1846, 128])
m.shape torch.Size([1689, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5372605323791504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5372605323791504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1689, 128]), torch.Size([1, 1689, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.5388712882995605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6204943656921387  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1689, 128])
m.shape torch.Size([1626, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6258916854858398  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6258916854858398  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1626, 128]), torch.Size([1, 1626, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.6274423599243164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7192831039428711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1626, 128])
m.shape torch.Size([1490, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7256336212158203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7256336212158203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1490, 128]), torch.Size([1, 1490, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.7270545959472656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.8180713653564453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1490, 128])
m.shape torch.Size([21447, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9196281433105469  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9196281433105469  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21447, 128]), torch.Size([1, 21447, 128])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 0.9400815963745117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.395538330078125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21447, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2621359825134277  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.298631191253662  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3351263999938965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.2983460426330566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([38268, 256])
first layer input nodes number: 98256
first layer output nodes number: 38268
edges number: 295076
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3358607292175293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3723559379577637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3816604614257812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.3816604614257812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([840, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.428097724914551  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.428097724914551  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 840, 256]), torch.Size([1, 840, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4296998977661133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4431777000427246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 840, 256])
m.shape torch.Size([757, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4439291954040527  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4439291954040527  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 757, 256]), torch.Size([1, 757, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.445373058319092  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.467672348022461  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 757, 256])
m.shape torch.Size([567, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4688897132873535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4688897132873535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.469971179962158  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4962825775146484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([454, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4976820945739746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4976820945739746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.4985480308532715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5249505043029785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([347, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5261855125427246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5261855125427246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5268473625183105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5509610176086426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([295, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5523314476013184  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5523314476013184  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.552894115447998  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5785269737243652  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([247, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5799078941345215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.5799078941345215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.580379009246826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6039347648620605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([226, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6054372787475586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6054372787475586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.605868339538574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.630438804626465  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.631737232208252  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.631737232208252  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.632071018218994  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.653433322906494  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6548142433166504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6548142433166504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.655121326446533  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.676924228668213  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([142, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.678551197052002  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.678551197052002  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6788220405578613  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.6999478340148926  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([115, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.701138973236084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.701138973236084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7013583183288574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7200026512145996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([112, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.721292495727539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.721292495727539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.721506118774414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.741159439086914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([89, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.742250442504883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.742250442504883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.742420196533203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.759225845336914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7602944374084473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7602944374084473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7604470252990723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7766213417053223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([82, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.777806282043457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.777806282043457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7779626846313477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7956361770629883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7966527938842773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.7966527938842773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.796780586242676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8121156692504883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8130035400390625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8130035400390625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.813108444213867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8264312744140625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.827237129211426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.827237129211426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.827326774597168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.839339256286621  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.84035587310791  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.84035587310791  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.840460777282715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.855252265930176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8561487197875977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8561487197875977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.85623836517334  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8695058822631836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.870285987854004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.870285987854004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8703603744506836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.881890296936035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.882737636566162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.882737636566162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8828139305114746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8951735496520996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8958277702331543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8958277702331543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.8958849906921387  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.905555248260498  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([615, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.920304298400879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.920304298400879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 615, 256]), torch.Size([1, 615, 256])
----------------------------------------3
 Nvidia-smi: 4.8104248046875 GB
    Memory Allocated: 2.9214773178100586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8123779296875 GB
    Memory Allocated: 3.1298017501831055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 615, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8123779296875 GB
    Memory Allocated: 3.089465618133545  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8123779296875 GB
    Memory Allocated: 3.090312957763672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8123779296875 GB
    Memory Allocated: 3.091160297393799  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8123779296875 GB
    Memory Allocated: 3.090270519256592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 38268
output nodes number: 5684
edges number: 47236
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8123779296875 GB
    Memory Allocated: 3.0905981063842773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8123779296875 GB
    Memory Allocated: 3.0905985832214355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06670141220092773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 7 input nodes size: 97685
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10544872283935547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10549116134643555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.05857372283935547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0610809326171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0610809326171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0610809326171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97685, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0610809326171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1626, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20500612258911133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20500612258911133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1626, 128]), torch.Size([1, 1626, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2065567970275879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.21925020217895508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1626, 128])
m.shape torch.Size([2157, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22053194046020508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22053194046020508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2157, 128]), torch.Size([1, 2157, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22258901596069336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2542390823364258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2157, 128])
m.shape torch.Size([2225, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2563934326171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2563934326171875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2225, 128]), torch.Size([1, 2225, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2587580680847168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3058767318725586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2225, 128])
m.shape torch.Size([2063, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30875062942504883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30875062942504883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2063, 128]), torch.Size([1, 2063, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3108401298522949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.36904430389404297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2063, 128])
m.shape torch.Size([2016, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37227821350097656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37227821350097656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2016, 128]), torch.Size([1, 2016, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37420082092285156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4439830780029297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2016, 128])
m.shape torch.Size([1849, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.44831180572509766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.44831180572509766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1849, 128]), torch.Size([1, 1849, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4500751495361328  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5258989334106445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1849, 128])
m.shape torch.Size([1670, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5305914878845215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5305914878845215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1670, 128]), torch.Size([1, 1670, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5321841239929199  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6136078834533691  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1670, 128])
m.shape torch.Size([1667, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6191706657409668  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6191706657409668  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1667, 128]), torch.Size([1, 1667, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.620760440826416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7131876945495605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1667, 128])
m.shape torch.Size([1492, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7187957763671875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7187957763671875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1492, 128]), torch.Size([1, 1492, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7202186584472656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.812324047088623  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1492, 128])
m.shape torch.Size([20984, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9116721153259277  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9116721153259277  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20984, 128]), torch.Size([1, 20984, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9316840171813965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3525290489196777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20984, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.221092700958252  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2570929527282715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.293093204498291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2568116188049316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37749, 256])
first layer input nodes number: 97685
first layer output nodes number: 37749
edges number: 290335
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2938232421875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3298234939575195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.339348793029785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.339348793029785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([874, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.384699821472168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.384699821472168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 874, 256]), torch.Size([1, 874, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.386366844177246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.399703025817871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 874, 256])
m.shape torch.Size([749, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.400383949279785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.400383949279785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 749, 256]), torch.Size([1, 749, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4018125534057617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4245452880859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 749, 256])
m.shape torch.Size([602, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4257426261901855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4257426261901855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4268908500671387  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.452971935272217  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([456, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4543800354003906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4543800354003906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.455249786376953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.481814384460449  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([344, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.483959674835205  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.483959674835205  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4846158027648926  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5096211433410645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([317, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5111212730407715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5111212730407715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.511725902557373  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.537871837615967  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([250, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5392518043518066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5392518043518066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5397286415100098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.563570499420166  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([214, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5649776458740234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5649776458740234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5653858184814453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.588651657104492  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([180, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5900049209594727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5900049209594727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.590348243713379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.612320899963379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([153, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.613619804382324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.613619804382324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6139116287231445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6346311569213867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.636507511138916  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.636507511138916  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.636782169342041  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.658205509185791  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.659348487854004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.659348487854004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.659560203552246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.677556037902832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6786251068115234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6786251068115234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.678804397583008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6952991485595703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([89, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6964073181152344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6964073181152344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6965770721435547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7133827209472656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7142062187194824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7142062187194824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7143263816833496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7270636558532715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([89, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.728372573852539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.728372573852539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7285423278808594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7477245330810547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.748676300048828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.748676300048828  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7487964630126953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.763216018676758  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7642736434936523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7642736434936523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7643918991088867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7794103622436523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.779881000518799  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.779881000518799  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7799363136291504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7873482704162598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7882819175720215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7882819175720215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.788377285003662  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8018240928649902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.802947521209717  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.802947521209717  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.80305814743042  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8194308280944824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.81998872756958  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.81998872756958  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8200440406799316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.828617572784424  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.829430103302002  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.829430103302002  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.829502582550049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8412442207336426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8419694900512695  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8419694900512695  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8420324325561523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8526697158813477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([593, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.866887092590332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.866887092590332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 593, 256]), torch.Size([1, 593, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.86801815032959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.072721481323242  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 593, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.033515453338623  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.03436279296875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.035210132598877  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.03432035446167  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37749
output nodes number: 5684
edges number: 46074
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.03464412689209  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.034644603729248  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0664677619934082  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 8 input nodes size: 97295
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.05857372283935547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.05857372283935547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10544872283935547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10549116134643555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.061368465423583984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.061368465423583984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.061368465423583984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97295, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.061368465423583984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1668, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20534896850585938  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20534896850585938  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1668, 128]), torch.Size([1, 1668, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.206939697265625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.21976566314697266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1668, 128])
m.shape torch.Size([2099, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22097206115722656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22097206115722656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2099, 128]), torch.Size([1, 2099, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22297382354736328  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.254239559173584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2099, 128])
m.shape torch.Size([2124, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25627708435058594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25627708435058594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2124, 128]), torch.Size([1, 2124, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25895214080810547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.305356502532959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2124, 128])
m.shape torch.Size([2120, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30838727951049805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30838727951049805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2120, 128]), torch.Size([1, 2120, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3104109764099121  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3708014488220215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2120, 128])
m.shape torch.Size([2089, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3747711181640625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3747711181640625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3767828941345215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.45180797576904297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
m.shape torch.Size([1869, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4561591148376465  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4561591148376465  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1869, 128]), torch.Size([1, 1869, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.45794153213500977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5358290672302246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1869, 128])
m.shape torch.Size([1785, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.540895938873291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.540895938873291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1785, 128]), torch.Size([1, 1785, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5425982475280762  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.627713680267334  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1785, 128])
m.shape torch.Size([1630, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6330804824829102  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6330804824829102  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1630, 128]), torch.Size([1, 1630, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6346349716186523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7261233329772949  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1630, 128])
m.shape torch.Size([1495, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7317619323730469  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7317619323730469  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1495, 128]), torch.Size([1, 1495, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7331876754760742  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.8246831893920898  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1495, 128])
m.shape torch.Size([20778, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9235796928405762  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9235796928405762  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20778, 128]), torch.Size([1, 20778, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9433951377868652  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3502917289733887  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20778, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2177376747131348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.253650188446045  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.289562702178955  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2533693313598633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37657, 256])
first layer input nodes number: 97295
first layer output nodes number: 37657
edges number: 289147
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.290289878845215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.326202392578125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.335211753845215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.335211753845215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([831, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.38150691986084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.38150691986084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 831, 256]), torch.Size([1, 831, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.383091926574707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.395885467529297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 831, 256])
m.shape torch.Size([757, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.396679401397705  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.396679401397705  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 757, 256]), torch.Size([1, 757, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.398123264312744  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4217019081115723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 757, 256])
m.shape torch.Size([578, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4227004051208496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4227004051208496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4238028526306152  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.450153350830078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([438, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.451322555541992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.451322555541992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.452157974243164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.477159023284912  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([379, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.478562831878662  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.478562831878662  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.479285717010498  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5065407752990723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([285, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.508586883544922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.508586883544922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5091304779052734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5374956130981445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([275, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.539074420928955  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.539074420928955  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5395989418029785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.570544719696045  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([226, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5720205307006836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5720205307006836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.572451591491699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.59702205657959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([174, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5983119010925293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5983119010925293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5986437797546387  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6198840141296387  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([172, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.621371269226074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.621371269226074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.621699333190918  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.644991874694824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([133, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6462340354919434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6462340354919434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6464877128601074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6662745475769043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([124, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6675782203674316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6675782203674316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6678147315979004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.687918186187744  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([116, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6892495155334473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6892495155334473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6894707679748535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7098259925842285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7117319107055664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7117319107055664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.711911201477051  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.729660987854004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.730825901031494  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.730825901031494  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.730991840362549  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7485814094543457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7496213912963867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7496213912963867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.749760627746582  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7654943466186523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.766536235809326  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.766536235809326  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7666659355163574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7822299003601074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.783289909362793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.783289909362793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.783413887023926  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.799159049987793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8001198768615723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8001198768615723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8002266883850098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8145394325256348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8156590461730957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8156590461730957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8157753944396973  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8321805000305176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8328490257263184  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8328490257263184  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8329176902770996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8430800437927246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8438072204589844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8438072204589844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8438758850097656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8545188903808594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.855170249938965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.855170249938965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.855229377746582  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8648080825805664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.865586280822754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.865586280822754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8656530380249023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8769350051879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([554, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8902134895324707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8902134895324707  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.891270160675049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0785107612609863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 554, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.038358211517334  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.039205551147461  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.040052890777588  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.039163112640381  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37657
output nodes number: 5684
edges number: 46264
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0394864082336426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.039486885070801  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06679248809814453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 9 input nodes size: 97549
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10538387298583984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10542631149291992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.058508872985839844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0610198974609375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0610198974609375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0610198974609375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97549, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0610198974609375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1627, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20494842529296875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20494842529296875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1627, 128]), torch.Size([1, 1627, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20650005340576172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2191944122314453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1627, 128])
m.shape torch.Size([2057, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22038030624389648  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22038030624389648  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2057, 128]), torch.Size([1, 2057, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22234201431274414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2534656524658203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2057, 128])
m.shape torch.Size([2144, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.255551815032959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.255551815032959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2144, 128]), torch.Size([1, 2144, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2583184242248535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30509376525878906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2144, 128])
m.shape torch.Size([2121, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3081169128417969  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3081169128417969  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2121, 128]), torch.Size([1, 2121, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3101506233215332  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37037181854248047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2121, 128])
m.shape torch.Size([1992, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37410974502563477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37410974502563477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1992, 128]), torch.Size([1, 1992, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.376009464263916  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.445681095123291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1992, 128])
m.shape torch.Size([1820, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4499382972717285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4499382972717285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1820, 128]), torch.Size([1, 1820, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4516739845275879  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5277390480041504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1820, 128])
m.shape torch.Size([1751, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5327157974243164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5327157974243164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1751, 128]), torch.Size([1, 1751, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5343856811523438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6179442405700684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1751, 128])
m.shape torch.Size([1648, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6233959197998047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6233959197998047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1648, 128]), torch.Size([1, 1648, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6249675750732422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7172641754150391  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1648, 128])
m.shape torch.Size([1551, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7231345176696777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7231345176696777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1551, 128]), torch.Size([1, 1551, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7246136665344238  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.8194317817687988  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1551, 128])
m.shape torch.Size([20929, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9184894561767578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9184894561767578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20929, 128]), torch.Size([1, 20929, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9391255378723145  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3562464714050293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20929, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2243595123291016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.260255813598633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.296152114868164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.259974956512451  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37640, 256])
first layer input nodes number: 97549
first layer output nodes number: 37640
edges number: 290227
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2968811988830566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.332777500152588  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3418030738830566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3418030738830566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([830, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.388099193572998  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.388099193572998  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 830, 256]), torch.Size([1, 830, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3896822929382324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.402808666229248  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 830, 256])
m.shape torch.Size([688, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4035229682922363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4035229682922363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4048352241516113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4252114295959473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([579, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4263081550598145  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4263081550598145  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 579, 256]), torch.Size([1, 579, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.427412509918213  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.453141689300537  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 579, 256])
m.shape torch.Size([464, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4543848037719727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4543848037719727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4552698135375977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.482579231262207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([428, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.484193801879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.484193801879883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4850101470947266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5152363777160645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([297, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.516541004180908  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.516541004180908  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5171074867248535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.543419361114502  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([252, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5448317527770996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5448317527770996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5453124046325684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.569344997406006  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([232, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5708885192871094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5708885192871094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.571331024169922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5965538024902344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([200, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5980629920959473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5980629920959473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5984444618225098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6228585243225098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([158, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6247963905334473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6247963905334473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6250977516174316  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6464943885803223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([152, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.647951126098633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.647951126098633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6482410430908203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6708545684814453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6720709800720215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6720709800720215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6722960472106934  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6914267539978027  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([118, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.692788600921631  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.692788600921631  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6930136680603027  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7137198448181152  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.714657783508301  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.714657783508301  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.71480655670166  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7295351028442383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7305660247802734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7305660247802734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.730710983276367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7460765838623047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.746926784515381  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.746926784515381  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7470412254333496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7599730491638184  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7610206604003906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7610206604003906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.761138916015625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.77532958984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7762222290039062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7762222290039062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.776327133178711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7896499633789062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.790492534637451  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.790492534637451  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.790585994720459  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.803109645843506  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.803966522216797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.803966522216797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.804056167602539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8166961669921875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.817539691925049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.817539691925049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8176236152648926  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8300442695617676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.830806255340576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.830806255340576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.830878734588623  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8421130180358887  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8427181243896484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8427181243896484  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8427734375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.851734161376953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8522143363952637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8522143363952637  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8522562980651855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8593478202819824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([608, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.873936176300049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.873936176300049  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.875095844268799  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.083817481994629  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 608, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.043614387512207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.044461727142334  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.045309066772461  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.044419288635254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37640
output nodes number: 5684
edges number: 46605
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0447425842285156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.044743061065674  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06641817092895508  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 10 input nodes size: 97213
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.058508872985839844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.058508872985839844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10538387298583984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10542631149291992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06136178970336914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06136178970336914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06136178970336914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97213, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06136178970336914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1593, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20327329635620117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20327329635620117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1593, 128]), torch.Size([1, 1593, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20479249954223633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.21731138229370117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1593, 128])
m.shape torch.Size([2098, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.21860694885253906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.21860694885253906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2098, 128]), torch.Size([1, 2098, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22060775756835938  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25272560119628906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2098, 128])
m.shape torch.Size([2224, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2541923522949219  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2541923522949219  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2224, 128]), torch.Size([1, 2224, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2579078674316406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30496978759765625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2224, 128])
m.shape torch.Size([2133, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30797767639160156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30797767639160156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2133, 128]), torch.Size([1, 2133, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3101520538330078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3703885078430176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2133, 128])
m.shape torch.Size([2035, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37369251251220703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37369251251220703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2035, 128]), torch.Size([1, 2035, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37563323974609375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.44587135314941406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2035, 128])
m.shape torch.Size([1839, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.450162410736084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.450162410736084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1839, 128]), torch.Size([1, 1839, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4519162178039551  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5275530815124512  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1839, 128])
m.shape torch.Size([1745, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5325007438659668  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5325007438659668  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1745, 128]), torch.Size([1, 1745, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5341649055480957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6174077987670898  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1745, 128])
m.shape torch.Size([1611, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6227936744689941  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6227936744689941  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1611, 128]), torch.Size([1, 1611, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6243300437927246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7119030952453613  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1611, 128])
m.shape torch.Size([1480, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7174863815307617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7174863815307617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1480, 128]), torch.Size([1, 1480, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.718897819519043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.8095569610595703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1480, 128])
m.shape torch.Size([20756, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9084606170654297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9084606170654297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20756, 128]), torch.Size([1, 20756, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9282550811767578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3336620330810547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20756, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.202815055847168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.238591194152832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.274367332458496  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.238311290740967  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37514, 256])
first layer input nodes number: 97213
first layer output nodes number: 37514
edges number: 288185
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2750935554504395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3108696937561035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3200154304504395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3200154304504395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([842, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.366325855255127  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.366325855255127  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 842, 256]), torch.Size([1, 842, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.367931842803955  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3815369606018066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 842, 256])
m.shape torch.Size([725, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.382171630859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.382171630859375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.383554458618164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4051785469055176  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([591, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.406215190887451  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.406215190887451  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4073424339294434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.433776378631592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.435074806213379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.435074806213379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.435946464538574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4629430770874023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([359, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.464232921600342  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.464232921600342  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4649176597595215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.490426540374756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([292, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4917683601379395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4917683601379395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4923253059387207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.522179126739502  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([267, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5236973762512207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5236973762512207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5242066383361816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.551797389984131  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([237, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5533652305603027  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5533652305603027  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5538172721862793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5795836448669434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([196, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5810532569885254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5810532569885254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5814270973205566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6053528785705566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([172, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.607248306274414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.607248306274414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.607576370239258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.630868911743164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6321325302124023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6321325302124023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.632390022277832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6524744033813477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([135, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.653903007507324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.653903007507324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.654160499572754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6760473251342773  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.677180767059326  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.677180767059326  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6773734092712402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.695096492767334  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6961441040039062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6961441040039062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6963062286376953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7123565673828125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7133712768554688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7133712768554688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7135162353515625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7288818359375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.729886054992676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.729886054992676  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7300195693969727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7451066970825195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7460856437683105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7460856437683105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7462077140808105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7608561515808105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([75, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7620930671691895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7620930671691895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7622361183166504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7804036140441895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.781081199645996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.781081199645996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7811594009399414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7916383743286133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7925028800964355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7925028800964355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7925925254821777  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.805232524871826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.806288719177246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.806288719177246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8063840866088867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.820498466491699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8210220336914062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8210220336914062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.821073532104492  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8290557861328125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.82969331741333  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.82969331741333  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8297505378723145  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.839020252227783  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.839684009552002  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.839684009552002  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8397412300109863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8494114875793457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([580, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8633193969726562  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8633193969726562  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8644256591796875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0685348510742188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 580, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.028353214263916  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.029200553894043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.03004789352417  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.029158115386963  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37514
output nodes number: 5684
edges number: 46268
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.029480457305908  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0294809341430664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0660090446472168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 11 input nodes size: 97709
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10546016693115234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10550260543823242  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.058585166931152344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06111621856689453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06111621856689453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06111621856689453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97709, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06111621856689453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1667, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2059173583984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2059173583984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1667, 128]), torch.Size([1, 1667, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20750713348388672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22022533416748047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1667, 128])
m.shape torch.Size([2113, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22144556045532227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22144556045532227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2113, 128]), torch.Size([1, 2113, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22346067428588867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25432300567626953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2113, 128])
m.shape torch.Size([2189, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25644683837890625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25644683837890625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2189, 128]), torch.Size([1, 2189, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25913381576538086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30647993087768555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2189, 128])
m.shape torch.Size([2205, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3094048500061035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3094048500061035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2205, 128]), torch.Size([1, 2205, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.311737060546875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3734006881713867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2205, 128])
m.shape torch.Size([2095, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37734413146972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37734413146972656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2095, 128]), torch.Size([1, 2095, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37940311431884766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.45278072357177734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2095, 128])
m.shape torch.Size([1899, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.45690441131591797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.45690441131591797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1899, 128]), torch.Size([1, 1899, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.45871543884277344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5373239517211914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1899, 128])
m.shape torch.Size([1783, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5423698425292969  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5423698425292969  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1783, 128]), torch.Size([1, 1783, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5440702438354492  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6290903091430664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1783, 128])
m.shape torch.Size([1650, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6345343589782715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6345343589782715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1650, 128]), torch.Size([1, 1650, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6361079216003418  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7279767990112305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1650, 128])
m.shape torch.Size([1550, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7338418960571289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7338418960571289  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1550, 128]), torch.Size([1, 1550, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7353200912475586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.8308420181274414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1550, 128])
m.shape torch.Size([20971, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9301004409790039  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9301004409790039  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 20971, 128]), torch.Size([1, 20971, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9507622718811035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.370727062225342  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 20971, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2385644912719727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2749204635620117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.311276435852051  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2746362686157227  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([38122, 256])
first layer input nodes number: 97709
first layer output nodes number: 38122
edges number: 292490
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3120064735412598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.348362445831299  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.357893943786621  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.357893943786621  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([809, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.404172420501709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.404172420501709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 809, 256]), torch.Size([1, 809, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4057154655456543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.418342113494873  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 809, 256])
m.shape torch.Size([725, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4190025329589844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4190025329589844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4203853607177734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4411277770996094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([552, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.442241668701172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.442241668701172  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4432945251464844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.468478202819824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([478, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.469789505004883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.469789505004883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.470701217651367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.497969627380371  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([381, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.499344825744629  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.499344825744629  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5000715255737305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.52862548828125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([318, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.530540943145752  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.530540943145752  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5311474800109863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.557715892791748  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([244, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.559678554534912  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.559678554534912  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5601439476013184  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.583413600921631  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([219, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.584865093231201  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.584865093231201  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.585282802581787  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6090922355651855  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([217, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6107606887817383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6107606887817383  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6111745834350586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6376638412475586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6389660835266113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6389660835266113  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.639265537261963  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.660526752471924  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([143, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.66188907623291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.66188907623291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6621618270874023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.683436393737793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6846842765808105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6846842765808105  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.684913158416748  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7043681144714355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7058920860290527  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7058920860290527  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7060999870300293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.725226879119873  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([97, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.726428508758545  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.726428508758545  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7266135215759277  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.744929790496826  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.746091842651367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.746091842651367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.746257781982422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7638473510742188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.76473331451416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.76473331451416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7648534774780273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7784318923950195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.779489040374756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.779489040374756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7796149253845215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7947211265563965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7955408096313477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7955408096313477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.795638084411621  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8079919815063477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.809156894683838  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.809156894683838  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8092751502990723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8251214027404785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.82608699798584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.82608699798584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.826188087463379  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8404417037963867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8410372734069824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8410372734069824  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8410983085632324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8501315116882324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8506932258605957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8506932258605957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8507466316223145  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8590245246887207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8596835136413574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8596835136413574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8597426414489746  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.869321346282959  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8699841499328613  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8699841499328613  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8700413703918457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.879711627960205  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([612, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8943886756896973  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8943886756896973  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8955559730529785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.1042542457580566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 612, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0640478134155273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0648951530456543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0657424926757812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.064852714538574  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 38122
output nodes number: 5684
edges number: 47023
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0651793479919434  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0651798248291016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06657075881958008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 12 input nodes size: 97893
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.058585166931152344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.058585166931152344  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10546016693115234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10550260543823242  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06139230728149414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06139230728149414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06139230728149414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([97893, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06139230728149414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1616, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2050037384033203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2050037384033203  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1616, 128]), torch.Size([1, 1616, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2065448760986328  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.21916961669921875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1616, 128])
m.shape torch.Size([2110, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2204113006591797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2204113006591797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2110, 128]), torch.Size([1, 2110, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22257566452026367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2540621757507324  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2110, 128])
m.shape torch.Size([2242, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25626325607299805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25626325607299805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2242, 128]), torch.Size([1, 2242, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2589268684387207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30605077743530273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2242, 128])
m.shape torch.Size([2089, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30896615982055664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30896615982055664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.31100034713745117  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.36985111236572266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
m.shape torch.Size([2052, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37298583984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37298583984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2052, 128]), torch.Size([1, 2052, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37572193145751953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.45029687881469727  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2052, 128])
m.shape torch.Size([1813, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.45450544357299805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.45450544357299805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1813, 128]), torch.Size([1, 1813, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4562344551086426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5339045524597168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1813, 128])
m.shape torch.Size([1714, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5387611389160156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5387611389160156  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1714, 128]), torch.Size([1, 1714, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5403957366943359  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.622859001159668  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1714, 128])
m.shape torch.Size([1641, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6283016204833984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6283016204833984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6298666000366211  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7221031188964844  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
m.shape torch.Size([1457, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7275733947753906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7275733947753906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1457, 128]), torch.Size([1, 1457, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7289628982543945  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.8184127807617188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1457, 128])
m.shape torch.Size([21172, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9192805290222168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9192805290222168  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21172, 128]), torch.Size([1, 21172, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9394717216491699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3920435905456543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21172, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.259251117706299  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.295401096343994  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3315510749816895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2951183319091797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37906, 256])
first layer input nodes number: 97893
first layer output nodes number: 37906
edges number: 292015
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.332282543182373  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3684325218200684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.377868175506592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.377868175506592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([834, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.424168109893799  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.424168109893799  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4257588386535645  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4387784004211426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 834, 256])
m.shape torch.Size([721, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.439450263977051  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.439450263977051  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 721, 256]), torch.Size([1, 721, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4408254623413086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4620847702026367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 721, 256])
m.shape torch.Size([609, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.463573455810547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.463573455810547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4647350311279297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.490682601928711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 609, 256])
m.shape torch.Size([458, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.492356777191162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.492356777191162  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4932303428649902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5199637413024902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([384, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5213723182678223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5213723182678223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5221047401428223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.549765110015869  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([301, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5511350631713867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5511350631713867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5517091751098633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.577493667602539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([249, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5788822174072266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5788822174072266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.579357147216797  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6031036376953125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([220, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.604557991027832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.604557991027832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.604977607727051  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6288957595825195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.631349563598633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.631349563598633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6317214965820312  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6555252075195312  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6568870544433594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6568870544433594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.657194137573242  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.678997039794922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6803131103515625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6803131103515625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6805782318115234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7012577056884766  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([121, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7025208473205566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7025208473205566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.702751636505127  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7223687171936035  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7235279083251953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7235279083251953  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.723722457885742  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7416210174560547  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([75, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7425379753112793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7425379753112793  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7426810264587402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.756843090057373  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7581124305725098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7581124305725098  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7582898139953613  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.777092456817627  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.777895927429199  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.777895927429199  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7780065536499023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7905073165893555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7914161682128906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7914161682128906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7915287017822266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.805032730102539  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8058934211730957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8058934211730957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8059945106506348  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8188328742980957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8198599815368652  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8198599815368652  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8199706077575684  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.834794521331787  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.835700511932373  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.835700511932373  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8357958793640137  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.849242687225342  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8501033782958984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8501033782958984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.850189208984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8628921508789062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8637166023254395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8637166023254395  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8637948036193848  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.875916004180908  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.876650810241699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.876650810241699  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8767175674438477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8875322341918945  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.88809871673584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.88809871673584  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.888148307800293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.896529197692871  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([597, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.9108495712280273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.9108495712280273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.9119882583618164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.116260528564453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 597, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0760674476623535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0769147872924805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0777621269226074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0768723487854004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37906
output nodes number: 5684
edges number: 46469
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.077197551727295  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.077198028564453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06590509414672852  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 13 input nodes size: 96711
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10498428344726562  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.1050267219543457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.058109283447265625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.060622215270996094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.060622215270996094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.060622215270996094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([96711, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.060622215270996094  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1662, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20456743240356445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20456743240356445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20615243911743164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2189774513244629  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([2061, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22015047073364258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22015047073364258  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2061, 128]), torch.Size([1, 2061, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22211599349975586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25319385528564453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2061, 128])
m.shape torch.Size([2114, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2552351951599121  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2552351951599121  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2114, 128]), torch.Size([1, 2114, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.25803327560424805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3045053482055664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2114, 128])
m.shape torch.Size([2064, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30743408203125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30743408203125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2064, 128]), torch.Size([1, 2064, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.30942630767822266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3687105178833008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2064, 128])
m.shape torch.Size([1953, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37238264083862305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37238264083862305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1953, 128]), torch.Size([1, 1953, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37424516677856445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4435276985168457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1953, 128])
m.shape torch.Size([1814, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4477863311767578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4477863311767578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1814, 128]), torch.Size([1, 1814, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.44951629638671875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5239048004150391  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1814, 128])
m.shape torch.Size([1704, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5287275314331055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5287275314331055  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1704, 128]), torch.Size([1, 1704, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5303525924682617  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6122078895568848  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1704, 128])
m.shape torch.Size([1613, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6175484657287598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6175484657287598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1613, 128]), torch.Size([1, 1613, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.619086742401123  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7067685127258301  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1613, 128])
m.shape torch.Size([1433, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7121491432189941  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7121491432189941  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7135157585144043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.8025107383728027  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([21132, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9033899307250977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9033899307250977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21132, 128]), torch.Size([1, 21132, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9235429763793945  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.37569522857666  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21132, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.2435126304626465  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.279323101043701  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.315133571624756  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.279043197631836  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([37550, 256])
first layer input nodes number: 96711
first layer output nodes number: 37550
edges number: 290080
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.315856456756592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.3516669273376465  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.360778331756592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.360778331756592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([867, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4071125984191895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4071125984191895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 867, 256]), torch.Size([1, 867, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.408766269683838  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4225335121154785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 867, 256])
m.shape torch.Size([751, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.423344135284424  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.423344135284424  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 751, 256]), torch.Size([1, 751, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.424776554107666  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4479832649230957  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 751, 256])
m.shape torch.Size([538, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4489054679870605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4489054679870605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4499316215515137  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.473130702972412  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([461, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.474393367767334  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.474393367767334  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.4752726554870605  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5016674995422363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([379, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.503662586212158  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.503662586212158  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.504385471343994  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5322556495666504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([295, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.533595561981201  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.533595561981201  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.534158229827881  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.560176372528076  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([243, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.561530113220215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.561530113220215  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.5619935989379883  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.58516788482666  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([220, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.586627960205078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.586627960205078  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.587047576904297  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6109657287597656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([182, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.612330436706543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.612330436706543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.612677574157715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.634894371032715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([148, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.636143684387207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.636143684387207  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6364259719848633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.656468391418457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6583938598632812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6583938598632812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.658651351928711  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6787357330322266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6799683570861816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6799683570861816  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.6801934242248535  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.699324131011963  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([114, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.700636386871338  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.700636386871338  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7008538246154785  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.720858097076416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7218799591064453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7218799591064453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7220401763916016  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7379016876220703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([92, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7391481399536133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7391481399536133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.739323616027832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7579240798950195  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7588205337524414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7588205337524414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7589426040649414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7727365493774414  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7738356590270996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7738356590270996  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7739710807800293  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.790221691131592  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.791234016418457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.791234016418457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.7913427352905273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.805150032043457  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8060455322265625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8060455322265625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8061447143554688  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8194351196289062  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8201355934143066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8201355934143066  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8202099800109863  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8306984901428223  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8315696716308594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8315696716308594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.831655502319336  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.844358444213867  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8450980186462402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8450980186462402  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8451685905456543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.856107234954834  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.856691360473633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.856691360473633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8567447662353516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.865396499633789  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8664498329162598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8664498329162598  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8665356636047363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.8810410499572754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([619, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.895871639251709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.895871639251709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 2.89705228805542  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.1070055961608887  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 619, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0667924880981445  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0676398277282715  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0684871673583984  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0675973892211914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([5684, 40])
input nodes number: 37550
output nodes number: 5684
edges number: 46993
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.0679197311401367  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 3.067920207977295  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.06602096557617188  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

pseudo mini batch 14 input nodes size: 98851
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.058109283447265625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.058109283447265625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10524511337280273  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.10528755187988281  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.05912971496582031  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.061710357666015625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.061710357666015625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.061710357666015625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([98851, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.061710357666015625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([1664, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20874977111816406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.20874977111816406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1664, 128]), torch.Size([1, 1664, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.21033668518066406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22303199768066406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1664, 128])
m.shape torch.Size([2073, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22443580627441406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22443580627441406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2073, 128]), torch.Size([1, 2073, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.22733449935913086  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.2595252990722656  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2073, 128])
m.shape torch.Size([2137, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.26074838638305664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.26074838638305664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2137, 128]), torch.Size([1, 2137, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.264559268951416  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3109245300292969  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2137, 128])
m.shape torch.Size([2104, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3139185905456543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3139185905456543  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2104, 128]), torch.Size([1, 2104, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.3165292739868164  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.37664127349853516  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2104, 128])
m.shape torch.Size([2053, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.379849910736084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.379849910736084  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 2053, 128]), torch.Size([1, 2053, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.38251495361328125  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.45694828033447266  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 2053, 128])
m.shape torch.Size([1903, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4614138603210449  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.4614138603210449  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1903, 128]), torch.Size([1, 1903, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.463228702545166  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5430693626403809  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1903, 128])
m.shape torch.Size([1756, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5480232238769531  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5480232238769531  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1756, 128]), torch.Size([1, 1756, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.5496978759765625  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6337032318115234  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1756, 128])
m.shape torch.Size([1636, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6391067504882812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6391067504882812  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1636, 128]), torch.Size([1, 1636, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.6406669616699219  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.73260498046875  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1636, 128])
m.shape torch.Size([1504, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7382793426513672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7382793426513672  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 1504, 128]), torch.Size([1, 1504, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.7397136688232422  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.8324098587036133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 1504, 128])
m.shape torch.Size([21725, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9352855682373047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9352855682373047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 21725, 128]), torch.Size([1, 21725, 128])
----------------------------------------3
 Nvidia-smi: 4.8143310546875 GB
    Memory Allocated: 0.9560041427612305  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.427022933959961  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 21725, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2901439666748047  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3269128799438477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3636817932128906  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.326625347137451  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

torch.Size([38555, 256])
first layer input nodes number: 98851
first layer output nodes number: 38555
edges number: 298486
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3644204139709473  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4011893272399902  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.41038179397583  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.41038179397583  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

m.shape torch.Size([840, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.457368850708008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.457368850708008  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 840, 256]), torch.Size([1, 840, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4589710235595703  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4726295471191406  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 840, 256])
m.shape torch.Size([725, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.473222255706787  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.473222255706787  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.474605083465576  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4954047203063965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([577, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.496389865875244  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.496389865875244  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.497490406036377  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5229640007019043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([431, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5242605209350586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5242605209350586  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.525082588195801  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5490307807922363  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([391, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5504989624023438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5504989624023438  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5512447357177734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.578693389892578  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([312, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.580120086669922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.580120086669922  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5807151794433594  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.610046863555908  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([250, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.61143159866333  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.61143159866333  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.611908435821533  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6357502937316895  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([201, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6370763778686523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6370763778686523  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6374597549438477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6593122482299805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([176, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6606431007385254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6606431007385254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6609787940979004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6824631690979004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([158, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.68381404876709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.68381404876709  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.684115409851074  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.705512046813965  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7067360877990723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7067360877990723  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.706984043121338  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7263245582580566  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([132, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7277231216430664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7277231216430664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7279748916625977  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.749375343322754  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.750424385070801  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.750424385070801  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.750603675842285  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7670984268188477  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7691330909729004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7691330909729004  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.769300937652588  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7859177589416504  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([74, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.786989212036133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.786989212036133  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.787130355834961  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.802091598510742  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.802882194519043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.802882194519043  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8029890060424805  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.815058708190918  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8161606788635254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8161606788635254  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.816286563873291  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.831392765045166  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.832341194152832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.832341194152832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8324499130249023  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.846257209777832  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8472299575805664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8472299575805664  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.847334861755371  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.861392021179199  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([63, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.862550735473633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.862550735473633  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8626708984375  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8796138763427734  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.880462169647217  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.880462169647217  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8805480003356934  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8932509422302246  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.894138813018799  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.894138813018799  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8942227363586426  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.907230854034424  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9079184532165527  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9079184532165527  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9079813957214355  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.918178081512451  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9190235137939453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9190235137939453  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.919095993041992  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.931344985961914  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([648, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9468793869018555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9468793869018555  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

 h.shape torch.Size([1, 648, 256]), torch.Size([1, 648, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.948115348815918  GigaBytes
Max Memory Allocated: 3.154575824737549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1675162315368652  GigaBytes
Max Memory Allocated: 3.1829657554626465  GigaBytes

rst.shape  torch.Size([1, 648, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1266026496887207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1274499893188477  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1282973289489746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1274075508117676  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 38555
output nodes number: 5684
edges number: 47805
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.127737522125244  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1277379989624023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06631135940551758  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 15 input nodes size: 97549
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05912971496582031  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05912971496582031  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10600471496582031  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10604715347290039  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061373233795166016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061373233795166016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061373233795166016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97549, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061373233795166016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1676, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2053365707397461  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2053365707397461  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1676, 128]), torch.Size([1, 1676, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20693492889404297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21980857849121094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1676, 128])
m.shape torch.Size([2148, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22105789184570312  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22105789184570312  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2148, 128]), torch.Size([1, 2148, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22310638427734375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25461387634277344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2148, 128])
m.shape torch.Size([2135, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25664377212524414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25664377212524414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2135, 128]), torch.Size([1, 2135, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2586860656738281  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3049478530883789  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2135, 128])
m.shape torch.Size([2123, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30797910690307617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30797910690307617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2123, 128]), torch.Size([1, 2123, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3105354309082031  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37088537216186523  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2123, 128])
m.shape torch.Size([2089, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37429332733154297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37429332733154297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3768620491027832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4518547058105469  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
m.shape torch.Size([1853, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4561600685119629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4561600685119629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1853, 128]), torch.Size([1, 1853, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45792722702026367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5353798866271973  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1853, 128])
m.shape torch.Size([1651, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5400071144104004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5400071144104004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1651, 128]), torch.Size([1, 1651, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5415816307067871  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6215815544128418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1651, 128])
m.shape torch.Size([1552, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6267147064208984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6267147064208984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1552, 128]), torch.Size([1, 1552, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6281948089599609  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7133865356445312  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1552, 128])
m.shape torch.Size([1496, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7190666198730469  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7190666198730469  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7204933166503906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8118019104003906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([21004, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9112434387207031  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9112434387207031  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 21004, 128]), torch.Size([1, 21004, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9312744140625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3820838928222656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 21004, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2500438690185547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2860231399536133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.322002410888672  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2857418060302734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37727, 256])
first layer input nodes number: 97549
first layer output nodes number: 37727
edges number: 289909
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3227314949035645  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.358710765838623  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3682265281677246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3682265281677246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([847, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.414536952972412  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.414536952972412  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 847, 256]), torch.Size([1, 847, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4161524772644043  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4296040534973145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 847, 256])
m.shape torch.Size([757, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.430349349975586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.430349349975586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 757, 256]), torch.Size([1, 757, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.431793212890625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.455174446105957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 757, 256])
m.shape torch.Size([596, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.456235885620117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.456235885620117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4573726654052734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4833626747131348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([466, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.484668254852295  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.484668254852295  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4855570793151855  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.513587474822998  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([389, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.515012741088867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.515012741088867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5157546997070312  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.544283866882324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([300, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5456433296203613  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5456433296203613  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.546215534210205  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.572726249694824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([241, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.574061870574951  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.574061870574951  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.574521541595459  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5975050926208496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([200, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.598813056945801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.598813056945801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5991945266723633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.620938301086426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6222963333129883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6222963333129883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6226377487182617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6444883346557617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.645750045776367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.645750045776367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6460342407226562  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6662120819091797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6673178672790527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6673178672790527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6675429344177246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.685098171234131  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.686347007751465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.686347007751465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6865720748901367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.705702781677246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7069272994995117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7069272994995117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7071313858032227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.725907325744629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7271242141723633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7271242141723633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.727311134338379  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.745816230773926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.746933937072754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.746933937072754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.74709415435791  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7640771865844727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7651658058166504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7651658058166504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.765310764312744  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.781691074371338  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7826972007751465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7826972007751465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.782823085784912  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.797929286956787  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7988181114196777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7988181114196777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7989230155944824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8122458457946777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.81321382522583  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.81321382522583  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8133187294006348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.827375888824463  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8283495903015137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8283495903015137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8284506797790527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8427042961120605  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8436226844787598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8436226844787598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8437142372131348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8572640419006348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8578314781188965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8578314781188965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.857886791229248  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8664603233337402  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8670296669006348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8670296669006348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8670811653137207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8754239082336426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.87615966796875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.87615966796875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.876222610473633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.886859893798828  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([590, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.901005268096924  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.901005268096924  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.902130603790283  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.10701847076416  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 590, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0668282508850098  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0676751136779785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0685219764709473  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0676326751708984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5681, 40])
input nodes number: 37727
output nodes number: 5681
edges number: 46125
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.06795597076416  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0679564476013184  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06677484512329102  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06677484512329102  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06677484512329102  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02562333643436432 |0.002828255295753479 |0.12304189801216125 |9.171664714813232e-05 |0.0746866762638092 |0.0047092437744140625 |
----------------------------------------------------------pseudo_mini_loss sum 4.115085601806641
Total (block generation + training)time/epoch 10.023910760879517
Training time/epoch 3.704216241836548
Training time without block to device /epoch 3.658964157104492
Training time without total dataloading part /epoch 3.1698338985443115
load block tensor time/epoch 0.4099733829498291
block to device time/epoch 0.045252084732055664
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2163971
Number of first layer input nodes during this epoch:  1560222
Number of first layer output nodes during this epoch:  603749
----------------------------------------before generate dataloader block 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06677436828613281  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.015906095504760742
number of batches is  16
batch size is  5684
random selection method spend 0.005943775177001953
time for parepare:  0.021412372589111328
local_output_nid generation:  0.002460002899169922
local_in_edges_tensor generation:  0.004876613616943359
mini_batch_src_global generation:  0.0016338825225830078
r_  generation:  0.015973329544067383
local_output_nid generation:  0.002905607223510742
local_in_edges_tensor generation:  0.001859903335571289
mini_batch_src_global generation:  0.001905202865600586
r_  generation:  0.016492843627929688
local_output_nid generation:  0.002980947494506836
local_in_edges_tensor generation:  0.001626729965209961
mini_batch_src_global generation:  0.001184701919555664
r_  generation:  0.016231775283813477
local_output_nid generation:  0.002959012985229492
local_in_edges_tensor generation:  0.0018603801727294922
mini_batch_src_global generation:  0.0012636184692382812
r_  generation:  0.016797542572021484
local_output_nid generation:  0.0029184818267822266
local_in_edges_tensor generation:  0.0015842914581298828
mini_batch_src_global generation:  0.001249551773071289
r_  generation:  0.01695704460144043
local_output_nid generation:  0.0029413700103759766
local_in_edges_tensor generation:  0.001506805419921875
mini_batch_src_global generation:  0.0012974739074707031
r_  generation:  0.017243146896362305
local_output_nid generation:  0.0029306411743164062
local_in_edges_tensor generation:  0.006825923919677734
mini_batch_src_global generation:  0.0013895034790039062
r_  generation:  0.019486427307128906
local_output_nid generation:  0.0028944015502929688
local_in_edges_tensor generation:  0.001558065414428711
mini_batch_src_global generation:  0.0015685558319091797
r_  generation:  0.019258737564086914
local_output_nid generation:  0.0029516220092773438
local_in_edges_tensor generation:  0.001561880111694336
mini_batch_src_global generation:  0.0015456676483154297
r_  generation:  0.019329547882080078
local_output_nid generation:  0.0029871463775634766
local_in_edges_tensor generation:  0.0016264915466308594
mini_batch_src_global generation:  0.0016245841979980469
r_  generation:  0.019660234451293945
local_output_nid generation:  0.002956390380859375
local_in_edges_tensor generation:  0.0015113353729248047
mini_batch_src_global generation:  0.0016014575958251953
r_  generation:  0.017737627029418945
local_output_nid generation:  0.0030188560485839844
local_in_edges_tensor generation:  0.0014731884002685547
mini_batch_src_global generation:  0.0013806819915771484
r_  generation:  0.017847061157226562
local_output_nid generation:  0.0029544830322265625
local_in_edges_tensor generation:  0.0015323162078857422
mini_batch_src_global generation:  0.0013909339904785156
r_  generation:  0.01741504669189453
local_output_nid generation:  0.0030248165130615234
local_in_edges_tensor generation:  0.0014786720275878906
mini_batch_src_global generation:  0.001352548599243164
r_  generation:  0.017622947692871094
local_output_nid generation:  0.002936840057373047
local_in_edges_tensor generation:  0.001477956771850586
mini_batch_src_global generation:  0.0014009475708007812
r_  generation:  0.01780247688293457
local_output_nid generation:  0.002950906753540039
local_in_edges_tensor generation:  0.0014345645904541016
mini_batch_src_global generation:  0.0014002323150634766
r_  generation:  0.0176541805267334
----------------------check_connections_block total spend ----------------------------- 0.4878220558166504
generate_one_block  0.03341269493103027
generate_one_block  0.026056289672851562
generate_one_block  0.025243759155273438
generate_one_block  0.026034116744995117
generate_one_block  0.02581501007080078
generate_one_block  0.02587580680847168
generate_one_block  0.02579188346862793
generate_one_block  0.02556324005126953
generate_one_block  0.02609705924987793
generate_one_block  0.026376724243164062
generate_one_block  0.026218414306640625
generate_one_block  0.02638530731201172
generate_one_block  0.025575637817382812
generate_one_block  0.025679588317871094
generate_one_block  0.026468992233276367
generate_one_block  0.02595829963684082
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029875755310058594
gen group dst list time:  0.01681828498840332
time for parepare:  0.018744945526123047
local_output_nid generation:  0.00790548324584961
local_in_edges_tensor generation:  0.014746665954589844
mini_batch_src_global generation:  0.009335041046142578
r_  generation:  0.1043863296508789
local_output_nid generation:  0.011302947998046875
local_in_edges_tensor generation:  0.010788440704345703
mini_batch_src_global generation:  0.011519908905029297
r_  generation:  0.10799479484558105
local_output_nid generation:  0.011663675308227539
local_in_edges_tensor generation:  0.00904083251953125
mini_batch_src_global generation:  0.012710094451904297
r_  generation:  0.11291217803955078
local_output_nid generation:  0.01190185546875
local_in_edges_tensor generation:  0.010017156600952148
mini_batch_src_global generation:  0.011390447616577148
r_  generation:  0.11520600318908691
local_output_nid generation:  0.011818408966064453
local_in_edges_tensor generation:  0.009467601776123047
mini_batch_src_global generation:  0.012181282043457031
r_  generation:  0.11715555191040039
local_output_nid generation:  0.011780261993408203
local_in_edges_tensor generation:  0.009407758712768555
mini_batch_src_global generation:  0.013846874237060547
r_  generation:  0.12164855003356934
local_output_nid generation:  0.012509346008300781
local_in_edges_tensor generation:  0.012066364288330078
mini_batch_src_global generation:  0.013098001480102539
r_  generation:  0.11901235580444336
local_output_nid generation:  0.011257171630859375
local_in_edges_tensor generation:  0.010251522064208984
mini_batch_src_global generation:  0.012819051742553711
r_  generation:  0.11714625358581543
local_output_nid generation:  0.011296987533569336
local_in_edges_tensor generation:  0.009477615356445312
mini_batch_src_global generation:  0.01281595230102539
r_  generation:  0.11920523643493652
local_output_nid generation:  0.011300325393676758
local_in_edges_tensor generation:  0.010212898254394531
mini_batch_src_global generation:  0.013303756713867188
r_  generation:  0.11940884590148926
local_output_nid generation:  0.011249065399169922
local_in_edges_tensor generation:  0.009672164916992188
mini_batch_src_global generation:  0.013616800308227539
r_  generation:  0.11805844306945801
local_output_nid generation:  0.011626005172729492
local_in_edges_tensor generation:  0.009654521942138672
mini_batch_src_global generation:  0.013695240020751953
r_  generation:  0.1204984188079834
local_output_nid generation:  0.01122903823852539
local_in_edges_tensor generation:  0.010702371597290039
mini_batch_src_global generation:  0.013712167739868164
r_  generation:  0.11860299110412598
local_output_nid generation:  0.011575937271118164
local_in_edges_tensor generation:  0.011376142501831055
mini_batch_src_global generation:  0.013146400451660156
r_  generation:  0.11773014068603516
local_output_nid generation:  0.01250457763671875
local_in_edges_tensor generation:  0.009611129760742188
mini_batch_src_global generation:  0.014484882354736328
r_  generation:  0.11933660507202148
local_output_nid generation:  0.011511087417602539
local_in_edges_tensor generation:  0.009324073791503906
mini_batch_src_global generation:  0.016090869903564453
r_  generation:  0.11779427528381348
----------------------check_connections_block total spend ----------------------------- 2.8969273567199707
generate_one_block  0.13865447044372559
generate_one_block  0.1360013484954834
generate_one_block  0.15600156784057617
generate_one_block  0.13826584815979004
generate_one_block  0.13760900497436523
generate_one_block  0.13659238815307617
generate_one_block  0.13828516006469727
generate_one_block  0.1381368637084961
generate_one_block  0.13688874244689941
generate_one_block  0.14235591888427734
generate_one_block  0.1437079906463623
generate_one_block  0.14562749862670898
generate_one_block  0.13608694076538086
generate_one_block  0.1369321346282959
generate_one_block  0.14073491096496582
generate_one_block  0.14170098304748535
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06677436828613281  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

connection checking time:  2.8969273567199707
block generation total time  2.243581771850586
average batch blocks generation time:  0.14022386074066162
block dataloader generation time/epoch 6.292912483215332
pseudo mini batch 0 input nodes size: 97555
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.058867454528808594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.058867454528808594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10538530349731445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10542774200439453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05851030349731445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06102609634399414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06102609634399414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06102609634399414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97555, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06102609634399414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1652, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20421743392944336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20421743392944336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1652, 128]), torch.Size([1, 1652, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20579290390014648  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21849298477172852  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1652, 128])
m.shape torch.Size([2079, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21968793869018555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21968793869018555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2079, 128]), torch.Size([1, 2079, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22226810455322266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25363636016845703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2079, 128])
m.shape torch.Size([2089, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2556333541870117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2556333541870117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25843000411987305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3045530319213867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
m.shape torch.Size([2171, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30769777297973633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30769777297973633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2171, 128]), torch.Size([1, 2171, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3097681999206543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37144899368286133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2171, 128])
m.shape torch.Size([2040, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3752775192260742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3752775192260742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2040, 128]), torch.Size([1, 2040, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37722301483154297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.44748973846435547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2040, 128])
m.shape torch.Size([1844, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45179271697998047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45179271697998047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1844, 128]), torch.Size([1, 1844, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4535512924194336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5294027328491211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1844, 128])
m.shape torch.Size([1755, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5343813896179199  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5343813896179199  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1755, 128]), torch.Size([1, 1755, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5360550880432129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6202926635742188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1755, 128])
m.shape torch.Size([1637, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6257004737854004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6257004737854004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1637, 128]), torch.Size([1, 1637, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6272616386413574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7187619209289551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1637, 128])
m.shape torch.Size([1520, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7245044708251953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7245044708251953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1520, 128]), torch.Size([1, 1520, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7259540557861328  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8187541961669922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1520, 128])
m.shape torch.Size([21004, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9181842803955078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9181842803955078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 21004, 128]), torch.Size([1, 21004, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9390335083007812  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.389842987060547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 21004, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.257225513458252  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2932658195495605  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.329306125640869  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2929840087890625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37791, 256])
first layer input nodes number: 97555
first layer output nodes number: 37791
edges number: 291126
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3300352096557617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3660755157470703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.375591278076172  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.375591278076172  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([830, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.421888828277588  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.421888828277588  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 830, 256]), torch.Size([1, 830, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4234719276428223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.436732769012451  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 830, 256])
m.shape torch.Size([705, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4373598098754883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4373598098754883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 705, 256]), torch.Size([1, 705, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.438704490661621  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4591736793518066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 705, 256])
m.shape torch.Size([580, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4604601860046387  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4604601860046387  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.46156644821167  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4867591857910156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([453, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4882025718688965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4882025718688965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4890666007995605  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.516909122467041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([389, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5183467864990234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5183467864990234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5190887451171875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5465383529663086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([309, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5479493141174316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5479493141174316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5485386848449707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5754408836364746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([299, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5776052474975586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5776052474975586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5781755447387695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.607508659362793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([211, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6088461875915527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6088461875915527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.609248638153076  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.632188320159912  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.633674144744873  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.633674144744873  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6340460777282715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6578497886657715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6591920852661133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6591920852661133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6594953536987305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.681027412414551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([147, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6824302673339844  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6824302673339844  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.682710647583008  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.704580307006836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([121, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7058358192443848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7058358192443848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.706066608428955  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7256836891174316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.726905345916748  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.726905345916748  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.727109432220459  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7458853721618652  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.747086524963379  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.747086524963379  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7472448348999023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7629175186157227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.763948917388916  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.763948917388916  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7640957832336426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.779663562774658  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7808051109313965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7808051109313965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7809557914733887  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.797982692718506  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7989888191223145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7989888191223145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.79911470413208  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.814220905303955  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.815023422241211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.815023422241211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8151187896728516  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.827230453491211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.827986717224121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.827986717224121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.828070640563965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8393163681030273  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.840254783630371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.840254783630371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8403520584106445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.854067802429199  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.855069160461426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.855069160461426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.855168342590332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.869847297668457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8704957962036133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8704957962036133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.870558738708496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.880314826965332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8810572624206543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8810572624206543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8811240196228027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8919386863708496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8926897048950195  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8926897048950195  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.892754554748535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.903714179992676  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([575, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9174981117248535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9174981117248535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9185948371887207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.117554187774658  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 575, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0773792266845703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0782265663146973  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.079073905944824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.078184127807617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37791
output nodes number: 5684
edges number: 46450
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0785088539123535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.07850980758667  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06552648544311523  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 1 input nodes size: 97352
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05851173400878906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05851173400878906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10538673400878906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10542917251586914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06135225296020508  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06135225296020508  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06135225296020508  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97352, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06135225296020508  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1606, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20325756072998047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20325756072998047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1606, 128]), torch.Size([1, 1606, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2047891616821289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21734046936035156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1606, 128])
m.shape torch.Size([2040, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21865558624267578  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21865558624267578  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2040, 128]), torch.Size([1, 2040, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22060108184814453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2507028579711914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2040, 128])
m.shape torch.Size([2085, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2527127265930176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2527127265930176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2085, 128]), torch.Size([1, 2085, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2547011375427246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30087947845458984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2085, 128])
m.shape torch.Size([2129, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30394601821899414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30394601821899414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2129, 128]), torch.Size([1, 2129, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30597639083862305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.36714792251586914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2129, 128])
m.shape torch.Size([2093, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3711228370666504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3711228370666504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2093, 128]), torch.Size([1, 2093, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.373136043548584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4475436210632324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2093, 128])
m.shape torch.Size([1833, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45178985595703125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45178985595703125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1833, 128]), torch.Size([1, 1833, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4535379409790039  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5306739807128906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1833, 128])
m.shape torch.Size([1655, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5353240966796875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5353240966796875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1655, 128]), torch.Size([1, 1655, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5369024276733398  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6181864738464355  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1655, 128])
m.shape torch.Size([1629, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6236114501953125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6236114501953125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1629, 128]), torch.Size([1, 1629, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6251649856567383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7172222137451172  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1629, 128])
m.shape torch.Size([1436, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7226080894470215  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7226080894470215  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1436, 128]), torch.Size([1, 1436, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7239775657653809  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8126997947692871  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1436, 128])
m.shape torch.Size([20790, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9116244316101074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9116244316101074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 20790, 128]), torch.Size([1, 20790, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9314513206481934  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.339160442352295  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 20790, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2079710960388184  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.243539333343506  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2791075706481934  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2432613372802734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37296, 256])
first layer input nodes number: 97352
first layer output nodes number: 37296
edges number: 287361
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2798352241516113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.315403461456299  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.325021266937256  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.325021266937256  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([849, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.370026111602783  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.370026111602783  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 849, 256]), torch.Size([1, 849, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.371645450592041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3850960731506348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 849, 256])
m.shape torch.Size([719, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3858642578125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3858642578125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 719, 256]), torch.Size([1, 719, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.387235641479492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.407834529876709  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 719, 256])
m.shape torch.Size([636, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4090781211853027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4090781211853027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 636, 256]), torch.Size([1, 636, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4102911949157715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.437150478363037  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 636, 256])
m.shape torch.Size([462, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4384727478027344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4384727478027344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4393539428710938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.467156410217285  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([385, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.468566417694092  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.468566417694092  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4693007469177246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4970993995666504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([319, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.499021053314209  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.499021053314209  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.499629497528076  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.528128147125244  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([257, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5295534133911133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5295534133911133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.530043601989746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5610952377319336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([215, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5625033378601074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5625033378601074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.562913417816162  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5862879753112793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([157, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5874414443969727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5874414443969727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.587740898132324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.606905937194824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([170, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6083903312683105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6083903312683105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6087145805358887  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6317362785339355  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.632991313934326  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.632991313934326  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.633246898651123  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6531825065612793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([124, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6544852256774902  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6544852256774902  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.654721736907959  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6748251914978027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([85, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.675769329071045  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.675769329071045  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.675931453704834  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6908469200134277  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.691896438598633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.691896438598633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.692056655883789  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.707918167114258  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.709078311920166  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.709078311920166  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.709242343902588  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7266297340393066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7274703979492188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7274703979492188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7275848388671875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7405166625976562  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.741292953491211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.741292953491211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7413902282714844  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.753063201904297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.753983497619629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.753983497619629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7540903091430664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.767655372619629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7693772315979004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7693772315979004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7694954872131348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.785341739654541  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.786283493041992  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.786283493041992  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7863826751708984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8003673553466797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8010849952697754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8010849952697754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8011574745178223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8118844032287598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.81284236907959  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.81284236907959  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.812932014465332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.826827049255371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8274455070495605  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8274455070495605  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.827502727508545  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8367724418640137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8375744819641113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8375744819641113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8376431465148926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.849247455596924  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([570, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8629093170166016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8629093170166016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8639965057373047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.065464973449707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 570, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0266013145446777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0274486541748047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0282959938049316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0274062156677246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37296
output nodes number: 5684
edges number: 45736
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.027726650238037  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0277271270751953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06637763977050781  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 2 input nodes size: 96991
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.1051177978515625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10516023635864258  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0582427978515625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06072711944580078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06072711944580078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06072711944580078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([96991, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06072711944580078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1641, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20265913009643555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20265913009643555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2042241096496582  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21691179275512695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
m.shape torch.Size([2110, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21820592880249023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21820592880249023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2110, 128]), torch.Size([1, 2110, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22021818161010742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2522444725036621  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2110, 128])
m.shape torch.Size([2185, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25371265411376953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25371265411376953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2185, 128]), torch.Size([1, 2185, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2573823928833008  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30414247512817383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2185, 128])
m.shape torch.Size([2161, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3072223663330078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3072223663330078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2161, 128]), torch.Size([1, 2161, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30956411361694336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3703899383544922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2161, 128])
m.shape torch.Size([2121, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37403249740600586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37403249740600586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2121, 128]), torch.Size([1, 2121, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37645816802978516  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4515395164489746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2121, 128])
m.shape torch.Size([1821, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4557380676269531  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4557380676269531  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1821, 128]), torch.Size([1, 1821, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4574747085571289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5332317352294922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1821, 128])
m.shape torch.Size([1761, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5382413864135742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5382413864135742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1761, 128]), torch.Size([1, 1761, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5399208068847656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6241097450256348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1761, 128])
m.shape torch.Size([1647, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6295528411865234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6295528411865234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1647, 128]), torch.Size([1, 1647, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6311235427856445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7229499816894531  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1647, 128])
m.shape torch.Size([1450, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7291302680969238  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7291302680969238  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1450, 128]), torch.Size([1, 1450, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7305130958557129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8196597099304199  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1450, 128])
m.shape torch.Size([20636, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9173684120178223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9173684120178223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 20636, 128]), torch.Size([1, 20636, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9370484352111816  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3343300819396973  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 20636, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.203495979309082  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.239290237426758  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2750844955444336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2390103340148926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37533, 256])
first layer input nodes number: 96991
first layer output nodes number: 37533
edges number: 287504
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2758092880249023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.311603546142578  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3212947845458984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3212947845458984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([875, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3663110733032227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3663110733032227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 875, 256]), torch.Size([1, 875, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3679800033569336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3818302154541016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 875, 256])
m.shape torch.Size([744, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.382641315460205  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.382641315460205  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 744, 256]), torch.Size([1, 744, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3840603828430176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.405670642852783  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 744, 256])
m.shape torch.Size([568, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4066295623779297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4066295623779297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.407712936401367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4341063499450684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([446, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4357428550720215  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4357428550720215  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.436593532562256  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4624457359313965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([419, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.464034080505371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.464034080505371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4648332595825195  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.494462013244629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([293, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4957523345947266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4957523345947266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4963111877441406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5288963317871094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([226, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5302863121032715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5302863121032715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.530717372894287  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5522704124450684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([228, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.554682731628418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.554682731628418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.555117607116699  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5799055099487305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5813231468200684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5813231468200684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.58168363571167  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.60475492477417  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([174, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6062474250793457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6062474250793457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.606579303741455  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6301426887512207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([116, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6312031745910645  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6312031745910645  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6314244270324707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.648682117462158  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.64992094039917  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.64992094039917  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.650144100189209  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6691126823425293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([116, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6704506874084473  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6704506874084473  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6706719398498535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6910271644592285  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([106, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.692343235015869  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.692343235015869  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6925454139709473  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7125611305236816  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.713700294494629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.713700294494629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.713864326477051  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7312517166137695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.732219696044922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.732219696044922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.732349395751953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7470054626464844  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7479209899902344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7479209899902344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.748035430908203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.761768341064453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7624897956848145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7624897956848145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.762575626373291  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7734761238098145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.774383068084717  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.774383068084717  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.774482250213623  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7877726554870605  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7886457443237305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7886457443237305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7887372970581055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8016462326049805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.802549362182617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.802549362182617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8026390075683594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.815906524658203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8163905143737793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8163905143737793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8164381980895996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.823829174041748  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.824446678161621  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.824446678161621  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8245019912719727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.833462715148926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8341732025146484  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8341732025146484  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8342342376708984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8445491790771484  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([575, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.858335018157959  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.858335018157959  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.859431743621826  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0662169456481934  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 575, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0273618698120117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0282092094421387  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0290565490722656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0281667709350586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37533
output nodes number: 5684
edges number: 45726
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.028489112854004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.028489589691162  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06568765640258789  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 3 input nodes size: 98062
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0582427978515625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0582427978515625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.1051177978515625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10516023635864258  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061403751373291016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061403751373291016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061403751373291016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([98062, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061403751373291016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1618, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2061767578125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2061767578125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1618, 128]), torch.Size([1, 1618, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2077198028564453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22034072875976562  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1618, 128])
m.shape torch.Size([2094, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22156620025634766  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22156620025634766  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2094, 128]), torch.Size([1, 2094, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22356319427490234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2542533874511719  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2094, 128])
m.shape torch.Size([2159, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25634336471557617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25634336471557617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2159, 128]), torch.Size([1, 2159, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2591066360473633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3063845634460449  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2159, 128])
m.shape torch.Size([2154, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3090691566467285  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3090691566467285  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2154, 128]), torch.Size([1, 2154, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3115200996398926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37273406982421875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2154, 128])
m.shape torch.Size([2104, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3767232894897461  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3767232894897461  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2104, 128]), torch.Size([1, 2104, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.378753662109375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4530525207519531  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2104, 128])
m.shape torch.Size([1903, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45749378204345703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45749378204345703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1903, 128]), torch.Size([1, 1903, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4593086242675781  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5377874374389648  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1903, 128])
m.shape torch.Size([1646, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5423741340637207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5423741340637207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5439438819885254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6238198280334473  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1646, 128])
m.shape torch.Size([1622, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6292223930358887  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6292223930358887  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1622, 128]), torch.Size([1, 1622, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6307692527770996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7235560417175293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1622, 128])
m.shape torch.Size([1486, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7291598320007324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7291598320007324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1486, 128]), torch.Size([1, 1486, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7305769920349121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8212752342224121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1486, 128])
m.shape torch.Size([21235, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9221291542053223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9221291542053223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 21235, 128]), torch.Size([1, 21235, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.942380428314209  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.395613193511963  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 21235, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2627415657043457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2990012168884277  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3352608680725098  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.298717498779297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([38021, 256])
first layer input nodes number: 98062
first layer output nodes number: 38021
edges number: 293059
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.335993766784668  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.37225341796875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3816590309143066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3816590309143066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([846, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.427974224090576  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.427974224090576  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 846, 256]), torch.Size([1, 846, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4295878410339355  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.443026065826416  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 846, 256])
m.shape torch.Size([725, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.443613052368164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.443613052368164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.444995880126953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.465738296508789  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([540, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.466616630554199  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.466616630554199  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.467646598815918  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.492645263671875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([459, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4939584732055664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4939584732055664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4948339462280273  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.521770477294922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([407, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5232887268066406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5232887268066406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5240650177001953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5521016120910645  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([315, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.553530216217041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.553530216217041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.554131031036377  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.58203125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([242, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5833592414855957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5833592414855957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5838208198547363  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6068997383117676  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([224, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.608464241027832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.608464241027832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.608891487121582  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.633244514465332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.634544849395752  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.634544849395752  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.634878635406494  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.656240940093994  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6576218605041504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6576218605041504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.657928943634033  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.679731845855713  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([126, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.680910587310791  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.680910587310791  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6811509132385254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6998963356018066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([118, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7011375427246094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7011375427246094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7013626098632812  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7204933166503906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([108, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7217302322387695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7217302322387695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7219362258911133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7408876419067383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.741971969604492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.741971969604492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.742137908935547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.758565902709961  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([95, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.759852886199951  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.759852886199951  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7600340843200684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7792410850524902  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.780336856842041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.780336856842041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.780470371246338  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7955574989318848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([69, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7966184616088867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7966184616088867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.796750068664551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8125429153442383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8135151863098145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8135151863098145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.813629627227783  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8281636238098145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8291659355163574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8291659355163574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8292765617370605  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8441004753112793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8450255393981934  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8450255393981934  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.845122814178467  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8588385581970215  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.859678268432617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.859678268432617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.859762191772461  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.872182846069336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8729867935180664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8729867935180664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.873063087463379  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8848886489868164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.885469913482666  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.885469913482666  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8855233192443848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8941750526428223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8947253227233887  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8947253227233887  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.894773006439209  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.902831554412842  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([611, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9174890518188477  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9174890518188477  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.918654441833496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1257753372192383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 611, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.085568904876709  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.086416244506836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.087263584136963  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.086373805999756  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 38021
output nodes number: 5684
edges number: 47015
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.086699962615967  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.086700439453125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0665888786315918  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 4 input nodes size: 97609
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10541248321533203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10545492172241211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05853748321533203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06105518341064453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06105518341064453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06105518341064453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97609, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06105518341064453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1606, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20421171188354492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20421171188354492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1606, 128]), torch.Size([1, 1606, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20574331283569336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21835565567016602  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1606, 128])
m.shape torch.Size([2087, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21958017349243164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21958017349243164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2087, 128]), torch.Size([1, 2087, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22217845916748047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25357723236083984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2087, 128])
m.shape torch.Size([2210, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25574350357055664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25574350357055664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2210, 128]), torch.Size([1, 2210, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25850582122802734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3053712844848633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2210, 128])
m.shape torch.Size([2160, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3084373474121094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3084373474121094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2160, 128]), torch.Size([1, 2160, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.31052112579345703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3710451126098633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2160, 128])
m.shape torch.Size([2009, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3748049736022949  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3748049736022949  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2009, 128]), torch.Size([1, 2009, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3767209053039551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.446810245513916  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2009, 128])
m.shape torch.Size([1880, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4512310028076172  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4512310028076172  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1880, 128]), torch.Size([1, 1880, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45302391052246094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5310802459716797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1880, 128])
m.shape torch.Size([1709, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5358881950378418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5358881950378418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1709, 128]), torch.Size([1, 1709, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5375180244445801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6206750869750977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1709, 128])
m.shape torch.Size([1593, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6259369850158691  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6259369850158691  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1593, 128]), torch.Size([1, 1593, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6274561882019043  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7150769233703613  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1593, 128])
m.shape torch.Size([1496, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7207374572753906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7207374572753906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7221641540527344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8134727478027344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([21055, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9131574630737305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9131574630737305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 21055, 128]), torch.Size([1, 21055, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9332370758056641  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3845815658569336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 21055, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.252925395965576  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2889790534973145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3250327110290527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2886972427368164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37805, 256])
first layer input nodes number: 97609
first layer output nodes number: 37805
edges number: 291096
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3257622718811035  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.361815929412842  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.371307373046875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.371307373046875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([837, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4176101684570312  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4176101684570312  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4192066192626953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4328560829162598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([696, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.433572769165039  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.433572769165039  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4349002838134766  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.455066204071045  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([571, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4564056396484375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4564056396484375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4574947357177734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4831643104553223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([509, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4847168922424316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4847168922424316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.485687732696533  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5138421058654785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([353, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.515094757080078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.515094757080078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.515768051147461  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5417556762695312  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([311, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.543212890625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.543212890625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5438060760498047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5700254440307617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([279, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.571606159210205  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.571606159210205  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5721383094787598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.599043369293213  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([220, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6004691123962402  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6004691123962402  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.600888729095459  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6248068809509277  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([202, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6271023750305176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6271023750305176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6274876594543457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6521458625793457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([173, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.653616428375244  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.653616428375244  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6539463996887207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6773743629455566  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.678499221801758  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.678499221801758  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.678731918334961  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6968822479248047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.698150157928467  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.698150157928467  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6983790397644043  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.717833995819092  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7190065383911133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7190065383911133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.719202995300293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.737277030944824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7384033203125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7384033203125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.738576889038086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7557601928710938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([71, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.756697177886963  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.756697177886963  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7568325996398926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7711873054504395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7720422744750977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7720422744750977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7721567153930664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.785088539123535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7867212295532227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7867212295532227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7868566513061523  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.803107261657715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8039565086364746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8039565086364746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8040575981140137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8168959617614746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.817594528198242  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.817594528198242  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8176727294921875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8281517028808594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.829246997833252  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.829246997833252  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.829359531402588  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.845226764678955  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8459982872009277  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8459982872009277  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.846076488494873  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8576502799987793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.858245849609375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.858245849609375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8583030700683594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8671722412109375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8678956031799316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8678956031799316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8679604530334473  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8784661293029785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.879241466522217  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.879241466522217  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8793082237243652  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.890590190887451  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([602, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.905022144317627  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.905022144317627  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.90617036819458  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.111288547515869  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 602, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.071091651916504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.071938991546631  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.072786331176758  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.071896553039551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37805
output nodes number: 5684
edges number: 46603
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.072220802307129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.072221279144287  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06555843353271484  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 5 input nodes size: 97421
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05853748321533203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05853748321533203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10541248321533203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10545492172241211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06137514114379883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06137514114379883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06137514114379883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97421, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06137514114379883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1559, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20528268814086914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20528268814086914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1559, 128]), torch.Size([1, 1559, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20676946640014648  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21919679641723633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1559, 128])
m.shape torch.Size([2158, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22051143646240234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22051143646240234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2158, 128]), torch.Size([1, 2158, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22256946563720703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2543525695800781  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2158, 128])
m.shape torch.Size([2252, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2565450668334961  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2565450668334961  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2252, 128]), torch.Size([1, 2252, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2588682174682617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.306427001953125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2252, 128])
m.shape torch.Size([2117, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3093910217285156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3093910217285156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3114938735961914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37111425399780273  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([2023, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3743133544921875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3743133544921875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2023, 128]), torch.Size([1, 2023, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37624263763427734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.44626903533935547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2023, 128])
m.shape torch.Size([1884, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45069456100463867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45069456100463867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1884, 128]), torch.Size([1, 1884, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45249128341674805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5303568840026855  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1884, 128])
m.shape torch.Size([1717, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5351896286010742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5351896286010742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1717, 128]), torch.Size([1, 1717, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5368270874023438  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6187000274658203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1717, 128])
m.shape torch.Size([1672, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6242594718933105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6242594718933105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1672, 128]), torch.Size([1, 1672, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6258540153503418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7182440757751465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1672, 128])
m.shape torch.Size([1564, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.724158763885498  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.724158763885498  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1564, 128]), torch.Size([1, 1564, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7256503105163574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8221631050109863  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1564, 128])
m.shape torch.Size([20792, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9210267066955566  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9210267066955566  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 20792, 128]), torch.Size([1, 20792, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9408555030822754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3487000465393066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 20792, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.217398166656494  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.253387928009033  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2893776893615723  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2531065940856934  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37738, 256])
first layer input nodes number: 97421
first layer output nodes number: 37738
edges number: 289909
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2901058197021484  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3260955810546875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.335712432861328  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.335712432861328  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([800, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.381979465484619  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.381979465484619  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.383505344390869  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.396902561187744  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([761, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3976874351501465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3976874351501465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 761, 256]), torch.Size([1, 761, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.399138927459717  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4209113121032715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 761, 256])
m.shape torch.Size([591, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.422253131866455  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.422253131866455  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4233803749084473  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4492592811584473  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([458, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4509143829345703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4509143829345703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4517879486083984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.478883743286133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([372, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4802350997924805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4802350997924805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4809446334838867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.508538246154785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([302, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.509925365447998  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.509925365447998  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5105013847351074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.538501262664795  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([262, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.539976119995117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.539976119995117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.540475845336914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5717782974243164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([245, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5734124183654785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5734124183654785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5738797187805176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.600515842437744  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([205, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.602055549621582  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.602055549621582  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6024465560913086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6274709701538086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.628870964050293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.628870964050293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.62918758392334  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.651667594909668  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([119, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.652925968170166  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.652925968170166  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6531529426574707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6708569526672363  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6720471382141113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6720471382141113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.672262668609619  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.690582752227783  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.691737174987793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.691737174987793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.691929817199707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.709652900695801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7107138633728027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7107138633728027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7108778953552246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7271170616149902  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7280731201171875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7280731201171875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.72821044921875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.742767333984375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7437753677368164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7437753677368164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7439088821411133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.75899600982666  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7597789764404297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7597789764404297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.759878158569336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.771780014038086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([68, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.772907257080078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.772907257080078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7730369567871094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.789508819580078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.790576457977295  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.790576457977295  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7906947135925293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8065409660339355  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8080244064331055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8080244064331055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8081235885620117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.822108268737793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([57, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.823209285736084  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.823209285736084  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8233180046081543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8394083976745605  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8400306701660156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8400306701660156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8400917053222656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8495521545410156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8501410484313965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8501410484313965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8501944541931152  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8588461875915527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8595809936523438  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8595809936523438  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8596439361572266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.870281219482422  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([577, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8841142654418945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8841142654418945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8852148056030273  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0870351791381836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 577, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0468602180480957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0477075576782227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0485548973083496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0476651191711426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37738
output nodes number: 5684
edges number: 46368
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0479888916015625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0479893684387207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06678009033203125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 6 input nodes size: 97312
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.1052708625793457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10531330108642578  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0583958625793457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.060910701751708984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.060910701751708984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.060910701751708984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97312, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.060910701751708984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1631, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20482826232910156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20482826232910156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1631, 128]), torch.Size([1, 1631, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20638370513916016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2191019058227539  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1631, 128])
m.shape torch.Size([2082, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22030973434448242  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22030973434448242  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2082, 128]), torch.Size([1, 2082, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22229528427124023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.253542423248291  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2082, 128])
m.shape torch.Size([2222, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25572824478149414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25572824478149414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2222, 128]), torch.Size([1, 2222, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25831174850463867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3057236671447754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2222, 128])
m.shape torch.Size([1991, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30846166610717773  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30846166610717773  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1991, 128]), torch.Size([1, 1991, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3103604316711426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3667292594909668  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1991, 128])
m.shape torch.Size([1981, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37050294876098633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37050294876098633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1981, 128]), torch.Size([1, 1981, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3723921775817871  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4419379234313965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1981, 128])
m.shape torch.Size([1852, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4462919235229492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4462919235229492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1852, 128]), torch.Size([1, 1852, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4480581283569336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.524785041809082  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1852, 128])
m.shape torch.Size([1685, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5295262336730957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5295262336730957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1685, 128]), torch.Size([1, 1685, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5311331748962402  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6120367050170898  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1685, 128])
m.shape torch.Size([1564, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6171994209289551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6171994209289551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1564, 128]), torch.Size([1, 1564, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6186909675598145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7037091255187988  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1564, 128])
m.shape torch.Size([1491, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7093620300292969  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7093620300292969  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1491, 128]), torch.Size([1, 1491, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7107839584350586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8018312454223633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1491, 128])
m.shape torch.Size([21140, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9026827812194824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9026827812194824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 21140, 128]), torch.Size([1, 21140, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9228434562683105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.37507963180542  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 21140, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.243502140045166  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.279397487640381  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3152928352355957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.279116630554199  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37639, 256])
first layer input nodes number: 97312
first layer output nodes number: 37639
edges number: 290568
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3160200119018555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3519153594970703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3613662719726562  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3613662719726562  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([836, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4076743125915527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4076743125915527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.409268856048584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4232945442199707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([722, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4240036010742188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4240036010742188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 722, 256]), torch.Size([1, 722, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4253807067871094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4460372924804688  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 722, 256])
m.shape torch.Size([597, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4472312927246094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4472312927246094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4483699798583984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4745254516601562  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([422, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4756016731262207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4756016731262207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4764065742492676  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5007987022399902  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([403, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.502333164215088  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.502333164215088  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5031018257141113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5311484336853027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([318, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5325980186462402  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5325980186462402  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5332045555114746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5620083808898926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([266, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.56349515914917  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.56349515914917  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.564002513885498  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.590853214263916  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([214, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.592245101928711  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.592245101928711  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.592653274536133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6159191131591797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([167, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.617159843444824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.617159843444824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.617478370666504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.637864112854004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([154, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6391854286193848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6391854286193848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.639479160308838  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6603341102600098  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.661709785461426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.661709785461426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.661984443664551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.683407783508301  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([133, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6848044395446777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6848044395446777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.685058116912842  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.706620693206787  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.708388328552246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.708388328552246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7085962295532227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7277231216430664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7287497520446777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7287497520446777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.728909969329834  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7447714805603027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.745628833770752  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.745628833770752  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7457528114318848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.758894443511963  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7599244117736816  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7599244117736816  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7600598335266113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.775362491607666  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([69, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7764225006103516  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7764225006103516  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7765541076660156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.792346954345703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.793302059173584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.793302059173584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.79341459274292  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.807706356048584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.80865478515625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.80865478515625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8087596893310547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.822816848754883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.823725700378418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.823725700378418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8238210678100586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8372678756713867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8380074501037598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8380074501037598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8380818367004395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.849091053009033  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8498363494873047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8498363494873047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8499069213867188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8608455657958984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.861517906188965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.861517906188965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.861578941345215  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.871466636657715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8720130920410156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8720130920410156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.872060775756836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8801193237304688  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([613, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.894824981689453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.894824981689453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 613, 256]), torch.Size([1, 613, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.895994186401367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1053171157836914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 613, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0651044845581055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0659518241882324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0667991638183594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0659093856811523  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37639
output nodes number: 5684
edges number: 46757
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.066232681274414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0662331581115723  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06629753112792969  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 7 input nodes size: 97839
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0583958625793457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0583958625793457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.1052708625793457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10531330108642578  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0613713264465332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0613713264465332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0613713264465332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97839, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0613713264465332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1663, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20533180236816406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20533180236816406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1663, 128]), torch.Size([1, 1663, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20691776275634766  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21973609924316406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1663, 128])
m.shape torch.Size([2127, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22097158432006836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22097158432006836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2127, 128]), torch.Size([1, 2127, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22300004959106445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2544221878051758  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2127, 128])
m.shape torch.Size([2175, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2565193176269531  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2565193176269531  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2175, 128]), torch.Size([1, 2175, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25904130935668945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30581188201904297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2175, 128])
m.shape torch.Size([2101, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30878210067749023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30878210067749023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2101, 128]), torch.Size([1, 2101, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3108334541320801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3703298568725586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2101, 128])
m.shape torch.Size([2041, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37363672256469727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37363672256469727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2041, 128]), torch.Size([1, 2041, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3755831718444824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4458155632019043  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2041, 128])
m.shape torch.Size([1907, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4502983093261719  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4502983093261719  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1907, 128]), torch.Size([1, 1907, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4521169662475586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5309486389160156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1907, 128])
m.shape torch.Size([1760, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5359139442443848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5359139442443848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1760, 128]), torch.Size([1, 1760, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5375924110412598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6215157508850098  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1760, 128])
m.shape torch.Size([1643, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6269440650939941  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6269440650939941  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1643, 128]), torch.Size([1, 1643, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6285109519958496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7207379341125488  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1643, 128])
m.shape torch.Size([1527, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7265076637268066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7265076637268066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1527, 128]), torch.Size([1, 1527, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.727963924407959  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8222098350524902  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1527, 128])
m.shape torch.Size([20792, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9210910797119141  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9210910797119141  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 20792, 128]), torch.Size([1, 20792, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9409198760986328  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.348764419555664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 20792, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2171554565429688  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.253143310546875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2891311645507812  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.252861976623535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37736, 256])
first layer input nodes number: 97839
first layer output nodes number: 37736
edges number: 289620
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2898621559143066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.325850009918213  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3354668617248535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3354668617248535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([827, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3817591667175293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3817591667175293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3833365440368652  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3965048789978027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([727, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3972644805908203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3972644805908203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.398651123046875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4194507598876953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([585, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4205846786499023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4205846786499023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4217004776000977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.448850631713867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([463, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4503626823425293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4503626823425293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4512457847595215  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.478541851043701  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([412, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4800806045532227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4800806045532227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4808664321899414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5095300674438477  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([301, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.510873317718506  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.510873317718506  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5114474296569824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5397000312805176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([230, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.540984630584717  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.540984630584717  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5414233207702637  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5633578300476074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([238, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5649685859680176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5649685859680176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.565422534942627  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5912976264953613  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([212, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.592904567718506  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.592904567718506  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.593308925628662  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.619187831878662  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([147, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6204309463500977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6204309463500977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.620711326599121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.640618324279785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.641846179962158  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.641846179962158  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6420788764953613  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.660229206085205  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([129, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6616010665893555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6616010665893555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6618471145629883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6827611923217773  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([115, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.684083938598633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.684083938598633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6843032836914062  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7044830322265625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7057409286499023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7057409286499023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.70590877532959  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7225255966186523  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([83, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.723809242248535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.723809242248535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7239675521850586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.740748405456543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.741753578186035  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.741753578186035  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.741887092590332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.756974220275879  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7582740783691406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7582740783691406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.758401870727539  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7737369537353516  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.775040626525879  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.775040626525879  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7751760482788086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.792374610900879  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7931108474731445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7931108474731445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7931947708129883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.804440498352051  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8052639961242676  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8052639961242676  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.805349826812744  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8174519538879395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.818470001220703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.818470001220703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8185672760009766  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8329639434814453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.833740234375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.833740234375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8338146209716797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8453445434570312  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.845860004425049  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.845860004425049  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.845907688140869  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8536324501037598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8541855812072754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8541855812072754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8542332649230957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8622918128967285  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([568, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.875916004180908  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.875916004180908  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8769993782043457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.081617832183838  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 568, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.041450023651123  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.04229736328125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.043144702911377  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.04225492477417  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37736
output nodes number: 5684
edges number: 46085
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.04257869720459  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.042579174041748  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06678295135498047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 8 input nodes size: 97614
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10541486740112305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10545730590820312  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05853986740112305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06104326248168945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06104326248168945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06104326248168945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97614, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06104326248168945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1682, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20501995086669922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20501995086669922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1682, 128]), torch.Size([1, 1682, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20662403106689453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2195138931274414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1682, 128])
m.shape torch.Size([2068, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22068405151367188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22068405151367188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2068, 128]), torch.Size([1, 2068, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22265625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25373268127441406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2068, 128])
m.shape torch.Size([2207, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2559037208557129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2559037208557129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2207, 128]), torch.Size([1, 2207, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2585487365722656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.305877685546875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2207, 128])
m.shape torch.Size([2163, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30895090103149414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30895090103149414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2163, 128]), torch.Size([1, 2163, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3110346794128418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37155628204345703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2163, 128])
m.shape torch.Size([2096, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3755221366882324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3755221366882324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2096, 128]), torch.Size([1, 2096, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3779582977294922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45205116271972656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2096, 128])
m.shape torch.Size([1881, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4559640884399414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4559640884399414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1881, 128]), torch.Size([1, 1881, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45775794982910156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5357065200805664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1881, 128])
m.shape torch.Size([1732, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.540590763092041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.540590763092041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1732, 128]), torch.Size([1, 1732, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5422425270080566  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.625241756439209  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1732, 128])
m.shape torch.Size([1664, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6307635307312012  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6307635307312012  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1664, 128]), torch.Size([1, 1664, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6323504447937012  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7243685722351074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1664, 128])
m.shape torch.Size([1454, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7298150062561035  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7298150062561035  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1454, 128]), torch.Size([1, 1454, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7312016487121582  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8220067024230957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1454, 128])
m.shape torch.Size([20817, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9205765724182129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9205765724182129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 20817, 128]), torch.Size([1, 20817, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9404292106628418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.349966526031494  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 20817, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.218522071838379  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2545366287231445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.29055118560791  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2542548179626465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37764, 256])
first layer input nodes number: 97614
first layer output nodes number: 37764
edges number: 289549
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.291280746459961  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3272953033447266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.336900234222412  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.336900234222412  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([864, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.383228302001953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.383228302001953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 864, 256]), torch.Size([1, 864, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.384876251220703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.399168014526367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 864, 256])
m.shape torch.Size([728, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3998236656188965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3998236656188965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 728, 256]), torch.Size([1, 728, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.401212215423584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4220404624938965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 728, 256])
m.shape torch.Size([582, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4233317375183105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4233317375183105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4244418144226074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4503307342529297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([464, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4519877433776855  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4519877433776855  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4528727531433105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4800477027893066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([378, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.481421947479248  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.481421947479248  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.482142925262451  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5095486640930176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([291, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.510866641998291  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.510866641998291  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5114216804504395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.538641929626465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([261, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5401206016540527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5401206016540527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.540618419647217  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5716357231140137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([190, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.572847843170166  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.572847843170166  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5732102394104004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5938668251037598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([191, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5953378677368164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5953378677368164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5957021713256836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6190176010131836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.620373249053955  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.620373249053955  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.620678424835205  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.642345905303955  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([159, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.644209861755371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.644209861755371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6445131301879883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.668168067932129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6694235801696777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6694235801696777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.669656276702881  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6894354820251465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6905064582824707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6905064582824707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.690687656402588  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.707357883453369  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7085189819335938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7085189819335938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7086963653564453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.72625732421875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([74, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.727235794067383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.727235794067383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.727376937866211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.742338180541992  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.743344306945801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.743344306945801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7434778213500977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7585649490356445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7596750259399414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7596750259399414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.759812355041504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.776291847229004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.777174949645996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.777174949645996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.777279853820801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.790602684020996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7914819717407227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7914819717407227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.791579246520996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8046140670776367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8057384490966797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8057384490966797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8058547973632812  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8222599029541016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.822988986968994  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.822988986968994  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.823063373565674  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8340725898742676  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.834817886352539  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.834817886352539  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.834888458251953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.845827102661133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.846587657928467  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.846587657928467  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.846656322479248  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8577799797058105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8584837913513184  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8584837913513184  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8585448265075684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8688597679138184  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([579, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.882741928100586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.882741928100586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 579, 256]), torch.Size([1, 579, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8838462829589844  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0881195068359375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 579, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0479421615600586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0487895011901855  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0496368408203125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0487470626831055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37764
output nodes number: 5684
edges number: 46311
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0490713119506836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.049071788787842  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06645822525024414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 9 input nodes size: 98602
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05853986740112305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05853986740112305  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10555696487426758  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10559940338134766  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.059010982513427734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061563968658447266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061563968658447266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061563968658447266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([98602, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061563968658447266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1617, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20744609832763672  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20744609832763672  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1617, 128]), torch.Size([1, 1617, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20898818969726562  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22132492065429688  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1617, 128])
m.shape torch.Size([2101, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22302007675170898  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22302007675170898  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2101, 128]), torch.Size([1, 2101, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22576618194580078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25651979446411133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2101, 128])
m.shape torch.Size([2190, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2586507797241211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2586507797241211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2190, 128]), torch.Size([1, 2190, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2613954544067383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.308652400970459  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2190, 128])
m.shape torch.Size([2095, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3113722801208496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3113722801208496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2095, 128]), torch.Size([1, 2095, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.31365013122558594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37319183349609375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2095, 128])
m.shape torch.Size([2122, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37725210189819336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37725210189819336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2122, 128]), torch.Size([1, 2122, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3799929618835449  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45530271530151367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2122, 128])
m.shape torch.Size([1842, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4595608711242676  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4595608711242676  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1842, 128]), torch.Size([1, 1842, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4613175392150879  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5379376411437988  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1842, 128])
m.shape torch.Size([1763, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5429439544677734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5429439544677734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1763, 128]), torch.Size([1, 1763, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5446252822875977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6288876533508301  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1763, 128])
m.shape torch.Size([1639, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6342992782592773  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6342992782592773  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1639, 128]), torch.Size([1, 1639, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6358623504638672  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7280206680297852  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1639, 128])
m.shape torch.Size([1496, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7336592674255371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7336592674255371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7350859642028809  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8263945579528809  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([21391, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9276814460754395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9276814460754395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 21391, 128]), torch.Size([1, 21391, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9480814933776855  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4029507637023926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 21391, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2694826126098633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.305966377258301  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3424501419067383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3056812286376953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([38256, 256])
first layer input nodes number: 98602
first layer output nodes number: 38256
edges number: 295258
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.343186855316162  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3796706199645996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3890018463134766  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3890018463134766  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([814, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4355039596557617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4355039596557617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 814, 256]), torch.Size([1, 814, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.437056541442871  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.450263500213623  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 814, 256])
m.shape torch.Size([732, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4509077072143555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4509077072143555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 732, 256]), torch.Size([1, 732, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.452303886413574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.475947380065918  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 732, 256])
m.shape torch.Size([568, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.477226734161377  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.477226734161377  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4783101081848145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.504774570465088  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.506244659423828  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.506244659423828  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5071163177490234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5333809852600098  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([383, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5353174209594727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5353174209594727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.53604793548584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5635809898376465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([286, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5648651123046875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5648651123046875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.565410614013672  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.590508460998535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([266, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5920257568359375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5920257568359375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5925331115722656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6183528900146484  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([195, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6203393936157227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6203393936157227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.620711326599121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.641911506652832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([191, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6433777809143066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6433777809143066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.643742084503174  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.667057514190674  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([180, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6686058044433594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6686058044433594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6689491271972656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6933250427246094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([147, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6947078704833984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6947078704833984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.694988250732422  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.71685791015625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.718101978302002  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.718101978302002  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7183308601379395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.737785816192627  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7389960289001465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7389960289001465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7391982078552246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.757798671722412  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7594523429870605  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7594523429870605  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7596144676208496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.775664806365967  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([71, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7766075134277344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7766075134277344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.776742935180664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.791097640991211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7922449111938477  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7922449111938477  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.79239559173584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.809422492980957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8104419708251953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8104419708251953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8105697631835938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8259048461914062  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([72, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.827086925506592  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.827086925506592  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8272242546081543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.844665050506592  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([64, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8457651138305664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8457651138305664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8458871841430664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8622446060180664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8632216453552246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8632216453552246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8633246421813965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.877847194671631  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.87890625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.87890625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8790111541748047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8945369720458984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8951401710510254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8951401710510254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8951992988586426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9043641090393066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.905130386352539  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.905130386352539  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9051990509033203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.916322708129883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9169344902038574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9169344902038574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.916987895965576  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.926013469696045  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([597, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9403319358825684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9403319358825684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9414706230163574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1443963050842285  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 597, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.103987216949463  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.10483455657959  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.105681896209717  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1047921180725098  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 38256
output nodes number: 5684
edges number: 47329
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1051197052001953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1051201820373535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06681203842163086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 10 input nodes size: 97726
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.059010982513427734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.059010982513427734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10588598251342773  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10592842102050781  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06138944625854492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06138944625854492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06138944625854492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97726, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06138944625854492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1618, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20476245880126953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20476245880126953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1618, 128]), torch.Size([1, 1618, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20630550384521484  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21893787384033203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1618, 128])
m.shape torch.Size([2060, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22013092041015625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22013092041015625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2060, 128]), torch.Size([1, 2060, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22250843048095703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25380420684814453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2060, 128])
m.shape torch.Size([2219, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2559962272644043  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2559962272644043  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2219, 128]), torch.Size([1, 2219, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25887441635131836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30582141876220703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2219, 128])
m.shape torch.Size([2085, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30874013900756836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30874013900756836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2085, 128]), torch.Size([1, 2085, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3107924461364746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.369781494140625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2085, 128])
m.shape torch.Size([2072, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37372732162475586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37372732162475586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2072, 128]), torch.Size([1, 2072, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3764982223510742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4508638381958008  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2072, 128])
m.shape torch.Size([1919, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45456504821777344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45456504821777344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1919, 128]), torch.Size([1, 1919, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45639514923095703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5361709594726562  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1919, 128])
m.shape torch.Size([1695, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5409135818481445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5409135818481445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1695, 128]), torch.Size([1, 1695, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5425300598144531  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6245627403259277  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1695, 128])
m.shape torch.Size([1608, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6298885345458984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6298885345458984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1608, 128]), torch.Size([1, 1608, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6314220428466797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7191314697265625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1608, 128])
m.shape torch.Size([1482, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7247247695922852  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7247247695922852  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1482, 128]), torch.Size([1, 1482, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7261381149291992  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8165922164916992  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1482, 128])
m.shape torch.Size([21085, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9164266586303711  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9164266586303711  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 21085, 128]), torch.Size([1, 21085, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9365348815917969  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3881940841674805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 21085, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2563819885253906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2924718856811523  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.328561782836914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.292189598083496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37843, 256])
first layer input nodes number: 97726
first layer output nodes number: 37843
edges number: 291526
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.329291820526123  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3653817176818848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.374858856201172  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.374858856201172  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([847, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.421173095703125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.421173095703125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 847, 256]), torch.Size([1, 847, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.422788619995117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4366636276245117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 847, 256])
m.shape torch.Size([761, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4373536109924316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4373536109924316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 761, 256]), torch.Size([1, 761, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.438805103302002  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4605774879455566  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 761, 256])
m.shape torch.Size([571, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.461653709411621  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.461653709411621  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.462742805480957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.488618850708008  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([454, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4900527000427246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4900527000427246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4909186363220215  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5176663398742676  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([394, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5191268920898438  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5191268920898438  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.519878387451172  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5475125312805176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([298, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.549112319946289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.549112319946289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.549680709838867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.575343132019043  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([202, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.576418399810791  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.576418399810791  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.576803684234619  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5960679054260254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([208, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5974745750427246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5974745750427246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5978713035583496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6204848289489746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([204, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6222949028015137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6222949028015137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6226840019226074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6475863456726074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([160, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6489295959472656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6489295959472656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6492347717285156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6709022521972656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([125, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6720714569091797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6720714569091797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6723098754882812  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.690906524658203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([123, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.692206382751465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.692206382751465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.692440986633301  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7123823165893555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.713602066040039  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.713602066040039  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.71380615234375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7325820922851562  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([109, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7339468002319336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7339468002319336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.73415470123291  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.75473690032959  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([92, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7559595108032227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7559595108032227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7561349868774414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.774735450744629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([74, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7757859230041504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7757859230041504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7759270668029785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7918763160705566  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.792965888977051  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.792965888977051  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7931013107299805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.809351921081543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.809976577758789  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.809976577758789  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8100528717041016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.819742202758789  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8205623626708984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8205623626708984  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8206520080566406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8326644897460938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.833465576171875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.833465576171875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8335494995117188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8453826904296875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8461079597473145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8461079597473145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8461804389953613  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.856907367706299  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.857632637023926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.857632637023926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.857701301574707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.868344306945801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.869105815887451  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.869105815887451  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8691744804382324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.880298137664795  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8810253143310547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8810253143310547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8810882568359375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.891725540161133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([610, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9063515663146973  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9063515663146973  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.907515048980713  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.115230083465576  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 610, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.075023651123047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.075870990753174  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.076718330383301  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0758285522460938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37843
output nodes number: 5684
edges number: 46662
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.07615327835083  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0761537551879883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06589698791503906  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 11 input nodes size: 98312
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10574769973754883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.1057901382446289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05887269973754883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06143522262573242  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06143522262573242  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06143522262573242  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([98312, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06143522262573242  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1595, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20731878280639648  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20731878280639648  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1595, 128]), torch.Size([1, 1595, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20883989334106445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2215561866760254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1595, 128])
m.shape torch.Size([2191, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2228851318359375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2228851318359375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2191, 128]), torch.Size([1, 2191, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22570085525512695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.257814884185791  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2191, 128])
m.shape torch.Size([2136, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2599043846130371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2599043846130371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2136, 128]), torch.Size([1, 2136, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.26194143295288086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3081703186035156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2136, 128])
m.shape torch.Size([2175, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.31130027770996094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.31130027770996094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2175, 128]), torch.Size([1, 2175, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.313870906829834  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3751039505004883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2175, 128])
m.shape torch.Size([2009, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3788566589355469  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3788566589355469  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2009, 128]), torch.Size([1, 2009, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.38077259063720703  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45086193084716797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2009, 128])
m.shape torch.Size([1850, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4551968574523926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4551968574523926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1850, 128]), torch.Size([1, 1850, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45696115493774414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5328259468078613  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1850, 128])
m.shape torch.Size([1797, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5379419326782227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5379419326782227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1797, 128]), torch.Size([1, 1797, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5396556854248047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6253433227539062  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1797, 128])
m.shape torch.Size([1705, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6309905052185059  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6309905052185059  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1705, 128]), torch.Size([1, 1705, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6326165199279785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7258658409118652  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1705, 128])
m.shape torch.Size([1521, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7315802574157715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7315802574157715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1521, 128]), torch.Size([1, 1521, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7330307960510254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.826561450958252  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1521, 128])
m.shape torch.Size([21452, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9281272888183594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9281272888183594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 21452, 128]), torch.Size([1, 21452, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9485855102539062  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.404094696044922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 21452, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.270010471343994  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3066611289978027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3433117866516113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3063745498657227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([38431, 256])
first layer input nodes number: 98312
first layer output nodes number: 38431
edges number: 296658
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3440465927124023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.380697250366211  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3899993896484375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3899993896484375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([783, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.436342239379883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.436342239379883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.437835693359375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4505624771118164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 783, 256])
m.shape torch.Size([781, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.451338291168213  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.451338291168213  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 781, 256]), torch.Size([1, 781, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4528279304504395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4763340950012207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 781, 256])
m.shape torch.Size([570, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4774675369262695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4774675369262695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4785547256469727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5050301551818848  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([453, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5063886642456055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5063886642456055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5072526931762695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.535027503967285  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([376, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.536402702331543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.536402702331543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5371198654174805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.563971519470215  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([314, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5654239654541016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5654239654541016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5660228729248047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5942158699035645  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([245, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.595564842224121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.595564842224121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.59603214263916  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6193971633911133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([237, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.620985984802246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.620985984802246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6214380264282227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6472043991088867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.648527145385742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.648527145385742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6488685607910156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6707191467285156  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6720962524414062  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6720962524414062  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.672403335571289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6942062377929688  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([153, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6956706047058105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6956706047058105  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.695962429046631  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7187247276306152  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([98, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7197208404541016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7197208404541016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.719907760620117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7357959747314453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7373013496398926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7373013496398926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7374939918518066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7552170753479004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.756173610687256  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.756173610687256  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7563185691833496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.770669460296631  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([97, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7719955444335938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7719955444335938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7721805572509766  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7917919158935547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([67, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7927584648132324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7927584648132324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.792886257171631  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8073267936706543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8083086013793945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8083086013793945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8084306716918945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8230791091918945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.824021816253662  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.824021816253662  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8241324424743652  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.838181972503662  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8390398025512695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8390398025512695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.83913516998291  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.851914405822754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.852808952331543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.852808952331543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.852902412414551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8660802841186523  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8669824600219727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8669824600219727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.867072105407715  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8803396224975586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.881013870239258  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.881013870239258  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8810787200927734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8911304473876953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8917393684387207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8917393684387207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8917946815490723  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9007554054260254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.901742935180664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.901742935180664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.901826858520508  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9160099029541016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([618, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9308176040649414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9308176040649414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 618, 256]), torch.Size([1, 618, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9319963455200195  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1416540145874023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 618, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.101353645324707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.102200984954834  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.103048324584961  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.102158546447754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 38431
output nodes number: 5684
edges number: 47196
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.102487564086914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1024880409240723  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06602191925048828  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 12 input nodes size: 96512
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05887269973754883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05887269973754883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10574769973754883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.1057901382446289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061350345611572266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061350345611572266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061350345611572266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([96512, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061350345611572266  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1670, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20328998565673828  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20328998565673828  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1670, 128]), torch.Size([1, 1670, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20488262176513672  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21767330169677734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1670, 128])
m.shape torch.Size([2130, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2189655303955078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2189655303955078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2130, 128]), torch.Size([1, 2130, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22099685668945312  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25296783447265625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2130, 128])
m.shape torch.Size([2142, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2544698715209961  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2544698715209961  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2142, 128]), torch.Size([1, 2142, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2570533752441406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3034677505493164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2142, 128])
m.shape torch.Size([2108, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30646705627441406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30646705627441406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2108, 128]), torch.Size([1, 2108, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3084983825683594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3691539764404297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2108, 128])
m.shape torch.Size([2008, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3729362487792969  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3729362487792969  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2008, 128]), torch.Size([1, 2008, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3748512268066406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4449348449707031  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2008, 128])
m.shape torch.Size([1815, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4491701126098633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4491701126098633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1815, 128]), torch.Size([1, 1815, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4509010314941406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5261926651000977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1815, 128])
m.shape torch.Size([1653, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5308446884155273  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5308446884155273  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1653, 128]), torch.Size([1, 1653, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5324211120605469  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6130847930908203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1653, 128])
m.shape torch.Size([1592, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6183695793151855  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6183695793151855  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1592, 128]), torch.Size([1, 1592, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6198878288269043  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7064557075500488  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1592, 128])
m.shape torch.Size([1478, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7120394706726074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7120394706726074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1478, 128]), torch.Size([1, 1478, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7134490013122559  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8037505149841309  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1478, 128])
m.shape torch.Size([20787, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9026551246643066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9026551246643066  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 20787, 128]), torch.Size([1, 20787, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9224791526794434  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3299851417541504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 20787, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.199040412902832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.234691619873047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2703428268432617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.234412670135498  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37383, 256])
first layer input nodes number: 96512
first layer output nodes number: 37383
edges number: 287197
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.271063804626465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3067150115966797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3163342475891113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3163342475891113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([846, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3614087104797363  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3614087104797363  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 846, 256]), torch.Size([1, 846, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3630223274230957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3767943382263184  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 846, 256])
m.shape torch.Size([764, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.377561092376709  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.377561092376709  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 764, 256]), torch.Size([1, 764, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3790183067321777  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.400876522064209  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 764, 256])
m.shape torch.Size([582, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.401855945587158  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.401855945587158  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.402966022491455  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4290318489074707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([487, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4307003021240234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4307003021240234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.431629180908203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4592275619506836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([354, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.460482120513916  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.460482120513916  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4611573219299316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.485722064971924  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([306, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.487175941467285  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.487175941467285  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.487759590148926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.516068458557129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([241, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5174951553344727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5174951553344727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5179548263549805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.540938377380371  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5422911643981934  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5422911643981934  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.542680263519287  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.564858913421631  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([177, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.566195487976074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.566195487976074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.566533088684082  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.588139533996582  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([186, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.58975887298584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.58975887298584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.590113639831543  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.615302085876465  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([150, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.616710662841797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.616710662841797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6169967651367188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.639312744140625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.640669822692871  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.640669822692871  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.640913963317871  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.661665916442871  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6629209518432617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6629209518432617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.663102149963379  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.67977237701416  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.681058883666992  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.681058883666992  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6812267303466797  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.697843551635742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([79, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.699136257171631  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.699136257171631  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.699286937713623  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.715259075164795  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7162132263183594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7162132263183594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.716339111328125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7305641174316406  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7314653396606445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7314653396606445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7315778732299805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.745081901550293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7461276054382324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7461276054382324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.746243953704834  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7610201835632324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7619118690490723  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7619118690490723  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7620110511779785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.775301456451416  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7761173248291016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7761173248291016  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.776203155517578  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7883052825927734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7890095710754395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7890095710754395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7890801429748535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7995247840881348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.800208568572998  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.800208568572998  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8002734184265137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8103251457214355  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8112215995788574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8112215995788574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8113017082214355  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.824279308319092  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8249545097351074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8249545097351074  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8250136375427246  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8350062370300293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([570, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.848672866821289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.848672866821289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.849760055541992  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0565733909606934  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 570, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.017637252807617  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.018484592437744  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.019331932067871  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.018442153930664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37383
output nodes number: 5684
edges number: 45814
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.018763542175293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.018764019012451  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06644916534423828  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 13 input nodes size: 97398
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10531187057495117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10535430908203125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05843687057495117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06093740463256836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06093740463256836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06093740463256836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97398, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06093740463256836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1700, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20493268966674805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20493268966674805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1700, 128]), torch.Size([1, 1700, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20655393600463867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21952390670776367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1700, 128])
m.shape torch.Size([2034, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22065305709838867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22065305709838867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2034, 128]), torch.Size([1, 2034, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22259283065795898  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2517695426940918  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2034, 128])
m.shape torch.Size([2169, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2547593116760254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2547593116760254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2169, 128]), torch.Size([1, 2169, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25739431381225586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3035855293273926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2169, 128])
m.shape torch.Size([2123, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30660057067871094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30660057067871094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2123, 128]), torch.Size([1, 2123, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30901098251342773  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.36921215057373047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2123, 128])
m.shape torch.Size([2126, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37268543243408203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37268543243408203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2126, 128]), torch.Size([1, 2126, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37529468536376953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45113515853881836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2126, 128])
m.shape torch.Size([1905, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45557165145874023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45557165145874023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1905, 128]), torch.Size([1, 1905, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45738840103149414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5355086326599121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1905, 128])
m.shape torch.Size([1666, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5401611328125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5401611328125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1666, 128]), torch.Size([1, 1666, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5417499542236328  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6259546279907227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1666, 128])
m.shape torch.Size([1653, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6319808959960938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6319808959960938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1653, 128]), torch.Size([1, 1653, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6335573196411133  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7258701324462891  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1653, 128])
m.shape torch.Size([1491, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.731480598449707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.731480598449707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1491, 128]), torch.Size([1, 1491, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7329025268554688  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.823969841003418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1491, 128])
m.shape torch.Size([20802, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9224505424499512  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9224505424499512  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 20802, 128]), torch.Size([1, 20802, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.942288875579834  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3508105278015137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 20802, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.218904972076416  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.254828929901123  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.29075288772583  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2545480728149414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37669, 256])
first layer input nodes number: 97398
first layer output nodes number: 37669
edges number: 289152
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.291480541229248  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.327404499053955  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3370165824890137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3370165824890137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([855, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3833365440368652  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3833365440368652  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 855, 256]), torch.Size([1, 855, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.38496732711792  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3985352516174316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 855, 256])
m.shape torch.Size([688, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.399069309234619  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.399069309234619  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.400381565093994  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4203476905822754  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([584, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.421462059020996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.421462059020996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4225759506225586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4490137100219727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 584, 256])
m.shape torch.Size([441, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.450265884399414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.450265884399414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4511070251464844  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4755001068115234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([408, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4770402908325195  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4770402908325195  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.477818489074707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5063939094543457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([320, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.507850170135498  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.507850170135498  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.508460521697998  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.536834239959717  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([274, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.53837251663208  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.53837251663208  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5388951301574707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5697808265686035  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([218, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5711960792541504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5711960792541504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5716118812561035  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5953125953674316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([170, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5965752601623535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5965752601623535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5968995094299316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6176514625549316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([164, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.619065761566162  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.619065761566162  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6193785667419434  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.641587734222412  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([153, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6430492401123047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6430492401123047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.643341064453125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6661033630371094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([127, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.667422294616699  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.667422294616699  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6676645278930664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6882543563842773  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6894078254699707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6894078254699707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6896023750305176  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.70750093460083  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.708695411682129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.708695411682129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.708878517150879  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.727005958557129  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([72, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.727956771850586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.727956771850586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7280941009521484  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7426509857177734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.743743896484375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.743743896484375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.743875503540039  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.758747100830078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.759613037109375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.759613037109375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7597217559814453  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.772768020629883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7737340927124023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7737340927124023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7738447189331055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7878942489624023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.788879871368408  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.788879871368408  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7889885902404785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8035569190979004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.804271697998047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.804271697998047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8043479919433594  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.815105438232422  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8159356117248535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8159356117248535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8160176277160645  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.828155994415283  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.828791618347168  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.828791618347168  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.828852653503418  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.838313102722168  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8390121459960938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8390121459960938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8390750885009766  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.849271774291992  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.850001811981201  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.850001811981201  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.850064754486084  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8607020378112793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([590, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.874847412109375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.874847412109375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8759727478027344  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.082557201385498  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 590, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.042369842529297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.043217182159424  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.044064521789551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0431747436523438  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 37669
output nodes number: 5684
edges number: 46404
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0434980392456055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0434985160827637  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06636381149291992  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 14 input nodes size: 97772
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05843687057495117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.05843687057495117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10531187057495117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10535430908203125  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061406612396240234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061406612396240234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061406612396240234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97772, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061406612396240234  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1655, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20619916915893555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20619916915893555  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1655, 128]), torch.Size([1, 1655, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2077775001525879  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22046709060668945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1655, 128])
m.shape torch.Size([2100, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2216806411743164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2216806411743164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2100, 128]), torch.Size([1, 2100, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.22368335723876953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2544279098510742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2100, 128])
m.shape torch.Size([2191, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2565608024597168  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2565608024597168  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2191, 128]), torch.Size([1, 2191, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2593107223510742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3067498207092285  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2191, 128])
m.shape torch.Size([2066, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3094191551208496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3094191551208496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2066, 128]), torch.Size([1, 2066, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3116917610168457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37046337127685547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2066, 128])
m.shape torch.Size([2055, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3743777275085449  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.3743777275085449  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2055, 128]), torch.Size([1, 2055, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.377230167388916  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45139551162719727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2055, 128])
m.shape torch.Size([1856, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45482778549194336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45482778549194336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1856, 128]), torch.Size([1, 1856, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45659780502319336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5350852012634277  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1856, 128])
m.shape torch.Size([1762, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5400815010070801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5400815010070801  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1762, 128]), torch.Size([1, 1762, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5417618751525879  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6259875297546387  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1762, 128])
m.shape torch.Size([1662, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6314873695373535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6314873695373535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6330723762512207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7250809669494629  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([1518, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7311396598815918  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7311396598815918  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1518, 128]), torch.Size([1, 1518, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7325873374938965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8252387046813965  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1518, 128])
m.shape torch.Size([21187, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9260773658752441  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9260773658752441  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 21187, 128]), torch.Size([1, 21187, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9470252990722656  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.399754524230957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 21187, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2672410011291504  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.303530216217041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3398194313049316  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.30324649810791  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([38052, 256])
first layer input nodes number: 97772
first layer output nodes number: 38052
edges number: 293265
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.340549945831299  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3768391609191895  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.38626766204834  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.38626766204834  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([850, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.432706356048584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.432706356048584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 850, 256]), torch.Size([1, 850, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4343276023864746  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.448087215423584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 850, 256])
m.shape torch.Size([715, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.448674201965332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.448674201965332  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 715, 256]), torch.Size([1, 715, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.450037956237793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4706220626831055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 715, 256])
m.shape torch.Size([551, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4717836380004883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4717836380004883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 551, 256]), torch.Size([1, 551, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.472834587097168  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.49655818939209  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 551, 256])
m.shape torch.Size([459, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.497877597808838  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.497877597808838  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.498753070831299  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.524942398071289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([410, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.526945114135742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.526945114135742  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5277271270751953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5561270713806152  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([317, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5575642585754395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5575642585754395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.558168888092041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5869693756103516  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.588322162628174  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.588322162628174  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5887913703918457  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6122517585754395  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([217, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6136860847473145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6136860847473145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6140999794006348  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6376919746398926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([173, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.638981819152832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.638981819152832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6393117904663086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6604299545288086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([137, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6615819931030273  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6615819931030273  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6618432998657227  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.68039608001709  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([146, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.681809425354004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.681809425354004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6820878982543945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7038087844848633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.70548677444458  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.70548677444458  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.705681324005127  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7222180366516113  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([104, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7234206199645996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7234206199645996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.723618984222412  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.741868495941162  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.742913246154785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.742913246154785  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.743075370788574  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7591257095336914  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.760270118713379  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.760270118713379  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.760432243347168  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7776174545288086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7786130905151367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7786130905151367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7787466049194336  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7938337326049805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.794992446899414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.794992446899414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.795135498046875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8123016357421875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([75, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.813528060913086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.813528060913086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.813671112060547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.831838607788086  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8326072692871094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8326072692871094  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8326950073242188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.844451904296875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.845460891723633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.845460891723633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8455638885498047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.860086441040039  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.860903263092041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.860903263092041  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.860985279083252  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8731236457824707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8738865852355957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8738865852355957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8739590644836426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.885193347930908  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8858866691589355  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8858866691589355  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8859496116638184  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.896146297454834  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([49, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.897245407104492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.897245407104492  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8973388671875  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9131336212158203  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([604, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9275999069213867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9275999069213867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.9287519454956055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1341552734375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 604, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.093836784362793  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.09468412399292  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.095531463623047  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.09464168548584  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5684, 40])
input nodes number: 38052
output nodes number: 5684
edges number: 47226
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.094967842102051  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.094968318939209  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06649303436279297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

pseudo mini batch 15 input nodes size: 97527
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10537338256835938  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.10541582107543945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.058498382568359375  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061008453369140625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061008453369140625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061008453369140625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([97527, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.061008453369140625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([1669, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2049565315246582  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2049565315246582  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1669, 128]), torch.Size([1, 1669, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.20654821395874023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.21940374374389648  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1669, 128])
m.shape torch.Size([2099, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2206096649169922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2206096649169922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2099, 128]), torch.Size([1, 2099, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2226114273071289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2538752555847168  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2099, 128])
m.shape torch.Size([2210, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25603580474853516  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.25603580474853516  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2210, 128]), torch.Size([1, 2210, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.2585878372192383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30581235885620117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2210, 128])
m.shape torch.Size([2110, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30878305435180664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.30878305435180664  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2110, 128]), torch.Size([1, 2110, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.31084299087524414  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37019872665405273  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2110, 128])
m.shape torch.Size([2022, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37401342391967773  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37401342391967773  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 2022, 128]), torch.Size([1, 2022, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.37594175338745117  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4459567070007324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 2022, 128])
m.shape torch.Size([1800, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45014238357543945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.45014238357543945  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1800, 128]), torch.Size([1, 1800, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.4518589973449707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.527428150177002  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1800, 128])
m.shape torch.Size([1630, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.532010555267334  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.532010555267334  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1630, 128]), torch.Size([1, 1630, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.5335650444030762  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6139483451843262  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1630, 128])
m.shape torch.Size([1560, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6191220283508301  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6191220283508301  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1560, 128]), torch.Size([1, 1560, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.6206097602844238  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7054762840270996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1560, 128])
m.shape torch.Size([1455, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7109766006469727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7109766006469727  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 1455, 128]), torch.Size([1, 1455, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.7123641967773438  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.8014850616455078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 1455, 128])
m.shape torch.Size([21142, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9023537635803223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9023537635803223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 21142, 128]), torch.Size([1, 21142, 128])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.9225163459777832  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3747735023498535  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 21142, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2431588172912598  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.279109477996826  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3150601387023926  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.2788281440734863  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([37697, 256])
first layer input nodes number: 97527
first layer output nodes number: 37697
edges number: 290252
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.315788745880127  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.3517394065856934  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.361189365386963  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.361189365386963  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

m.shape torch.Size([869, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4075241088867188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4075241088867188  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 869, 256]), torch.Size([1, 869, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.409181594848633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.423184394836426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 869, 256])
m.shape torch.Size([738, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4239230155944824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4239230155944824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 738, 256]), torch.Size([1, 738, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.425330638885498  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4464449882507324  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 738, 256])
m.shape torch.Size([601, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4476470947265625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4476470947265625  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.448793411254883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.4743642807006836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([433, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.475482940673828  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.475482940673828  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.476308822631836  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.501944065093994  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([379, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.503352642059326  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.503352642059326  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.504075527191162  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.53127384185791  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([268, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5324583053588867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5324583053588867  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5329694747924805  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.556870460510254  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([249, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.558290481567383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.558290481567383  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.558765411376953  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.5825119018554688  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([208, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.583873748779297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.583873748779297  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.584270477294922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.606884002685547  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.608320713043213  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.608320713043213  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6086812019348145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6317524909973145  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([147, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6329851150512695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6329851150512695  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.633265495300293  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.653172492980957  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([140, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.655198574066162  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.655198574066162  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.655465602874756  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6762938499450684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([142, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.677798271179199  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.677798271179199  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.6780691146850586  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7010908126831055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7022299766540527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7022299766540527  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7024245262145996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.720323085784912  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.721477508544922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.721477508544922  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7216548919677734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.739215850830078  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7403383255004883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7403383255004883  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7404985427856445  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.757481575012207  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7584471702575684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7584471702575684  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7585768699645996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.773232936859131  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.774148464202881  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.774148464202881  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7742629051208496  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7879958152770996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([67, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.789097785949707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.789097785949707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.7892255783081055  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.805455207824707  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8063230514526367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8063230514526367  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.80642032623291  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.819455146789551  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.820420742034912  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.820420742034912  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8205199241638184  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8345046043395996  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.835383892059326  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.835383892059326  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8354716300964355  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.848456859588623  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8490686416625977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8490686416625977  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.849127769470215  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.858292579650879  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.858992576599121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.858992576599121  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.859055519104004  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8692522048950195  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.869913101196289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.869913101196289  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8699703216552734  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.879640579223633  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([601, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8940529823303223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8940529823303223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 2.8951992988586426  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.1003623008728027  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

rst.shape  torch.Size([1, 601, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0601611137390137  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0610079765319824  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.061854839324951  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0609655380249023  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

torch.Size([5681, 40])
input nodes number: 37697
output nodes number: 5681
edges number: 46568
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.061288833618164  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes
Using backend: pytorch

-----------------------------------------after loss calculation
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 3.0612893104553223  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06640386581420898  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06640386581420898  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.7362060546875 GB
    Memory Allocated: 0.06640386581420898  GigaBytes
Max Memory Allocated: 3.183180809020996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02645707130432129 |0.0026334822177886963 |0.12387725710868835 |9.149312973022461e-05 |0.07454849779605865 |0.0047724246978759766 |
----------------------------------------------------------pseudo_mini_loss sum 3.0799596309661865
Total (block generation + training)time/epoch 10.009955763816833
Training time/epoch 3.729088068008423
Training time without block to device /epoch 3.6869523525238037
Training time without total dataloading part /epoch 3.1810483932495117
load block tensor time/epoch 0.4233131408691406
block to device time/epoch 0.04213571548461914
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2166258
Number of first layer input nodes during this epoch:  1561604
Number of first layer output nodes during this epoch:  604654
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
