[05:21:49] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 16 parts and get 0 edge cuts
main start at this time 1651555294.3668625
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03798413276672363
global_2_local spend time (sec) 0.03705286979675293
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0051822662353515625
A = g.adjacency_matrix() spent  0.007888317108154297
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08473539352416992
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.3569395542144775
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.3282842636108398

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.009 seconds
Metis partitioning: 0.063 seconds
Split the graph: 0.022 seconds
Construct subgraphs: 0.054 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.14859652519226074
5682
5684
5684
5684
5684
5684
5684
5684
5683
5684
5684
5684
5684
5684
5684
5684
total k batches seeds list generation spend  10.45354676246643
after graph partition
graph partition algorithm spend time 10.624128818511963
5682
5684
5684
5684
5684
5684
5684
5684
5683
5684
5684
5684
5684
5684
5684
5684
partition_len_list
[37883, 38035, 37843, 37957, 37498, 37479, 37066, 38098, 37602, 37375, 37898, 38341, 37557, 37831, 37471, 37832]
shared_neighbor_graph_partition_s0 selection method  spend 10.708841562271118
time for parepare:  0.01776289939880371
local_output_nid generation:  0.0009453296661376953
local_in_edges_tensor generation:  0.0014996528625488281
mini_batch_src_global generation:  0.0018298625946044922
r_  generation:  0.014577865600585938
local_output_nid generation:  0.001096963882446289
local_in_edges_tensor generation:  0.0014271736145019531
mini_batch_src_global generation:  0.0017790794372558594
r_  generation:  0.015147924423217773
local_output_nid generation:  0.0012471675872802734
local_in_edges_tensor generation:  0.0012857913970947266
mini_batch_src_global generation:  0.0012521743774414062
r_  generation:  0.01519322395324707
local_output_nid generation:  0.0013458728790283203
local_in_edges_tensor generation:  0.001323699951171875
mini_batch_src_global generation:  0.0011806488037109375
r_  generation:  0.015376567840576172
local_output_nid generation:  0.0013556480407714844
local_in_edges_tensor generation:  0.0012505054473876953
mini_batch_src_global generation:  0.0012772083282470703
r_  generation:  0.015127420425415039
local_output_nid generation:  0.0013644695281982422
local_in_edges_tensor generation:  0.0012826919555664062
mini_batch_src_global generation:  0.001298666000366211
r_  generation:  0.015476465225219727
local_output_nid generation:  0.0013544559478759766
local_in_edges_tensor generation:  0.001219034194946289
mini_batch_src_global generation:  0.0012056827545166016
r_  generation:  0.015587568283081055
local_output_nid generation:  0.0013670921325683594
local_in_edges_tensor generation:  0.0011980533599853516
mini_batch_src_global generation:  0.0013492107391357422
r_  generation:  0.015650272369384766
local_output_nid generation:  0.0013530254364013672
local_in_edges_tensor generation:  0.0011980533599853516
mini_batch_src_global generation:  0.0013370513916015625
r_  generation:  0.015755414962768555
local_output_nid generation:  0.0013854503631591797
local_in_edges_tensor generation:  0.001178741455078125
mini_batch_src_global generation:  0.0012068748474121094
r_  generation:  0.015528202056884766
local_output_nid generation:  0.0013802051544189453
local_in_edges_tensor generation:  0.0012161731719970703
mini_batch_src_global generation:  0.0013546943664550781
r_  generation:  0.015981197357177734
local_output_nid generation:  0.001369476318359375
local_in_edges_tensor generation:  0.0012063980102539062
mini_batch_src_global generation:  0.001424551010131836
r_  generation:  0.016177892684936523
local_output_nid generation:  0.001424551010131836
local_in_edges_tensor generation:  0.0011913776397705078
mini_batch_src_global generation:  0.0013210773468017578
r_  generation:  0.015909194946289062
local_output_nid generation:  0.0014879703521728516
local_in_edges_tensor generation:  0.0012450218200683594
mini_batch_src_global generation:  0.0014028549194335938
r_  generation:  0.016169071197509766
local_output_nid generation:  0.0014400482177734375
local_in_edges_tensor generation:  0.0012409687042236328
mini_batch_src_global generation:  0.0014107227325439453
r_  generation:  0.016100406646728516
local_output_nid generation:  0.001421213150024414
local_in_edges_tensor generation:  0.0012412071228027344
mini_batch_src_global generation:  0.0013227462768554688
r_  generation:  0.015972375869750977
----------------------check_connections_block total spend ----------------------------- 0.40923309326171875
generate_one_block  0.03321218490600586
generate_one_block  0.0252230167388916
generate_one_block  0.02437567710876465
generate_one_block  0.02504897117614746
generate_one_block  0.02854132652282715
generate_one_block  0.025435924530029297
generate_one_block  0.024394512176513672
generate_one_block  0.02464580535888672
generate_one_block  0.02599501609802246
generate_one_block  0.027548789978027344
generate_one_block  0.024814367294311523
generate_one_block  0.026652812957763672
generate_one_block  0.024678707122802734
generate_one_block  0.02560114860534668
generate_one_block  0.027306556701660156
generate_one_block  0.02591681480407715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05771589279174805
gen group dst list time:  0.01734018325805664
time for parepare:  0.021086454391479492
local_output_nid generation:  0.007244110107421875
local_in_edges_tensor generation:  0.021010398864746094
mini_batch_src_global generation:  0.00924372673034668
r_  generation:  0.10966682434082031
local_output_nid generation:  0.011017322540283203
local_in_edges_tensor generation:  0.01395559310913086
mini_batch_src_global generation:  0.019445419311523438
r_  generation:  0.11470818519592285
local_output_nid generation:  0.010387659072875977
local_in_edges_tensor generation:  0.011121749877929688
mini_batch_src_global generation:  0.012212038040161133
r_  generation:  0.1090397834777832
local_output_nid generation:  0.010370731353759766
local_in_edges_tensor generation:  0.009415388107299805
mini_batch_src_global generation:  0.011660575866699219
r_  generation:  0.11268353462219238
local_output_nid generation:  0.010405540466308594
local_in_edges_tensor generation:  0.009348869323730469
mini_batch_src_global generation:  0.012151241302490234
r_  generation:  0.11289191246032715
local_output_nid generation:  0.010290145874023438
local_in_edges_tensor generation:  0.009251117706298828
mini_batch_src_global generation:  0.012570619583129883
r_  generation:  0.11807775497436523
local_output_nid generation:  0.010255813598632812
local_in_edges_tensor generation:  0.009307622909545898
mini_batch_src_global generation:  0.012727499008178711
r_  generation:  0.11325287818908691
local_output_nid generation:  0.011452913284301758
local_in_edges_tensor generation:  0.01990485191345215
mini_batch_src_global generation:  0.018180370330810547
r_  generation:  0.1214754581451416
local_output_nid generation:  0.011764764785766602
local_in_edges_tensor generation:  0.011118888854980469
mini_batch_src_global generation:  0.012974739074707031
r_  generation:  0.11718058586120605
local_output_nid generation:  0.010510444641113281
local_in_edges_tensor generation:  0.009241819381713867
mini_batch_src_global generation:  0.013023138046264648
r_  generation:  0.11392331123352051
local_output_nid generation:  0.010885000228881836
local_in_edges_tensor generation:  0.009280204772949219
mini_batch_src_global generation:  0.013473272323608398
r_  generation:  0.11762070655822754
local_output_nid generation:  0.010762453079223633
local_in_edges_tensor generation:  0.009561300277709961
mini_batch_src_global generation:  0.013311386108398438
r_  generation:  0.11911821365356445
local_output_nid generation:  0.010720252990722656
local_in_edges_tensor generation:  0.009319305419921875
mini_batch_src_global generation:  0.013197898864746094
r_  generation:  0.11730837821960449
local_output_nid generation:  0.010671138763427734
local_in_edges_tensor generation:  0.009215116500854492
mini_batch_src_global generation:  0.013014793395996094
r_  generation:  0.11912918090820312
local_output_nid generation:  0.010591268539428711
local_in_edges_tensor generation:  0.00928497314453125
mini_batch_src_global generation:  0.013071060180664062
r_  generation:  0.11519360542297363
local_output_nid generation:  0.010596036911010742
local_in_edges_tensor generation:  0.009338855743408203
mini_batch_src_global generation:  0.013030529022216797
r_  generation:  0.11638092994689941
----------------------check_connections_block total spend ----------------------------- 2.8715431690216064
generate_one_block  0.1355574131011963
generate_one_block  0.13622522354125977
generate_one_block  0.13601899147033691
generate_one_block  0.13824081420898438
generate_one_block  0.13500118255615234
generate_one_block  0.13591265678405762
generate_one_block  0.15256881713867188
generate_one_block  0.13791561126708984
generate_one_block  0.1361687183380127
generate_one_block  0.13446545600891113
generate_one_block  0.1370856761932373
generate_one_block  0.14066243171691895
generate_one_block  0.13404488563537598
generate_one_block  0.13653111457824707
generate_one_block  0.1350569725036621
generate_one_block  0.1368265151977539
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  2.8715431690216064
block generation total time  2.198282480239868
average batch blocks generation time:  0.13739265501499176
pseudo mini batch 0 input nodes size: 97392
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0662841796875 GB
    Memory Allocated: 0.0496525764465332  GigaBytes
Max Memory Allocated: 0.0496525764465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0662841796875 GB
    Memory Allocated: 0.04969501495361328  GigaBytes
Max Memory Allocated: 0.04969501495361328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0662841796875 GB
    Memory Allocated: 0.04969501495361328  GigaBytes
Max Memory Allocated: 0.04969501495361328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.05222034454345703  GigaBytes
Max Memory Allocated: 0.05222034454345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.05222034454345703  GigaBytes
Max Memory Allocated: 0.05222034454345703  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.05222034454345703  GigaBytes
Max Memory Allocated: 0.05222034454345703  GigaBytes

torch.Size([97392, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.05222034454345703  GigaBytes
Max Memory Allocated: 0.05222034454345703  GigaBytes

m.shape torch.Size([1563, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.19609498977661133  GigaBytes
Max Memory Allocated: 0.19979190826416016  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.19609498977661133  GigaBytes
Max Memory Allocated: 0.19979190826416016  GigaBytes

 h.shape torch.Size([1, 1563, 128]), torch.Size([1, 1563, 128])
----------------------------------------3
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.1975855827331543  GigaBytes
Max Memory Allocated: 0.19979190826416016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.20951032638549805  GigaBytes
Max Memory Allocated: 0.21025562286376953  GigaBytes

rst.shape  torch.Size([1, 1563, 128])
m.shape torch.Size([2146, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.21081161499023438  GigaBytes
Max Memory Allocated: 0.2108602523803711  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.21081161499023438  GigaBytes
Max Memory Allocated: 0.2108602523803711  GigaBytes

 h.shape torch.Size([1, 2146, 128]), torch.Size([1, 2146, 128])
----------------------------------------3
 Nvidia-smi: 1.4061279296875 GB
    Memory Allocated: 0.2128582000732422  GigaBytes
Max Memory Allocated: 0.2128582000732422  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.24372005462646484  GigaBytes
Max Memory Allocated: 0.24585533142089844  GigaBytes

rst.shape  torch.Size([1, 2146, 128])
m.shape torch.Size([2153, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.24577665328979492  GigaBytes
Max Memory Allocated: 0.24585533142089844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.24577665328979492  GigaBytes
Max Memory Allocated: 0.24585533142089844  GigaBytes

 h.shape torch.Size([1, 2153, 128]), torch.Size([1, 2153, 128])
----------------------------------------3
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.24791193008422852  GigaBytes
Max Memory Allocated: 0.24791193008422852  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.29319286346435547  GigaBytes
Max Memory Allocated: 0.29627275466918945  GigaBytes

rst.shape  torch.Size([1, 2153, 128])
m.shape torch.Size([2208, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.29637765884399414  GigaBytes
Max Memory Allocated: 0.2964763641357422  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.29637765884399414  GigaBytes
Max Memory Allocated: 0.2964763641357422  GigaBytes

 h.shape torch.Size([1, 2208, 128]), torch.Size([1, 2208, 128])
----------------------------------------3
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.29848337173461914  GigaBytes
Max Memory Allocated: 0.29848337173461914  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.36128854751586914  GigaBytes
Max Memory Allocated: 0.36549997329711914  GigaBytes

rst.shape  torch.Size([1, 2208, 128])
m.shape torch.Size([2040, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.36549997329711914  GigaBytes
Max Memory Allocated: 0.3656144142150879  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.36549997329711914  GigaBytes
Max Memory Allocated: 0.3656144142150879  GigaBytes

 h.shape torch.Size([1, 2040, 128]), torch.Size([1, 2040, 128])
----------------------------------------3
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.3674454689025879  GigaBytes
Max Memory Allocated: 0.3674454689025879  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.4385361671447754  GigaBytes
Max Memory Allocated: 0.44339990615844727  GigaBytes

rst.shape  torch.Size([1, 2040, 128])
m.shape torch.Size([1881, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.4429450035095215  GigaBytes
Max Memory Allocated: 0.44339990615844727  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.4429450035095215  GigaBytes
Max Memory Allocated: 0.44339990615844727  GigaBytes

 h.shape torch.Size([1, 1881, 128]), torch.Size([1, 1881, 128])
----------------------------------------3
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.44473886489868164  GigaBytes
Max Memory Allocated: 0.44473886489868164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.522254467010498  GigaBytes
Max Memory Allocated: 0.5276360511779785  GigaBytes

rst.shape  torch.Size([1, 1881, 128])
m.shape torch.Size([1714, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5270786285400391  GigaBytes
Max Memory Allocated: 0.5276360511779785  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.5270786285400391  GigaBytes
Max Memory Allocated: 0.5276360511779785  GigaBytes

 h.shape torch.Size([1, 1714, 128]), torch.Size([1, 1714, 128])
----------------------------------------3
 Nvidia-smi: 1.7459716796875 GB
    Memory Allocated: 0.5287132263183594  GigaBytes
Max Memory Allocated: 0.5287132263183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6112937927246094  GigaBytes
Max Memory Allocated: 0.6170148849487305  GigaBytes

rst.shape  torch.Size([1, 1714, 128])
m.shape torch.Size([1550, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.616389274597168  GigaBytes
Max Memory Allocated: 0.6170148849487305  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.616389274597168  GigaBytes
Max Memory Allocated: 0.6170148849487305  GigaBytes

 h.shape torch.Size([1, 1550, 128]), torch.Size([1, 1550, 128])
----------------------------------------3
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6178674697875977  GigaBytes
Max Memory Allocated: 0.6178674697875977  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.7028112411499023  GigaBytes
Max Memory Allocated: 0.7087240219116211  GigaBytes

rst.shape  torch.Size([1, 1550, 128])
m.shape torch.Size([1515, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.7085738182067871  GigaBytes
Max Memory Allocated: 0.7087268829345703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.7085738182067871  GigaBytes
Max Memory Allocated: 0.7087268829345703  GigaBytes

 h.shape torch.Size([1, 1515, 128]), torch.Size([1, 1515, 128])
----------------------------------------3
 Nvidia-smi: 1.9373779296875 GB
    Memory Allocated: 0.7100186347961426  GigaBytes
Max Memory Allocated: 0.7100186347961426  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.8024868965148926  GigaBytes
Max Memory Allocated: 0.8089885711669922  GigaBytes

rst.shape  torch.Size([1, 1515, 128])
m.shape torch.Size([21113, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.9033269882202148  GigaBytes
Max Memory Allocated: 0.9057064056396484  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.9033269882202148  GigaBytes
Max Memory Allocated: 0.9057064056396484  GigaBytes

 h.shape torch.Size([1, 21113, 128]), torch.Size([1, 21113, 128])
----------------------------------------3
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.9234619140625  GigaBytes
Max Memory Allocated: 0.9234619140625  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7518310546875 GB
    Memory Allocated: 2.3754148483276367  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

rst.shape  torch.Size([1, 21113, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7518310546875 GB
    Memory Allocated: 2.2435359954833984  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7518310546875 GB
    Memory Allocated: 2.2796640396118164  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7518310546875 GB
    Memory Allocated: 2.3157920837402344  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7518310546875 GB
    Memory Allocated: 2.27938175201416  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

torch.Size([37883, 256])
first layer input nodes number: 97392
first layer output nodes number: 37883
edges number: 291795
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7518310546875 GB
    Memory Allocated: 2.3165197372436523  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7518310546875 GB
    Memory Allocated: 2.3526477813720703  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7518310546875 GB
    Memory Allocated: 2.361680030822754  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7518310546875 GB
    Memory Allocated: 2.361680030822754  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

m.shape torch.Size([849, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.4079980850219727  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.4079980850219727  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

 h.shape torch.Size([1, 849, 256]), torch.Size([1, 849, 256])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.4096174240112305  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.422572135925293  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

rst.shape  torch.Size([1, 849, 256])
m.shape torch.Size([742, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.4232449531555176  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.4232449531555176  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

 h.shape torch.Size([1, 742, 256]), torch.Size([1, 742, 256])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 2.4246602058410645  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.4462857246398926  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

rst.shape  torch.Size([1, 742, 256])
m.shape torch.Size([553, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.447183132171631  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.447183132171631  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 2.448237895965576  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.4725046157836914  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([473, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.473851203918457  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.473851203918457  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.4747533798217773  GigaBytes
Max Memory Allocated: 2.4769773483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.5021438598632812  GigaBytes
Max Memory Allocated: 2.503948211669922  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([375, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.503499984741211  GigaBytes
Max Memory Allocated: 2.503948211669922  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.503499984741211  GigaBytes
Max Memory Allocated: 2.503948211669922  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.5042152404785156  GigaBytes
Max Memory Allocated: 2.5042152404785156  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.5330615043640137  GigaBytes
Max Memory Allocated: 2.5348544120788574  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([277, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.534367561340332  GigaBytes
Max Memory Allocated: 2.5348544120788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.534367561340332  GigaBytes
Max Memory Allocated: 2.5348544120788574  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.8045654296875 GB
    Memory Allocated: 2.534895896911621  GigaBytes
Max Memory Allocated: 2.534895896911621  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8065185546875 GB
    Memory Allocated: 2.5638437271118164  GigaBytes
Max Memory Allocated: 2.5654287338256836  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([258, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8065185546875 GB
    Memory Allocated: 2.5653157234191895  GigaBytes
Max Memory Allocated: 2.5654287338256836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8065185546875 GB
    Memory Allocated: 2.5653157234191895  GigaBytes
Max Memory Allocated: 2.5654287338256836  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.8065185546875 GB
    Memory Allocated: 2.565807819366455  GigaBytes
Max Memory Allocated: 2.565807819366455  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 2.591048240661621  GigaBytes
Max Memory Allocated: 2.592770576477051  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([226, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 2.5925402641296387  GigaBytes
Max Memory Allocated: 2.592770576477051  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 2.5925402641296387  GigaBytes
Max Memory Allocated: 2.592770576477051  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.8104248046875 GB
    Memory Allocated: 2.5929713249206543  GigaBytes
Max Memory Allocated: 2.5929713249206543  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8358154296875 GB
    Memory Allocated: 2.617541790008545  GigaBytes
Max Memory Allocated: 2.6192660331726074  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([179, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8358154296875 GB
    Memory Allocated: 2.618875026702881  GigaBytes
Max Memory Allocated: 2.6192660331726074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8358154296875 GB
    Memory Allocated: 2.618875026702881  GigaBytes
Max Memory Allocated: 2.6192660331726074  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.8358154296875 GB
    Memory Allocated: 2.6192164421081543  GigaBytes
Max Memory Allocated: 2.6192660331726074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8612060546875 GB
    Memory Allocated: 2.6410670280456543  GigaBytes
Max Memory Allocated: 2.6426033973693848  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([156, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8612060546875 GB
    Memory Allocated: 2.6423959732055664  GigaBytes
Max Memory Allocated: 2.6426033973693848  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8612060546875 GB
    Memory Allocated: 2.6423959732055664  GigaBytes
Max Memory Allocated: 2.6426033973693848  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.8612060546875 GB
    Memory Allocated: 2.642693519592285  GigaBytes
Max Memory Allocated: 2.642693519592285  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8807373046875 GB
    Memory Allocated: 2.6638193130493164  GigaBytes
Max Memory Allocated: 2.66530704498291  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8807373046875 GB
    Memory Allocated: 2.6649184226989746  GigaBytes
Max Memory Allocated: 2.66530704498291  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8807373046875 GB
    Memory Allocated: 2.6649184226989746  GigaBytes
Max Memory Allocated: 2.66530704498291  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8807373046875 GB
    Memory Allocated: 2.6651434898376465  GigaBytes
Max Memory Allocated: 2.66530704498291  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.6826987266540527  GigaBytes
Max Memory Allocated: 2.683936595916748  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([125, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.684028148651123  GigaBytes
Max Memory Allocated: 2.6840338706970215  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.684028148651123  GigaBytes
Max Memory Allocated: 2.6840338706970215  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.8963623046875 GB
    Memory Allocated: 2.6842665672302246  GigaBytes
Max Memory Allocated: 2.6842665672302246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.7045321464538574  GigaBytes
Max Memory Allocated: 2.705962657928467  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([119, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.705900192260742  GigaBytes
Max Memory Allocated: 2.705962657928467  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.705900192260742  GigaBytes
Max Memory Allocated: 2.705962657928467  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.706127166748047  GigaBytes
Max Memory Allocated: 2.706127166748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 2.727008819580078  GigaBytes
Max Memory Allocated: 2.7284841537475586  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 2.728147029876709  GigaBytes
Max Memory Allocated: 2.7284841537475586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 2.728147029876709  GigaBytes
Max Memory Allocated: 2.7284841537475586  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9373779296875 GB
    Memory Allocated: 2.7283244132995605  GigaBytes
Max Memory Allocated: 2.7284841537475586  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9549560546875 GB
    Memory Allocated: 2.7458853721618652  GigaBytes
Max Memory Allocated: 2.747127056121826  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9549560546875 GB
    Memory Allocated: 2.7471089363098145  GigaBytes
Max Memory Allocated: 2.747127056121826  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9549560546875 GB
    Memory Allocated: 2.7471089363098145  GigaBytes
Max Memory Allocated: 2.747127056121826  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9549560546875 GB
    Memory Allocated: 2.7472825050354004  GigaBytes
Max Memory Allocated: 2.7472825050354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9744873046875 GB
    Memory Allocated: 2.7656807899475098  GigaBytes
Max Memory Allocated: 2.7669825553894043  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([66, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9744873046875 GB
    Memory Allocated: 2.7666091918945312  GigaBytes
Max Memory Allocated: 2.7669825553894043  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9744873046875 GB
    Memory Allocated: 2.7666091918945312  GigaBytes
Max Memory Allocated: 2.7669825553894043  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.9744873046875 GB
    Memory Allocated: 2.766735076904297  GigaBytes
Max Memory Allocated: 2.7669825553894043  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9881591796875 GB
    Memory Allocated: 2.7809600830078125  GigaBytes
Max Memory Allocated: 2.7819671630859375  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9881591796875 GB
    Memory Allocated: 2.7821226119995117  GigaBytes
Max Memory Allocated: 2.7821273803710938  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9881591796875 GB
    Memory Allocated: 2.7821226119995117  GigaBytes
Max Memory Allocated: 2.7821273803710938  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9881591796875 GB
    Memory Allocated: 2.7822656631469727  GigaBytes
Max Memory Allocated: 2.7822656631469727  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 2.799431800842285  GigaBytes
Max Memory Allocated: 2.800647735595703  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 2.800312042236328  GigaBytes
Max Memory Allocated: 2.800647735595703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 2.800312042236328  GigaBytes
Max Memory Allocated: 2.800647735595703  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.0057373046875 GB
    Memory Allocated: 2.800416946411133  GigaBytes
Max Memory Allocated: 2.800647735595703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0194091796875 GB
    Memory Allocated: 2.813739776611328  GigaBytes
Max Memory Allocated: 2.8146839141845703  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0194091796875 GB
    Memory Allocated: 2.8144912719726562  GigaBytes
Max Memory Allocated: 2.8146839141845703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0194091796875 GB
    Memory Allocated: 2.8144912719726562  GigaBytes
Max Memory Allocated: 2.8146839141845703  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0194091796875 GB
    Memory Allocated: 2.8145751953125  GigaBytes
Max Memory Allocated: 2.8146839141845703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0311279296875 GB
    Memory Allocated: 2.8258209228515625  GigaBytes
Max Memory Allocated: 2.826618194580078  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0311279296875 GB
    Memory Allocated: 2.826624870300293  GigaBytes
Max Memory Allocated: 2.8266282081604004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0311279296875 GB
    Memory Allocated: 2.826624870300293  GigaBytes
Max Memory Allocated: 2.8266282081604004  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.0311279296875 GB
    Memory Allocated: 2.8267087936401367  GigaBytes
Max Memory Allocated: 2.8267087936401367  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 2.8385419845581055  GigaBytes
Max Memory Allocated: 2.839381217956543  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 2.8393077850341797  GigaBytes
Max Memory Allocated: 2.839381217956543  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 2.8393077850341797  GigaBytes
Max Memory Allocated: 2.839381217956543  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0447998046875 GB
    Memory Allocated: 2.839384078979492  GigaBytes
Max Memory Allocated: 2.839384078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0565185546875 GB
    Memory Allocated: 2.850675582885742  GigaBytes
Max Memory Allocated: 2.8514766693115234  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0565185546875 GB
    Memory Allocated: 2.8513989448547363  GigaBytes
Max Memory Allocated: 2.8514766693115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0565185546875 GB
    Memory Allocated: 2.8513989448547363  GigaBytes
Max Memory Allocated: 2.8514766693115234  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.0565185546875 GB
    Memory Allocated: 2.8514676094055176  GigaBytes
Max Memory Allocated: 2.8514766693115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 2.8621106147766113  GigaBytes
Max Memory Allocated: 2.862865924835205  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 2.862673282623291  GigaBytes
Max Memory Allocated: 2.862865924835205  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 2.862673282623291  GigaBytes
Max Memory Allocated: 2.862865924835205  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 2.862724781036377  GigaBytes
Max Memory Allocated: 2.862865924835205  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 2.871067523956299  GigaBytes
Max Memory Allocated: 2.871659755706787  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 2.8717799186706543  GigaBytes
Max Memory Allocated: 2.8717827796936035  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 2.8717799186706543  GigaBytes
Max Memory Allocated: 2.8717827796936035  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 2.8718409538269043  GigaBytes
Max Memory Allocated: 2.8718409538269043  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0877685546875 GB
    Memory Allocated: 2.8821558952331543  GigaBytes
Max Memory Allocated: 2.8828883171081543  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([629, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0877685546875 GB
    Memory Allocated: 2.897822856903076  GigaBytes
Max Memory Allocated: 2.897881507873535  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0877685546875 GB
    Memory Allocated: 2.897822856903076  GigaBytes
Max Memory Allocated: 2.897881507873535  GigaBytes

 h.shape torch.Size([1, 629, 256]), torch.Size([1, 629, 256])
----------------------------------------3
 Nvidia-smi: 4.0877685546875 GB
    Memory Allocated: 2.8990225791931152  GigaBytes
Max Memory Allocated: 2.8990225791931152  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3319091796875 GB
    Memory Allocated: 3.1131949424743652  GigaBytes
Max Memory Allocated: 3.1288199424743652  GigaBytes

rst.shape  torch.Size([1, 629, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3319091796875 GB
    Memory Allocated: 3.072969436645508  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3319091796875 GB
    Memory Allocated: 3.0738162994384766  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3338623046875 GB
    Memory Allocated: 3.0746631622314453  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3338623046875 GB
    Memory Allocated: 3.0737738609313965  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

torch.Size([5682, 40])
input nodes number: 37883
output nodes number: 5682
edges number: 47001
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3338623046875 GB
    Memory Allocated: 3.0749454498291016  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3338623046875 GB
    Memory Allocated: 3.074946403503418  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.060755252838134766  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

pseudo mini batch 1 input nodes size: 97749
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.053318023681640625  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.053318023681640625  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.09992837905883789  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.09997081756591797  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.05305337905883789  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.05558919906616211  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.05558919906616211  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.05558919906616211  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

torch.Size([97749, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.05558919906616211  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

m.shape torch.Size([1681, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.201416015625  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.201416015625  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 1681, 128]), torch.Size([1, 1681, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.2030191421508789  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.2159881591796875  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 1681, 128])
m.shape torch.Size([2042, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.2171339988708496  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.2171339988708496  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 2042, 128]), torch.Size([1, 2042, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.21908140182495117  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.24832677841186523  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 2042, 128])
m.shape torch.Size([2101, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.2512822151184082  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.2512822151184082  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 2101, 128]), torch.Size([1, 2101, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.2539525032043457  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.29943037033081055  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 2101, 128])
m.shape torch.Size([2149, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.30252742767333984  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.30252742767333984  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 2149, 128]), torch.Size([1, 2149, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.3052525520324707  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.3661184310913086  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 2149, 128])
m.shape torch.Size([2108, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.370119571685791  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.370119571685791  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 2108, 128]), torch.Size([1, 2108, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.3726158142089844  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.44716644287109375  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 2108, 128])
m.shape torch.Size([1856, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.45096588134765625  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.45096588134765625  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 1856, 128]), torch.Size([1, 1856, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.45273590087890625  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.5298347473144531  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 1856, 128])
m.shape torch.Size([1783, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.5349011421203613  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.5349011421203613  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 1783, 128]), torch.Size([1, 1783, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.5366015434265137  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.6216216087341309  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 1783, 128])
m.shape torch.Size([1607, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.6269016265869141  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.6269016265869141  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 1607, 128]), torch.Size([1, 1607, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.6284341812133789  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.7159628868103027  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 1607, 128])
m.shape torch.Size([1482, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.7215566635131836  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.7215566635131836  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 1482, 128]), torch.Size([1, 1482, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.7229700088500977  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.813502311706543  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 1482, 128])
m.shape torch.Size([21226, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.9143581390380859  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.9143581390380859  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 21226, 128]), torch.Size([1, 21226, 128])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 0.9355306625366211  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.388669013977051  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 21226, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.255344867706299  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.2916178703308105  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.3278908729553223  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.2913341522216797  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

torch.Size([38035, 256])
first layer input nodes number: 97749
first layer output nodes number: 38035
edges number: 293275
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.3286213874816895  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.364894390106201  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.3743042945861816  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.3743042945861816  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

m.shape torch.Size([862, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4206361770629883  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4206361770629883  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4222803115844727  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4358224868774414  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([719, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.436406135559082  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.436406135559082  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 719, 256]), torch.Size([1, 719, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.437777519226074  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.458348274230957  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 719, 256])
m.shape torch.Size([564, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4595065116882324  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4595065116882324  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4605822563171387  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4866347312927246  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([426, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.487974166870117  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.487974166870117  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4887866973876953  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5131759643554688  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([384, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.514615058898926  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.514615058898926  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.515347480773926  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.543002128601074  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([296, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5443429946899414  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5443429946899414  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.544907569885254  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5702972412109375  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([308, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.572087287902832  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.572087287902832  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5726747512817383  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.602602005004883  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([200, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6038460731506348  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6038460731506348  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6042275428771973  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6259713172912598  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.627467632293701  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.627467632293701  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6278395652770996  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6516432762145996  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6530051231384277  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6530051231384277  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6533122062683105  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6751151084899902  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([131, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.676483154296875  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.676483154296875  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6767330169677734  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6962223052978516  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([108, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.697343349456787  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.697343349456787  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.697549343109131  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7150588035583496  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7162303924560547  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7162303924560547  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7164249420166016  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.734323501586914  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7354373931884766  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7354373931884766  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7356090545654297  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.752603530883789  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.753800868988037  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.753800868988037  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7539706230163574  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7719645500183105  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7727255821228027  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7727255821228027  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7728304862976074  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.784684658050537  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.785841464996338  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.785841464996338  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.785982608795166  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.802919864654541  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([68, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.804558277130127  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.804558277130127  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.804687976837158  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.821159839630127  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.822044849395752  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.822044849395752  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.822144031524658  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8354344367980957  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([66, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.836653709411621  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.836653709411621  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8367795944213867  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.85452938079834  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8552536964416504  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8552536964416504  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.85532808303833  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.866337299346924  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8670191764831543  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8670191764831543  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.86708402633667  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.877135753631592  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.87772274017334  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.87772274017334  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8777761459350586  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.886427879333496  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.887047290802002  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.887047290802002  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8871006965637207  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8961262702941895  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([605, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.9106369018554688  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.9106369018554688  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

 h.shape torch.Size([1, 605, 256]), torch.Size([1, 605, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.9117908477783203  GigaBytes
Max Memory Allocated: 3.1288723945617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 3.115955352783203  GigaBytes
Max Memory Allocated: 3.1303796768188477  GigaBytes

rst.shape  torch.Size([1, 605, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 3.0757522583007812  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 3.076599597930908  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 3.077446937561035  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 3.076557159423828  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

torch.Size([5684, 40])
input nodes number: 38035
output nodes number: 5684
edges number: 46849
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 3.0768837928771973  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 3.0768842697143555  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.06091022491455078  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

pseudo mini batch 2 input nodes size: 97735
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.053053855895996094  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.053053855895996094  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.0999288558959961  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.09997129440307617  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.0558323860168457  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.0558323860168457  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.0558323860168457  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

torch.Size([97735, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.0558323860168457  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

m.shape torch.Size([1590, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.1995830535888672  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.1995830535888672  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 1590, 128]), torch.Size([1, 1590, 128])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.20109939575195312  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.21365833282470703  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 1590, 128])
m.shape torch.Size([2086, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.21500921249389648  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.21500921249389648  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 2086, 128]), torch.Size([1, 2086, 128])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.21699857711791992  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.24912214279174805  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 2086, 128])
m.shape torch.Size([2229, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.25053882598876953  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.25053882598876953  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 2229, 128]), torch.Size([1, 2229, 128])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.2543001174926758  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.3014206886291504  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 2229, 128])
m.shape torch.Size([2212, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.3045768737792969  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.3045768737792969  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 2212, 128]), torch.Size([1, 2212, 128])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.306729793548584  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.36819028854370117  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 2212, 128])
m.shape torch.Size([2093, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.37200927734375  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.37200927734375  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 2093, 128]), torch.Size([1, 2093, 128])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.374178409576416  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.44763898849487305  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 2093, 128])
m.shape torch.Size([1871, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.4519939422607422  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.4519939422607422  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 1871, 128]), torch.Size([1, 1871, 128])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.4537782669067383  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.5316658020019531  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 1871, 128])
m.shape torch.Size([1776, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.5367016792297363  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.5367016792297363  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 1776, 128]), torch.Size([1, 1776, 128])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.5383954048156738  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.6230816841125488  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 1776, 128])
m.shape torch.Size([1646, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.6285138130187988  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.6285138130187988  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.6300835609436035  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.7223362922668457  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 1646, 128])
m.shape torch.Size([1499, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.7279844284057617  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.7279844284057617  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 1499, 128]), torch.Size([1, 1499, 128])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.7294139862060547  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.8211250305175781  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 1499, 128])
m.shape torch.Size([20841, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.9197878837585449  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.9197878837585449  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 20841, 128]), torch.Size([1, 20841, 128])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 0.9396634101867676  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.350825786590576  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 20841, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.2186427116394043  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.254732608795166  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.2908225059509277  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.2544503211975098  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

torch.Size([37843, 256])
first layer input nodes number: 97735
first layer output nodes number: 37843
edges number: 290489
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.291553020477295  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.3276429176330566  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.3372364044189453  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.3372364044189453  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

m.shape torch.Size([804, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.3835086822509766  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.3835086822509766  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.385042190551758  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.397310256958008  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 804, 256])
m.shape torch.Size([755, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.398041248321533  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.398041248321533  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 755, 256]), torch.Size([1, 755, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.3994812965393066  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4220399856567383  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 755, 256])
m.shape torch.Size([542, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.423020362854004  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.423020362854004  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4240541458129883  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4497246742248535  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([469, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4518160820007324  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4518160820007324  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4527106285095215  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4810142517089844  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([381, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.48239803314209  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.48239803314209  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.4831247329711914  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.511350631713867  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([336, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.512925148010254  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.512925148010254  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.513566017150879  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5418877601623535  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([245, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.543215751647949  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.543215751647949  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5436830520629883  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5670480728149414  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([230, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5685830116271973  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5685830116271973  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.569021701812744  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.594027042388916  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([173, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.596177577972412  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.596177577972412  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.5965075492858887  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6176257133483887  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([190, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6192870140075684  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6192870140075684  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6196494102478027  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6453795433044434  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([124, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6465096473693848  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6465096473693848  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6467461585998535  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.665194034576416  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.666390895843506  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.666390895843506  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6666083335876465  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6850905418395996  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6862564086914062  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.6862564086914062  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.686450958251953  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7043495178222656  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.70552396774292  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.70552396774292  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.705695629119873  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7226901054382324  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7236671447753906  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7236671447753906  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7238006591796875  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7379531860351562  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7391605377197266  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7391605377197266  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7393131256103516  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7565555572509766  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7575888633728027  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7575888633728027  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7577147483825684  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7728209495544434  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7738289833068848  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7738289833068848  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.773937702178955  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7877449989318848  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7889647483825684  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.7889647483825684  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.789090633392334  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8059592247009277  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([70, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.807241916656494  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.807241916656494  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.807375431060791  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8262009620666504  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8268814086914062  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8268814086914062  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8269519805908203  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8373966217041016  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.838165283203125  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.838165283203125  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.838237762451172  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8494720458984375  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.850275993347168  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.850275993347168  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.850348472595215  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8620901107788086  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8633270263671875  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8633270263671875  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8634185791015625  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.8788909912109375  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([559, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.892277240753174  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.892277240753174  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 4.5272216796875 GB
    Memory Allocated: 2.893343448638916  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5526123046875 GB
    Memory Allocated: 3.0817880630493164  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 559, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.5526123046875 GB
    Memory Allocated: 3.0416316986083984  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.5526123046875 GB
    Memory Allocated: 3.0424790382385254  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 3.0433263778686523  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 3.0424365997314453  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

torch.Size([5684, 40])
input nodes number: 37843
output nodes number: 5684
edges number: 46813
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 3.0427613258361816  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 3.04276180267334  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.06123018264770508  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

pseudo mini batch 3 input nodes size: 97503
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.09981155395507812  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.0998539924621582  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.052936553955078125  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.05548381805419922  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.05548381805419922  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.05548381805419922  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

torch.Size([97503, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.05548381805419922  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

m.shape torch.Size([1591, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.20123815536499023  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.20123815536499023  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.20275545120239258  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.21540212631225586  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([2050, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.2165985107421875  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.2165985107421875  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 2050, 128]), torch.Size([1, 2050, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.2185535430908203  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.2497091293334961  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 2050, 128])
m.shape torch.Size([2168, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.2518329620361328  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.2518329620361328  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 2168, 128]), torch.Size([1, 2168, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.25458526611328125  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.3016195297241211  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 2168, 128])
m.shape torch.Size([2033, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.30446338653564453  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.30446338653564453  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 2033, 128]), torch.Size([1, 2033, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.30640220642089844  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.36297130584716797  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 2033, 128])
m.shape torch.Size([2008, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.3667893409729004  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.3667893409729004  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 2008, 128]), torch.Size([1, 2008, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.36870431900024414  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.43855905532836914  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 2008, 128])
m.shape torch.Size([1838, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.44286012649536133  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.44286012649536133  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 1838, 128]), torch.Size([1, 1838, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.444612979888916  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5207390785217285  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 1838, 128])
m.shape torch.Size([1697, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5255270004272461  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5255270004272461  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 1697, 128]), torch.Size([1, 1697, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.5271453857421875  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.6090912818908691  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 1697, 128])
m.shape torch.Size([1609, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.6144199371337891  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.6144199371337891  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 1609, 128]), torch.Size([1, 1609, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.6159543991088867  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.7037296295166016  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 1609, 128])
m.shape torch.Size([1512, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.7094511985778809  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.7094511985778809  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 1512, 128]), torch.Size([1, 1512, 128])
----------------------------------------3
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.7108931541442871  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5545654296875 GB
    Memory Allocated: 0.8032488822937012  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 1512, 128])
m.shape torch.Size([21451, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.6580810546875 GB
    Memory Allocated: 0.9048142433166504  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6580810546875 GB
    Memory Allocated: 0.9048142433166504  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 21451, 128]), torch.Size([1, 21451, 128])
----------------------------------------3
 Nvidia-smi: 4.6580810546875 GB
    Memory Allocated: 0.9252715110778809  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.380770206451416  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 21451, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.246954917907715  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.283153533935547  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.319352149963379  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.282870292663574  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

torch.Size([37957, 256])
first layer input nodes number: 97503
first layer output nodes number: 37957
edges number: 294264
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.3200807571411133  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.3562793731689453  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.36558198928833  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.36558198928833  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

m.shape torch.Size([819, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.4123167991638184  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.4123167991638184  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 819, 256]), torch.Size([1, 819, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.413878917694092  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.4263758659362793  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 819, 256])
m.shape torch.Size([700, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.427037239074707  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.427037239074707  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 700, 256]), torch.Size([1, 700, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.428372383117676  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.4493703842163086  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 700, 256])
m.shape torch.Size([582, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.45046329498291  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.45046329498291  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.451573371887207  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.476212501525879  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([460, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.477626323699951  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.477626323699951  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.478503704071045  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.5063300132751465  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([398, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.5078043937683105  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.5078043937683105  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.50856351852417  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.5361690521240234  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.537594795227051  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.537594795227051  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.538191795349121  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.565798759460449  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.567155361175537  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.567155361175537  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.567624568939209  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.5910849571228027  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([214, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.592495918273926  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.592495918273926  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.5929040908813477  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.6161699295043945  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([190, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.618424415588379  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.618424415588379  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.6187868118286133  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.6419801712036133  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([155, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.643289089202881  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.643289089202881  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.643584728240967  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.6645750999450684  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.665844440460205  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.665844440460205  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.666100025177002  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.686035633087158  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.6872920989990234  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.6872920989990234  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.687520980834961  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7069759368896484  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([90, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7079882621765137  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7079882621765137  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.708159923553467  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7239527702331543  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.725010871887207  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.725010871887207  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.725172996520996  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7412233352661133  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7422690391540527  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7422690391540527  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7424159049987793  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.757983684539795  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([78, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7591099739074707  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7591099739074707  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.75925874710083  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7760701179504395  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7771215438842773  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7771215438842773  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.777237892150879  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7911996841430664  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([77, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.792473793029785  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.792473793029785  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.7926206588745117  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.811272621154785  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8123254776000977  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8123254776000977  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.812436103820801  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8272600173950195  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8286118507385254  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8286118507385254  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.82871675491333  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.843508243560791  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8443846702575684  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8443846702575684  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8444724082946777  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8574576377868652  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.858175277709961  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.858175277709961  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.858243942260742  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.868886947631836  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.869692802429199  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.869692802429199  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.869765281677246  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.88150691986084  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8822550773620605  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.8822550773620605  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.882319927215576  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.893279552459717  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([618, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.9080967903137207  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.9080967903137207  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

 h.shape torch.Size([1, 618, 256]), torch.Size([1, 618, 256])
----------------------------------------3
 Nvidia-smi: 4.7615966796875 GB
    Memory Allocated: 2.909275531768799  GigaBytes
Max Memory Allocated: 3.1316604614257812  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7713623046875 GB
    Memory Allocated: 3.1178932189941406  GigaBytes
Max Memory Allocated: 3.132627487182617  GigaBytes

rst.shape  torch.Size([1, 618, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7713623046875 GB
    Memory Allocated: 3.077238082885742  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7713623046875 GB
    Memory Allocated: 3.078085422515869  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7733154296875 GB
    Memory Allocated: 3.078932762145996  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7733154296875 GB
    Memory Allocated: 3.078042984008789  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([5684, 40])
input nodes number: 37957
output nodes number: 5684
edges number: 47567
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7733154296875 GB
    Memory Allocated: 3.078368663787842  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7733154296875 GB
    Memory Allocated: 3.078369140625  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.060782432556152344  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

pseudo mini batch 4 input nodes size: 97130
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.052936553955078125  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.052936553955078125  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.09981155395507812  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.0998539924621582  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05580949783325195  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05580949783325195  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05580949783325195  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([97130, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05580949783325195  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

m.shape torch.Size([1612, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.1975250244140625  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.1975250244140625  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1612, 128]), torch.Size([1, 1612, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19906234741210938  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21170806884765625  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1612, 128])
m.shape torch.Size([2132, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21297264099121094  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21297264099121094  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2132, 128]), torch.Size([1, 2132, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2150731086730957  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2466435432434082  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2132, 128])
m.shape torch.Size([2201, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24877548217773438  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24877548217773438  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2201, 128]), torch.Size([1, 2201, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2513446807861328  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2981114387512207  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2201, 128])
m.shape torch.Size([2073, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.30101585388183594  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.30101585388183594  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2073, 128]), torch.Size([1, 2073, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3030819892883301  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36197376251220703  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2073, 128])
m.shape torch.Size([2062, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36505603790283203  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36505603790283203  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2062, 128]), torch.Size([1, 2062, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3678731918334961  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44298791885375977  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2062, 128])
m.shape torch.Size([1836, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44725751876831055  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44725751876831055  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1836, 128]), torch.Size([1, 1836, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4490084648132324  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5270648002624512  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1836, 128])
m.shape torch.Size([1679, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5317935943603516  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5317935943603516  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1679, 128]), torch.Size([1, 1679, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5333948135375977  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6152234077453613  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1679, 128])
m.shape torch.Size([1613, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6205759048461914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6205759048461914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1613, 128]), torch.Size([1, 1613, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6221141815185547  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7097959518432617  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1613, 128])
m.shape torch.Size([1519, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.715545654296875  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.715545654296875  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1519, 128]), torch.Size([1, 1519, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7169942855834961  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.8097066879272461  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1519, 128])
m.shape torch.Size([20771, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9080262184143066  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9080262184143066  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 20771, 128]), torch.Size([1, 20771, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9278349876403809  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3342576026916504  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 20771, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2030978202819824  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.238858699798584  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2746195793151855  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.238579273223877  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([37498, 256])
first layer input nodes number: 97130
first layer output nodes number: 37498
edges number: 288135
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2753453254699707  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3111062049865723  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3202672004699707  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3202672004699707  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

m.shape torch.Size([824, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.365516185760498  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.365516185760498  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 824, 256]), torch.Size([1, 824, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3670878410339355  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3801040649414062  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 824, 256])
m.shape torch.Size([766, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3809471130371094  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3809471130371094  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 766, 256]), torch.Size([1, 766, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3824081420898438  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4058237075805664  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 766, 256])
m.shape torch.Size([618, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4071288108825684  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4071288108825684  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 618, 256]), torch.Size([1, 618, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4083075523376465  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.435243606567383  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 618, 256])
m.shape torch.Size([452, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4366579055786133  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4366579055786133  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4375200271606445  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4642152786254883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([378, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4656009674072266  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4656009674072266  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4663219451904297  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.494436264038086  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([279, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.49568510055542  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.49568510055542  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4962172508239746  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5231070518493652  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([231, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.52439546585083  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.52439546585083  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5248360633850098  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.546865940093994  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([212, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.548275947570801  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.548275947570801  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.548680305480957  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5717287063598633  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([196, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5732221603393555  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5732221603393555  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5735960006713867  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5975217819213867  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5990939140319824  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5990939140319824  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5994105339050293  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6218905448913574  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6231493949890137  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6231493949890137  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6234049797058105  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.643340587615967  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([148, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6449198722839355  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6449198722839355  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.645202159881592  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.669196605682373  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([97, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6704630851745605  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6704630851745605  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6706480979919434  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.687669277191162  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([100, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6889853477478027  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6889853477478027  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.689176082611084  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7080588340759277  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([82, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7093710899353027  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7093710899353027  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7095274925231934  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7261061668395996  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7274351119995117  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7274351119995117  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7275781631469727  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7437429428100586  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.744619369506836  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.744619369506836  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.744729995727539  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.758005142211914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7593564987182617  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7593564987182617  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7594728469848633  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7742490768432617  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7750492095947266  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7750492095947266  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7751388549804688  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.787151336669922  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7880101203918457  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7880101203918457  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.788099765777588  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8007397651672363  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.801623821258545  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.801623821258545  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8017115592956543  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.814696788787842  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8153934478759766  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8153934478759766  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.815460205078125  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.825807571411133  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.826415538787842  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.826415538787842  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8264708518981934  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8354315757751465  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8363037109375  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8363037109375  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8363780975341797  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.848949432373047  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([564, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.862464427947998  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.862464427947998  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8635401725769043  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.053112030029297  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 564, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0139875411987305  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0148348808288574  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0156822204589844  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0147924423217773  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([5684, 40])
input nodes number: 37498
output nodes number: 5684
edges number: 46016
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0151143074035645  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0151147842407227  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.060269832611083984  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

pseudo mini batch 5 input nodes size: 97731
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.09992027282714844  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.09996271133422852  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05304527282714844  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05553245544433594  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05553245544433594  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05553245544433594  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([97731, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05553245544433594  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

m.shape torch.Size([1656, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19700241088867188  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19700241088867188  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1656, 128]), torch.Size([1, 1656, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19858169555664062  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21131610870361328  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1656, 128])
m.shape torch.Size([2133, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21256065368652344  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21256065368652344  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2133, 128]), torch.Size([1, 2133, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21492624282836914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24650049209594727  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2133, 128])
m.shape torch.Size([2142, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24854755401611328  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24854755401611328  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2142, 128]), torch.Size([1, 2142, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2511124610900879  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2975125312805176  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2142, 128])
m.shape torch.Size([2086, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.30046987533569336  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.30046987533569336  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2086, 128]), torch.Size([1, 2086, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3025083541870117  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3621044158935547  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2086, 128])
m.shape torch.Size([2024, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3651580810546875  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3651580810546875  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2024, 128]), torch.Size([1, 2024, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36708831787109375  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.43726348876953125  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2024, 128])
m.shape torch.Size([1883, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44168567657470703  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44168567657470703  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1883, 128]), torch.Size([1, 1883, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4434814453125  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5232667922973633  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1883, 128])
m.shape torch.Size([1760, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5282435417175293  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5282435417175293  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1760, 128]), torch.Size([1, 1760, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5299220085144043  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6138453483581543  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1760, 128])
m.shape torch.Size([1621, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6191897392272949  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6191897392272949  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1621, 128]), torch.Size([1, 1621, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6207356452941895  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7095675468444824  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1621, 128])
m.shape torch.Size([1548, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7154378890991211  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7154378890991211  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1548, 128]), torch.Size([1, 1548, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.716914176940918  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.8120565414428711  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1548, 128])
m.shape torch.Size([20626, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9096708297729492  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9096708297729492  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 20626, 128]), torch.Size([1, 20626, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9293413162231445  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3259458541870117  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 20626, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.195659637451172  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2314023971557617  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2671451568603516  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2311229705810547  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([37479, 256])
first layer input nodes number: 97731
first layer output nodes number: 37479
edges number: 287590
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2678756713867188  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3036184310913086  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3127975463867188  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3127975463867188  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

m.shape torch.Size([824, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3590855598449707  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3590855598449707  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 824, 256]), torch.Size([1, 824, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.360657215118408  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3745627403259277  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 824, 256])
m.shape torch.Size([755, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.375293254852295  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.375293254852295  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 755, 256]), torch.Size([1, 755, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3767333030700684  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3983702659606934  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 755, 256])
m.shape torch.Size([598, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3994359970092773  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3994359970092773  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.400576591491699  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.427989959716797  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 598, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4292492866516113  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4292492866516113  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.430105686187744  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4557909965515137  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([360, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4570932388305664  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4570932388305664  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.457779884338379  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4870047569274902  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([321, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4885129928588867  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4885129928588867  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4891252517700195  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.523172378540039  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([250, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5245485305786133  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5245485305786133  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5250253677368164  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5488672256469727  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([220, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.550320625305176  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.550320625305176  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5507402420043945  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5746583938598633  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([204, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5762133598327637  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5762133598327637  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5766024589538574  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6015048027038574  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([164, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.60288667678833  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.60288667678833  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6031994819641113  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.62540864944458  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([131, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6266374588012695  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6266374588012695  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.626887321472168  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.646376609802246  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([110, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6475205421447754  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6475205421447754  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6477303504943848  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6655640602111816  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6667962074279785  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6667962074279785  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6670002937316895  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6857762336730957  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([101, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6870336532592773  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6870336532592773  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6872262954711914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7062978744506836  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.707571506500244  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.707571506500244  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7077527046203613  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.726959705352783  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([65, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7278943061828613  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7278943061828613  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.728018283843994  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.742027759552002  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7430295944213867  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7430295944213867  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7431516647338867  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7578001022338867  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7585525512695312  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7585525512695312  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7586421966552734  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7700271606445312  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7708773612976074  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7708773612976074  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7709708213806152  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.783494472503662  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.78458833694458  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.78458833694458  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7846970558166504  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8000264167785645  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.801053047180176  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.801053047180176  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.801150321960449  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.815546989440918  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8161964416503906  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8161964416503906  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8162593841552734  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8260154724121094  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8265810012817383  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8265810012817383  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.826632499694824  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.834975242614746  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.835503101348877  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.835503101348877  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8355488777160645  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.843285083770752  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([578, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8571505546569824  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8571505546569824  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.858253002166748  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0646615028381348  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 578, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0244855880737305  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0253329277038574  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0261802673339844  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0252904891967773  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([5684, 40])
input nodes number: 37479
output nodes number: 5684
edges number: 46116
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0256123542785645  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0256128311157227  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05999469757080078  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

pseudo mini batch 6 input nodes size: 96561
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05304527282714844  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05304527282714844  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.09992027282714844  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.09996271133422852  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05579042434692383  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05579042434692383  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05579042434692383  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([96561, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05579042434692383  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

m.shape torch.Size([1580, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19647502899169922  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19647502899169922  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1580, 128]), torch.Size([1, 1580, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.1979818344116211  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21058273315429688  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1580, 128])
m.shape torch.Size([2031, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2119121551513672  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2119121551513672  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2031, 128]), torch.Size([1, 2031, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21384906768798828  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24309730529785156  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2031, 128])
m.shape torch.Size([2106, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24514150619506836  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24514150619506836  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2106, 128]), torch.Size([1, 2106, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24714994430541992  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2933526039123535  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2106, 128])
m.shape torch.Size([2099, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.29635190963745117  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.29635190963745117  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2099, 128]), torch.Size([1, 2099, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2983570098876953  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.35848188400268555  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2099, 128])
m.shape torch.Size([1951, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36213254928588867  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36213254928588867  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1951, 128]), torch.Size([1, 1951, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36399316787719727  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.43375062942504883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1951, 128])
m.shape torch.Size([1821, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4380302429199219  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4380302429199219  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1821, 128]), torch.Size([1, 1821, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.43976688385009766  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5153961181640625  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1821, 128])
m.shape torch.Size([1668, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5200953483581543  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5200953483581543  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1668, 128]), torch.Size([1, 1668, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5216860771179199  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6021075248718262  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1668, 128])
m.shape torch.Size([1614, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6074690818786621  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6074690818786621  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1614, 128]), torch.Size([1, 1614, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6090083122253418  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6972899436950684  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1614, 128])
m.shape torch.Size([1511, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7030048370361328  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7030048370361328  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1511, 128]), torch.Size([1, 1511, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7044458389282227  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7970051765441895  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1511, 128])
m.shape torch.Size([20685, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.8949184417724609  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.8949184417724609  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 20685, 128]), torch.Size([1, 20685, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9146451950073242  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.315244674682617  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 20685, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.185275077819824  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2206239700317383  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2559728622436523  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2203474044799805  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([37066, 256])
first layer input nodes number: 96561
first layer output nodes number: 37066
edges number: 286074
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2566943168640137  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2920432090759277  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3016161918640137  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3016161918640137  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

m.shape torch.Size([851, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3465356826782227  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3465356826782227  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 851, 256]), torch.Size([1, 851, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.348158836364746  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.36160945892334  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 851, 256])
m.shape torch.Size([721, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3622002601623535  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3622002601623535  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 721, 256]), torch.Size([1, 721, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3635754585266113  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3843817710876465  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 721, 256])
m.shape torch.Size([588, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.385439395904541  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.385439395904541  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3865609169006348  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.412625789642334  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([495, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.414003849029541  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.414003849029541  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.414947986602783  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4436073303222656  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([387, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.445006847381592  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.445006847381592  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4457449913024902  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4735541343688965  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([305, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.475055694580078  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.475055694580078  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.475637435913086  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5062336921691895  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([239, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.507632255554199  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.507632255554199  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5080881118774414  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.530880928039551  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([221, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5327811241149902  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5327811241149902  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.533202648162842  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.557229518890381  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([182, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.558593273162842  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.558593273162842  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5589404106140137  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5811572074890137  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([169, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.582608222961426  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.582608222961426  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.582930564880371  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6058168411254883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([143, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.607229709625244  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.607229709625244  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6075024604797363  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.628777027130127  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.630213737487793  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.630213737487793  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.630446434020996  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6502256393432617  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([122, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6516833305358887  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6516833305358887  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.651916027069092  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6733241081237793  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6743788719177246  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6743788719177246  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6745448112487793  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6909728050231934  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([69, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.691958427429199  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.691958427429199  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6920900344848633  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.706040382385254  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7070436477661133  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7070436477661133  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7071752548217773  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7220468521118164  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7232065200805664  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7232065200805664  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7233495712280273  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.74051570892334  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7412056922912598  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7412056922912598  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7412896156311035  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7519478797912598  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7527642250061035  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7527642250061035  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7528538703918457  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.764866352081299  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.765629291534424  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.765629291534424  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.765709400177002  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7770047187805176  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.777751922607422  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.777751922607422  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7778263092041016  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7888355255126953  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.789580821990967  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.789580821990967  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.789651393890381  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8005900382995605  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.801218032836914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.801218032836914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8012752532958984  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.810544967651367  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.811185359954834  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.811185359954834  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8112406730651855  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8205885887145996  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([571, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8342814445495605  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8342814445495605  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8353705406188965  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0423331260681152  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 571, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0035548210144043  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0044021606445312  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.005249500274658  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.004359722137451  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([5684, 40])
input nodes number: 37066
output nodes number: 5684
edges number: 45645
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.004678726196289  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0046792030334473  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.06021595001220703  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

pseudo mini batch 7 input nodes size: 98817
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.10043811798095703  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.10048055648803711  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05356311798095703  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05609893798828125  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05609893798828125  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05609893798828125  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([98817, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05609893798828125  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

m.shape torch.Size([1688, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.20192813873291016  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.20192813873291016  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1688, 128]), torch.Size([1, 1688, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2035379409790039  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2165365219116211  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1688, 128])
m.shape torch.Size([2086, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21772098541259766  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21772098541259766  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2086, 128]), torch.Size([1, 2086, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2197103500366211  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2508697509765625  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2086, 128])
m.shape torch.Size([2138, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2529335021972656  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2529335021972656  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2138, 128]), torch.Size([1, 2138, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.25562572479248047  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3022193908691406  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2138, 128])
m.shape torch.Size([2139, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3052797317504883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3052797317504883  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2139, 128]), torch.Size([1, 2139, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.30731964111328125  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36847591400146484  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2139, 128])
m.shape torch.Size([2105, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.37247467041015625  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.37247467041015625  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 2105, 128]), torch.Size([1, 2105, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.374514102935791  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44910478591918945  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 2105, 128])
m.shape torch.Size([1846, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4528346061706543  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4528346061706543  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1846, 128]), torch.Size([1, 1846, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.45459508895874023  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5315127372741699  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1846, 128])
m.shape torch.Size([1739, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5364370346069336  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5364370346069336  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1739, 128]), torch.Size([1, 1739, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5380954742431641  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6210174560546875  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1739, 128])
m.shape torch.Size([1631, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6264100074768066  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6264100074768066  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1631, 128]), torch.Size([1, 1631, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6279654502868652  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7201271057128906  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1631, 128])
m.shape torch.Size([1510, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7258296012878418  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7258296012878418  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 1510, 128]), torch.Size([1, 1510, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7272696495056152  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.819699764251709  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 1510, 128])
m.shape torch.Size([21216, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9205422401428223  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9205422401428223  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 21216, 128]), torch.Size([1, 21216, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9407753944396973  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3938088417053223  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 21216, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2595138549804688  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.295846939086914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3321800231933594  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.295562744140625  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

torch.Size([38098, 256])
first layer input nodes number: 98817
first layer output nodes number: 38098
edges number: 293402
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.332918643951416  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3692517280578613  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.378666400909424  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.378666400909424  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

m.shape torch.Size([830, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4249672889709473  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4249672889709473  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 830, 256]), torch.Size([1, 830, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4265503883361816  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4401001930236816  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 830, 256])
m.shape torch.Size([715, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4406843185424805  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4406843185424805  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 715, 256]), torch.Size([1, 715, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4420480728149414  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4625043869018555  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 715, 256])
m.shape torch.Size([545, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.463761329650879  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.463761329650879  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 545, 256]), torch.Size([1, 545, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4648008346557617  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4888010025024414  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 545, 256])
m.shape torch.Size([458, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.490175724029541  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.490175724029541  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.491049289703369  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5179829597473145  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([414, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.519536018371582  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.519536018371582  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5203256607055664  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.549708366394043  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([304, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5510668754577637  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5510668754577637  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5516467094421387  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5787625312805176  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([258, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5802087783813477  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5802087783813477  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5807008743286133  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6068334579467773  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([234, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.608386993408203  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.608386993408203  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6088333129882812  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6342735290527344  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([178, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6355905532836914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6355905532836914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.635930061340332  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.657658576965332  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([153, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.65895938873291  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.65895938873291  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6592512130737305  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6799707412719727  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([154, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.681527614593506  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.681527614593506  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.681821346282959  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7047324180603027  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([135, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7061429023742676  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7061429023742676  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7064003944396973  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7282872200012207  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7295455932617188  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7295455932617188  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.729757308959961  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.749235153198242  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7503676414489746  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7503676414489746  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7505431175231934  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7679152488708496  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([85, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7690529823303223  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7690529823303223  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7692151069641113  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.786400318145752  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7874112129211426  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7874112129211426  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7875466346740723  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.802849292755127  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8038439750671387  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8038439750671387  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8039679527282715  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.818845272064209  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8207035064697266  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8207035064697266  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.820812225341797  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8346195220947266  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8354783058166504  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8354783058166504  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.835573673248291  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8483529090881348  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.849055290222168  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.849055290222168  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8491296768188477  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8596181869506836  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8603076934814453  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8603076934814453  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8603763580322266  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8705387115478516  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8713083267211914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8713083267211914  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8713808059692383  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.882615089416504  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.883551597595215  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.883551597595215  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8836355209350586  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.897231101989746  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.897858142852783  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.897858142852783  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8979134559631348  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.907261371612549  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([589, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.92138671875  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.92138671875  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.9225101470947266  GigaBytes
Max Memory Allocated: 3.133586883544922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.1227970123291016  GigaBytes
Max Memory Allocated: 3.1368398666381836  GigaBytes

rst.shape  torch.Size([1, 589, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.082608222961426  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0834555625915527  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0843029022216797  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0834131240844727  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([5684, 40])
input nodes number: 38098
output nodes number: 5684
edges number: 46773
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.083739757537842  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.083740234375  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.06142282485961914  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

pseudo mini batch 8 input nodes size: 97184
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05356311798095703  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05356311798095703  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.10043811798095703  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.10048055648803711  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05582380294799805  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05582380294799805  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05582380294799805  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([97184, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05582380294799805  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

m.shape torch.Size([1591, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19861745834350586  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19861745834350586  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2001347541809082  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21272993087768555  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([1989, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2138681411743164  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2138681411743164  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1989, 128]), torch.Size([1, 1989, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21576499938964844  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24455547332763672  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1989, 128])
m.shape torch.Size([2247, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24682140350341797  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24682140350341797  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2247, 128]), torch.Size([1, 2247, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2490558624267578  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.29662466049194336  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2247, 128])
m.shape torch.Size([2148, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2996501922607422  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2996501922607422  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2148, 128]), torch.Size([1, 2148, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3017458915710449  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36250829696655273  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2148, 128])
m.shape torch.Size([2059, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3663930892944336  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3663930892944336  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2059, 128]), torch.Size([1, 2059, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36840152740478516  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44158124923706055  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2059, 128])
m.shape torch.Size([1813, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4457864761352539  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4457864761352539  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1813, 128]), torch.Size([1, 1813, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44751548767089844  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5247068405151367  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1813, 128])
m.shape torch.Size([1744, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5296635627746582  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5296635627746582  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1744, 128]), torch.Size([1, 1744, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5313267707824707  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.614891529083252  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1744, 128])
m.shape torch.Size([1630, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6202778816223145  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6202778816223145  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1630, 128]), torch.Size([1, 1630, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6218323707580566  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7137303352355957  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1630, 128])
m.shape torch.Size([1507, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7194204330444336  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7194204330444336  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1507, 128]), torch.Size([1, 1507, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7208576202392578  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.813774585723877  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1507, 128])
m.shape torch.Size([20874, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9125909805297852  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9125909805297852  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 20874, 128]), torch.Size([1, 20874, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9324979782104492  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3458948135375977  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 20874, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2144784927368164  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.250338554382324  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.286198616027832  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.250058174133301  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([37602, 256])
first layer input nodes number: 97184
first layer output nodes number: 37602
edges number: 289626
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2869248390197754  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.322784900665283  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3318467140197754  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3318467140197754  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

m.shape torch.Size([836, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3781485557556152  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3781485557556152  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3797430992126465  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3924994468688965  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([704, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.393057346343994  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.393057346343994  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.394400119781494  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.415055751800537  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([631, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4163689613342285  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4163689613342285  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.417572498321533  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4443836212158203  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 631, 256])
m.shape torch.Size([470, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.445589065551758  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.445589065551758  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4464855194091797  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.475907325744629  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([403, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4778804779052734  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4778804779052734  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.478649139404297  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5070924758911133  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([303, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.508455753326416  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.508455753326416  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.509033679962158  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5347084999084473  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([246, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.536074638366699  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.536074638366699  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.536543846130371  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.560004234313965  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([216, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5614304542541504  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5614304542541504  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.561842441558838  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5853257179260254  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([192, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.586780548095703  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.586780548095703  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.587146759033203  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.610584259033203  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([142, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.611891269683838  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.611891269683838  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6121621131896973  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.631392002105713  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6327877044677734  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6327877044677734  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6330204010009766  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6511707305908203  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([107, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6522889137268066  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6522889137268066  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6524930000305176  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6698403358459473  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([86, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.670818328857422  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.670818328857422  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6709823608398438  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6860733032226562  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([81, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.687201499938965  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.687201499938965  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6873559951782227  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.702651023864746  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([88, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7038426399230957  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7038426399230957  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.704010486602783  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.721802234649658  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7229485511779785  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7229485511779785  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7231011390686035  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7403435707092285  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.741084575653076  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.741084575653076  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.741179943084717  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.752624034881592  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([81, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7539777755737305  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7539777755737305  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7541322708129883  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7737531661987305  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.774886131286621  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.774886131286621  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.77500057220459  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7903356552124023  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7909321784973145  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7909321784973145  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.79099702835083  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.800140857696533  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8008151054382324  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8008151054382324  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.800881862640381  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8107619285583496  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8113842010498047  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8113842010498047  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.811443328857422  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.820608139038086  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.821463108062744  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.821463108062744  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8215394020080566  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8338990211486816  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8346915245056152  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8346915245056152  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8347601890563965  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8463644981384277  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([609, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8609633445739746  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8609633445739746  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 609, 256]), torch.Size([1, 609, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8621249198913574  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.071807384490967  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 609, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.031601905822754  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0324487686157227  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0332956314086914  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0324063301086426  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([5683, 40])
input nodes number: 37602
output nodes number: 5683
edges number: 46480
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.032728672027588  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.032729148864746  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.06066751480102539  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

pseudo mini batch 9 input nodes size: 97149
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.053318023681640625  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.053318023681640625  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.09964227676391602  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.0996847152709961  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.052767276763916016  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05522871017456055  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05522871017456055  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05522871017456055  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([97149, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05522871017456055  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

m.shape torch.Size([1703, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19559860229492188  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19559860229492188  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1703, 128]), torch.Size([1, 1703, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19722270965576172  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21021556854248047  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1703, 128])
m.shape torch.Size([2216, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21187210083007812  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21187210083007812  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2216, 128]), torch.Size([1, 2216, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21398544311523438  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24579811096191406  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2216, 128])
m.shape torch.Size([2209, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24790143966674805  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.24790143966674805  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2209, 128]), torch.Size([1, 2209, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2500114440917969  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.29671764373779297  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2209, 128])
m.shape torch.Size([2075, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2996220588684082  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2996220588684082  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2075, 128]), torch.Size([1, 2075, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3018608093261719  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3607306480407715  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2075, 128])
m.shape torch.Size([2053, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3638010025024414  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3638010025024414  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2053, 128]), torch.Size([1, 2053, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3666086196899414  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4415402412414551  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2053, 128])
m.shape torch.Size([1865, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44643497467041016  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44643497467041016  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1865, 128]), torch.Size([1, 1865, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4482135772705078  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5274953842163086  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1865, 128])
m.shape torch.Size([1695, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5322637557983398  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5322637557983398  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1695, 128]), torch.Size([1, 1695, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5338802337646484  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.615912914276123  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1695, 128])
m.shape torch.Size([1639, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6213569641113281  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6213569641113281  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1639, 128]), torch.Size([1, 1639, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.622920036315918  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7153530120849609  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1639, 128])
m.shape torch.Size([1417, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7206525802612305  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7206525802612305  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1417, 128]), torch.Size([1, 1417, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7220039367675781  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.8103275299072266  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1417, 128])
m.shape torch.Size([20503, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9074177742004395  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9074177742004395  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 20503, 128]), torch.Size([1, 20503, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9269709587097168  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.315247058868408  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 20503, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.185606002807617  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.221249580383301  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2568931579589844  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.22097110748291  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([37375, 256])
first layer input nodes number: 97149
first layer output nodes number: 37375
edges number: 285277
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2576189041137695  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.293262481689453  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3025407791137695  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3025407791137695  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

m.shape torch.Size([853, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.346859931945801  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.346859931945801  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 853, 256]), torch.Size([1, 853, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.34848690032959  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3620452880859375  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 853, 256])
m.shape torch.Size([788, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3628902435302734  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3628902435302734  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 788, 256]), torch.Size([1, 788, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3643932342529297  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.388411521911621  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 788, 256])
m.shape torch.Size([568, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3893823623657227  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3893823623657227  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.39046573638916  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4149527549743652  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([463, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4163341522216797  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4163341522216797  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.417217254638672  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4445438385009766  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([399, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4460268020629883  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4460268020629883  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4467878341674805  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4796290397644043  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([298, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.481171131134033  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.481171131134033  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4817395210266113  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.510289192199707  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([247, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.511667251586914  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.511667251586914  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5121383666992188  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.535694122314453  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([241, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5373120307922363  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5373120307922363  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.537771701812744  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5639729499816895  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([180, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.565300464630127  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.565300464630127  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.565643787384033  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.587616443634033  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.588973045349121  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.588973045349121  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5892763137817383  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6108083724975586  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.612189769744873  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.612189769744873  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.612466335296631  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6340384483337402  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6352224349975586  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6352224349975586  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.635439872741699  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6539220809936523  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.655087947845459  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.655087947845459  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.655282497406006  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6731810569763184  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([85, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.674227714538574  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.674227714538574  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6743898391723633  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6904401779174805  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([75, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.691455364227295  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.691455364227295  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.691598415374756  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7067618370056152  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.707582473754883  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.707582473754883  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.707693099975586  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.720193862915039  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7212038040161133  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7212038040161133  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.721327781677246  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7362051010131836  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7370948791503906  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7370948791503906  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7371997833251953  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7505226135253906  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7513833045959473  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7513833045959473  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.751478672027588  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7642579078674316  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.76507568359375  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.76507568359375  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7651615142822266  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.777263641357422  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.778282642364502  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.778282642364502  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.778381824493408  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.793060779571533  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7938785552978516  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7938785552978516  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.793956756591797  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8060779571533203  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8068790435791016  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8068790435791016  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8069515228271484  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.818693161010742  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8194875717163086  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8194875717163086  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.81955623626709  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.831160545349121  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([527, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8437891006469727  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8437891006469727  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.844794273376465  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.022937297821045  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 527, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.9847984313964844  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.9856457710266113  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.9864931106567383  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.9856033325195312  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([5684, 40])
input nodes number: 37375
output nodes number: 5684
edges number: 45019
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.98592472076416  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.9859251976013184  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05964946746826172  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

pseudo mini batch 10 input nodes size: 97468
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05276775360107422  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05276775360107422  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.09964275360107422  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.0996851921081543  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.055844783782958984  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.055844783782958984  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.055844783782958984  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([97468, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.055844783782958984  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

m.shape torch.Size([1632, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19975805282592773  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.19975805282592773  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1632, 128]), torch.Size([1, 1632, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.20131444931030273  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21407175064086914  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1632, 128])
m.shape torch.Size([2010, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21521472930908203  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.21521472930908203  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2010, 128]), torch.Size([1, 2010, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2171316146850586  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2470407485961914  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2010, 128])
m.shape torch.Size([2247, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2492966651916504  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2492966651916504  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2247, 128]), torch.Size([1, 2247, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.25143957138061523  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.2989683151245117  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2247, 128])
m.shape torch.Size([2084, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.30187177658081055  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.30187177658081055  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2084, 128]), torch.Size([1, 2084, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3038802146911621  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.3622474670410156  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2084, 128])
m.shape torch.Size([2077, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36620569229125977  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36620569229125977  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2077, 128]), torch.Size([1, 2077, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.36898088455200195  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44350671768188477  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2077, 128])
m.shape torch.Size([1866, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44705724716186523  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.44705724716186523  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1866, 128]), torch.Size([1, 1866, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.4488368034362793  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5272231101989746  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1866, 128])
m.shape torch.Size([1727, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5320978164672852  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5320978164672852  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1727, 128]), torch.Size([1, 1727, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.5337448120117188  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6166853904724121  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1727, 128])
m.shape torch.Size([1627, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6220684051513672  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6220684051513672  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1627, 128]), torch.Size([1, 1627, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.6236200332641602  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7153282165527344  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1627, 128])
m.shape torch.Size([1478, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7216706275939941  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7216706275939941  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1478, 128]), torch.Size([1, 1478, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.7230801582336426  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.814018726348877  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1478, 128])
m.shape torch.Size([21150, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9148764610290527  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9148764610290527  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 21150, 128]), torch.Size([1, 21150, 128])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.9350466728210449  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.387387752532959  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 21150, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.255319595336914  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.291461944580078  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.327604293823242  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.2911791801452637  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([37898, 256])
first layer input nodes number: 97468
first layer output nodes number: 37898
edges number: 292217
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3283324241638184  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3644747734069824  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3739209175109863  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.3739209175109863  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

m.shape torch.Size([843, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4202322959899902  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4202322959899902  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 843, 256]), torch.Size([1, 843, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.421840190887451  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4352564811706543  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 843, 256])
m.shape torch.Size([689, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.435851573944092  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.435851573944092  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 689, 256]), torch.Size([1, 689, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4371657371520996  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4571852684020996  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 689, 256])
m.shape torch.Size([600, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.458277702331543  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.458277702331543  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4594221115112305  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4858741760253906  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([462, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4871039390563965  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.4871039390563965  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.487985134124756  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5157437324523926  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([416, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5173025131225586  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5173025131225586  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5180959701538086  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5466604232788086  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([287, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5479187965393066  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5479187965393066  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.548466205596924  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.575120449066162  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([264, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.57662296295166  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.57662296295166  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.5771265029907227  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.603384494781494  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([203, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.60469388961792  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.60469388961792  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.605081081390381  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6271510124206543  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([173, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6284542083740234  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6284542083740234  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6287841796875  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.64990234375  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([183, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6521353721618652  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6521353721618652  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.65248441696167  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6772665977478027  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.678530216217041  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.678530216217041  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6787896156311035  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.6990227699279785  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.700277328491211  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.700277328491211  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7005062103271484  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.719961166381836  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([113, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7212586402893066  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7212586402893066  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7214741706848145  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.741302967071533  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([86, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7423524856567383  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7423524856567383  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.74251651763916  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.758755683898926  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([83, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7598705291748047  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7598705291748047  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.760028839111328  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7768096923828125  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7774996757507324  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7774996757507324  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.777595043182373  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.7883715629577637  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.789353370666504  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.789353370666504  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.789473533630371  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8038930892944336  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.805729389190674  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.805729389190674  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8058438301086426  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.820377826690674  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8211426734924316  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8211426734924316  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.821228504180908  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8327298164367676  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8333792686462402  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8333792686462402  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8334479331970215  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8431296348571777  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.844205856323242  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.844205856323242  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.844310760498047  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8598365783691406  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8603129386901855  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8603129386901855  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.860360622406006  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8677515983581543  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.868567943572998  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.868567943572998  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.868640422821045  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8803820610046387  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.881199359893799  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.881199359893799  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.881269931793213  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.8931965827941895  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([617, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.907987117767334  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.907987117767334  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 617, 256]), torch.Size([1, 617, 256])
----------------------------------------3
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 2.9091639518737793  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.118251323699951  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 617, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.078038215637207  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.078885555267334  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.079732894897461  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.078843116760254  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([5684, 40])
input nodes number: 37898
output nodes number: 5684
edges number: 46802
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0791683197021484  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 3.0791687965393066  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.060555458068847656  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

pseudo mini batch 11 input nodes size: 98604
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.10033655166625977  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.10037899017333984  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.053461551666259766  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05602121353149414  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05602121353149414  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05602121353149414  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([98604, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7752685546875 GB
    Memory Allocated: 0.05602121353149414  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

m.shape torch.Size([1611, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20190906524658203  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20190906524658203  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1611, 128]), torch.Size([1, 1611, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2034454345703125  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21621417999267578  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1611, 128])
m.shape torch.Size([2080, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21742963790893555  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21742963790893555  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2080, 128]), torch.Size([1, 2080, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22020530700683594  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.252288818359375  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2080, 128])
m.shape torch.Size([2185, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2542724609375  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2542724609375  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2185, 128]), torch.Size([1, 2185, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25635623931884766  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3032236099243164  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2185, 128])
m.shape torch.Size([2148, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30627870559692383  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30627870559692383  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2148, 128]), torch.Size([1, 2148, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3086204528808594  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.36924171447753906  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2148, 128])
m.shape torch.Size([2079, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37272214889526367  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37272214889526367  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 2079, 128]), torch.Size([1, 2079, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37518978118896484  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4494190216064453  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 2079, 128])
m.shape torch.Size([1879, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45380353927612305  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45380353927612305  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1879, 128]), torch.Size([1, 1879, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4555954933166504  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5340781211853027  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1879, 128])
m.shape torch.Size([1701, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5388598442077637  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5388598442077637  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1701, 128]), torch.Size([1, 1701, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5404820442199707  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.621983528137207  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1701, 128])
m.shape torch.Size([1626, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6273751258850098  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6273751258850098  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1626, 128]), torch.Size([1, 1626, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6289258003234863  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7208638191223145  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1626, 128])
m.shape torch.Size([1541, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7267017364501953  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7267017364501953  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 1541, 128]), torch.Size([1, 1541, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7281713485717773  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8229012489318848  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 1541, 128])
m.shape torch.Size([21491, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9246435165405273  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9246435165405273  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 21491, 128]), torch.Size([1, 21491, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9451389312744141  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.401057243347168  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 21491, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.266541004180908  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3031058311462402  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3396706581115723  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3028197288513184  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

torch.Size([38341, 256])
first layer input nodes number: 98604
first layer output nodes number: 38341
edges number: 296281
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.340407371520996  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.376972198486328  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3862557411193848  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3862557411193848  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

m.shape torch.Size([828, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.432589054107666  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.432589054107666  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4341683387756348  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.447049140930176  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([731, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4478821754455566  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4478821754455566  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 731, 256]), torch.Size([1, 731, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4492764472961426  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4720263481140137  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 731, 256])
m.shape torch.Size([588, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.473238468170166  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.473238468170166  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4743599891662598  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.499769687652588  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([443, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5011181831359863  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5011181831359863  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5019631385803223  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5289273262023926  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([389, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.530374526977539  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.530374526977539  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.531116485595703  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.559462070465088  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([311, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.560884952545166  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.560884952545166  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5614781379699707  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5871505737304688  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([248, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5890326499938965  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5890326499938965  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.589505672454834  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.613156795501709  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([217, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.614589214324951  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.614589214324951  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6150031089782715  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6385951042175293  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([183, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6399712562561035  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6399712562561035  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.640320301055908  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.662659168243408  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([169, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.664109230041504  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.664109230041504  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.664431571960449  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6873178482055664  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([147, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.688711166381836  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.688711166381836  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6889915466308594  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7108612060546875  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7120361328125  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7120361328125  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7122535705566406  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7307357788085938  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([88, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.732234477996826  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.732234477996826  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7324023246765137  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7478442192077637  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7487292289733887  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7487292289733887  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.748866558074951  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7624621391296387  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.763489246368408  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.763489246368408  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.763634204864502  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7789998054504395  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7798962593078613  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7798962593078613  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7800164222717285  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7935948371887207  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7945971488952637  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7945971488952637  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7947211265563965  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.809598445892334  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8105688095092773  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8105688095092773  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8106794357299805  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8247289657592773  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.825751304626465  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.825751304626465  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.825863838195801  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8409433364868164  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8420214653015137  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8420214653015137  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8421339988708496  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.858001232147217  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8591766357421875  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8591766357421875  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.859292984008789  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8765125274658203  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.877046585083008  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.877046585083008  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8770999908447266  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.885377883911133  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8861913681030273  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8861913681030273  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.886263847351074  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.898005485534668  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8987998962402344  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8987998962402344  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8988685607910156  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.910472869873047  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([613, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.925168037414551  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.925168037414551  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

 h.shape torch.Size([1, 613, 256]), torch.Size([1, 613, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.926337242126465  GigaBytes
Max Memory Allocated: 3.138517379760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.1361308097839355  GigaBytes
Max Memory Allocated: 3.1507458686828613  GigaBytes

rst.shape  torch.Size([1, 613, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0958876609802246  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0967350006103516  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0975823402404785  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0966925621032715  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([5684, 40])
input nodes number: 38341
output nodes number: 5684
edges number: 47141
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0970211029052734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0970215797424316  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06078624725341797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

pseudo mini batch 12 input nodes size: 96643
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.053461551666259766  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.053461551666259766  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10033655166625977  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10037899017333984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05581331253051758  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05581331253051758  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05581331253051758  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([96643, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05581331253051758  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([1622, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.19861984252929688  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.19861984252929688  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1622, 128]), torch.Size([1, 1622, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2001667022705078  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21282958984375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1622, 128])
m.shape torch.Size([2122, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2140798568725586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2140798568725586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2122, 128]), torch.Size([1, 2122, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21610355377197266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.24704742431640625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2122, 128])
m.shape torch.Size([2216, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2492055892944336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2492055892944336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2216, 128]), torch.Size([1, 2216, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2518625259399414  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2993202209472656  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2216, 128])
m.shape torch.Size([2118, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30220794677734375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30220794677734375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2118, 128]), torch.Size([1, 2118, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30437183380126953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3639822006225586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2118, 128])
m.shape torch.Size([2036, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3678264617919922  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3678264617919922  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2036, 128]), torch.Size([1, 2036, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3697681427001953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44001197814941406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2036, 128])
m.shape torch.Size([1863, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44437122344970703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44437122344970703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1863, 128]), torch.Size([1, 1863, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4461479187011719  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5228891372680664  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1863, 128])
m.shape torch.Size([1666, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5275616645812988  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5275616645812988  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1666, 128]), torch.Size([1, 1666, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5291504859924316  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6101202964782715  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1666, 128])
m.shape torch.Size([1612, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6154751777648926  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6154751777648926  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1612, 128]), torch.Size([1, 1612, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6170125007629395  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7055172920227051  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1612, 128])
m.shape torch.Size([1458, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7119812965393066  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7119812965393066  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1458, 128]), torch.Size([1, 1458, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.713371753692627  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8026537895202637  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1458, 128])
m.shape torch.Size([20844, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9013504981994629  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9013504981994629  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 20844, 128]), torch.Size([1, 20844, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9212288856506348  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.332594394683838  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 20844, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.202305316925049  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2381224632263184  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.273939609527588  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.237842559814453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([37557, 256])
first layer input nodes number: 96643
first layer output nodes number: 37557
edges number: 288464
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2746620178222656  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.310479164123535  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3195838928222656  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3195838928222656  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([850, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3658971786499023  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3658971786499023  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 850, 256]), torch.Size([1, 850, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.367518424987793  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.380885124206543  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 850, 256])
m.shape torch.Size([696, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3814964294433594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3814964294433594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.382823944091797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4027366638183594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([602, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4040093421936035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4040093421936035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4051575660705566  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4312310218811035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([471, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4328417778015137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4328417778015137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4337401390075684  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.460509777069092  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([381, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4618916511535645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4618916511535645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.462618350982666  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4910950660705566  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([329, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4930715560913086  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4930715560913086  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.493699073791504  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5207509994506836  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([255, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.522152900695801  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.522152900695801  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.522639274597168  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5469579696655273  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([200, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.548252582550049  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.548252582550049  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5486340522766113  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.570377826690674  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([191, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5718393325805664  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5718393325805664  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5722036361694336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5955190658569336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([170, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.596971035003662  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.596971035003662  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5972952842712402  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.620316982269287  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6215929985046387  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6215929985046387  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.621852397918701  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.642085552215576  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([127, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.643643856048584  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.643643856048584  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.643886089324951  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.664475917816162  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([98, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.665623188018799  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.665623188018799  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6658101081848145  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.683006763458252  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([89, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6841816902160645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6841816902160645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6843514442443848  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7011570930480957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7022204399108887  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7022204399108887  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7023653984069824  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.71773099899292  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([78, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7189269065856934  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7189269065856934  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7190756797790527  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.735887050628662  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([55, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7367115020751953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7367115020751953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.73681640625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7494049072265625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7502694129943848  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7502694129943848  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.750370502471924  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7632088661193848  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7639622688293457  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7639622688293457  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7640461921691895  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.775291919708252  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.776517391204834  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.776517391204834  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7766261100769043  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7919554710388184  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7927894592285156  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7927894592285156  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7928733825683594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8052940368652344  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.805971145629883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.805971145629883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8060359954833984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8160877227783203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8165197372436523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8165197372436523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8165597915649414  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8230485916137695  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.823605537414551  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.823605537414551  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.823653221130371  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.831711769104004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([602, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8461532592773438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8461532592773438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.847301483154297  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.055255889892578  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 602, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0150580406188965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0159053802490234  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0167527198791504  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0158629417419434  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([5684, 40])
input nodes number: 37557
output nodes number: 5684
edges number: 46213
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0161852836608887  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.016185760498047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0612030029296875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

pseudo mini batch 13 input nodes size: 97125
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.09963130950927734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.09967374801635742  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.052756309509277344  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.055268287658691406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.055268287658691406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.055268287658691406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([97125, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.055268287658691406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([1595, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1980729103088379  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1980729103088379  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1595, 128]), torch.Size([1, 1595, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.19959402084350586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21219205856323242  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1595, 128])
m.shape torch.Size([2159, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21349048614501953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21349048614501953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2159, 128]), torch.Size([1, 2159, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21554946899414062  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.24682855606079102  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2159, 128])
m.shape torch.Size([2203, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.24895048141479492  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.24895048141479492  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2203, 128]), torch.Size([1, 2203, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25142478942871094  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2985725402832031  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2203, 128])
m.shape torch.Size([2186, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3015279769897461  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3015279769897461  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2186, 128]), torch.Size([1, 2186, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3037843704223633  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.365114688873291  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2186, 128])
m.shape torch.Size([2089, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3690528869628906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3690528869628906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3711247444152832  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4445958137512207  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
m.shape torch.Size([1925, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4487156867980957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4487156867980957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1925, 128]), torch.Size([1, 1925, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45055150985717773  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5300393104553223  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1925, 128])
m.shape torch.Size([1708, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5348224639892578  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5348224639892578  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1708, 128]), torch.Size([1, 1708, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5364513397216797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6180171966552734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1708, 128])
m.shape torch.Size([1615, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6233634948730469  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6233634948730469  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1615, 128]), torch.Size([1, 1615, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.624903678894043  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7133426666259766  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1615, 128])
m.shape torch.Size([1415, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7186450958251953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7186450958251953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1415, 128]), torch.Size([1, 1415, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7199945449829102  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8084678649902344  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1415, 128])
m.shape torch.Size([20936, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9076237678527832  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9076237678527832  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 20936, 128]), torch.Size([1, 20936, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9275898933410645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.345184803009033  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 20936, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.213881492614746  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.249959945678711  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.286038398742676  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2496776580810547  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([37831, 256])
first layer input nodes number: 97125
first layer output nodes number: 37831
edges number: 290232
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.286764144897461  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.322842597961426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.332390785217285  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.332390785217285  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([809, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.378671169281006  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.378671169281006  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 809, 256]), torch.Size([1, 809, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.380214214324951  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3935351371765137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 809, 256])
m.shape torch.Size([756, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3942670822143555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3942670822143555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 756, 256]), torch.Size([1, 756, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3957090377807617  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.418426513671875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 756, 256])
m.shape torch.Size([546, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.419449806213379  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.419449806213379  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 546, 256]), torch.Size([1, 546, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4204912185668945  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.443882942199707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 546, 256])
m.shape torch.Size([462, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.445138454437256  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.445138454437256  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4460196495056152  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4730467796325684  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([415, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4746007919311523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4746007919311523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4753923416137695  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5046863555908203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([297, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5060033798217773  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5060033798217773  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5065698623657227  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5321927070617676  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([239, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.533517837524414  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.533517837524414  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5339736938476562  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5567665100097656  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([202, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5580921173095703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5580921173095703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5584774017333984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5804386138916016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([204, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5820107460021973  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5820107460021973  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.582399845123291  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.607302188873291  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([151, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6085591316223145  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6085591316223145  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.608847141265869  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.629295825958252  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.630674362182617  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.630674362182617  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.630949020385742  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.652372360229492  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([140, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6539578437805176  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6539578437805176  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6542248725891113  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.67692232131958  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6780261993408203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6780261993408203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6782150268554688  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.695587158203125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.696744441986084  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.696744441986084  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6969218254089355  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7144827842712402  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([94, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.715749740600586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.715749740600586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7159290313720703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.734933853149414  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([80, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.736074447631836  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.736074447631836  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.736227035522461  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.753469467163086  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7545700073242188  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7545700073242188  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7547073364257812  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7711868286132812  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.77194881439209  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.77194881439209  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.772040367126465  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.78366756439209  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7846593856811523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7846593856811523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.784762382507324  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7985639572143555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([62, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7997045516967773  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7997045516967773  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7998228073120117  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8164968490600586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8173460960388184  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8173460960388184  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.817431926727295  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.830134868621826  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.830620765686035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.830620765686035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8306684494018555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.838059425354004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8384556770324707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8384556770324707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.838491916656494  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.844362735748291  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8452444076538086  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8452444076538086  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8453187942504883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8578901290893555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([589, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8720059394836426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8720059394836426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.873129367828369  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0765342712402344  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 589, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.036345958709717  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0371932983398438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0380406379699707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0371508598327637  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([5684, 40])
input nodes number: 37831
output nodes number: 5684
edges number: 46789
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0374755859375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.037476062774658  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05983257293701172  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

pseudo mini batch 14 input nodes size: 97056
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.052756309509277344  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.052756309509277344  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.09963130950927734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.09967374801635742  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.055806636810302734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.055806636810302734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.055806636810302734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([97056, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.055806636810302734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([1687, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.19716739654541016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.19716739654541016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1687, 128]), torch.Size([1, 1687, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1987762451171875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21164703369140625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1687, 128])
m.shape torch.Size([2091, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21283674240112305  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21283674240112305  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2154555320739746  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.24664306640625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([2172, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.24875307083129883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.24875307083129883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2172, 128]), torch.Size([1, 2172, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2514982223510742  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2981243133544922  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2172, 128])
m.shape torch.Size([2112, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.301116943359375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.301116943359375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2112, 128]), torch.Size([1, 2112, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3031597137451172  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3630352020263672  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2112, 128])
m.shape torch.Size([2048, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3669109344482422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3669109344482422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2048, 128]), torch.Size([1, 2048, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3688640594482422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4391765594482422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2048, 128])
m.shape torch.Size([1874, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4435615539550781  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4435615539550781  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1874, 128]), torch.Size([1, 1874, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44534873962402344  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5225486755371094  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1874, 128])
m.shape torch.Size([1701, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5273327827453613  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5273327827453613  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1701, 128]), torch.Size([1, 1701, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5289549827575684  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6102595329284668  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1701, 128])
m.shape torch.Size([1622, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.615635871887207  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.615635871887207  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1622, 128]), torch.Size([1, 1622, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.617182731628418  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7088141441345215  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1622, 128])
m.shape torch.Size([1502, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7151970863342285  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7151970863342285  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1502, 128]), torch.Size([1, 1502, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7166295051574707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8083043098449707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1502, 128])
m.shape torch.Size([20662, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9061121940612793  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9061121940612793  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 20662, 128]), torch.Size([1, 20662, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9258170127868652  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.324859142303467  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 20662, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.194831371307373  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2305665016174316  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2663016319274902  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2302870750427246  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([37471, 256])
first layer input nodes number: 97056
first layer output nodes number: 37471
edges number: 287338
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.267026901245117  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.302762031555176  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.311948776245117  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.311948776245117  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([874, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3582849502563477  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3582849502563477  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 874, 256]), torch.Size([1, 874, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.359951972961426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3736162185668945  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 874, 256])
m.shape torch.Size([717, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3743996620178223  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3743996620178223  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.375767230987549  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3967041969299316  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 717, 256])
m.shape torch.Size([574, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3976969718933105  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3976969718933105  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.398791790008545  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4247374534606934  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([426, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4258666038513184  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4258666038513184  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4266791343688965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4506115913391113  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([374, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.452003002166748  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.452003002166748  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.45271635055542  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.480848789215088  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([307, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.48226261138916  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.48226261138916  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4828481674194336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5153322219848633  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([254, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5167484283447266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5167484283447266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.517232894897461  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5414562225341797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([217, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5428829193115234  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5428829193115234  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5432968139648438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5668888092041016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([181, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.568300247192383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.568300247192383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.568645477294922  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.590740203857422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([175, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.592249870300293  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.592249870300293  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.592583656311035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6162824630737305  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([160, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.617807388305664  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.617807388305664  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.618112564086914  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.641916275024414  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6430554389953613  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6430554389953613  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6432690620422363  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6614270210266113  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.662644863128662  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.662644863128662  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6628470420837402  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6814475059509277  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([100, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.682692050933838  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.682692050933838  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.682882785797119  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.701765537261963  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([69, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.70267391204834  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.70267391204834  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.702805519104004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7167558670043945  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7178616523742676  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7178616523742676  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7180047035217285  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7341694831848145  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7350621223449707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7350621223449707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7351746559143066  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.748678684234619  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([73, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7498855590820312  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7498855590820312  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7500247955322266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7677078247070312  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.768794536590576  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.768794536590576  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7689127922058105  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.784759044647217  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7857956886291504  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7857956886291504  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7859044075012207  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8012337684631348  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.801926612854004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.801926612854004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.801997184753418  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.812441825866699  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([49, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8134989738464355  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8134989738464355  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8135924339294434  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8280787467956543  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8286514282226562  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8286514282226562  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.828704833984375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8373565673828125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.837883472442627  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.837883472442627  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8379292488098145  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.845665454864502  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([574, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8594350814819336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8594350814819336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860529899597168  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0661020278930664  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 574, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.025932788848877  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.026780128479004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.027627468109131  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.026737689971924  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([5684, 40])
input nodes number: 37471
output nodes number: 5684
edges number: 46516
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.027059555053711  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.027060031890869  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06026744842529297  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

pseudo mini batch 15 input nodes size: 98096
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10009431838989258  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10013675689697266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05321931838989258  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0557246208190918  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0557246208190918  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0557246208190918  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([98096, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0557246208190918  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([1709, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.19858312606811523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.19858312606811523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1709, 128]), torch.Size([1, 1709, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20021295547485352  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21325159072875977  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1709, 128])
m.shape torch.Size([2200, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21547794342041016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21547794342041016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2200, 128]), torch.Size([1, 2200, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2175760269165039  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.24947261810302734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2200, 128])
m.shape torch.Size([2244, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25145435333251953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25145435333251953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2244, 128]), torch.Size([1, 2244, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2537527084350586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30086612701416016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2244, 128])
m.shape torch.Size([2069, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3037424087524414  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3037424087524414  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2069, 128]), torch.Size([1, 2069, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30577945709228516  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.36492252349853516  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2069, 128])
m.shape torch.Size([2016, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3687424659729004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3687424659729004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2016, 128]), torch.Size([1, 2016, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3706650733947754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4407944679260254  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2016, 128])
m.shape torch.Size([1857, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4451460838317871  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4451460838317871  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1857, 128]), torch.Size([1, 1857, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4469170570373535  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5242056846618652  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1857, 128])
m.shape torch.Size([1765, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5292115211486816  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5292115211486816  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1765, 128]), torch.Size([1, 1765, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5308947563171387  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6150565147399902  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1765, 128])
m.shape torch.Size([1670, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6205854415893555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6205854415893555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1670, 128]), torch.Size([1, 1670, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6221780776977539  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7144556045532227  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1670, 128])
m.shape torch.Size([1459, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7199206352233887  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7199206352233887  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1459, 128]), torch.Size([1, 1459, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7213120460510254  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.811943531036377  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1459, 128])
m.shape torch.Size([20843, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9106349945068359  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9106349945068359  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 20843, 128]), torch.Size([1, 20843, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9305124282836914  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3418102264404297  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 20843, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2100534439086914  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2461328506469727  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.282212257385254  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2458505630493164  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([37832, 256])
first layer input nodes number: 98096
first layer output nodes number: 37832
edges number: 289615
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.282945156097412  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3190245628356934  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3286170959472656  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3286170959472656  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([872, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3749537467956543  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3749537467956543  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 872, 256]), torch.Size([1, 872, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.376616954803467  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.390623092651367  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 872, 256])
m.shape torch.Size([752, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3912601470947266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3912601470947266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 752, 256]), torch.Size([1, 752, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3926944732666016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4144458770751953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 752, 256])
m.shape torch.Size([578, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.41591739654541  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.41591739654541  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.417019844055176  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.444657325744629  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([441, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4463090896606445  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4463090896606445  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.447150230407715  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.471543312072754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([368, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.472891330718994  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.472891330718994  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.473593235015869  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4992990493774414  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([305, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5007071495056152  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5007071495056152  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.501288890838623  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5277719497680664  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([257, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.529726982116699  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.529726982116699  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.530217170715332  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5595335960388184  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([219, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5609726905822754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5609726905822754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5613903999328613  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5851998329162598  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5865049362182617  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5865049362182617  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.586838722229004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.608201026916504  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([136, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.609341621398926  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.609341621398926  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6096010208129883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.628018379211426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.629411220550537  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.629411220550537  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.629685878753662  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.651109218597412  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([121, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.65236759185791  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.65236759185791  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6525983810424805  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.672215461730957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([114, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.673524856567383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.673524856567383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6737422943115234  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.693746566772461  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.694894313812256  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.694894313812256  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.695065975189209  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7120604515075684  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.712984085083008  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.712984085083008  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7131175994873047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7272701263427734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7282490730285645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7282490730285645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7283787727355957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.743034839630127  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.743999481201172  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.743999481201172  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.744119644165039  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7585391998291016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.759413719177246  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.759413719177246  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.759516716003418  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.772597312927246  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7734408378601074  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7734408378601074  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7735342979431152  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.786057949066162  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7867226600646973  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7867226600646973  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7867932319641113  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.796743869781494  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7977986335754395  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7977986335754395  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7979016304016113  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.813145160675049  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8138551712036133  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8138551712036133  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8139238357543945  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8245668411254883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8253283500671387  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8253283500671387  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.82539701461792  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8365206718444824  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.837155342102051  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.837155342102051  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8372106552124023  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8465585708618164  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([616, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.861332416534424  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.861332416534424  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8625073432922363  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.072296142578125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 616, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0330114364624023  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0338587760925293  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0347061157226562  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.033816337585449  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([5684, 40])
input nodes number: 37832
output nodes number: 5684
edges number: 46510
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0341410636901855  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0341415405273438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06058645248413086  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06613683700561523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06613683700561523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02642674744129181 |0.023624062538146973 |0.15557987987995148 |0.00010445713996887207 |0.07781730592250824 |0.005903720855712891 |
----------------------------------------------------------pseudo_mini_loss sum 5.33543586730957
 Run 0| Epoch 0 |[05:22:10] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 16 parts and get 0 edge cuts

Number of nodes for computation during this epoch:  2163709
Number of first layer input nodes during this epoch:  1559943
Number of first layer output nodes during this epoch:  603766
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06613636016845703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030170440673828125
global_2_local spend time (sec) 0.047846078872680664
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004263639450073242
A = g.adjacency_matrix() spent  0.008988618850708008
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08080697059631348
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3180840015411377
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1588492393493652

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.002 seconds
Metis partitioning: 0.072 seconds
Split the graph: 0.024 seconds
Construct subgraphs: 0.065 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.16222143173217773
5682
5684
5684
5684
5684
5684
5684
5684
5683
5684
5684
5684
5684
5684
5684
5684
total k batches seeds list generation spend  10.331368446350098
after graph partition
graph partition algorithm spend time 10.429980516433716
5682
5684
5684
5684
5684
5684
5684
5684
5683
5684
5684
5684
5684
5684
5684
5684
partition_len_list
[37894, 37585, 37563, 37991, 37728, 38391, 37269, 37674, 37093, 37880, 38006, 37990, 37931, 37931, 37823, 37470]
shared_neighbor_graph_partition_s0 selection method  spend 10.530738115310669
time for parepare:  0.017115354537963867
local_output_nid generation:  0.0011839866638183594
local_in_edges_tensor generation:  0.0016825199127197266
mini_batch_src_global generation:  0.001720428466796875
r_  generation:  0.014593839645385742
local_output_nid generation:  0.0014209747314453125
local_in_edges_tensor generation:  0.0012488365173339844
mini_batch_src_global generation:  0.001682281494140625
r_  generation:  0.015128374099731445
local_output_nid generation:  0.001608133316040039
local_in_edges_tensor generation:  0.0011904239654541016
mini_batch_src_global generation:  0.0012454986572265625
r_  generation:  0.015384674072265625
local_output_nid generation:  0.0017173290252685547
local_in_edges_tensor generation:  0.0014476776123046875
mini_batch_src_global generation:  0.0012803077697753906
r_  generation:  0.017385482788085938
local_output_nid generation:  0.0017337799072265625
local_in_edges_tensor generation:  0.001169443130493164
mini_batch_src_global generation:  0.0013051033020019531
r_  generation:  0.01840949058532715
local_output_nid generation:  0.0019378662109375
local_in_edges_tensor generation:  0.0012562274932861328
mini_batch_src_global generation:  0.0013027191162109375
r_  generation:  0.01634955406188965
local_output_nid generation:  0.0018591880798339844
local_in_edges_tensor generation:  0.001210927963256836
mini_batch_src_global generation:  0.0013575553894042969
r_  generation:  0.016088008880615234
local_output_nid generation:  0.0018763542175292969
local_in_edges_tensor generation:  0.0014193058013916016
mini_batch_src_global generation:  0.0011973381042480469
r_  generation:  0.01738119125366211
local_output_nid generation:  0.0019197463989257812
local_in_edges_tensor generation:  0.0011930465698242188
mini_batch_src_global generation:  0.0013728141784667969
r_  generation:  0.016231060028076172
local_output_nid generation:  0.0019292831420898438
local_in_edges_tensor generation:  0.0014739036560058594
mini_batch_src_global generation:  0.0012214183807373047
r_  generation:  0.0165097713470459
local_output_nid generation:  0.0019767284393310547
local_in_edges_tensor generation:  0.0011975765228271484
mini_batch_src_global generation:  0.0013971328735351562
r_  generation:  0.016971826553344727
local_output_nid generation:  0.0018641948699951172
local_in_edges_tensor generation:  0.0011935234069824219
mini_batch_src_global generation:  0.0012836456298828125
r_  generation:  0.016663074493408203
local_output_nid generation:  0.0018680095672607422
local_in_edges_tensor generation:  0.0011904239654541016
mini_batch_src_global generation:  0.0013632774353027344
r_  generation:  0.017084121704101562
local_output_nid generation:  0.0018644332885742188
local_in_edges_tensor generation:  0.0011615753173828125
mini_batch_src_global generation:  0.001424551010131836
r_  generation:  0.016627073287963867
local_output_nid generation:  0.001794576644897461
local_in_edges_tensor generation:  0.0011522769927978516
mini_batch_src_global generation:  0.0013289451599121094
r_  generation:  0.02274179458618164
local_output_nid generation:  0.0018162727355957031
local_in_edges_tensor generation:  0.0011878013610839844
mini_batch_src_global generation:  0.0014164447784423828
r_  generation:  0.016539573669433594
----------------------check_connections_block total spend ----------------------------- 0.4463634490966797
generate_one_block  0.0453798770904541
generate_one_block  0.030612468719482422
generate_one_block  0.0340731143951416
generate_one_block  0.026649951934814453
generate_one_block  0.026108980178833008
generate_one_block  0.025701045989990234
generate_one_block  0.02483391761779785
generate_one_block  0.02574014663696289
generate_one_block  0.02495598793029785
generate_one_block  0.025929927825927734
generate_one_block  0.02602219581604004
generate_one_block  0.02586841583251953
generate_one_block  0.02626323699951172
generate_one_block  0.02573084831237793
generate_one_block  0.025903701782226562
generate_one_block  0.025635957717895508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03892064094543457
gen group dst list time:  0.01814746856689453
time for parepare:  0.02083134651184082
local_output_nid generation:  0.008214235305786133
local_in_edges_tensor generation:  0.02335667610168457
mini_batch_src_global generation:  0.012121200561523438
r_  generation:  0.10466480255126953
local_output_nid generation:  0.012562274932861328
local_in_edges_tensor generation:  0.011156082153320312
mini_batch_src_global generation:  0.013926029205322266
r_  generation:  0.10714149475097656
local_output_nid generation:  0.01089334487915039
local_in_edges_tensor generation:  0.008658885955810547
mini_batch_src_global generation:  0.010438919067382812
r_  generation:  0.11087346076965332
local_output_nid generation:  0.010920047760009766
local_in_edges_tensor generation:  0.008963584899902344
mini_batch_src_global generation:  0.011473655700683594
r_  generation:  0.1137990951538086
local_output_nid generation:  0.010882854461669922
local_in_edges_tensor generation:  0.008358955383300781
mini_batch_src_global generation:  0.012187957763671875
r_  generation:  0.11162471771240234
local_output_nid generation:  0.010907173156738281
local_in_edges_tensor generation:  0.009271383285522461
mini_batch_src_global generation:  0.013533830642700195
r_  generation:  0.11626577377319336
local_output_nid generation:  0.010751724243164062
local_in_edges_tensor generation:  0.008612871170043945
mini_batch_src_global generation:  0.012582063674926758
r_  generation:  0.11111164093017578
local_output_nid generation:  0.010790824890136719
local_in_edges_tensor generation:  0.008438348770141602
mini_batch_src_global generation:  0.01285243034362793
r_  generation:  0.1139521598815918
local_output_nid generation:  0.010653257369995117
local_in_edges_tensor generation:  0.008278846740722656
mini_batch_src_global generation:  0.012512445449829102
r_  generation:  0.11127233505249023
local_output_nid generation:  0.010875463485717773
local_in_edges_tensor generation:  0.009436607360839844
mini_batch_src_global generation:  0.012845277786254883
r_  generation:  0.1203923225402832
local_output_nid generation:  0.011032342910766602
local_in_edges_tensor generation:  0.008548259735107422
mini_batch_src_global generation:  0.013186216354370117
r_  generation:  0.11764669418334961
local_output_nid generation:  0.010933399200439453
local_in_edges_tensor generation:  0.008375167846679688
mini_batch_src_global generation:  0.01312398910522461
r_  generation:  0.1171424388885498
local_output_nid generation:  0.011061668395996094
local_in_edges_tensor generation:  0.008485555648803711
mini_batch_src_global generation:  0.012879133224487305
r_  generation:  0.11819100379943848
local_output_nid generation:  0.010852575302124023
local_in_edges_tensor generation:  0.008574724197387695
mini_batch_src_global generation:  0.013115644454956055
r_  generation:  0.11714720726013184
local_output_nid generation:  0.010713577270507812
local_in_edges_tensor generation:  0.008489608764648438
mini_batch_src_global generation:  0.012993574142456055
r_  generation:  0.11391735076904297
local_output_nid generation:  0.010590791702270508
local_in_edges_tensor generation:  0.008470535278320312
mini_batch_src_global generation:  0.012981176376342773
r_  generation:  0.11467432975769043
----------------------check_connections_block total spend ----------------------------- 2.8039324283599854
generate_one_block  0.1540825366973877
generate_one_block  0.13327741622924805
generate_one_block  0.1354210376739502
generate_one_block  0.13889837265014648
generate_one_block  0.1356220245361328
generate_one_block  0.16768765449523926
generate_one_block  0.1336510181427002
generate_one_block  0.13581323623657227
generate_one_block  0.13367438316345215
generate_one_block  0.1366252899169922
generate_one_block  0.13864421844482422
generate_one_block  0.13702678680419922
generate_one_block  0.13804292678833008
generate_one_block  0.13944554328918457
generate_one_block  0.1412971019744873
generate_one_block  0.1364758014678955
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06613636016845703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

connection checking time:  2.8039324283599854
block generation total time  2.235685348510742
average batch blocks generation time:  0.1397303342819214
block dataloader generation time/epoch 16.730733633041382
pseudo mini batch 0 input nodes size: 97882
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05876874923706055  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05876874923706055  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10564374923706055  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10568618774414062  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588679313659668  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061380863189697266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061380863189697266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061380863189697266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([97882, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061380863189697266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([1659, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20528888702392578  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20528888702392578  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1659, 128]), torch.Size([1, 1659, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20687103271484375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21969985961914062  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1659, 128])
m.shape torch.Size([2090, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2209019660949707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2209019660949707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2090, 128]), torch.Size([1, 2090, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22289514541625977  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25488710403442383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2090, 128])
m.shape torch.Size([2220, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2568802833557129  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2568802833557129  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2220, 128]), torch.Size([1, 2220, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25899744033813477  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3061079978942871  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2220, 128])
m.shape torch.Size([2181, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30920934677124023  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30920934677124023  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2181, 128]), torch.Size([1, 2181, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3114008903503418  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3724079132080078  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2181, 128])
m.shape torch.Size([2081, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3760504722595215  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3760504722595215  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2081, 128]), torch.Size([1, 2081, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37836170196533203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4520602226257324  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2081, 128])
m.shape torch.Size([1905, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45651817321777344  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45651817321777344  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1905, 128]), torch.Size([1, 1905, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45833492279052734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5374832153320312  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1905, 128])
m.shape torch.Size([1689, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5422124862670898  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5422124862670898  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1689, 128]), torch.Size([1, 1689, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5438232421875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6251511573791504  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1689, 128])
m.shape torch.Size([1664, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6306934356689453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6306934356689453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1664, 128]), torch.Size([1, 1664, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6322803497314453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.724639892578125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1664, 128])
m.shape torch.Size([1482, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7302064895629883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7302064895629883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1482, 128]), torch.Size([1, 1482, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7316198348999023  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8228969573974609  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1482, 128])
m.shape torch.Size([20923, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9219589233398438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9219589233398438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 20923, 128]), torch.Size([1, 20923, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9419126510620117  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3586273193359375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 20923, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2269396781921387  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.263078212738037  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2992167472839355  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2627954483032227  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([37894, 256])
first layer input nodes number: 97882
first layer output nodes number: 37894
edges number: 290761
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.299948215484619  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3360867500305176  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3456411361694336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3456411361694336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([823, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.39193058013916  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.39193058013916  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 823, 256]), torch.Size([1, 823, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.393500328063965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4068198204040527  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 823, 256])
m.shape torch.Size([703, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.407409191131592  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.407409191131592  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 703, 256]), torch.Size([1, 703, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.408750057220459  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.428863048553467  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 703, 256])
m.shape torch.Size([570, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.429999351501465  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.429999351501465  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.431086540222168  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4572787284851074  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([518, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4587268829345703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4587268829345703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 518, 256]), torch.Size([1, 518, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.459714889526367  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4883670806884766  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 518, 256])
m.shape torch.Size([418, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.489881992340088  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.489881992340088  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4906792640686035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.51953125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([305, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5208916664123535  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5208916664123535  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5214734077453613  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5486512184143066  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([234, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5499348640441895  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5499348640441895  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5503811836242676  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.572697162628174  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([222, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.574181079864502  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.574181079864502  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5746045112609863  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5987401008605957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([176, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.600050926208496  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.600050926208496  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.600386619567871  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.621870994567871  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([152, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.623164176940918  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.623164176940918  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6234540939331055  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.644038200378418  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([150, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.646080493927002  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.646080493927002  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.646366596221924  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.66868257522583  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([139, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6701431274414062  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6701431274414062  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.670408248901367  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.692943572998047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([86, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.693910598754883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.693910598754883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6940746307373047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.709165573120117  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.710348606109619  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.710348606109619  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7105278968811035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7282776832580566  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([78, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7293267250061035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7293267250061035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.729475498199463  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7452454566955566  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7462940216064453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7462940216064453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7464332580566406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.762166976928711  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.763012409210205  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.763012409210205  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7631192207336426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7759366035461426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7767138481140137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7767138481140137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7768054008483887  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7884325981140137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.789299964904785  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.789299964904785  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.789395332336426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8021745681762695  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.803131580352783  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.803131580352783  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8032307624816895  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8172154426574707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8179736137390137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8179736137390137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.818049907684326  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.829341411590576  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8298745155334473  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8298745155334473  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.829926013946533  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8379082679748535  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8387227058410645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8387227058410645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8387951850891113  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.850536823272705  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8511929512023926  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8511929512023926  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.851250171661377  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8609204292297363  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([600, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8753089904785156  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8753089904785156  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.876453399658203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0817108154296875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 600, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0415115356445312  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0423583984375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0432052612304688  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.04231595993042  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([5682, 40])
input nodes number: 37894
output nodes number: 5682
edges number: 46373
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0426406860351562  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0426416397094727  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06676769256591797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

pseudo mini batch 1 input nodes size: 97055
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.058868408203125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.058868408203125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1051478385925293  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10519027709960938  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0582728385925293  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.060758113861083984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.060758113861083984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.060758113861083984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([97055, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.060758113861083984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([1735, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2020416259765625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2020416259765625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1735, 128]), torch.Size([1, 1735, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20369625091552734  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2169332504272461  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1735, 128])
m.shape torch.Size([2184, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21906614303588867  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21906614303588867  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2184, 128]), torch.Size([1, 2184, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22168684005737305  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2530074119567871  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2184, 128])
m.shape torch.Size([2190, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.255098819732666  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.255098819732666  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2190, 128]), torch.Size([1, 2190, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2574477195739746  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30435991287231445  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2190, 128])
m.shape torch.Size([2145, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3071751594543457  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3071751594543457  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2145, 128]), torch.Size([1, 2145, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3094925880432129  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3698544502258301  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2145, 128])
m.shape torch.Size([2065, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37375497817993164  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37375497817993164  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2065, 128]), torch.Size([1, 2065, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3762683868408203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44964599609375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2065, 128])
m.shape torch.Size([1864, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4534120559692383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4534120559692383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1864, 128]), torch.Size([1, 1864, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45518970489501953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5336313247680664  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1864, 128])
m.shape torch.Size([1674, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.538330078125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.538330078125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1674, 128]), torch.Size([1, 1674, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5399265289306641  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6212987899780273  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1674, 128])
m.shape torch.Size([1595, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6265850067138672  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6265850067138672  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1595, 128]), torch.Size([1, 1595, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6281061172485352  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7149486541748047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1595, 128])
m.shape torch.Size([1458, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7204451560974121  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7204451560974121  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1458, 128]), torch.Size([1, 1458, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7218356132507324  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8110194206237793  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1458, 128])
m.shape torch.Size([20675, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9089102745056152  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9089102745056152  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 20675, 128]), torch.Size([1, 20675, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9286274909973145  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.328549861907959  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 20675, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.198997974395752  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.234841823577881  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2706856727600098  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2345614433288574  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([37585, 256])
first layer input nodes number: 97055
first layer output nodes number: 37585
edges number: 287112
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2714109420776367  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3072547912597656  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3163328170776367  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3163328170776367  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([896, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.362687587738037  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.362687587738037  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 896, 256]), torch.Size([1, 896, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.364396572113037  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.378875255584717  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 896, 256])
m.shape torch.Size([748, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.379599094390869  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.379599094390869  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 748, 256]), torch.Size([1, 748, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.381025791168213  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4025492668151855  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 748, 256])
m.shape torch.Size([586, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.403604030609131  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.403604030609131  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.404721736907959  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4307732582092285  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([445, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4319581985473633  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4319581985473633  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.432806968688965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.45742130279541  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([347, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.458664894104004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.458664894104004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.45932674407959  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.487006187438965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([306, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4884400367736816  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4884400367736816  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4890236854553223  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5198683738708496  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([247, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5212388038635254  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5212388038635254  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.52170991897583  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5452656745910645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([201, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.546623706817627  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.546623706817627  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5470070838928223  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.568859577178955  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([185, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5702900886535645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5702900886535645  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5706429481506348  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5932259559631348  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([165, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5946431159973145  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5946431159973145  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5949578285217285  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.617302417755127  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([122, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6187362670898438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6187362670898438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.618968963623047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6371192932128906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.638640880584717  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.638640880584717  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.638852596282959  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.656848430633545  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([98, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.657975196838379  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.657975196838379  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6581621170043945  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.675358772277832  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([99, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6765975952148438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6765975952148438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.676786422729492  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6954803466796875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6967267990112305  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6967267990112305  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.696904182434082  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7157068252563477  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([67, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.716649055480957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.716649055480957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7167768478393555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.731217384338379  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7322030067443848  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7322030067443848  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7323193550109863  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.746281147003174  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7472753524780273  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7472753524780273  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7473859786987305  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7614355087280273  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.762275218963623  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.762275218963623  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.762368679046631  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7748923301696777  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7757301330566406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7757301330566406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.77581787109375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.788188934326172  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.789073944091797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.789073944091797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7891616821289062  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8021469116210938  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8032240867614746  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8032240867614746  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.803321361541748  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.818398952484131  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8193230628967285  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8193230628967285  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8194069862365723  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8330025672912598  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8335604667663574  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8335604667663574  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8336100578308105  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8419909477233887  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([587, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8560709953308105  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8560709953308105  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8571906089782715  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0655312538146973  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 587, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0253500938415527  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0261974334716797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0270447731018066  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0261549949645996  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([5684, 40])
input nodes number: 37585
output nodes number: 5684
edges number: 46285
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0264782905578613  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0264787673950195  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06521749496459961  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

pseudo mini batch 2 input nodes size: 97241
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0582733154296875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0582733154296875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1051483154296875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10519075393676758  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06136274337768555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06136274337768555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06136274337768555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([97241, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06136274337768555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([1649, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2041788101196289  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2041788101196289  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1649, 128]), torch.Size([1, 1649, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2057514190673828  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21846389770507812  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1649, 128])
m.shape torch.Size([2094, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21967458724975586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21967458724975586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2094, 128]), torch.Size([1, 2094, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22167158126831055  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2523617744445801  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2094, 128])
m.shape torch.Size([2147, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25443458557128906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25443458557128906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2147, 128]), torch.Size([1, 2147, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25719213485717773  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3043956756591797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2147, 128])
m.shape torch.Size([2119, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30695629119873047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30695629119873047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2119, 128]), torch.Size([1, 2119, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3094477653503418  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.370241641998291  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2119, 128])
m.shape torch.Size([2097, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37423086166381836  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37423086166381836  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2097, 128]), torch.Size([1, 2097, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37624120712280273  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4515399932861328  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2097, 128])
m.shape torch.Size([1827, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4565396308898926  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4565396308898926  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1827, 128]), torch.Size([1, 1827, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4582819938659668  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.534996509552002  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1827, 128])
m.shape torch.Size([1657, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5396561622619629  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5396561622619629  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1657, 128]), torch.Size([1, 1657, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.541236400604248  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6219534873962402  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1657, 128])
m.shape torch.Size([1649, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6274538040161133  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6274538040161133  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1649, 128]), torch.Size([1, 1649, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6290264129638672  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7213048934936523  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1649, 128])
m.shape torch.Size([1468, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7268185615539551  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7268185615539551  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1468, 128]), torch.Size([1, 1468, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7282185554504395  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8178181648254395  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1468, 128])
m.shape torch.Size([20856, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.916567325592041  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.916567325592041  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 20856, 128]), torch.Size([1, 20856, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9364571571350098  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.348635196685791  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 20856, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2168798446655273  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2527027130126953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2885255813598633  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.25242280960083  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([37563, 256])
first layer input nodes number: 97241
first layer output nodes number: 37563
edges number: 288764
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.289252281188965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.325075149536133  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.334174156188965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.334174156188965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([841, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.379314422607422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.379314422607422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.380918502807617  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3941211700439453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 841, 256])
m.shape torch.Size([727, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.394944667816162  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.394944667816162  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.396331310272217  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4179625511169434  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([574, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4189682006835938  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4189682006835938  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.420063018798828  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4465599060058594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([488, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.448024272918701  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.448024272918701  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4489550590515137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.476724147796631  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([390, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.478133201599121  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.478133201599121  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.478877067565918  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5079941749572754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([289, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.509289264678955  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.509289264678955  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.509840488433838  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5358729362487793  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([223, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.537097930908203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.537097930908203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5375232696533203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5587902069091797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([261, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.560584545135498  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.560584545135498  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.561082363128662  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5942234992980957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([178, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5955147743225098  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5955147743225098  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5958542823791504  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6175827980041504  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([177, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.619114398956299  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.619114398956299  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6194519996643066  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6434216499328613  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([129, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6446170806884766  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6446170806884766  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6448631286621094  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6640548706054688  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6652121543884277  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6652121543884277  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.66542387008667  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.683419704437256  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([118, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6850810050964355  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6850810050964355  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6853060722351074  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.70601224899292  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.70731258392334  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.70731258392334  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.707512855529785  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.727339744567871  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7284507751464844  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7284507751464844  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7286109924316406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.745594024658203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.746682643890381  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.746682643890381  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7468276023864746  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7632079124450684  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.764132499694824  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.764132499694824  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.764248847961426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7782106399536133  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.779208183288574  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.779208183288574  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.779324531555176  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.794100761413574  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.795010566711426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.795010566711426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.795111656188965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.808657646179199  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([61, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8097801208496094  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8097801208496094  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.809896469116211  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8263015747070312  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8269095420837402  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8269095420837402  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.826972484588623  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8362879753112793  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8369545936584473  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8369545936584473  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.83701753616333  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.846773624420166  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8472728729248047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8472728729248047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.847318649291992  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.854734420776367  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8553576469421387  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8553576469421387  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8554110527038574  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.864436626434326  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([559, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8778419494628906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8778419494628906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.878908157348633  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0673913955688477  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 559, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0283961296081543  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0292434692382812  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.030090808868408  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.029201030731201  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([5684, 40])
input nodes number: 37563
output nodes number: 5684
edges number: 45885
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0295233726501465  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0295238494873047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06660795211791992  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

pseudo mini batch 3 input nodes size: 97775
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10549163818359375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10553407669067383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05861663818359375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061156272888183594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061156272888183594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061156272888183594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([97775, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061156272888183594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([1690, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20697832107543945  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20697832107543945  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1690, 128]), torch.Size([1, 1690, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20859003067016602  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22159910202026367  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1690, 128])
m.shape torch.Size([2046, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22274446487426758  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22274446487426758  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2046, 128]), torch.Size([1, 2046, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22469568252563477  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25397539138793945  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2046, 128])
m.shape torch.Size([2149, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2569136619567871  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2569136619567871  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2149, 128]), torch.Size([1, 2149, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2595553398132324  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30553674697875977  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2149, 128])
m.shape torch.Size([2090, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3084983825683594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3084983825683594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2090, 128]), torch.Size([1, 2090, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.31099462509155273  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3707280158996582  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2090, 128])
m.shape torch.Size([2000, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37374353408813477  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37374353408813477  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2000, 128]), torch.Size([1, 2000, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37565088272094727  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44541406631469727  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2000, 128])
m.shape torch.Size([1809, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44963598251342773  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44963598251342773  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1809, 128]), torch.Size([1, 1809, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45136117935180664  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5273661613464355  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1809, 128])
m.shape torch.Size([1789, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5324749946594238  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5324749946594238  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1789, 128]), torch.Size([1, 1789, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5341811180114746  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6194872856140137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1789, 128])
m.shape torch.Size([1590, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.624699592590332  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.624699592590332  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1590, 128]), torch.Size([1, 1590, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.626215934753418  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7130246162414551  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1590, 128])
m.shape torch.Size([1447, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7184762954711914  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7184762954711914  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1447, 128]), torch.Size([1, 1447, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7198562622070312  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8088092803955078  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1447, 128])
m.shape torch.Size([21381, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.910071849822998  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.910071849822998  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 21381, 128]), torch.Size([1, 21381, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9304623603820801  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3852267265319824  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 21381, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.251807689666748  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.288038730621338  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3242697715759277  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2877554893493652  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([37991, 256])
first layer input nodes number: 97775
first layer output nodes number: 37991
edges number: 293519
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.325000286102295  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3612313270568848  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3705673217773438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3705673217773438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([857, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4169259071350098  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4169259071350098  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.41856050491333  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4321517944335938  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([746, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4329090118408203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4329090118408203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 746, 256]), torch.Size([1, 746, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4343318939208984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.455982208251953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 746, 256])
m.shape torch.Size([601, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4570374488830566  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4570374488830566  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.458183765411377  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4842777252197266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([411, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4853248596191406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4853248596191406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4861087799072266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5105838775634766  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([386, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.512047290802002  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.512047290802002  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5127835273742676  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.539851188659668  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([278, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5410866737365723  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5410866737365723  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.541616916656494  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5682129859924316  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([267, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.56974458694458  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.56974458694458  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.570253849029541  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5962324142456055  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5975465774536133  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5975465774536133  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.597935676574707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.620114326477051  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([168, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6215996742248535  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6215996742248535  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.621920108795166  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.642427921295166  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([154, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6437482833862305  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6437482833862305  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6440420150756836  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6648969650268555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([129, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.666114330291748  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.666114330291748  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.666360378265381  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6855521202087402  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([130, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6869287490844727  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6869287490844727  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6871767044067383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7082529067993164  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([112, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7095284461975098  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7095284461975098  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7097420692443848  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7293953895568848  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.730419158935547  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.730419158935547  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.730579376220703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.746440887451172  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.747312545776367  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.747312545776367  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.747438430786133  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.760782241821289  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.761626720428467  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.761626720428467  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7617392539978027  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7744555473327637  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([80, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7757067680358887  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7757067680358887  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7758593559265137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7941699028015137  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.795320987701416  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.795320987701416  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7954354286193848  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.809969425201416  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([67, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.811135768890381  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.811135768890381  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8112635612487793  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.82838773727417  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([62, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8295159339904785  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8295159339904785  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.829634189605713  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8463082313537598  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8471779823303223  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8471779823303223  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8472657203674316  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860250949859619  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860947608947754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860947608947754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8610143661499023  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.87136173248291  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8719916343688965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8719916343688965  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.872048854827881  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8813185691833496  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.882166862487793  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.882166862487793  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.88223934173584  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8944883346557617  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([614, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.909205436706543  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.909205436706543  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 614, 256]), torch.Size([1, 614, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.91037654876709  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.118534564971924  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 614, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0782933235168457  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0791406631469727  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0799880027770996  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0790982246398926  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([5684, 40])
input nodes number: 37991
output nodes number: 5684
edges number: 47133
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0794239044189453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0794243812561035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06647109985351562  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

pseudo mini batch 4 input nodes size: 97311
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05861663818359375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05861663818359375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10549163818359375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10553407669067383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06137514114379883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06137514114379883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06137514114379883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([97311, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06137514114379883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([1662, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20420551300048828  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20420551300048828  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20579051971435547  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21851825714111328  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([2108, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21973609924316406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21973609924316406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2108, 128]), torch.Size([1, 2108, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22174644470214844  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2525634765625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2108, 128])
m.shape torch.Size([2204, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2547111511230469  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2547111511230469  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2204, 128]), torch.Size([1, 2204, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2574291229248047  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3048992156982422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2204, 128])
m.shape torch.Size([2052, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3076038360595703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3076038360595703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2052, 128]), torch.Size([1, 2052, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3098182678222656  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.36820411682128906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2052, 128])
m.shape torch.Size([2077, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3721776008605957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3721776008605957  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2077, 128]), torch.Size([1, 2077, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37510204315185547  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4505801200866699  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2077, 128])
m.shape torch.Size([1836, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4555320739746094  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4555320739746094  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1836, 128]), torch.Size([1, 1836, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45728302001953125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5353050231933594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1836, 128])
m.shape torch.Size([1758, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5402975082397461  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5402975082397461  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1758, 128]), torch.Size([1, 1758, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5419740676879883  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6259040832519531  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1758, 128])
m.shape torch.Size([1601, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6311731338500977  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6311731338500977  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1601, 128]), torch.Size([1, 1601, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6326999664306641  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7200403213500977  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1601, 128])
m.shape torch.Size([1502, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7257227897644043  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7257227897644043  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1502, 128]), torch.Size([1, 1502, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7271552085876465  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8188300132751465  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1502, 128])
m.shape torch.Size([20928, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9179062843322754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9179062843322754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 20928, 128]), torch.Size([1, 20928, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9378647804260254  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3549180030822754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 20928, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.223106861114502  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.259087085723877  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.295067310333252  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.258805751800537  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([37728, 256])
first layer input nodes number: 97311
first layer output nodes number: 37728
edges number: 290011
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2957944869995117  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3317747116088867  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3413267135620117  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3413267135620117  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([828, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.387619972229004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.387619972229004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3891992568969727  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4018335342407227  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([704, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4024524688720703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4024524688720703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4037952423095703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.424589157104492  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([587, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4256858825683594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4256858825683594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4268054962158203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.452341079711914  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 587, 256])
m.shape torch.Size([469, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.453610420227051  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.453610420227051  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.45450496673584  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.482060432434082  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([413, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.483598232269287  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.483598232269287  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4843859672546387  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5133328437805176  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([307, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.51470947265625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.51470947265625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5152950286865234  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5416154861450195  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([271, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5431461334228516  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5431461334228516  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5436630249023438  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.570821762084961  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([226, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5723013877868652  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5723013877868652  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.572732448577881  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5973029136657715  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([186, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.598696708679199  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.598696708679199  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5990514755249023  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6217565536499023  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([161, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.623126983642578  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.623126983642578  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.623434066772461  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6452369689941406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([132, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6464791297912598  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6464791297912598  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.646730899810791  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6663689613342285  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([138, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.667834758758545  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.667834758758545  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.668097972869873  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6904711723327637  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6918511390686035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6918511390686035  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.692030429840088  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7085251808166504  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([79, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.709542751312256  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.709542751312256  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.709693431854248  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7246108055114746  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([77, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7256460189819336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7256460189819336  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.72579288482666  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.741360664367676  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.74239444732666  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.74239444732666  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.74252986907959  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7578325271606445  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.758871555328369  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.758871555328369  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7589917182922363  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.773411273956299  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7744579315185547  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7744579315185547  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7745723724365234  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7891063690185547  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.789853096008301  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.789853096008301  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7899370193481445  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.801182746887207  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8019485473632812  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8019485473632812  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8020286560058594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.813323974609375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8142971992492676  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8142971992492676  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8143906593322754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8282227516174316  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.828810691833496  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.828810691833496  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8288679122924805  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8377370834350586  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8384604454040527  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8384604454040527  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8385252952575684  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8490309715270996  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8501052856445312  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8501052856445312  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.850187301635742  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8640480041503906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([576, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.877847194671631  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.877847194671631  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.878945827484131  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.081739902496338  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 576, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.041565418243408  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.042412757873535  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.043260097503662  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.042370319366455  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([5684, 40])
input nodes number: 37728
output nodes number: 5684
edges number: 46226
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.042694091796875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.042694568634033  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06603574752807617  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

pseudo mini batch 5 input nodes size: 98185
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10568714141845703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10572957992553711  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05881214141845703  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06137371063232422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06137371063232422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06137371063232422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([98185, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06137371063232422  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([1598, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20725440979003906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20725440979003906  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1598, 128]), torch.Size([1, 1598, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20877838134765625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22150039672851562  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1598, 128])
m.shape torch.Size([2089, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2227306365966797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2227306365966797  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22550630569458008  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2576146125793457  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
m.shape torch.Size([2141, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25960683822631836  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25960683822631836  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2141, 128]), torch.Size([1, 2141, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.26164865493774414  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30815887451171875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2141, 128])
m.shape torch.Size([2154, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.311246395111084  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.311246395111084  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2154, 128]), torch.Size([1, 2154, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3137831687927246  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.374666690826416  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2154, 128])
m.shape torch.Size([2134, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37872743606567383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37872743606567383  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 2134, 128]), torch.Size([1, 2134, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.38077545166015625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45630550384521484  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 2134, 128])
m.shape torch.Size([1910, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4607524871826172  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4607524871826172  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1910, 128]), torch.Size([1, 1910, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4625740051269531  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5408992767333984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1910, 128])
m.shape torch.Size([1807, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5460200309753418  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5460200309753418  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1807, 128]), torch.Size([1, 1807, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5477433204650879  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.634829044342041  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1807, 128])
m.shape torch.Size([1635, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6402044296264648  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6402044296264648  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1635, 128]), torch.Size([1, 1635, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6417636871337891  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7339634895324707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1635, 128])
m.shape torch.Size([1496, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7396039962768555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7396039962768555  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7410306930541992  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8323392868041992  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([21427, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9337978363037109  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9337978363037109  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 21427, 128]), torch.Size([1, 21427, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9542322158813477  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4094791412353516  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 21427, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.275059700012207  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3116722106933594  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3482847213745117  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3113861083984375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

torch.Size([38391, 256])
first layer input nodes number: 98185
first layer output nodes number: 38391
edges number: 296408
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3490185737609863  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3856310844421387  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3949451446533203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3949451446533203  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

m.shape torch.Size([836, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4414567947387695  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4414567947387695  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.443051338195801  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.455807685852051  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([717, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.456453800201416  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.456453800201416  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4578213691711426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.478334903717041  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 717, 256])
m.shape torch.Size([568, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.479595184326172  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.479595184326172  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4806785583496094  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.506305694580078  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([442, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5074634552001953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5074634552001953  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5083065032958984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5349936485290527  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([371, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5363550186157227  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5363550186157227  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.537062644958496  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.563654899597168  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([293, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.564990997314453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.564990997314453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.565549850463867  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5915417671203613  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([266, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.593052387237549  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.593052387237549  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.593559741973877  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.620194911956787  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([229, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.622166156768799  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.622166156768799  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.622602939605713  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6474995613098145  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.64896821975708  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.64896821975708  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6493401527404785  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6731438636779785  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([182, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6747074127197266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6747074127197266  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6750545501708984  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6997013092041016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([126, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.700860023498535  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.700860023498535  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7011003494262695  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.719845771789551  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([126, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7211790084838867  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7211790084838867  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.721419334411621  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.741847038269043  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7429141998291016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7429141998291016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7430953979492188  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.759765625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([78, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7616467475891113  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7616467475891113  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7617955207824707  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.776524066925049  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7776031494140625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7776031494140625  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7777557373046875  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7939300537109375  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([75, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7950072288513184  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7950072288513184  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7951502799987793  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8113150596618652  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.81242036819458  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.81242036819458  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8125576972961426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8290371894836426  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.830127716064453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.830127716064453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8302555084228516  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.846485137939453  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8474254608154297  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8474254608154297  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8475284576416016  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.861330032348633  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8622589111328125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8622589111328125  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.862356185913086  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8760719299316406  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8770127296447754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8770127296447754  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.877106189727783  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8909382820129395  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.891737461090088  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.891737461090088  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8918137550354004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.903639316558838  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9043970108032227  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9043970108032227  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.904465675354004  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9155893325805664  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.916593074798584  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.916593074798584  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9166789054870605  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9311842918395996  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([591, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9453420639038086  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9453420639038086  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.946469306945801  GigaBytes
Max Memory Allocated: 3.151829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.1479454040527344  GigaBytes
Max Memory Allocated: 3.1620359420776367  GigaBytes

rst.shape  torch.Size([1, 591, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.1075539588928223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.108401298522949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.109248638153076  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.108358860015869  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 38391
output nodes number: 5684
edges number: 47317
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.108687400817871  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.1086878776550293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06607770919799805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 6 input nodes size: 96897
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05881214141845703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05881214141845703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10568714141845703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10572957992553711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06133413314819336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06133413314819336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06133413314819336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([96897, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06133413314819336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1656, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2016453742980957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2016453742980957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1656, 128]), torch.Size([1, 1656, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20322465896606445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21597623825073242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1656, 128])
m.shape torch.Size([2155, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2176837921142578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2176837921142578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2155, 128]), torch.Size([1, 2155, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21973896026611328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2518124580383301  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2155, 128])
m.shape torch.Size([2150, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25386762619018555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25386762619018555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2150, 128]), torch.Size([1, 2150, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.255918025970459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3023490905761719  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2150, 128])
m.shape torch.Size([2168, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30545902252197266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30545902252197266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2168, 128]), torch.Size([1, 2168, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3079252243041992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.36899471282958984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2168, 128])
m.shape torch.Size([2026, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3727912902832031  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3727912902832031  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2026, 128]), torch.Size([1, 2026, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3747234344482422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44478416442871094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2026, 128])
m.shape torch.Size([1850, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4491109848022461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4491109848022461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1850, 128]), torch.Size([1, 1850, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45087528228759766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5272016525268555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1850, 128])
m.shape torch.Size([1674, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5319070816040039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5319070816040039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1674, 128]), torch.Size([1, 1674, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.533503532409668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6156768798828125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1674, 128])
m.shape torch.Size([1598, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6209745407104492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6209745407104492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1598, 128]), torch.Size([1, 1598, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6224985122680664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7101736068725586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1598, 128])
m.shape torch.Size([1523, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7159476280212402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7159476280212402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1523, 128]), torch.Size([1, 1523, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.717400074005127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8104758262634277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1523, 128])
m.shape torch.Size([20469, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.907353401184082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.907353401184082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 20469, 128]), torch.Size([1, 20469, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9268741607666016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3129634857177734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 20469, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.184263229370117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2198057174682617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2553482055664062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2195277214050293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37269, 256])
first layer input nodes number: 96897
first layer output nodes number: 37269
edges number: 285217
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.256072521209717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2916150093078613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.300994396209717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.300994396209717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([846, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.345803737640381  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.345803737640381  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 846, 256]), torch.Size([1, 846, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3474173545837402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.361279010772705  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 846, 256])
m.shape torch.Size([753, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3619771003723145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3619771003723145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3634133338928223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3853888511657715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 753, 256])
m.shape torch.Size([576, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.386443614959717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.386443614959717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.387542247772217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.411712169647217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([452, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4129366874694824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4129366874694824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4137988090515137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4416918754577637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([384, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.443249225616455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.443249225616455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.443981647491455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4775242805480957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([312, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4791464805603027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4791464805603027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4797415733337402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.512603759765625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([234, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.513880729675293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.513880729675293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.514327049255371  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5366430282592773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([198, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.537942409515381  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.537942409515381  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5383200645446777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5598464012145996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([216, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.561526298522949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.561526298522949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5619382858276367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5883054733276367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([177, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5898008346557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5898008346557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5901384353637695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.614108085632324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([160, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.615631103515625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.615631103515625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.615936279296875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.639739990234375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([116, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.640925407409668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.640925407409668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.641146659851074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6599531173706055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6616153717041016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6616153717041016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6618194580078125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6805953979492188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([106, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.681920051574707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.681920051574707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.682122230529785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7021379470825195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7031784057617188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7031784057617188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7033233642578125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.71868896484375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7196006774902344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7196006774902344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7197227478027344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7335166931152344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.734597682952881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.734597682952881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.734727382659912  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.750291347503662  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7513885498046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7513885498046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7515087127685547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7667694091796875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7675676345825195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7675676345825195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7676572799682617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.779669761657715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.780689239501953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.780689239501953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.780792236328125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7953147888183594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7961716651916504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7961716651916504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.796257495880127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.808960437774658  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8098692893981934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8098692893981934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.80995512008667  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.823258876800537  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.823857307434082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.823857307434082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8239126205444336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8328733444213867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.833630084991455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.833630084991455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8336949348449707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8446545600891113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([522, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8571648597717285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8571648597717285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8581604957580566  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0333924293518066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 522, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.994765281677246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.995612621307373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9964599609375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.995570182800293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37269
output nodes number: 5684
edges number: 45538
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9958906173706055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9958910942077637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06575965881347656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 7 input nodes size: 97531
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10537528991699219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10541772842407227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05850028991699219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061005592346191406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061005592346191406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061005592346191406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97531, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.061005592346191406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1648, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2038283348083496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2038283348083496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1648, 128]), torch.Size([1, 1648, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2053999900817871  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21810102462768555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1648, 128])
m.shape torch.Size([2147, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21936273574829102  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21936273574829102  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2147, 128]), torch.Size([1, 2147, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22141027450561523  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2525806427001953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2147, 128])
m.shape torch.Size([2196, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2546982765197754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2546982765197754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2196, 128]), torch.Size([1, 2196, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25722646713256836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30440521240234375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2196, 128])
m.shape torch.Size([2055, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30707740783691406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30707740783691406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2055, 128]), torch.Size([1, 2055, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30934858322143555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3678593635559082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2055, 128])
m.shape torch.Size([2040, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37174320220947266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37174320220947266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2040, 128]), torch.Size([1, 2040, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3736886978149414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4439554214477539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2040, 128])
m.shape torch.Size([1787, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44809532165527344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44809532165527344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1787, 128]), torch.Size([1, 1787, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4497995376586914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5249652862548828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1787, 128])
m.shape torch.Size([1670, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5296874046325684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5296874046325684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1670, 128]), torch.Size([1, 1670, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5312800407409668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.612729549407959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1670, 128])
m.shape torch.Size([1601, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6180405616760254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6180405616760254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1601, 128]), torch.Size([1, 1601, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6195673942565918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.706596851348877  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1601, 128])
m.shape torch.Size([1496, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7122535705566406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7122535705566406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7136802673339844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8050708770751953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([21034, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9046554565429688  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9046554565429688  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21034, 128]), torch.Size([1, 21034, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9247150421142578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3758392333984375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21034, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2447938919067383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2807226181030273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3166513442993164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2804417610168457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37674, 256])
first layer input nodes number: 97531
first layer output nodes number: 37674
edges number: 289974
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.317379951477051  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.35330867767334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.362301826477051  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.362301826477051  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([854, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.408618927001953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.408618927001953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 854, 256]), torch.Size([1, 854, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.410247802734375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4240331649780273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 854, 256])
m.shape torch.Size([758, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4247236251831055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4247236251831055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 758, 256]), torch.Size([1, 758, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4261693954467773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4490013122558594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 758, 256])
m.shape torch.Size([574, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.450282573699951  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.450282573699951  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4513773918151855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4770913124084473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4782705307006836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4782705307006836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4791269302368164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5053606033325195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([375, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.507596969604492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.507596969604492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.508312225341797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.536233901977539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([326, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5377564430236816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5377564430236816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5383782386779785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5661072731018066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([240, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.567411422729492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.567411422729492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.567869186401367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.590757369995117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([221, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5922279357910156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5922279357910156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.592649459838867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6166763305664062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([198, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.618178367614746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.618178367614746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.618556022644043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.642725944519043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([148, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6439599990844727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6439599990844727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.644242286682129  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6642847061157227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([137, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6655921936035156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6655921936035156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.665853500366211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6862354278564453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([111, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.687385082244873  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.687385082244873  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6875967979431152  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.705592632293701  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([113, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7068986892700195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7068986892700195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7071142196655273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.726943016052246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.727921485900879  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.727921485900879  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.728074073791504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.743180274963379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7443222999572754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7443222999572754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7444748878479004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7606492042541504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([65, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7616047859191895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7616047859191895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7617287635803223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.77573823928833  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7766566276550293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7766566276550293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.776771068572998  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.790503978729248  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.791294574737549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.791294574737549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7913880348205566  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.803257465362549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8043160438537598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8043160438537598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8044285774230957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8195080757141113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8203744888305664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8203744888305664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8204660415649414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8333749771118164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8343844413757324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8343844413757324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.834479808807373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8485941886901855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8491177558898926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8491177558898926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8491692543029785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.857151508331299  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8578553199768066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8578553199768066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8579182624816895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.868114948272705  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.868683338165283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.868683338165283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8687329292297363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8771138191223145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([603, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.891578197479248  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.891578197479248  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.892728328704834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0987095832824707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 603, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0585098266601562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.059357166290283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.06020450592041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.059314727783203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37674
output nodes number: 5684
edges number: 46182
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.059638023376465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.059638500213623  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06568241119384766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 8 input nodes size: 96636
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05850028991699219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05850028991699219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10537528991699219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10541772842407227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06132078170776367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06132078170776367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06132078170776367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([96636, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06132078170776367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1661, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20072555541992188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20072555541992188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20230960845947266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21521425247192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
m.shape torch.Size([2091, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2164163589477539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2164163589477539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2186903953552246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2508554458618164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([2246, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2523202896118164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2523202896118164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2246, 128]), torch.Size([1, 2246, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25606250762939453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30318546295166016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2246, 128])
m.shape torch.Size([2160, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3063364028930664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3063364028930664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2160, 128]), torch.Size([1, 2160, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3084373474121094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3693428039550781  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2160, 128])
m.shape torch.Size([2025, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.373140811920166  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.373140811920166  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2025, 128]), torch.Size([1, 2025, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37507200241088867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44512128829956055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2025, 128])
m.shape torch.Size([1785, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4492626190185547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4492626190185547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1785, 128]), torch.Size([1, 1785, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45096492767333984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.52490234375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1785, 128])
m.shape torch.Size([1736, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5299639701843262  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5299639701843262  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1736, 128]), torch.Size([1, 1736, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5316195487976074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6143984794616699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1736, 128])
m.shape torch.Size([1633, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6198000907897949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6198000907897949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1633, 128]), torch.Size([1, 1633, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6213574409484863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7133946418762207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1633, 128])
m.shape torch.Size([1479, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7189631462097168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7189631462097168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1479, 128]), torch.Size([1, 1479, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7203736305236816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8114700317382812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1479, 128])
m.shape torch.Size([20277, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9074530601501465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9074530601501465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 20277, 128]), torch.Size([1, 20277, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.926790714263916  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.301893711090088  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 20277, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.1731576919555664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2085323333740234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2439069747924805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2082557678222656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37093, 256])
first layer input nodes number: 96636
first layer output nodes number: 37093
edges number: 283353
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.24462890625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.280003547668457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.28955078125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.28955078125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([857, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3344883918762207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3344883918762207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.336122989654541  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.350360870361328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([734, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3510594367980957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3510594367980957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 734, 256]), torch.Size([1, 734, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.35245943069458  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3734593391418457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 734, 256])
m.shape torch.Size([632, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.374617576599121  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.374617576599121  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3758230209350586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.402926445007324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.404085636138916  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.404085636138916  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4049572944641113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4363088607788086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([389, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.438228130340576  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.438228130340576  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4389700889587402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4769558906555176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([278, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.478938102722168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.478938102722168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.47946834564209  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.504643440246582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([272, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5062084197998047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5062084197998047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5067272186279297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5336132049560547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([220, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.535045623779297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.535045623779297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5354652404785156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5593833923339844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([188, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.560800075531006  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.560800075531006  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5611586570739746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5841078758239746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([154, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.585409164428711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.585409164428711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.585702896118164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.606557846069336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([123, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6077117919921875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6077117919921875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6079463958740234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6262454986572266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([104, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6273279190063477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6273279190063477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.62752628326416  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6443872451782227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([104, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.645587921142578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.645587921142578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6457862854003906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6640357971191406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.664905548095703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.664905548095703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6650428771972656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.678638458251953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([100, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.680011749267578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.680011749267578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6802024841308594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.700420379638672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([65, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7013421058654785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7013421058654785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7014660835266113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.715475559234619  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7162961959838867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7162961959838867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7163991928100586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7287588119506836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.729641914367676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.729641914367676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7297449111938477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.742825508117676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.743687152862549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.743687152862549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7437825202941895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.756561756134033  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7574563026428223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7574563026428223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.75754976272583  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7707276344299316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.771697998046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.771697998046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.771791458129883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.785623550415039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7862114906311035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7862114906311035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.786268711090088  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.795137882232666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7959275245666504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7959275245666504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7959980964660645  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8074307441711426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8082032203674316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8082032203674316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.80826997756958  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.819551944732666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([576, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8333587646484375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8333587646484375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8344573974609375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.028719902038574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 576, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9899234771728516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9907703399658203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.991617202758789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9907279014587402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5683, 40])
input nodes number: 37093
output nodes number: 5683
edges number: 45659
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.99104642868042  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.991046905517578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06572628021240234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 9 input nodes size: 97150
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.058868408203125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.058868408203125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1051931381225586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10523557662963867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.058318138122558594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.060840606689453125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.060840606689453125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.060840606689453125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97150, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.060840606689453125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1674, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20476865768432617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20476865768432617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1674, 128]), torch.Size([1, 1674, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20636510848999023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2192673683166504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1674, 128])
m.shape torch.Size([2090, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22046232223510742  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22046232223510742  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2090, 128]), torch.Size([1, 2090, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2234025001525879  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25536584854125977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2090, 128])
m.shape torch.Size([2109, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25735902786254883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25735902786254883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2109, 128]), torch.Size([1, 2109, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2593703269958496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3056340217590332  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2109, 128])
m.shape torch.Size([2174, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3087749481201172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3087749481201172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2174, 128]), torch.Size([1, 2174, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3114738464355469  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37279415130615234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2174, 128])
m.shape torch.Size([2043, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37662839889526367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37662839889526367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2043, 128]), torch.Size([1, 2043, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37857675552368164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44886064529418945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2043, 128])
m.shape torch.Size([1870, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45323657989501953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45323657989501953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1870, 128]), torch.Size([1, 1870, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4550199508666992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5317049026489258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1870, 128])
m.shape torch.Size([1745, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5366377830505371  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5366377830505371  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1745, 128]), torch.Size([1, 1745, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.538301944732666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6218018531799316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1745, 128])
m.shape torch.Size([1615, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6271305084228516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6271305084228516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1615, 128]), torch.Size([1, 1615, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6286706924438477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7171788215637207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1615, 128])
m.shape torch.Size([1540, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.723017692565918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.723017692565918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1540, 128]), torch.Size([1, 1540, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7244863510131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8192243576049805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1540, 128])
m.shape torch.Size([21020, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9187211990356445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9187211990356445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21020, 128]), torch.Size([1, 21020, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9387674331665039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.389744758605957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21020, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2580699920654297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2941951751708984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.330320358276367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.293912887573242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37880, 256])
first layer input nodes number: 97150
first layer output nodes number: 37880
edges number: 291507
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3310461044311523  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.367171287536621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3766794204711914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3766794204711914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([857, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.423001766204834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.423001766204834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4246363639831543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4382338523864746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([727, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4388961791992188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4388961791992188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4402828216552734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4614601135253906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([556, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.462477207183838  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.462477207183838  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4635376930236816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4884538650512695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([481, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4898457527160645  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4898457527160645  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4907631874084473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.518096446990967  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([381, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5194687843322754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5194687843322754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.520195484161377  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5486655235290527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([301, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5500383377075195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5500383377075195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.550612449645996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.576300621032715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([249, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5776891708374023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5776891708374023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5781641006469727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6019105911254883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([218, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6033496856689453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6033496856689453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6037654876708984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6274662017822266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([186, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6288676261901855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6288676261901855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6292223930358887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6519274711608887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([148, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.653351306915283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.653351306915283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6536335945129395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.673676013946533  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([125, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.674856662750244  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.674856662750244  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6750950813293457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6936917304992676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([127, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.695037364959717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.695037364959717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.695279598236084  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.715869426727295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.717010498046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.717010498046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.717203140258789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.734926223754883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7359471321105957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7359471321105957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.736105442047119  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7517781257629395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.752725601196289  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.752725601196289  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.752859115600586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7670116424560547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([90, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.76832914352417  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.76832914352417  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.768500804901123  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.787898540496826  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7887606620788574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7887606620788574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7888712882995605  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8021464347839355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8030600547790527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8030600547790527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8031668663024902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8167319297790527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8177356719970703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8177356719970703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8178443908691406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8324127197265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8333849906921387  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8333849906921387  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8334860801696777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8477396965026855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8485169410705566  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8485169410705566  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.848595142364502  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860168933868408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860891342163086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860891342163086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860960006713867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.871603012084961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.872298240661621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.872298240661621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.872361183166504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8825578689575195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8832879066467285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8832879066467285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8833508491516113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8939881324768066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([617, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.908782482147217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.908782482147217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 617, 256]), torch.Size([1, 617, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.909959316253662  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.120389461517334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 617, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0801796913146973  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.081027030944824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.081874370574951  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.080984592437744  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37880
output nodes number: 5684
edges number: 46885
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0813097953796387  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.081310272216797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06588554382324219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 10 input nodes size: 97741
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0583186149597168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0583186149597168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1051936149597168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06140565872192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06140565872192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06140565872192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97741, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06140565872192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1589, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20718097686767578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20718097686767578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1589, 128]), torch.Size([1, 1589, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2086963653564453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22132110595703125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1589, 128])
m.shape torch.Size([2047, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22251558303833008  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22251558303833008  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2047, 128]), torch.Size([1, 2047, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22446775436401367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.253756046295166  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2047, 128])
m.shape torch.Size([2182, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25669002532958984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25669002532958984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2182, 128]), torch.Size([1, 2182, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.259521484375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3058490753173828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2182, 128])
m.shape torch.Size([2144, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3088979721069336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3088979721069336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2144, 128]), torch.Size([1, 2144, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3112525939941406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3717498779296875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2144, 128])
m.shape torch.Size([2053, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3751492500305176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3751492500305176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2053, 128]), torch.Size([1, 2053, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3776235580444336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4514274597167969  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2053, 128])
m.shape torch.Size([1827, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4556756019592285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4556756019592285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1827, 128]), torch.Size([1, 1827, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45741796493530273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5352120399475098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1827, 128])
m.shape torch.Size([1733, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5401253700256348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5401253700256348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1733, 128]), torch.Size([1, 1733, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5417780876159668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.62493896484375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1733, 128])
m.shape torch.Size([1683, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6305327415466309  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6305327415466309  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1683, 128]), torch.Size([1, 1683, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6321377754211426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7245173454284668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1683, 128])
m.shape torch.Size([1490, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7304058074951172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7304058074951172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1490, 128]), torch.Size([1, 1490, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7318267822265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.823420524597168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1490, 128])
m.shape torch.Size([21258, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9242725372314453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9242725372314453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21258, 128]), torch.Size([1, 21258, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9445457458496094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.398019790649414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21258, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2640609741210938  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3003063201904297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3365516662597656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.300023078918457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([38006, 256])
first layer input nodes number: 97741
first layer output nodes number: 38006
edges number: 293617
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.337282180786133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3735275268554688  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3829221725463867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3829221725463867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([812, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.429206371307373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.429206371307373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 812, 256]), torch.Size([1, 812, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.430755138397217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.443145275115967  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 812, 256])
m.shape torch.Size([715, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4437904357910156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4437904357910156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 715, 256]), torch.Size([1, 715, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4451541900634766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4656105041503906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 715, 256])
m.shape torch.Size([591, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4670495986938477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4670495986938477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.46817684173584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4945616722106934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([456, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4962358474731445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4962358474731445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.497105598449707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5237226486206055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([404, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5252294540405273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5252294540405273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5260000228881836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5550880432128906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([319, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.55654239654541  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.55654239654541  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5571508407592773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.584458351135254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([265, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.585937023162842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.585937023162842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.586442470550537  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.612985134124756  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([200, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.615062713623047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.615062713623047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6154441833496094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.637187957763672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([192, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.638658046722412  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.638658046722412  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.639024257659912  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.662461757659912  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([169, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.66390323638916  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.66390323638916  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6642255783081055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6871118545532227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([136, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6883888244628906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6883888244628906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.688648223876953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.708881378173828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([110, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7100205421447754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7100205421447754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7102303504943848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7280640602111816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([111, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.72934627532959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.72934627532959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.729557991027832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7490358352661133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7510128021240234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7510128021240234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.751178741455078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.767606735229492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.768677234649658  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.768677234649658  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.768829822540283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.785004138946533  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7860045433044434  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7860045433044434  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7861380577087402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.801225185394287  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.802335262298584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.802335262298584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8024725914001465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8189520835876465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([67, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.820042610168457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.820042610168457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8201704025268555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.836400032043457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8371033668518066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8371033668518066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8371834754943848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8479180335998535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8487048149108887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8487048149108887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8487868309020996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860351085662842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8610167503356934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8610167503356934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.861083507537842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8709635734558105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.871734142303467  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.871734142303467  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8718066215515137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8830409049987793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8836679458618164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8836679458618164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.883725166320801  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8929948806762695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.893704414367676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.893704414367676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.893765449523926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.904080390930176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([608, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.918659210205078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.918659210205078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.919818878173828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.126223564147949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 608, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0860161781311035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0868635177612305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0877108573913574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0868210792541504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 38006
output nodes number: 5684
edges number: 46760
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.087146759033203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0871472358703613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06671380996704102  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 11 input nodes size: 98133
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10566234588623047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10570478439331055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05878734588623047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06131267547607422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06131267547607422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06131267547607422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([98133, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06131267547607422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1653, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20523643493652344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20523643493652344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1653, 128]), torch.Size([1, 1653, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20681285858154297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2196493148803711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1653, 128])
m.shape torch.Size([2124, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2208867073059082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2208867073059082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2124, 128]), torch.Size([1, 2124, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22382164001464844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2558250427246094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2124, 128])
m.shape torch.Size([2200, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25785064697265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25785064697265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2200, 128]), torch.Size([1, 2200, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25994873046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3068256378173828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2200, 128])
m.shape torch.Size([2105, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30979156494140625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30979156494140625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2105, 128]), torch.Size([1, 2105, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3120689392089844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37195634841918945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2105, 128])
m.shape torch.Size([2130, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3753533363342285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3753533363342285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2130, 128]), torch.Size([1, 2130, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3780503273010254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45406532287597656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2130, 128])
m.shape torch.Size([1847, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45833396911621094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45833396911621094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1847, 128]), torch.Size([1, 1847, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4600954055786133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5366172790527344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1847, 128])
m.shape torch.Size([1698, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5414042472839355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5414042472839355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1698, 128]), torch.Size([1, 1698, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5430235862731934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6246285438537598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1698, 128])
m.shape torch.Size([1627, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6300253868103027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6300253868103027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1627, 128]), torch.Size([1, 1627, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6315770149230957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7235312461853027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1627, 128])
m.shape torch.Size([1486, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7291326522827148  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7291326522827148  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1486, 128]), torch.Size([1, 1486, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7305498123168945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8212480545043945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1486, 128])
m.shape torch.Size([21120, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9221019744873047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9221019744873047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21120, 128]), torch.Size([1, 21120, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9422435760498047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3942699432373047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21120, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.26175594329834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2979860305786133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3342161178588867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2977027893066406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37990, 256])
first layer input nodes number: 98133
first layer output nodes number: 37990
edges number: 292129
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.334949493408203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3711795806884766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3806400299072266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3806400299072266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([841, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4269490242004395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4269490242004395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4285531044006348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.441969394683838  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 841, 256])
m.shape torch.Size([726, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.442594528198242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.442594528198242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 726, 256]), torch.Size([1, 726, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.443979263305664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.464750289916992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 726, 256])
m.shape torch.Size([576, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4659876823425293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4659876823425293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4670863151550293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.493201732635498  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([436, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4943289756774902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4943289756774902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4951605796813965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5193533897399902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([421, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.520960807800293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.520960807800293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.521763801574707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5506715774536133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([274, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5518503189086914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5518503189086914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.552372932434082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.576535224914551  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([230, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.577821731567383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.577821731567383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5782604217529297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6001949310302734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([222, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.601682662963867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.601682662963867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6021060943603516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.626241683959961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([206, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.62809419631958  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.62809419631958  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6284871101379395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6536335945129395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6550326347351074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6550326347351074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6553492546081543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6778292655944824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([148, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6792359352111816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6792359352111816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.679518222808838  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7015366554260254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.702871799468994  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.702871799468994  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.703115940093994  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.723867893218994  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7249956130981445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7249956130981445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.725186347961426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.742733955383301  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.743809700012207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.743809700012207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7439756393432617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.760403633117676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7616615295410156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7616615295410156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.761838912963867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.780641555786133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7815370559692383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7815370559692383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7816591262817383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7954530715942383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7965288162231445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7965288162231445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.79665470123291  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.811760902404785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([73, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8129611015319824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8129611015319824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8131003379821777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8307833671569824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([55, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.831725597381592  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.831725597381592  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8318305015563965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8458876609802246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8467774391174316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8467774391174316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8468708992004395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860048770904541  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860809803009033  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.860809803009033  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8608860969543457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8721776008605957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.87294340133667  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.87294340133667  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.873015880584717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8842501640319824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.884700298309326  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.884700298309326  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.884742259979248  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.891540050506592  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.892303466796875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.892303466796875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8923683166503906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9033279418945312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([589, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9174485206604004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9174485206604004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.918571949005127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.120081901550293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 589, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.07989501953125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.080742359161377  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.081589698791504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.080699920654297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37990
output nodes number: 5684
edges number: 46699
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0810256004333496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.081026077270508  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0660696029663086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 12 input nodes size: 97809
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05878734588623047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05878734588623047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10566234588623047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10570478439331055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06141233444213867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06141233444213867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06141233444213867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97809, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06141233444213867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1621, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2072010040283203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2072010040283203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1621, 128]), torch.Size([1, 1621, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20874691009521484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22149372100830078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1621, 128])
m.shape torch.Size([2065, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22269010543823242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22269010543823242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2065, 128]), torch.Size([1, 2065, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22465944290161133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25583648681640625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2065, 128])
m.shape torch.Size([2132, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.257901668548584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.257901668548584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2132, 128]), torch.Size([1, 2132, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2606625556945801  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30728912353515625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2132, 128])
m.shape torch.Size([2075, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3102302551269531  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3102302551269531  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2075, 128]), torch.Size([1, 2075, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.31223630905151367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3715848922729492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2075, 128])
m.shape torch.Size([1993, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3753471374511719  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3753471374511719  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1993, 128]), torch.Size([1, 1993, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37724781036376953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4466257095336914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1993, 128])
m.shape torch.Size([1841, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4509425163269043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4509425163269043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1841, 128]), torch.Size([1, 1841, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4526982307434082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5281939506530762  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1841, 128])
m.shape torch.Size([1736, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5331106185913086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5331106185913086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1736, 128]), torch.Size([1, 1736, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5347661972045898  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.618037223815918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1736, 128])
m.shape torch.Size([1589, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6232709884643555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6232709884643555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1589, 128]), torch.Size([1, 1589, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.624786376953125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7112984657287598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1589, 128])
m.shape torch.Size([1484, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7169094085693359  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7169094085693359  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1484, 128]), torch.Size([1, 1484, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7183246612548828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8094453811645508  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1484, 128])
m.shape torch.Size([21395, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9107570648193359  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9107570648193359  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21395, 128]), torch.Size([1, 21395, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9319987297058105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3869099617004395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21395, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.252918243408203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2890920639038086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.325265884399414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.288809299468994  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37931, 256])
first layer input nodes number: 97809
first layer output nodes number: 37931
edges number: 293628
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3259968757629395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.362170696258545  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.371500015258789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.371500015258789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([842, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4183311462402344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4183311462402344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 842, 256]), torch.Size([1, 842, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4199371337890625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4333763122558594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 842, 256])
m.shape torch.Size([743, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4340248107910156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4340248107910156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 743, 256]), torch.Size([1, 743, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4354419708251953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.457770824432373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 743, 256])
m.shape torch.Size([535, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.458627223968506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.458627223968506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4596476554870605  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4840359687805176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([425, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4855079650878906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4855079650878906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.486318588256836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.50982666015625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([361, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5111565589904785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5111565589904785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.511845111846924  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.537322998046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([329, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5388760566711426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5388760566711426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.539503574371338  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.568233013153076  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([256, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.569641590118408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.569641590118408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.570129871368408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.594543933868408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([213, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.595937728881836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.595937728881836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.596343994140625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6195011138916016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([185, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.620898723602295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.620898723602295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6212515830993652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6438345909118652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([155, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.645148277282715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.645148277282715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.645443916320801  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6664342880249023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([144, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.667809009552002  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.667809009552002  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.668083667755127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.689507007598877  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([123, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.690788745880127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.690788745880127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.691023349761963  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7109646797180176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.712202548980713  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.712202548980713  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7123913764953613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7297635078430176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7314000129699707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7314000129699707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.731600284576416  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.751427173614502  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([90, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.752624988555908  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.752624988555908  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7527966499328613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7709927558898926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([69, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.771981716156006  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.771981716156006  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.77211332321167  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.786984920501709  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.788151741027832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.788151741027832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.78829288482666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.805230140686035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.806234359741211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.806234359741211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8063488006591797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.820882797241211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.821775436401367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.821775436401367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8218746185302734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.835165023803711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8360958099365234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8360958099365234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.836193084716797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8499088287353516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.851034641265869  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.851034641265869  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.851137638092041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8663811683654785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.867175579071045  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.867175579071045  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8672518730163574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.879077434539795  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8796586990356445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8796586990356445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8797121047973633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.888363838195801  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8890061378479004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8890061378479004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.889061450958252  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.898409366607666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([622, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.913327217102051  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.913327217102051  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 622, 256]), torch.Size([1, 622, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.91451358795166  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.1257576942443848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 622, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0850257873535156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0858731269836426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0867204666137695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0858306884765625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37931
output nodes number: 5684
edges number: 47644
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.086155891418457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0861563682556152  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06673336029052734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 13 input nodes size: 97932
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10556650161743164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10560894012451172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05869150161743164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06122446060180664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06122446060180664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06122446060180664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97932, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06122446060180664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1542, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20698261260986328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20698261260986328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1542, 128]), torch.Size([1, 1542, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20845317840576172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22089290618896484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1542, 128])
m.shape torch.Size([2106, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2221660614013672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2221660614013672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2106, 128]), torch.Size([1, 2106, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22417449951171875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25571727752685547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2106, 128])
m.shape torch.Size([2101, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.257718563079834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.257718563079834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2101, 128]), torch.Size([1, 2101, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25972461700439453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3058652877807617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2101, 128])
m.shape torch.Size([2102, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30887269973754883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30887269973754883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2102, 128]), torch.Size([1, 2102, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.31157541275024414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37179136276245117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2102, 128])
m.shape torch.Size([2076, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37573862075805664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37573862075805664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2076, 128]), torch.Size([1, 2076, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3777427673339844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4527435302734375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2076, 128])
m.shape torch.Size([1870, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4571037292480469  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4571037292480469  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1870, 128]), torch.Size([1, 1870, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45888710021972656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5374755859375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1870, 128])
m.shape torch.Size([1745, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5424084663391113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5424084663391113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1745, 128]), torch.Size([1, 1745, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5440726280212402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6272807121276855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1745, 128])
m.shape torch.Size([1683, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.632868766784668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.632868766784668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1683, 128]), torch.Size([1, 1683, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6344738006591797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.727078914642334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1683, 128])
m.shape torch.Size([1443, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7324690818786621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7324690818786621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1443, 128]), torch.Size([1, 1443, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7338452339172363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.823387622833252  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1443, 128])
m.shape torch.Size([21263, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9242620468139648  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9242620468139648  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21263, 128]), torch.Size([1, 21263, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9445400238037109  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.398066520690918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21263, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.263943672180176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3001174926757812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3362913131713867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.299834728240967  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37931, 256])
first layer input nodes number: 97932
first layer output nodes number: 37931
edges number: 293361
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3370232582092285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.373197078704834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.382589340209961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.382589340209961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([813, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4288697242736816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4288697242736816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 813, 256]), torch.Size([1, 813, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.430420398712158  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4428257942199707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 813, 256])
m.shape torch.Size([753, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4435062408447266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4435062408447266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4449424743652344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4680356979370117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 753, 256])
m.shape torch.Size([542, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.469027519226074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.469027519226074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4700613021850586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.494525909423828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([489, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4958953857421875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4958953857421875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.496828079223633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5240068435668945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([417, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5255446434020996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5255446434020996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5263400077819824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5549731254577637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([312, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.556375026702881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.556375026702881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5569701194763184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5834574699401855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([261, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.584916114807129  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.584916114807129  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.585413932800293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6110916137695312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([218, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6125192642211914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6125192642211914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6129350662231445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6366357803344727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([159, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.637803554534912  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.637803554534912  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6381068229675293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6575160026550293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([152, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.658825397491455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.658825397491455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6591153144836426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.679699420928955  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([146, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.681098461151123  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.681098461151123  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6813769340515137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7030978202819824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([113, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7043609619140625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7043609619140625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7045764923095703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7228965759277344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([115, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7242259979248047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7242259979248047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.724445343017578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7446250915527344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([99, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.745847702026367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.745847702026367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7460365295410156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.764730453491211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([67, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7656021118164062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7656021118164062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7657299041748047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.779275894165039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([77, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7803964614868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7803964614868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.780543327331543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7971391677856445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.798029899597168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.798029899597168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.798142433166504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8116464614868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([51, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8124728202819824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8124728202819824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.812570095062256  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8249239921569824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8258252143859863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8258252143859863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8259243965148926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.83921480178833  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.840087890625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.840087890625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.840179443359375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.85308837890625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.853829860687256  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.853829860687256  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8539042472839355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8649134635925293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.865447521209717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.865447521209717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8654990196228027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.873481273651123  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8742074966430664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8742074966430664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.874272346496582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8847780227661133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.885368824005127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.885368824005127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.885420322418213  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8941235542297363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([614, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.908851146697998  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.908851146697998  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 614, 256]), torch.Size([1, 614, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.910022258758545  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.118650436401367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 614, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0784401893615723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.079287528991699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.080134868621826  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.079245090484619  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37931
output nodes number: 5684
edges number: 46522
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0795702934265137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.079570770263672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06653690338134766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 14 input nodes size: 97290
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05869150161743164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05869150161743164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10556650161743164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10560894012451172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06138944625854492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06138944625854492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06138944625854492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97290, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06138944625854492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1580, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20526885986328125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20526885986328125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1580, 128]), torch.Size([1, 1580, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20677566528320312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21931934356689453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1580, 128])
m.shape torch.Size([2101, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22056961059570312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22056961059570312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2101, 128]), torch.Size([1, 2101, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22351503372192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2556576728820801  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2101, 128])
m.shape torch.Size([2177, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2576613426208496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2576613426208496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2177, 128]), torch.Size([1, 2177, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.259737491607666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30649375915527344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2177, 128])
m.shape torch.Size([2175, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3096041679382324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3096041679382324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2175, 128]), torch.Size([1, 2175, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3119802474975586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37305688858032227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2175, 128])
m.shape torch.Size([2025, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3765373229980469  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3765373229980469  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2025, 128]), torch.Size([1, 2025, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37846851348876953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44864940643310547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2025, 128])
m.shape torch.Size([1853, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4529852867126465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4529852867126465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1853, 128]), torch.Size([1, 1853, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45475244522094727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5307402610778809  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1853, 128])
m.shape torch.Size([1711, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5355677604675293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5355677604675293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1711, 128]), torch.Size([1, 1711, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5371994972229004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6194858551025391  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1711, 128])
m.shape torch.Size([1616, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6248345375061035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6248345375061035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1616, 128]), torch.Size([1, 1616, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.626375675201416  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7154717445373535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1616, 128])
m.shape torch.Size([1529, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7212629318237305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7212629318237305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1529, 128]), torch.Size([1, 1529, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7227210998535156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8160438537597656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1529, 128])
m.shape torch.Size([21056, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.915717601776123  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.915717601776123  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21056, 128]), torch.Size([1, 21056, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.935798168182373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.387153148651123  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21056, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.255448818206787  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2915196418762207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3275904655456543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2912378311157227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37823, 256])
first layer input nodes number: 97290
first layer output nodes number: 37823
edges number: 291482
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.328317642211914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3643884658813477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3738794326782227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3738794326782227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([802, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4201512336730957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4201512336730957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 802, 256]), torch.Size([1, 802, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4216809272766113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4342808723449707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 802, 256])
m.shape torch.Size([731, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4350147247314453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4350147247314453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 731, 256]), torch.Size([1, 731, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4364089965820312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.457632064819336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 731, 256])
m.shape torch.Size([580, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.458807945251465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.458807945251465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.459914207458496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4860634803771973  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([466, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.487414836883545  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.487414836883545  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4883036613464355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.515449047088623  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([389, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.517399787902832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.517399787902832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.518141746520996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.54603910446167  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([322, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.547525405883789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.547525405883789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5481395721435547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.575636386871338  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([254, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5774636268615723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5774636268615723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5779480934143066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6021714210510254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([218, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6036057472229004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6036057472229004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6040215492248535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6277222633361816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([192, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6291751861572266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6291751861572266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6295413970947266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6529788970947266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([173, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.654458999633789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.654458999633789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6547889709472656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6782169342041016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([146, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.679595947265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.679595947265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6798744201660156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7015953063964844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([131, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7029671669006348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7029671669006348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.703217029571533  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7244553565979004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([99, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.725839614868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.725839614868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7260284423828125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7434005737304688  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([82, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7444305419921875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7444305419921875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.744586944580078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.76007080078125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([75, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7611169815063477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7611169815063477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7612600326538086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.776423454284668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([56, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7772130966186523  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7772130966186523  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.77731990814209  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7893896102905273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7902841567993164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7902841567993164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7903947830200195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8036699295043945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.80474853515625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.80474853515625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.80487060546875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.82037353515625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.821481227874756  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.821481227874756  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8215975761413574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.837188243865967  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8380722999572754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8380722999572754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.838165760040283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8513436317443848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8523006439208984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8523006439208984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8523941040039062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8662261962890625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.866814136505127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.866814136505127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8668713569641113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8757405281066895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8764195442199707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8764195442199707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8764805793762207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8863682746887207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8872838020324707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8872838020324707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.887362003326416  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.900578022003174  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([584, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.914571762084961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.914571762084961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9156856536865234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.1181416511535645  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 584, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0779590606689453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0788064002990723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.079653739929199  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.078763961791992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37823
output nodes number: 5684
edges number: 46645
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0790882110595703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0790886878967285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06644248962402344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 15 input nodes size: 97287
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10525894165039062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1053013801574707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.058383941650390625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06088066101074219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06088066101074219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06088066101074219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97287, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06088066101074219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1569, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20365667343139648  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20365667343139648  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1569, 128]), torch.Size([1, 1569, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2051529884338379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21771478652954102  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1569, 128])
m.shape torch.Size([2046, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2189178466796875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2189178466796875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2046, 128]), torch.Size([1, 2046, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2208690643310547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2501487731933594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2046, 128])
m.shape torch.Size([2277, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25243043899536133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25243043899536133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2277, 128]), torch.Size([1, 2277, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2554788589477539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30669689178466797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2277, 128])
m.shape torch.Size([2057, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30953454971313477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30953454971313477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2057, 128]), torch.Size([1, 2057, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3116011619567871  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37046051025390625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2057, 128])
m.shape torch.Size([2011, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37427425384521484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37427425384521484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2011, 128]), torch.Size([1, 2011, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3761920928955078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.446014404296875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2011, 128])
m.shape torch.Size([1891, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45046567916870117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45046567916870117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1891, 128]), torch.Size([1, 1891, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4522690773010254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5334086418151855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1891, 128])
m.shape torch.Size([1749, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5383448600769043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5383448600769043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1749, 128]), torch.Size([1, 1749, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5400128364562988  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6234116554260254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1749, 128])
m.shape torch.Size([1572, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6285743713378906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6285743713378906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1572, 128]), torch.Size([1, 1572, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6300735473632812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7157621383666992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1572, 128])
m.shape torch.Size([1464, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7212953567504883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7212953567504883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1464, 128]), torch.Size([1, 1464, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.722691535949707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8122835159301758  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1464, 128])
m.shape torch.Size([20834, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9109296798706055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9109296798706055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 20834, 128]), torch.Size([1, 20834, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9307985305786133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.341486930847168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 20834, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2103075981140137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.246041774749756  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.281775951385498  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.245762348175049  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37470, 256])
first layer input nodes number: 97287
first layer output nodes number: 37470
edges number: 288456
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.282503128051758  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3182373046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.327425003051758  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.327425003051758  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([823, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3737144470214844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3737144470214844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 823, 256]), torch.Size([1, 823, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.375284194946289  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3891000747680664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 823, 256])
m.shape torch.Size([721, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3898673057556152  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3898673057556152  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 721, 256]), torch.Size([1, 721, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.391242504119873  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4128870964050293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 721, 256])
m.shape torch.Size([629, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.41416072845459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.41416072845459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 629, 256]), torch.Size([1, 629, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.415360450744629  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4418277740478516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 629, 256])
m.shape torch.Size([436, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4429054260253906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4429054260253906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.443737030029297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4702959060668945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([376, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4716873168945312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4716873168945312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4724044799804688  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4992122650146484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([317, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5006818771362305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5006818771362305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.501286506652832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5285215377807617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([276, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.530076503753662  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.530076503753662  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5306029319763184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5606741905212402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([201, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5619568824768066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5619568824768066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.562340259552002  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5841927528381348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([166, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.585437297821045  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.585437297821045  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.585753917694092  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.606017589569092  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([166, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.607454776763916  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.607454776763916  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.607771396636963  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.630251407623291  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([150, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.631679058074951  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.631679058074951  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.631965160369873  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6542811393737793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([119, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6555252075195312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6555252075195312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.655752182006836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6750450134277344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([104, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6762313842773438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6762313842773438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6764297485351562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6946792602539062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.695845127105713  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.695845127105713  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6960244178771973  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7137742042541504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7148380279541016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7148380279541016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7149906158447266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7311649322509766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7321653366088867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7321653366088867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7322988510131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7473859786987305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7484307289123535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7484307289123535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7485604286193848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7641243934631348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7650585174560547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7650585174560547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.765167236328125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7789745330810547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.77972412109375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.77972412109375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7798080444335938  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7910537719726562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7919540405273438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7919540405273438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7920475006103516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.805225372314453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8062286376953125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8062286376953125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8063278198242188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8210067749023438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.82157039642334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.82157039642334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8216257095336914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8301992416381836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8309454917907715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8309454917907715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.83101224899292  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.841826915740967  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8423471450805664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8423471450805664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.842392921447754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8501291275024414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([598, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8644752502441406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8644752502441406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8656158447265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0731515884399414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 598, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.032957077026367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.033804416656494  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.034651756286621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.033761978149414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37470
output nodes number: 5684
edges number: 46497
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.034083843231201  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0340843200683594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06628084182739258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06628084182739258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes
[05:22:31] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 16 parts and get 0 edge cuts

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06628084182739258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02595345675945282 |0.0028146952390670776 |0.12267084419727325 |9.173154830932617e-05 |0.0744687020778656 |0.00481867790222168 |
----------------------------------------------------------pseudo_mini_loss sum 4.118006229400635
Total (block generation + training)time/epoch 20.4248309135437
Training time/epoch 3.693850517272949
Training time without block to device /epoch 3.648815393447876
Training time without total dataloading part /epoch 3.1605191230773926
load block tensor time/epoch 0.4152553081512451
block to device time/epoch 0.04503512382507324
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2164074
Number of first layer input nodes during this epoch:  1559855
Number of first layer output nodes during this epoch:  604219
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06628036499023438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018513917922973633
global_2_local spend time (sec) 0.04793286323547363
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0043675899505615234
A = g.adjacency_matrix() spent  0.01327967643737793
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08719801902770996
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3236594200134277
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.187162160873413

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.002 seconds
Metis partitioning: 0.063 seconds
Split the graph: 0.020 seconds
Construct subgraphs: 0.005 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.09125614166259766
5682
5684
5684
5684
5684
5684
5684
5684
5683
5684
5684
5684
5684
5684
5684
5684
total k batches seeds list generation spend  10.360830307006836
after graph partition
graph partition algorithm spend time 10.520379781723022
5682
5684
5684
5684
5684
5684
5684
5684
5683
5684
5684
5684
5684
5684
5684
5684
partition_len_list
[37330, 36832, 38228, 37627, 38036, 37468, 38032, 38172, 37702, 38001, 37344, 38127, 38071, 37757, 37798, 37799]
shared_neighbor_graph_partition_s0 selection method  spend 10.626415729522705
time for parepare:  0.017385005950927734
local_output_nid generation:  0.0012068748474121094
local_in_edges_tensor generation:  0.0013170242309570312
mini_batch_src_global generation:  0.0019643306732177734
r_  generation:  0.017232656478881836
local_output_nid generation:  0.0014538764953613281
local_in_edges_tensor generation:  0.001306295394897461
mini_batch_src_global generation:  0.0017504692077636719
r_  generation:  0.01792621612548828
local_output_nid generation:  0.002166271209716797
local_in_edges_tensor generation:  0.0012521743774414062
mini_batch_src_global generation:  0.0012483596801757812
r_  generation:  0.016074657440185547
local_output_nid generation:  0.0017173290252685547
local_in_edges_tensor generation:  0.0012595653533935547
mini_batch_src_global generation:  0.0012733936309814453
r_  generation:  0.015766382217407227
local_output_nid generation:  0.0017247200012207031
local_in_edges_tensor generation:  0.0012259483337402344
mini_batch_src_global generation:  0.0012581348419189453
r_  generation:  0.016180753707885742
local_output_nid generation:  0.0017647743225097656
local_in_edges_tensor generation:  0.0013637542724609375
mini_batch_src_global generation:  0.0013287067413330078
r_  generation:  0.016386747360229492
local_output_nid generation:  0.0017533302307128906
local_in_edges_tensor generation:  0.001730203628540039
mini_batch_src_global generation:  0.0014069080352783203
r_  generation:  0.016788482666015625
local_output_nid generation:  0.0017862319946289062
local_in_edges_tensor generation:  0.0012836456298828125
mini_batch_src_global generation:  0.0013685226440429688
r_  generation:  0.016594886779785156
local_output_nid generation:  0.0017659664154052734
local_in_edges_tensor generation:  0.0012297630310058594
mini_batch_src_global generation:  0.0013093948364257812
r_  generation:  0.01661992073059082
local_output_nid generation:  0.0018091201782226562
local_in_edges_tensor generation:  0.0012257099151611328
mini_batch_src_global generation:  0.0013539791107177734
r_  generation:  0.018283367156982422
local_output_nid generation:  0.0017766952514648438
local_in_edges_tensor generation:  0.001216888427734375
mini_batch_src_global generation:  0.0016326904296875
r_  generation:  0.01865983009338379
local_output_nid generation:  0.0017309188842773438
local_in_edges_tensor generation:  0.001209259033203125
mini_batch_src_global generation:  0.0016825199127197266
r_  generation:  0.019106149673461914
local_output_nid generation:  0.001783132553100586
local_in_edges_tensor generation:  0.001209259033203125
mini_batch_src_global generation:  0.0016989707946777344
r_  generation:  0.018352270126342773
local_output_nid generation:  0.0017948150634765625
local_in_edges_tensor generation:  0.0012359619140625
mini_batch_src_global generation:  0.0016622543334960938
r_  generation:  0.018813133239746094
local_output_nid generation:  0.0017812252044677734
local_in_edges_tensor generation:  0.0012273788452148438
mini_batch_src_global generation:  0.0016946792602539062
r_  generation:  0.016590356826782227
local_output_nid generation:  0.0017566680908203125
local_in_edges_tensor generation:  0.0011796951293945312
mini_batch_src_global generation:  0.0013811588287353516
r_  generation:  0.016645193099975586
----------------------check_connections_block total spend ----------------------------- 0.4474778175354004
generate_one_block  0.034224510192871094
generate_one_block  0.025580644607543945
generate_one_block  0.02625560760498047
generate_one_block  0.025916337966918945
generate_one_block  0.026124954223632812
generate_one_block  0.026243209838867188
generate_one_block  0.026073932647705078
generate_one_block  0.028592824935913086
generate_one_block  0.027822017669677734
generate_one_block  0.026354551315307617
generate_one_block  0.028337955474853516
generate_one_block  0.035498619079589844
generate_one_block  0.03780817985534668
generate_one_block  0.03293156623840332
generate_one_block  0.02588653564453125
generate_one_block  0.025638341903686523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028903484344482422
gen group dst list time:  0.018453359603881836
time for parepare:  0.022054672241210938
local_output_nid generation:  0.008905887603759766
local_in_edges_tensor generation:  0.028189659118652344
mini_batch_src_global generation:  0.009509086608886719
r_  generation:  0.13001465797424316
local_output_nid generation:  0.014003515243530273
local_in_edges_tensor generation:  0.014148235321044922
mini_batch_src_global generation:  0.012676000595092773
r_  generation:  0.11700010299682617
local_output_nid generation:  0.017911911010742188
local_in_edges_tensor generation:  0.011996269226074219
mini_batch_src_global generation:  0.012223482131958008
r_  generation:  0.12057304382324219
local_output_nid generation:  0.014473676681518555
local_in_edges_tensor generation:  0.010905265808105469
mini_batch_src_global generation:  0.013666391372680664
r_  generation:  0.11946916580200195
local_output_nid generation:  0.01464390754699707
local_in_edges_tensor generation:  0.011153221130371094
mini_batch_src_global generation:  0.014067411422729492
r_  generation:  0.12470245361328125
local_output_nid generation:  0.014325141906738281
local_in_edges_tensor generation:  0.010006904602050781
mini_batch_src_global generation:  0.01474452018737793
r_  generation:  0.12246251106262207
local_output_nid generation:  0.014531373977661133
local_in_edges_tensor generation:  0.009906530380249023
mini_batch_src_global generation:  0.015110969543457031
r_  generation:  0.12640380859375
local_output_nid generation:  0.014474153518676758
local_in_edges_tensor generation:  0.010296344757080078
mini_batch_src_global generation:  0.015672683715820312
r_  generation:  0.1260993480682373
local_output_nid generation:  0.014589548110961914
local_in_edges_tensor generation:  0.010038375854492188
mini_batch_src_global generation:  0.015448808670043945
r_  generation:  0.1259779930114746
local_output_nid generation:  0.014454841613769531
local_in_edges_tensor generation:  0.00992894172668457
mini_batch_src_global generation:  0.015122413635253906
r_  generation:  0.12684369087219238
local_output_nid generation:  0.014189004898071289
local_in_edges_tensor generation:  0.01021718978881836
mini_batch_src_global generation:  0.01492619514465332
r_  generation:  0.12468862533569336
local_output_nid generation:  0.014519929885864258
local_in_edges_tensor generation:  0.009804248809814453
mini_batch_src_global generation:  0.015285253524780273
r_  generation:  0.12650060653686523
local_output_nid generation:  0.01456451416015625
local_in_edges_tensor generation:  0.00988006591796875
mini_batch_src_global generation:  0.015594005584716797
r_  generation:  0.1277608871459961
local_output_nid generation:  0.014249324798583984
local_in_edges_tensor generation:  0.01020193099975586
mini_batch_src_global generation:  0.015511512756347656
r_  generation:  0.12500381469726562
local_output_nid generation:  0.01431131362915039
local_in_edges_tensor generation:  0.05064272880554199
mini_batch_src_global generation:  0.014042377471923828
r_  generation:  0.12668991088867188
local_output_nid generation:  0.013138771057128906
local_in_edges_tensor generation:  0.009636402130126953
mini_batch_src_global generation:  0.015514850616455078
r_  generation:  0.1257638931274414
----------------------check_connections_block total spend ----------------------------- 3.194413423538208
generate_one_block  0.13750290870666504
generate_one_block  0.13503551483154297
generate_one_block  0.13959956169128418
generate_one_block  0.14647555351257324
generate_one_block  0.13947653770446777
generate_one_block  0.1408710479736328
generate_one_block  0.1408538818359375
generate_one_block  0.1459352970123291
generate_one_block  0.14057135581970215
generate_one_block  0.14115142822265625
generate_one_block  0.14058399200439453
generate_one_block  0.14577174186706543
generate_one_block  0.14306402206420898
generate_one_block  0.13803672790527344
generate_one_block  0.1400134563446045
generate_one_block  0.14184236526489258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06628036499023438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

connection checking time:  3.194413423538208
block generation total time  2.2567853927612305
average batch blocks generation time:  0.1410490870475769
block dataloader generation time/epoch 16.972131609916687
pseudo mini batch 0 input nodes size: 96729
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05838298797607422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05838298797607422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10525798797607422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1053004264831543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588679313659668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06135129928588867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06135129928588867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06135129928588867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([96729, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06135129928588867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1616, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20247220993041992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20247220993041992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1616, 128]), torch.Size([1, 1616, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20401334762573242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2166762351989746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1616, 128])
m.shape torch.Size([2091, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21789979934692383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21789979934692383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22057008743286133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2519841194152832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([2185, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25411272048950195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25411272048950195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2185, 128]), torch.Size([1, 2185, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25685787200927734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30356454849243164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2185, 128])
m.shape torch.Size([2091, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30651092529296875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30651092529296875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3085498809814453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.36791563034057617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([2035, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3710193634033203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3710193634033203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2035, 128]), torch.Size([1, 2035, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37296009063720703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44319820404052734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2035, 128])
m.shape torch.Size([1798, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4473719596862793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4473719596862793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1798, 128]), torch.Size([1, 1798, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44908666610717773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5240702629089355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1798, 128])
m.shape torch.Size([1726, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5289740562438965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5289740562438965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1726, 128]), torch.Size([1, 1726, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5306200981140137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6131119728088379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1726, 128])
m.shape torch.Size([1637, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6185336112976074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6185336112976074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1637, 128]), torch.Size([1, 1637, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6200947761535645  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7122931480407715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1637, 128])
m.shape torch.Size([1449, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7177309989929199  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7177309989929199  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1449, 128]), torch.Size([1, 1449, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7191128730773926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8092660903930664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1449, 128])
m.shape torch.Size([20702, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.907289981842041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.907289981842041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 20702, 128]), torch.Size([1, 20702, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9270329475402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3287835121154785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 20702, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.1989383697509766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.234539031982422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.270139694213867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2342605590820312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37330, 256])
first layer input nodes number: 96729
first layer output nodes number: 37330
edges number: 286919
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.270862579345703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3064632415771484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.315784454345703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.315784454345703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([830, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3620800971984863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3620800971984863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 830, 256]), torch.Size([1, 830, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3636631965637207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.376904010772705  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 830, 256])
m.shape torch.Size([728, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.377553939819336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.377553939819336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 728, 256]), torch.Size([1, 728, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3789424896240234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.400442123413086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 728, 256])
m.shape torch.Size([606, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4015097618103027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4015097618103027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.402665615081787  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.429154872894287  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 606, 256])
m.shape torch.Size([449, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.43032169342041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.43032169342041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.431178092956543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4564127922058105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([416, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4588088989257812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4588088989257812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4596023559570312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.488443374633789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([287, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.489701747894287  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.489701747894287  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4902491569519043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.520651340484619  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([265, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.522160530090332  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.522160530090332  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5226659774780273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.556715965270996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([207, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5580549240112305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5580549240112305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5584497451782227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5809545516967773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([173, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.582253932952881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.582253932952881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5825839042663574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6037020683288574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.605046272277832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.605046272277832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6053457260131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6266069412231445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.627990245819092  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.627990245819092  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6282668113708496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.649838924407959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([117, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.651050090789795  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.651050090789795  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.651273250579834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6702418327331543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([96, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.671329975128174  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.671329975128174  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.671513080596924  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.688358783721924  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.689558982849121  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.689558982849121  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.689742088317871  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.707869529724121  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([88, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7090468406677246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7090468406677246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.709214687347412  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.727006435394287  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.728168487548828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.728168487548828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.728322982788086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7457809448242188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([73, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7475461959838867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7475461959838867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.747685432434082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7643938064575195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([56, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7652931213378906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7652931213378906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.765399932861328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7789649963378906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7796239852905273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7796239852905273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.779698371887207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.789666175842285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.790417194366455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.790417194366455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7904953956604004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8015217781066895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8026132583618164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8026132583618164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.802720069885254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.818528175354004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8194055557250977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8194055557250977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8194894790649414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8324975967407227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8330307006835938  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8330307006835938  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.833080291748047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.841114044189453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8419198989868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8419198989868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8419885635375977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.853592872619629  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([570, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8672547340393066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8672547340393066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8683419227600098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0702719688415527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 570, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0301008224487305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.030947685241699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.031794548034668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.030905246734619  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5682, 40])
input nodes number: 37330
output nodes number: 5682
edges number: 46213
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0312256813049316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.031226634979248  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06580066680908203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 1 input nodes size: 96403
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.058868408203125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.058868408203125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10483694076538086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10487937927246094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05796194076538086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06040143966674805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06040143966674805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06040143966674805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([96403, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06040143966674805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1640, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1991267204284668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.1991267204284668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1640, 128]), torch.Size([1, 1640, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.20069074630737305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.21413612365722656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1640, 128])
m.shape torch.Size([2091, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2153482437133789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2153482437133789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2177119255065918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2498769760131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([2151, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2512059211730957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2512059211730957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2151, 128]), torch.Size([1, 2151, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25494813919067383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30138683319091797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2151, 128])
m.shape torch.Size([2087, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30434179306030273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30434179306030273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2087, 128]), torch.Size([1, 2087, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.30695152282714844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3667426109313965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2087, 128])
m.shape torch.Size([2045, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.36985111236572266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.36985111236572266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2045, 128]), torch.Size([1, 2045, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.37180137634277344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4420795440673828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2045, 128])
m.shape torch.Size([1825, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44632577896118164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44632577896118164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1825, 128]), torch.Size([1, 1825, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44806623458862305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.524172306060791  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1825, 128])
m.shape torch.Size([1683, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5289196968078613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5289196968078613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1683, 128]), torch.Size([1, 1683, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.530524730682373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6118497848510742  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1683, 128])
m.shape torch.Size([1621, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6172308921813965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6172308921813965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1621, 128]), torch.Size([1, 1621, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.618776798248291  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7076373100280762  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1621, 128])
m.shape torch.Size([1450, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7140283584594727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7140283584594727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1450, 128]), torch.Size([1, 1450, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7154111862182617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8048548698425293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1450, 128])
m.shape torch.Size([20239, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9006705284118652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9006705284118652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 20239, 128]), torch.Size([1, 20239, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9202017784118652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.293130397796631  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 20239, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.1649069786071777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2000327110290527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2351584434509277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.1997580528259277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([36832, 256])
first layer input nodes number: 96403
first layer output nodes number: 36832
edges number: 281987
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2358789443969727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2710046768188477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2797861099243164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2797861099243164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([857, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3243279457092285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3243279457092285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.325962543487549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3395276069641113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([736, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3404226303100586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3404226303100586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 736, 256]), torch.Size([1, 736, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3418264389038086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3628835678100586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 736, 256])
m.shape torch.Size([600, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.363943576812744  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.363943576812744  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3650879859924316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.391359806060791  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([439, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3925681114196777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3925681114196777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3934054374694824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.424389362335205  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([390, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.426398277282715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.426398277282715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4271421432495117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.465947151184082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([317, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4674034118652344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4674034118652344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.468008041381836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4944400787353516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([268, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.496753692626953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.496753692626953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.497264862060547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5229334831237793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([236, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5244927406311035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5244927406311035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5249428749084473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.550600528717041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([195, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.552062511444092  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.552062511444092  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5524344444274902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5762381553649902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.577561378479004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.577561378479004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5778608322143555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5991220474243164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([107, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6001038551330566  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6001038551330566  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6003079414367676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6162266731262207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([102, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6173014640808105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6173014640808105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6174960136413574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.634032726287842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([127, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6355223655700684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6355223655700684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6357645988464355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.658050060272217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6591672897338867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6591672897338867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6593427658081055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6767148971557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([104, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.678126811981201  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.678126811981201  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6783251762390137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6993517875671387  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.700298309326172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.700298309326172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.700428009033203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7150840759277344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7159342765808105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7159342765808105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.716041088104248  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.728858470916748  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([68, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7299818992614746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7299818992614746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.730111598968506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7465834617614746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.747358798980713  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.747358798980713  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7474465370178223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7592034339904785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7602171897888184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7602171897888184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.760322093963623  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.775113582611084  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7756667137145996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7756667137145996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.775723934173584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7841925621032715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7848830223083496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7848830223083496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7849478721618652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.794999599456787  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.795741081237793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.795741081237793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7958078384399414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8066225051879883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8071889877319336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8071889877319336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8072385787963867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.815619468688965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([539, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8285460472106934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8285460472106934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8295741081237793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.0110249519348145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 539, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9726576805114746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9735050201416016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9743523597717285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9734625816345215  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 36832
output nodes number: 5684
edges number: 45246
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9737801551818848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.973780632019043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06478548049926758  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 2 input nodes size: 98264
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05796241760253906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.05796241760253906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10483741760253906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.10487985610961914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06142377853393555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06142377853393555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06142377853393555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([98264, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.06142377853393555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1520, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2072606086730957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2072606086730957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1520, 128]), torch.Size([1, 1520, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2087101936340332  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2211165428161621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1520, 128])
m.shape torch.Size([2121, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22241449356079102  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22241449356079102  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2121, 128]), torch.Size([1, 2121, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.22523212432861328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.2574892044067383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2121, 128])
m.shape torch.Size([2196, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25951194763183594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.25951194763183594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2196, 128]), torch.Size([1, 2196, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.26160621643066406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3084597587585449  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2196, 128])
m.shape torch.Size([2126, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.31146764755249023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.31146764755249023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2126, 128]), torch.Size([1, 2126, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.31376218795776367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.373995304107666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2126, 128])
m.shape torch.Size([2019, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.377227783203125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.377227783203125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2019, 128]), torch.Size([1, 2019, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.3791532516479492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.44929981231689453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2019, 128])
m.shape torch.Size([1932, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45386457443237305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.45386457443237305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1932, 128]), torch.Size([1, 1932, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.4557070732116699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.537147045135498  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1932, 128])
m.shape torch.Size([1753, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5420770645141602  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5420770645141602  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1753, 128]), torch.Size([1, 1753, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.5437488555908203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6281337738037109  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1753, 128])
m.shape torch.Size([1650, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6335921287536621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6335921287536621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1650, 128]), torch.Size([1, 1650, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.6351656913757324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7270598411560059  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1650, 128])
m.shape torch.Size([1556, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7332158088684082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7332158088684082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1556, 128]), torch.Size([1, 1556, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.7346997261047363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.8296704292297363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1556, 128])
m.shape torch.Size([21355, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9307570457458496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9307570457458496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21355, 128]), torch.Size([1, 21355, 128])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 0.9515676498413086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4060592651367188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21355, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.2724485397338867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.308905601501465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.345362663269043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.3086204528808594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([38228, 256])
first layer input nodes number: 98264
first layer output nodes number: 38228
edges number: 295566
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.346096992492676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.382554054260254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.391902446746826  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.391902446746826  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([790, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4381933212280273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4381933212280273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 790, 256]), torch.Size([1, 790, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.439700126647949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4523496627807617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 790, 256])
m.shape torch.Size([737, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.453188896179199  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.453188896179199  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.454594612121582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.475879669189453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([593, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.476914405822754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.476914405822754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 593, 256]), torch.Size([1, 593, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.4780454635620117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.503648281097412  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 593, 256])
m.shape torch.Size([468, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5051097869873047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5051097869873047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.506002426147461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.532310962677002  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([376, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.534086227416992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.534086227416992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5348033905029297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5627822875976562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([295, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5641250610351562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5641250610351562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.564687728881836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5905489921569824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([254, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5919766426086426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.5919766426086426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.592461109161377  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6166844367980957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([210, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6180572509765625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6180572509765625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.618457794189453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6412887573242188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([204, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.642853260040283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.642853260040283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.643242359161377  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.668144702911377  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([150, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6693921089172363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6693921089172363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.669678211212158  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6899914741516113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([156, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.691497802734375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.691497802734375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.6917953491210938  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7150039672851562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([116, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.716193199157715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.716193199157715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.716414451599121  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7352209091186523  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([108, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.736459732055664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.736459732055664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.736665725708008  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.755617141723633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.75675630569458  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.75675630569458  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.756929874420166  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.774113178253174  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([81, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7751941680908203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7751941680908203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.775348663330078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7917251586914062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([73, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7927708625793457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.7927708625793457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.792910099029541  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8086438179016113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.809629440307617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.809629440307617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8097496032714844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.824169158935547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.825223445892334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.825223445892334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8253378868103027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.839871883392334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.841020107269287  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.841020107269287  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8411459922790527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8580145835876465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.858893871307373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.858893871307373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.858987331390381  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8721652030944824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8729867935180664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8729867935180664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8730688095092773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.885207176208496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.885885238647461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.885885238647461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8859500885009766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8960018157958984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8967432975769043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8967432975769043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.8968100547790527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9076247215270996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9084219932556152  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9084219932556152  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9084906578063965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9200949668884277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([596, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9343814849853516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.9343814849853516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 2.935518264770508  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.1395931243896484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 596, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.099372386932373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.1002197265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.101067066192627  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.10017728805542  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 38228
output nodes number: 5684
edges number: 47133
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.1005048751831055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9178466796875 GB
    Memory Allocated: 3.1005053520202637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06652212142944336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 3 input nodes size: 97675
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10544395446777344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10548639297485352  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05856895446777344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.061081886291503906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.061081886291503906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.061081886291503906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97675, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.061081886291503906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1641, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20498132705688477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20498132705688477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20654630661010742  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21930837631225586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
m.shape torch.Size([2092, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2205209732055664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2205209732055664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2092, 128]), torch.Size([1, 2092, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22348356246948242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2555098533630371  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2092, 128])
m.shape torch.Size([2131, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.257504940032959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.257504940032959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2131, 128]), torch.Size([1, 2131, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2595372200012207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30596399307250977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2131, 128])
m.shape torch.Size([2082, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30891895294189453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30891895294189453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2082, 128]), torch.Size([1, 2082, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3114924430847168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37128114700317383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2082, 128])
m.shape torch.Size([2031, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3743324279785156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3743324279785156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2031, 128]), torch.Size([1, 2031, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3762693405151367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4464845657348633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2031, 128])
m.shape torch.Size([1728, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45045995712280273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45045995712280273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1728, 128]), torch.Size([1, 1728, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45210790634155273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.524594783782959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1728, 128])
m.shape torch.Size([1585, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5290613174438477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5290613174438477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1585, 128]), torch.Size([1, 1585, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5305728912353516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6061515808105469  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1585, 128])
m.shape torch.Size([1624, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6115908622741699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6115908622741699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1624, 128]), torch.Size([1, 1624, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6131396293640137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7042574882507324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1624, 128])
m.shape torch.Size([1433, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7096328735351562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7096328735351562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7109994888305664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7998814582824707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([21280, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9007606506347656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9007606506347656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21280, 128]), torch.Size([1, 21280, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9210548400878906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3747596740722656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21280, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2431578636169434  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2790417671203613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3149256706237793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.278761386871338  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37627, 256])
first layer input nodes number: 97675
first layer output nodes number: 37627
edges number: 290853
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3156557083129883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3515396118164062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3605775833129883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3605775833129883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([874, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4069128036499023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4069128036499023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 874, 256]), torch.Size([1, 874, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4085798263549805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4219160079956055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 874, 256])
m.shape torch.Size([758, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4226832389831543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4226832389831543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 758, 256]), torch.Size([1, 758, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.424129009246826  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4465250968933105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 758, 256])
m.shape torch.Size([573, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.447606086730957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.447606086730957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4486989974975586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4742660522460938  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([463, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.475564479827881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.475564479827881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.476447582244873  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5028395652770996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 463, 256])
m.shape torch.Size([407, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5043540000915527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5043540000915527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5051302909851074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5338430404663086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([276, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5350465774536133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5350465774536133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5355730056762695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5603365898132324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([234, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.561647891998291  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.561647891998291  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.562094211578369  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5844101905822754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([231, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.585963249206543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.585963249206543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5864038467407227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.611517906188965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([186, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6129069328308105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6129069328308105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6132616996765137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6359667778015137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6373062133789062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6373062133789062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.637605667114258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6588668823242188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([125, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.660038948059082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.660038948059082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6602773666381836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6788740158081055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([112, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.680046558380127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.680046558380127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.680260181427002  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.698418140411377  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.699307441711426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.699307441711426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.699458122253418  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.713320732116699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([76, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7142696380615234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7142696380615234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.714414596557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7287654876708984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.729933261871338  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.729933261871338  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7300972938537598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7474846839904785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7484793663024902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7484793663024902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.748612880706787  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.763700008392334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7645812034606934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7645812034606934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7646918296813965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7779669761657715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7789173126220703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7789173126220703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7790279388427734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7930774688720703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7939352989196777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7939352989196777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7940306663513184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.806809902191162  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8079047203063965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8079047203063965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.808009624481201  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.822801113128662  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.823495864868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.823495864868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.823566436767578  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8340110778808594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8346738815307617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8346738815307617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8347368240356445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8444929122924805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.84525728225708  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.84525728225708  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8453259468078613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.856449604034424  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.856968879699707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.856968879699707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8570146560668945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.864750862121582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([626, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.879769802093506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.879769802093506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8809638023376465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0915985107421875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 626, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0513787269592285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0522260665893555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0530734062194824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0521836280822754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37627
output nodes number: 5684
edges number: 46239
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.052506446838379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.052506923675537  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06642484664916992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 4 input nodes size: 98003
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05856895446777344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05856895446777344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10544395446777344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10548639297485352  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06139993667602539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06139993667602539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06139993667602539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([98003, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06139993667602539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1664, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20533275604248047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20533275604248047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1664, 128]), torch.Size([1, 1664, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20691967010498047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21980953216552734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1664, 128])
m.shape torch.Size([2121, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.221038818359375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.221038818359375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2121, 128]), torch.Size([1, 2121, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2239551544189453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2559375762939453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2121, 128])
m.shape torch.Size([2203, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25796031951904297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25796031951904297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2203, 128]), torch.Size([1, 2203, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.26006126403808594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30696821212768555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2203, 128])
m.shape torch.Size([2149, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3100166320800781  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3100166320800781  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2149, 128]), torch.Size([1, 2149, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.31228113174438477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3728494644165039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2149, 128])
m.shape torch.Size([2043, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.376248836517334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.376248836517334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2043, 128]), torch.Size([1, 2043, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37819719314575195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.44848108291625977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2043, 128])
m.shape torch.Size([1846, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4527883529663086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4527883529663086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1846, 128]), torch.Size([1, 1846, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45454883575439453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5302495956420898  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1846, 128])
m.shape torch.Size([1765, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5352606773376465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5352606773376465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1765, 128]), torch.Size([1, 1765, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5369439125061035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6212797164916992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1765, 128])
m.shape torch.Size([1593, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6265149116516113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6265149116516113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1593, 128]), torch.Size([1, 1593, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6280341148376465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7156014442443848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1593, 128])
m.shape torch.Size([1412, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7209014892578125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7209014892578125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1412, 128]), torch.Size([1, 1412, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7222480773925781  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.810762882232666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1412, 128])
m.shape torch.Size([21240, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9116520881652832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9116520881652832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21240, 128]), torch.Size([1, 21240, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.931908130645752  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.385193347930908  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21240, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2529611587524414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2892351150512695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3255090713500977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2889513969421387  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([38036, 256])
first layer input nodes number: 98003
first layer output nodes number: 38036
edges number: 292609
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3262414932250977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.362515449523926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3719186782836914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3719186782836914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([826, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4182138442993164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4182138442993164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 826, 256]), torch.Size([1, 826, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4197893142700195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.43276309967041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 826, 256])
m.shape torch.Size([749, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4334583282470703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4334583282470703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 749, 256]), torch.Size([1, 749, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.434886932373047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.457223892211914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 749, 256])
m.shape torch.Size([571, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4581856727600098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4581856727600098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4592747688293457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.48478364944458  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([456, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4863338470458984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4863338470458984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.487203598022461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5138378143310547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([397, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5153112411499023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5153112411499023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.516068458557129  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5439882278442383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([304, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.545362949371338  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.545362949371338  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.545942783355713  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5724740028381348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([242, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.573812484741211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.573812484741211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5742740631103516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.597352981567383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.598690986633301  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.598690986633301  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5990800857543945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6212587356567383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([181, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6226301193237305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6226301193237305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6229753494262695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6450700759887695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([169, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.646522045135498  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.646522045135498  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6468443870544434  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6697306632995605  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([137, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.671018123626709  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.671018123626709  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6712794303894043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6916613578796387  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([123, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6931710243225098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6931710243225098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6934056282043457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7133469581604004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([110, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.714604377746582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.714604377746582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7148141860961914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.734116554260254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([77, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.73507022857666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.73507022857666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7352170944213867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7497568130493164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.750847816467285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.750847816467285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.750992774963379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7663583755493164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7674503326416016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7674503326416016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7675857543945312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.782888412475586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7841148376464844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7841148376464844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.78424072265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.799346923828125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8002357482910156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8002357482910156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8003406524658203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8136634826660156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8145790100097656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8145790100097656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8146800994873047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.828226089477539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8293099403381348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8293099403381348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8294224739074707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.845289707183838  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.846182346343994  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.846182346343994  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8462719917297363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.85953950881958  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8601927757263184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8601927757263184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.860255718231201  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.870011806488037  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8706436157226562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8706436157226562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8707008361816406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8799705505371094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8807263374328613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8807263374328613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.880791187286377  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8917508125305176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([614, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9064717292785645  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9064717292785645  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 614, 256]), torch.Size([1, 614, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9076428413391113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.1150689125061035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 614, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.074859142303467  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0757064819335938  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0765538215637207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0756640434265137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 38036
output nodes number: 5684
edges number: 46950
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0759902000427246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.075990676879883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06593465805053711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 5 input nodes size: 96828
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10504007339477539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10508251190185547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05816507339477539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06066560745239258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06066560745239258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06066560745239258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([96828, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06066560745239258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1606, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.203460693359375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.203460693359375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1606, 128]), torch.Size([1, 1606, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20499229431152344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21762371063232422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1606, 128])
m.shape torch.Size([2112, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2188720703125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2188720703125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2112, 128]), torch.Size([1, 2112, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22088623046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.251739501953125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2112, 128])
m.shape torch.Size([2175, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2538437843322754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2538437843322754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2175, 128]), torch.Size([1, 2175, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2565288543701172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30379438400268555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2175, 128])
m.shape torch.Size([2114, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30647897720336914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30647897720336914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2114, 128]), torch.Size([1, 2114, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3088345527648926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3693275451660156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2114, 128])
m.shape torch.Size([1944, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3729543685913086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3729543685913086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1944, 128]), torch.Size([1, 1944, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37480831146240234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.44452571868896484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1944, 128])
m.shape torch.Size([1845, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.44887733459472656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.44887733459472656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1845, 128]), torch.Size([1, 1845, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4506368637084961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5268383026123047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1845, 128])
m.shape torch.Size([1694, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5316128730773926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5316128730773926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1694, 128]), torch.Size([1, 1694, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5332283973693848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6145281791687012  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1694, 128])
m.shape torch.Size([1615, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6198811531066895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6198811531066895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1615, 128]), torch.Size([1, 1615, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6214213371276855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7099595069885254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1615, 128])
m.shape torch.Size([1422, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7152919769287109  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7152919769287109  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1422, 128]), torch.Size([1, 1422, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7166481018066406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8056249618530273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1422, 128])
m.shape torch.Size([20941, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9048013687133789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9048013687133789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 20941, 128]), torch.Size([1, 20941, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9247722625732422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.342705726623535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 20941, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.211641311645508  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.247373580932617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2831058502197266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.24709415435791  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37468, 256])
first layer input nodes number: 96828
first layer output nodes number: 37468
edges number: 288587
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2838292121887207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.31956148147583  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3287510871887207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3287510871887207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([846, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3750662803649902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3750662803649902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 846, 256]), torch.Size([1, 846, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3766798973083496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3895888328552246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 846, 256])
m.shape torch.Size([717, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3903417587280273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3903417587280273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.391709327697754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.412714958190918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 717, 256])
m.shape torch.Size([578, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4137096405029297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4137096405029297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4148120880126953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4404525756835938  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([450, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.441929340362549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.441929340362549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4427876472473145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.469604015350342  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([382, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.471010684967041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.471010684967041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4717392921447754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.49923038482666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([309, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5011396408081055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5011396408081055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5017290115356445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.527663230895996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([249, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5290441513061523  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5290441513061523  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5295190811157227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5532655715942383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([225, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5547585487365723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5547585487365723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.555187702178955  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5796494483947754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([184, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.581026554107666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.581026554107666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5813775062561035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6038384437561035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([165, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6052489280700684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6052489280700684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6055636405944824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.627908229827881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([137, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.629199504852295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.629199504852295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6294608116149902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6498427391052246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([128, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6513004302978516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6513004302978516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6515445709228516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6722965240478516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([103, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.673461437225342  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.673461437225342  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6736578941345215  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6917319297790527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([90, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.692844867706299  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.692844867706299  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.693016529083252  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7100110054016113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.71104097366333  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.71104097366333  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.711185932159424  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7265515327453613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.727649211883545  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.727649211883545  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7277846336364746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7430872917175293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([67, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.744189739227295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.744189739227295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7443175315856934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.759652614593506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.760678768157959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.760678768157959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.760798931121826  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.776059627532959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([42, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.776766777038574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.776766777038574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7768468856811523  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.787581443786621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.788349151611328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.788349151611328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7884292602539062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.799724578857422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8005928993225098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8005928993225098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8006787300109863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8133816719055176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8141212463378906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8141212463378906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8141918182373047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8251304626464844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8258471488952637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8258471488952637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8259119987487793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8364176750183105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8373312950134277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8373312950134277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.837409496307373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.850625514984131  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([603, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8650755882263184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8650755882263184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8662257194519043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.07265043258667  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 603, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0324506759643555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0332980155944824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0341453552246094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0332555770874023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37468
output nodes number: 5684
edges number: 46856
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0335774421691895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0335779190063477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06600522994995117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 6 input nodes size: 97841
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05816507339477539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05816507339477539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10504007339477539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10508251190185547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06140851974487305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06140851974487305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06140851974487305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97841, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06140851974487305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1597, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20719003677368164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20719003677368164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1597, 128]), torch.Size([1, 1597, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20871305465698242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22136831283569336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1597, 128])
m.shape torch.Size([2104, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22261333465576172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22261333465576172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2104, 128]), torch.Size([1, 2104, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22461986541748047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25604724884033203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2104, 128])
m.shape torch.Size([2181, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2581639289855957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2581639289855957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2181, 128]), torch.Size([1, 2181, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2607431411743164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30766963958740234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2181, 128])
m.shape torch.Size([2067, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.31057214736938477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.31057214736938477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2067, 128]), torch.Size([1, 2067, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.31261539459228516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3713250160217285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2067, 128])
m.shape torch.Size([2088, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37465810775756836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37465810775756836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2088, 128]), torch.Size([1, 2088, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37729883193969727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4529085159301758  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2088, 128])
m.shape torch.Size([1876, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45728015899658203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45728015899658203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1876, 128]), torch.Size([1, 1876, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45906925201416016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5379800796508789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1876, 128])
m.shape torch.Size([1695, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5427432060241699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5427432060241699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1695, 128]), torch.Size([1, 1695, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5443596839904785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6258354187011719  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1695, 128])
m.shape torch.Size([1635, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6312642097473145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6312642097473145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1635, 128]), torch.Size([1, 1635, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6328234672546387  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7248673439025879  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1635, 128])
m.shape torch.Size([1540, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7306966781616211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7306966781616211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1540, 128]), torch.Size([1, 1540, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7321653366088867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8269529342651367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1540, 128])
m.shape torch.Size([21249, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9277811050415039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9277811050415039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21249, 128]), torch.Size([1, 21249, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9480457305908203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.401425361633301  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21249, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2670397758483887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.303309917449951  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3395800590515137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3030261993408203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([38032, 256])
first layer input nodes number: 97841
first layer output nodes number: 38032
edges number: 293607
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.340311050415039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3765811920166016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3859801292419434  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3859801292419434  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([856, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.432351589202881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.432351589202881  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 856, 256]), torch.Size([1, 856, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4339842796325684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4470458030700684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 856, 256])
m.shape torch.Size([737, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4478812217712402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4478812217712402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.449286937713623  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.47172212600708  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([584, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.472939968109131  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.472939968109131  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4740538597106934  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.499577522277832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 584, 256])
m.shape torch.Size([429, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5009407997131348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5009407997131348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5017590522766113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5265145301818848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([369, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.527878761291504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.527878761291504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5285825729370117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.555966854095459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([292, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5572991371154785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5572991371154785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5578560829162598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5838418006896973  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([240, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5851783752441406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5851783752441406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5856361389160156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6085243225097656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([225, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6100258827209473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6100258827209473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.61045503616333  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6349167823791504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([197, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.636406421661377  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.636406421661377  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.636782169342041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.660830020904541  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([164, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6622185707092285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6622185707092285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6625313758850098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6847405433654785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([140, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.686307430267334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.686307430267334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6865744590759277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7074027061462402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([110, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.708538055419922  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.708538055419922  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7087478637695312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.726581573486328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([98, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.727701187133789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.727701187133789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7278881072998047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.745084762573242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.746175765991211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.746175765991211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7463436126708984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.762960433959961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([89, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.764159679412842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.764159679412842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.764329433441162  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7823233604431152  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7832226753234863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7832226753234863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7833447456359863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7971386909484863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.798089027404785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.798089027404785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7982053756713867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.812167167663574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8131961822509766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8131961822509766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8133068084716797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8273563385009766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.828232765197754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.828232765197754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8283300399780273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.841364860534668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8424315452575684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8424315452575684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8425421714782715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.858140468597412  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8591957092285156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8591957092285156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8593006134033203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.874826431274414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.875493049621582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.875493049621582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8755578994750977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8856096267700195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.886218547821045  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.886218547821045  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8862738609313965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8952345848083496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.896129608154297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.896129608154297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8962059020996094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.909099578857422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([616, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.923862934112549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.923862934112549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9250378608703613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.134464740753174  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 616, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.094207763671875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.095055103302002  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.095902442932129  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.095012664794922  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 38032
output nodes number: 5684
edges number: 47153
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.095338821411133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.095339298248291  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06672477722167969  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 7 input nodes size: 98278
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10573148727416992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10577392578125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05885648727416992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06139707565307617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06139707565307617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06139707565307617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([98278, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06139707565307617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1620, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20717763900756836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20717763900756836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1620, 128]), torch.Size([1, 1620, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20872259140014648  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22147607803344727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1620, 128])
m.shape torch.Size([2162, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22276544570922852  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22276544570922852  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2162, 128]), torch.Size([1, 2162, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22482728958129883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2565150260925293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2162, 128])
m.shape torch.Size([2210, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25864553451538086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25864553451538086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2210, 128]), torch.Size([1, 2210, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2610173225402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3079714775085449  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2210, 128])
m.shape torch.Size([2131, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.31098222732543945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.31098222732543945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2131, 128]), torch.Size([1, 2131, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3130669593811035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37287330627441406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2131, 128])
m.shape torch.Size([2027, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3762993812561035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3762993812561035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2027, 128]), torch.Size([1, 2027, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.378232479095459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4483046531677246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2027, 128])
m.shape torch.Size([1838, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45259666442871094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45259666442871094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1838, 128]), torch.Size([1, 1838, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4543495178222656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5306224822998047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1838, 128])
m.shape torch.Size([1748, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5355806350708008  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5355806350708008  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1748, 128]), torch.Size([1, 1748, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5372476577758789  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6209592819213867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1748, 128])
m.shape torch.Size([1632, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6263513565063477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6263513565063477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1632, 128]), torch.Size([1, 1632, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6279077529907227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7198190689086914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1632, 128])
m.shape torch.Size([1519, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7255597114562988  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7255597114562988  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1519, 128]), torch.Size([1, 1519, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7270083427429199  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8206772804260254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1519, 128])
m.shape torch.Size([21285, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9215154647827148  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9215154647827148  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21285, 128]), torch.Size([1, 21285, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9418144226074219  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.395571708679199  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21285, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2621545791625977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.298558235168457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3349618911743164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2982735633850098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([38172, 256])
first layer input nodes number: 98278
first layer output nodes number: 38172
edges number: 294074
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.335696220397949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3720998764038086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.381481647491455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.381481647491455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([834, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.427783489227295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.427783489227295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4293742179870605  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4425082206726074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 834, 256])
m.shape torch.Size([737, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4431309700012207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4431309700012207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4445366859436035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4667186737060547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([585, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.46817684173584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.46817684173584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.469292640686035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4947509765625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([432, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4963536262512207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4963536262512207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4971776008605957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5236644744873047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([372, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.525040626525879  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.525040626525879  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.525750160217285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.553211212158203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([306, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5546212196350098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5546212196350098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5552048683166504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5806784629821777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([253, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5820889472961426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5820889472961426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.582571506500244  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6066994667053223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([240, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6083035469055176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6083035469055176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6087613105773926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6348538398742676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([191, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.636997699737549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.636997699737549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.637362003326416  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.660677433013916  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([132, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.661764144897461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.661764144897461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.662015914916992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.679891586303711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([139, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6812353134155273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6812353134155273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6815004348754883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7021799087524414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([114, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.703362464904785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.703362464904785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.703579902648926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.722062110900879  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([119, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.723440647125244  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.723440647125244  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.723667621612549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.74454927444458  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([99, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7457680702209473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7457680702209473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7459568977355957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.764650821685791  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([81, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7657241821289062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7657241821289062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.765878677368164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.782255172729492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([86, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.783592700958252  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.783592700958252  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.783756732940674  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8022923469543457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8031420707702637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8031420707702637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.803250789642334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8162970542907715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([73, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8175058364868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8175058364868164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8176450729370117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8353281021118164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.836282730102539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.836282730102539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8363895416259766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8507022857666016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.851494789123535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.851494789123535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.851578712463379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8634119033813477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8642783164978027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8642783164978027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8643641471862793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8770670890808105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8778066635131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8778066635131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8778772354125977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8888158798217773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8894662857055664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8894662857055664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8895254135131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.899104118347168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9000205993652344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9000205993652344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9000988006591797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9133148193359375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([580, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9272122383117676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9272122383117676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.928318500518799  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.128018379211426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 580, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.087841510772705  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.088688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.089536190032959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.088646411895752  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 38172
output nodes number: 5684
edges number: 46821
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0889735221862793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0889739990234375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06669950485229492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 8 input nodes size: 97518
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05885648727416992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05885648727416992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10573148727416992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10577392578125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06137704849243164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06137704849243164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06137704849243164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97518, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06137704849243164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1676, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20421409606933594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20421409606933594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1676, 128]), torch.Size([1, 1676, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2058124542236328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2185993194580078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1676, 128])
m.shape torch.Size([2024, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21973037719726562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21973037719726562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2024, 128]), torch.Size([1, 2024, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22166061401367188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2515525817871094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2024, 128])
m.shape torch.Size([2186, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25371456146240234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25371456146240234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2186, 128]), torch.Size([1, 2186, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25599193572998047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30236148834228516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2186, 128])
m.shape torch.Size([2099, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30532264709472656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30532264709472656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2099, 128]), torch.Size([1, 2099, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3076601028442383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.36731767654418945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2099, 128])
m.shape torch.Size([2103, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37064456939697266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37064456939697266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2103, 128]), torch.Size([1, 2103, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3733344078063965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4489927291870117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2103, 128])
m.shape torch.Size([1900, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45342588424682617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45342588424682617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1900, 128]), torch.Size([1, 1900, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45523786544799805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.533881664276123  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1900, 128])
m.shape torch.Size([1688, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5386099815368652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5386099815368652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1688, 128]), torch.Size([1, 1688, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.540219783782959  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6211371421813965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1688, 128])
m.shape torch.Size([1641, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6269850730895996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6269850730895996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6285500526428223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7207598686218262  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
m.shape torch.Size([1503, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7264275550842285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7264275550842285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1503, 128]), torch.Size([1, 1503, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7278609275817871  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8195967674255371  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1503, 128])
m.shape torch.Size([20882, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9184532165527344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9184532165527344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 20882, 128]), torch.Size([1, 20882, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9383678436279297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.352306365966797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 20882, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2207016944885254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.256657123565674  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2926125526428223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.256375789642334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37702, 256])
first layer input nodes number: 97518
first layer output nodes number: 37702
edges number: 289884
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2933411598205566  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.329296588897705  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3388705253601074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3388705253601074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([828, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3851675987243652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3851675987243652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.386746883392334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.399381160736084  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([691, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.400155544281006  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.400155544281006  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 691, 256]), torch.Size([1, 691, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4014735221862793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.421337127685547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 691, 256])
m.shape torch.Size([567, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4223570823669434  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4223570823669434  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.423438549041748  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4486565589904785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([459, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4499454498291016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4499454498291016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4508209228515625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.477555274963379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([422, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4791455268859863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4791455268859863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.479950428009033  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5097665786743164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([313, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.51116943359375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.51116943359375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5117664337158203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.538121223449707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([258, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5395588874816895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5395588874816895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.540050983428955  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5683469772338867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([234, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5699968338012695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5699968338012695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5704431533813477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.595883369445801  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([157, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5970187187194824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5970187187194824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.597318172454834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.616483211517334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([174, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6180062294006348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6180062294006348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.618338108062744  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6419014930725098  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([143, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.643247604370117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.643247604370117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6435203552246094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.664794921875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([138, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.666250228881836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.666250228881836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.666513442993164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6888866424560547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([105, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6900672912597656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6900672912597656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.690267562866211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7086925506591797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([95, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7107882499694824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7107882499694824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7109694480895996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.728908061981201  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.730012893676758  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.730012893676758  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.730165481567383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.746339797973633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([65, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.747457981109619  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.747457981109619  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.747581958770752  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7615914344787598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7623138427734375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7623138427734375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7624053955078125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7733917236328125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.774540901184082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.774540901184082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.774661064147949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.789921760559082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([65, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.791057586669922  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.791057586669922  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7911815643310547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8077945709228516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.808927059173584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.808927059173584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8090262413024902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8230109214782715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8241562843322754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8241562843322754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8242573738098145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8392186164855957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8398237228393555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8398237228393555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8398828506469727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8490476608276367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.849792003631592  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.849792003631592  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8498587608337402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.860673427581787  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.861309051513672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.861309051513672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8613643646240234  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8707122802734375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([578, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.884572982788086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.884572982788086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8856754302978516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.087735176086426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 578, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0475568771362305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.048403739929199  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.049250602722168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.048361301422119  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5683, 40])
input nodes number: 37702
output nodes number: 5683
edges number: 46701
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.048684597015381  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.048685073852539  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06610488891601562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 9 input nodes size: 97535
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.058868408203125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.058868408203125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.1053767204284668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10541915893554688  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0585017204284668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06103086471557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06103086471557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06103086471557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97535, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06103086471557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1616, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2049388885498047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2049388885498047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1616, 128]), torch.Size([1, 1616, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2064800262451172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21918487548828125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1616, 128])
m.shape torch.Size([2141, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22045612335205078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22045612335205078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2141, 128]), torch.Size([1, 2141, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22338533401489258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2554593086242676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2141, 128])
m.shape torch.Size([2117, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25750112533569336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25750112533569336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2117, 128]), torch.Size([1, 2117, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2595200538635254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3057231903076172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2117, 128])
m.shape torch.Size([2108, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3087344169616699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3087344169616699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2108, 128]), torch.Size([1, 2108, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3113679885864258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37161922454833984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2108, 128])
m.shape torch.Size([2119, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37500429153442383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37500429153442383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2119, 128]), torch.Size([1, 2119, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3776817321777344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4535207748413086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2119, 128])
m.shape torch.Size([1910, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.457974910736084  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.457974910736084  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1910, 128]), torch.Size([1, 1910, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4597964286804199  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5382246971130371  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1910, 128])
m.shape torch.Size([1774, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5432353019714355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5432353019714355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1774, 128]), torch.Size([1, 1774, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5449271202087402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6305251121520996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1774, 128])
m.shape torch.Size([1610, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6358208656311035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6358208656311035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1610, 128]), torch.Size([1, 1610, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6373562812805176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.725003719329834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1610, 128])
m.shape torch.Size([1507, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7307033538818359  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7307033538818359  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1507, 128]), torch.Size([1, 1507, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7321405410766602  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8241205215454102  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1507, 128])
m.shape torch.Size([21099, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.924964427947998  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.924964427947998  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21099, 128]), torch.Size([1, 21099, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9450860023498535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3968920707702637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21099, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2641167640686035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3003573417663574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3365979194641113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3000741004943848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([38001, 256])
first layer input nodes number: 97535
first layer output nodes number: 38001
edges number: 292587
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3373265266418457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3735671043395996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.383037567138672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.383037567138672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([791, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4292984008789062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4292984008789062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 791, 256]), torch.Size([1, 791, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.430807113647461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4428768157958984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 791, 256])
m.shape torch.Size([749, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4443464279174805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4443464279174805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 749, 256]), torch.Size([1, 749, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.445775032043457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4681029319763184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 749, 256])
m.shape torch.Size([566, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.469686508178711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.469686508178711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.470766067504883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.497856616973877  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([478, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.499154567718506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.499154567718506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5000662803649902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5273218154907227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([415, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.528860569000244  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.528860569000244  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5296521186828613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5590667724609375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([302, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.560412883758545  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.560412883758545  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5609889030456543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.58762264251709  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([242, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.588963031768799  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.588963031768799  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5894246101379395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6125035285949707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6138415336608887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6138415336608887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6142306327819824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.636409282684326  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([189, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.637849807739258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.637849807739258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6382102966308594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6612815856933594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([177, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6628026962280273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6628026962280273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.663140296936035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.68710994720459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.688788414001465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.688788414001465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6890363693237305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.708376884460449  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([120, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.70963716506958  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.70963716506958  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7098660469055176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.729321002960205  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([98, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.730431079864502  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.730431079864502  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7306180000305176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.747814655303955  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.749040126800537  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.749040126800537  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7492270469665527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7677321434020996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([87, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.768893241882324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.768893241882324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.769059181213379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.786648750305176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([72, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7876806259155273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7876806259155273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.78781795501709  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8033361434936523  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([68, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.804382801055908  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.804382801055908  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8045125007629395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8200764656066895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([59, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.821040630340576  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.821040630340576  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.821153163909912  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.835444927215576  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8364500999450684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8364500999450684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8365607261657715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8513846397399902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8522329330444336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8522329330444336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.852322578430176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.864962577819824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8659310340881348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8659310340881348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8660264015197754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.880140781402588  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.880706310272217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.880706310272217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8807616233825684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8893351554870605  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8901257514953613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8901257514953613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8901963233947754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9016289710998535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.902355194091797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.902355194091797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9024181365966797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.913055419921875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([585, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9270806312561035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9270806312561035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.928196430206299  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.130978584289551  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 585, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.09079647064209  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.091643810272217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0924911499023438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0916013717651367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 38001
output nodes number: 5684
edges number: 46772
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0919275283813477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.091928005218506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06556844711303711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 10 input nodes size: 96867
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.058502197265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.058502197265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.105377197265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10541963577270508  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0613398551940918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0613398551940918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0613398551940918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([96867, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0613398551940918  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1685, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2019505500793457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2019505500793457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1685, 128]), torch.Size([1, 1685, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20355749130249023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21641302108764648  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1685, 128])
m.shape torch.Size([2151, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21782541275024414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21782541275024414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2151, 128]), torch.Size([1, 2151, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21987676620483398  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2519035339355469  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2151, 128])
m.shape torch.Size([2158, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2539548873901367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2539548873901367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2158, 128]), torch.Size([1, 2158, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2560129165649414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3024916648864746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2158, 128])
m.shape torch.Size([2107, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3054814338684082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3054814338684082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2107, 128]), torch.Size([1, 2107, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30803632736206055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3681154251098633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2107, 128])
m.shape torch.Size([2013, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3712430000305176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3712430000305176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2013, 128]), torch.Size([1, 2013, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37316274642944336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.44307470321655273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2013, 128])
m.shape torch.Size([1875, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.447479248046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.447479248046875  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1875, 128]), torch.Size([1, 1875, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4492673873901367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5269355773925781  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1875, 128])
m.shape torch.Size([1719, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5317792892456055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5317792892456055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1719, 128]), torch.Size([1, 1719, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5334186553955078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.615386962890625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1719, 128])
m.shape torch.Size([1648, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6208539009094238  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6208539009094238  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1648, 128]), torch.Size([1, 1648, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6224255561828613  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7145600318908691  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1648, 128])
m.shape torch.Size([1502, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7202200889587402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7202200889587402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1502, 128]), torch.Size([1, 1502, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7216525077819824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8156237602233887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1502, 128])
m.shape torch.Size([20486, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9125924110412598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9125924110412598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 20486, 128]), torch.Size([1, 20486, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9321293830871582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3192543983459473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 20486, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.1903114318847656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2259254455566406  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2615394592285156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.22564697265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37344, 256])
first layer input nodes number: 96867
first layer output nodes number: 37344
edges number: 285799
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.262263298034668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.297877311706543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.307185173034668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.307185173034668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([842, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.352222442626953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.352222442626953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 842, 256]), torch.Size([1, 842, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3538284301757812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3686323165893555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 842, 256])
m.shape torch.Size([755, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3695125579833984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3695125579833984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 755, 256]), torch.Size([1, 755, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.370952606201172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.393220901489258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 755, 256])
m.shape torch.Size([581, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3942384719848633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3942384719848633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3953466415405273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.421563148498535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([430, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.422746181488037  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.422746181488037  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4235663414001465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.450967311859131  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([376, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4525132179260254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4525132179260254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.453230381011963  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4866585731506348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([326, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4882564544677734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4882564544677734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4888782501220703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.516498565673828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([270, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5180044174194336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5180044174194336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.518519401550293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5452051162719727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([215, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.546600818634033  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.546600818634033  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.547010898590088  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.570385456085205  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([199, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.571901798248291  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.571901798248291  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5722813606262207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5965733528137207  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([167, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.597989082336426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.597989082336426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5983076095581055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6209230422973633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([148, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.622328758239746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.622328758239746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6226110458374023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.64462947845459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([129, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6459765434265137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6459765434265137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6462225914001465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6671366691589355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([105, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.668325901031494  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.668325901031494  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6685261726379395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.686951160430908  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.688124179840088  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.688124179840088  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.688276767730713  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.703382968902588  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7043404579162598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7043404579162598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7044739723205566  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7186264991760254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.719543933868408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.719543933868408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.719666004180908  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.733459949493408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([69, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7345266342163086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7345266342163086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7346582412719727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.75045108795166  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7513198852539062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7513198852539062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.751422882080078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7645034790039062  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.765401840209961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.765401840209961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.765501022338867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7787914276123047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7796263694763184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7796263694763184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7797141075134277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7920851707458496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.792909622192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.792909622192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7929916381835938  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8051300048828125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8058714866638184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8058714866638184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8059420585632324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.816880702972412  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.817685604095459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.817685604095459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.817758083343506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8294997215270996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8300633430480957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8300633430480957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.830112934112549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.838493824005127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([562, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.851973056793213  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.851973056793213  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8530449867248535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.042518138885498  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 562, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0036230087280273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0044703483581543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0053176879882812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.004427909851074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37344
output nodes number: 5684
edges number: 45775
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.004748821258545  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.004749298095703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06577348709106445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 11 input nodes size: 98194
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10569143295288086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10573387145996094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05881643295288086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.061360836029052734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.061360836029052734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.061360836029052734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([98194, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.061360836029052734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1641, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20714998245239258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20714998245239258  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1641, 128]), torch.Size([1, 1641, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20871496200561523  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22154855728149414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1641, 128])
m.shape torch.Size([2026, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22269821166992188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22269821166992188  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2026, 128]), torch.Size([1, 2026, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22463035583496094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2537384033203125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2026, 128])
m.shape torch.Size([2198, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2567625045776367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2567625045776367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2198, 128]), torch.Size([1, 2198, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2595548629760742  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30605030059814453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2198, 128])
m.shape torch.Size([2192, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30918312072753906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30918312072753906  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2192, 128]), torch.Size([1, 2192, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.31146907806396484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37272167205810547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2192, 128])
m.shape torch.Size([2080, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37641429901123047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37641429901123047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2080, 128]), torch.Size([1, 2080, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37867259979248047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4523649215698242  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2080, 128])
m.shape torch.Size([1893, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4567890167236328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4567890167236328  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1893, 128]), torch.Size([1, 1893, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45859432220458984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5374374389648438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1893, 128])
m.shape torch.Size([1691, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5421791076660156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5421791076660156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1691, 128]), torch.Size([1, 1691, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5437917709350586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6255154609680176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1691, 128])
m.shape torch.Size([1568, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6306905746459961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6306905746459961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1568, 128]), torch.Size([1, 1568, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6321859359741211  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7178354263305664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1568, 128])
m.shape torch.Size([1523, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7236237525939941  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7236237525939941  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1523, 128]), torch.Size([1, 1523, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7250761985778809  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8180327415466309  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1523, 128])
m.shape torch.Size([21315, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9189443588256836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9189443588256836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21315, 128]), torch.Size([1, 21315, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9392719268798828  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.393343925476074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21315, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.259636402130127  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.295997142791748  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.332357883453369  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.295712947845459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([38127, 256])
first layer input nodes number: 98194
first layer output nodes number: 38127
edges number: 294051
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3330917358398438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.369452476501465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3788199424743652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3788199424743652  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([827, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.425257682800293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.425257682800293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.426835060119629  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4394540786743164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([701, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4400267601013184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4400267601013184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.44136381149292  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4623022079467773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([585, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.46352481842041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.46352481842041  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4646406173706055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4897828102111816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([474, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4913411140441895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4913411140441895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4922451972961426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.520535945892334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([383, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5219244956970215  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5219244956970215  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5226550102233887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5507311820983887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([318, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5521998405456543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5521998405456543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5528063774108887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5815868377685547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([248, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5829524993896484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5829524993896484  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.583425521850586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.607076644897461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([203, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.608401298522949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.608401298522949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.60878849029541  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6308584213256836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([182, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.63223934173584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.63223934173584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6325864791870117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6548032760620117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([177, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6563310623168945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6563310623168945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6566686630249023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.680638313293457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([141, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6819605827331543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6819605827331543  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.682229518890381  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7032065391540527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([116, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7045164108276367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7045164108276367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.704737663269043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.723544120788574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([107, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7247705459594727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7247705459594727  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7249746322631836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.74375057220459  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7449135780334473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7449135780334473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7450928688049316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7628426551818848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.763503074645996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.763503074645996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7636022567749023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.774115562438965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([63, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7750349044799805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7750349044799805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7751550674438477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.78873348236084  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.789865016937256  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.789865016937256  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7899985313415527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8060202598571777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([49, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8068013191223145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8068013191223145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8068947792053223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8187642097473145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([72, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8200325965881348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8200325965881348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8201699256896973  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8385720252990723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.839599132537842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.839599132537842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.839707851409912  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.855037212371826  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.85575008392334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.85575008392334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8558225631713867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.866549491882324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8673806190490723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8673806190490723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8674588203430176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.879580020904541  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8801822662353516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8801822662353516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.880237579345703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8891983032226562  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8898396492004395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8898396492004395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.889894962310791  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.899242877960205  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([628, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9143052101135254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9143052101135254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9155030250549316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.1283721923828125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 628, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.088010311126709  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.088857650756836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.089704990386963  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.088815212249756  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 38127
output nodes number: 5684
edges number: 47252
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.089141845703125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.089142322540283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06666851043701172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 12 input nodes size: 97646
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05881643295288086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05881643295288086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10569143295288086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10573387145996094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06140565872192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06140565872192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06140565872192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97646, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06140565872192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1585, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2071847915649414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2071847915649414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1585, 128]), torch.Size([1, 1585, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2086963653564453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22130203247070312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1585, 128])
m.shape torch.Size([2169, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22261476516723633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22261476516723633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2169, 128]), torch.Size([1, 2169, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22468328475952148  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25647449493408203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2169, 128])
m.shape torch.Size([2134, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25849294662475586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25849294662475586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2134, 128]), torch.Size([1, 2134, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2605447769165039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3066439628601074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2134, 128])
m.shape torch.Size([2137, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30970239639282227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30970239639282227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2137, 128]), torch.Size([1, 2137, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.31226444244384766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37290143966674805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2137, 128])
m.shape torch.Size([2062, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3767986297607422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3767986297607422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2062, 128]), torch.Size([1, 2062, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37883520126342773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4529280662536621  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2062, 128])
m.shape torch.Size([1903, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45738935470581055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45738935470581055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1903, 128]), torch.Size([1, 1903, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45920419692993164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5388045310974121  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1903, 128])
m.shape torch.Size([1747, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5437283515930176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5437283515930176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1747, 128]), torch.Size([1, 1747, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5453944206237793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6295614242553711  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1747, 128])
m.shape torch.Size([1642, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6349921226501465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6349921226501465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1642, 128]), torch.Size([1, 1642, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6365580558776855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7287764549255371  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1642, 128])
m.shape torch.Size([1503, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7344436645507812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7344436645507812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1503, 128]), torch.Size([1, 1503, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7358770370483398  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8278789520263672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1503, 128])
m.shape torch.Size([21189, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9287247657775879  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9287247657775879  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21189, 128]), torch.Size([1, 21189, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9489321708679199  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4016823768615723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21189, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2677741050720215  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.304081439971924  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.340388774871826  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.303797721862793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([38071, 256])
first layer input nodes number: 97646
first layer output nodes number: 38071
edges number: 293383
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.341118335723877  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3774256706237793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3868532180786133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3868532180786133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([832, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.433156967163086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.433156967163086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 832, 256]), torch.Size([1, 832, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.434743881225586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4479594230651855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 832, 256])
m.shape torch.Size([780, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4488582611083984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4488582611083984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 780, 256]), torch.Size([1, 780, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.450345993041992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4736642837524414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 780, 256])
m.shape torch.Size([524, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4751992225646973  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4751992225646973  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 524, 256]), torch.Size([1, 524, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.476198673248291  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4997668266296387  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 524, 256])
m.shape torch.Size([459, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5010318756103516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5010318756103516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5019073486328125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5283937454223633  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([385, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5303945541381836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5303945541381836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5311288833618164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.558795928955078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([298, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.560147285461426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.560147285461426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.560715675354004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.586483955383301  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([272, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5880298614501953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5880298614501953  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5885486602783203  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6146721839904785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([204, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6159815788269043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6159815788269043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.616370677947998  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.638549327850342  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([198, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6400675773620605  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6400675773620605  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6404452323913574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6646151542663574  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.665935516357422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.665935516357422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6662349700927734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6874961853027344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6888794898986816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6888794898986816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6891560554504395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.710728168487549  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7119970321655273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7119970321655273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7122297286987305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.732008934020996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([97, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.733659267425537  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.733659267425537  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.73384428024292  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7508654594421387  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([84, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.751903533935547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.751903533935547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.752063751220703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.767925262451172  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([88, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7691140174865723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7691140174865723  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7692818641662598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7870736122131348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7878355979919434  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7878355979919434  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.787940502166748  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7997946739196777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.800804615020752  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.800804615020752  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8009285926818848  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8158059120178223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.816678524017334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.816678524017334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.816781520843506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.829862117767334  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8306326866149902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8306326866149902  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.830718517303467  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.842219829559326  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.843202590942383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.843202590942383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.843303680419922  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8575572967529297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.85843563079834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.85843563079834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.858523368835449  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8715085983276367  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8723320960998535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8723320960998535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.872410297393799  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8845314979553223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8852219581604004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8852219581604004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.885284900665283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.895481586456299  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8962578773498535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8962578773498535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.896324634552002  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.907606601715088  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([612, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.922278881072998  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.922278881072998  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.9234461784362793  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.131394386291504  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 612, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.091183662414551  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0920310020446777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0928783416748047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0919885635375977  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 38071
output nodes number: 5684
edges number: 46856
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0923147201538086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.092315196990967  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06672143936157227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 13 input nodes size: 97480
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10535097122192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.1053934097290039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05847597122192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06096792221069336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06096792221069336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06096792221069336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97480, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06096792221069336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1700, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20381832122802734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20381832122802734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1700, 128]), torch.Size([1, 1700, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20543956756591797  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21840953826904297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1700, 128])
m.shape torch.Size([2129, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21962928771972656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21962928771972656  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2129, 128]), torch.Size([1, 2129, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22169828414916992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25250864028930664  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2129, 128])
m.shape torch.Size([2307, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.254793643951416  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.254793643951416  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2307, 128]), torch.Size([1, 2307, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2574605941772461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30839967727661133  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2307, 128])
m.shape torch.Size([2138, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.31093931198120117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.31093931198120117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2138, 128]), torch.Size([1, 2138, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3145756721496582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3748965263366699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2138, 128])
m.shape torch.Size([2116, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3784174919128418  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3784174919128418  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2116, 128]), torch.Size([1, 2116, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.38095664978027344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45639896392822266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2116, 128])
m.shape torch.Size([1816, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4614439010620117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4614439010620117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1816, 128]), torch.Size([1, 1816, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.46317577362060547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5389280319213867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1816, 128])
m.shape torch.Size([1734, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5438499450683594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5438499450683594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1734, 128]), torch.Size([1, 1734, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5455036163330078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6283884048461914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1734, 128])
m.shape torch.Size([1663, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6339054107666016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6339054107666016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1663, 128]), torch.Size([1, 1663, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6354913711547852  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7278900146484375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1663, 128])
m.shape torch.Size([1498, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7335257530212402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7335257530212402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1498, 128]), torch.Size([1, 1498, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7349543571472168  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8270697593688965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1498, 128])
m.shape torch.Size([20656, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9248509407043457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9248509407043457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 20656, 128]), torch.Size([1, 20656, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9445500373840332  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3431859016418457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 20656, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.212493419647217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2485013008117676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2845091819763184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2482199668884277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37757, 256])
first layer input nodes number: 97480
first layer output nodes number: 37757
edges number: 288391
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2852377891540527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3212456703186035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3309273719787598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3309273719787598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([847, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.376034736633301  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.376034736633301  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 847, 256]), torch.Size([1, 847, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.377650260925293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.391310691833496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 847, 256])
m.shape torch.Size([712, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3918728828430176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3918728828430176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 712, 256]), torch.Size([1, 712, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.39323091506958  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.413952350616455  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 712, 256])
m.shape torch.Size([617, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4150571823120117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4150571823120117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 617, 256]), torch.Size([1, 617, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.416234016418457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4425926208496094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 617, 256])
m.shape torch.Size([488, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4439148902893066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4439148902893066  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.444845676422119  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4729371070861816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([374, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.474269390106201  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.474269390106201  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.474982738494873  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.503350257873535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([305, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5047526359558105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5047526359558105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5053343772888184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5381035804748535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([242, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.539454460144043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.539454460144043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5399160385131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.562994956970215  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([202, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5643177032470703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5643177032470703  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5647029876708984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5866641998291016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([184, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5880632400512695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5880632400512695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.588414192199707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.610875129699707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([172, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6123528480529785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6123528480529785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6126809120178223  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6359734535217285  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([135, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.637237071990967  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.637237071990967  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6374945640563965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.657578945159912  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([136, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6590189933776855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6590189933776855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.659278392791748  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6813273429870605  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([109, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6825599670410156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6825599670410156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.682767868041992  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.701894760131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([73, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.702773094177246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.702773094177246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7029123306274414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7166967391967773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7178382873535156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7178382873535156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.717998504638672  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7349815368652344  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.735808849334717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.735808849334717  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7359213829040527  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7486376762390137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([78, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7498559951782227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7498559951782227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.750004768371582  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.767857551574707  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.768734931945801  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.768734931945801  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7688398361206055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.782162666320801  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7831335067749023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7831335067749023  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.783236503601074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7970380783081055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7980947494506836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7980947494506836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7981977462768555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.81272029876709  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8138480186462402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8138480186462402  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8139452934265137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8283419609069824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.828906536102295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.828906536102295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8289618492126465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8375353813171387  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8382153511047363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8382153511047363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8382763862609863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8481640815734863  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.84910249710083  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.84910249710083  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.849182605743408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8627209663391113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([550, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.875896453857422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.875896453857422  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 550, 256]), torch.Size([1, 550, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8769454956054688  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0626020431518555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 550, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.023653984069824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.024501323699951  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.025348663330078  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.024458885192871  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37757
output nodes number: 5684
edges number: 45845
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.024782657623291  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.024783134460449  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06639671325683594  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 14 input nodes size: 97817
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05847597122192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.05847597122192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10535097122192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.1053934097290039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06137895584106445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06137895584106445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06137895584106445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97817, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06137895584106445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1639, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2052454948425293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2052454948425293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1639, 128]), torch.Size([1, 1639, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20680856704711914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2195601463317871  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1639, 128])
m.shape torch.Size([2072, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22078847885131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22078847885131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2072, 128]), torch.Size([1, 2072, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2227644920349121  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2547945976257324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2072, 128])
m.shape torch.Size([2110, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25597429275512695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25597429275512695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2110, 128]), torch.Size([1, 2110, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.25978899002075195  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30608510971069336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2110, 128])
m.shape torch.Size([2195, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3092656135559082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3092656135559082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2195, 128]), torch.Size([1, 2195, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3119697570800781  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37361669540405273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2195, 128])
m.shape torch.Size([2114, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3776102066040039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3776102066040039  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2114, 128]), torch.Size([1, 2114, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.37990903854370117  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45392751693725586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2114, 128])
m.shape torch.Size([1868, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45794248580932617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45794248580932617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1868, 128]), torch.Size([1, 1868, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.45972394943237305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5369677543640137  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1868, 128])
m.shape torch.Size([1693, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5417280197143555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5417280197143555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1693, 128]), torch.Size([1, 1693, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5433425903320312  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6245403289794922  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1693, 128])
m.shape torch.Size([1689, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6301760673522949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6301760673522949  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1689, 128]), torch.Size([1, 1689, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6317868232727051  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7243857383728027  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1689, 128])
m.shape torch.Size([1517, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7300906181335449  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7300906181335449  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1517, 128]), torch.Size([1, 1517, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7315373420715332  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8252172470092773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1517, 128])
m.shape torch.Size([20901, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9241576194763184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9241576194763184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 20901, 128]), torch.Size([1, 20901, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9440903663635254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3593153953552246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 20901, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.227194309234619  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2632412910461426  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.299288272857666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.2629594802856445  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37798, 256])
first layer input nodes number: 97817
first layer output nodes number: 37798
edges number: 290697
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3000192642211914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.336066246032715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3456311225891113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3456311225891113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([862, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3908748626708984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3908748626708984  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.392518997192383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4069972038269043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([714, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4076333045959473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4076333045959473  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4089951515197754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4295620918273926  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 714, 256])
m.shape torch.Size([561, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4306106567382812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4306106567382812  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.431680679321289  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4557337760925293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([489, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4571123123168945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4571123123168945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.45804500579834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.485715866088867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([392, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.487133502960205  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.487133502960205  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4878811836242676  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.515964984893799  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([305, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.517350196838379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.517350196838379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5179319381713867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.543890953063965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([270, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.545416831970215  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.545416831970215  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.545931816101074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5740342140197754  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([225, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.575507164001465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.575507164001465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5759363174438477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.600398063659668  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([181, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6017494201660156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6017494201660156  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6020946502685547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6241893768310547  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([149, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6254491806030273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6254491806030273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6257333755493164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.64591121673584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([145, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6473021507263184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6473021507263184  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.647578716278076  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6691508293151855  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([130, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6705121994018555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6705121994018555  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.670760154724121  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.691836357116699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([100, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.692962169647217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.692962169647217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.693152904510498  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.710700511932373  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7118701934814453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7118701934814453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7120494842529297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.729799270629883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([67, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.73067569732666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.73067569732666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7308034896850586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.744349479675293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7454442977905273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7454442977905273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.745577812194824  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.760664939880371  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.761758327484131  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.761758327484131  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7618937492370605  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.778144359588623  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7790112495422363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7790112495422363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.779114246368408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7921948432922363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.792782783508301  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.792782783508301  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.792849540710449  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.80179500579834  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8026461601257324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8026461601257324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.802733898162842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8151049613952637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8157877922058105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8157877922058105  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.815856456756592  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.826018810272217  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8266191482543945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8266191482543945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.826676368713379  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.835545539855957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8362245559692383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8362245559692383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8362855911254883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8461732864379883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8466506004333496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8466506004333496  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8466925621032715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8537840843200684  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([604, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8682761192321777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8682761192321777  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8694281578063965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0758466720581055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 604, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0367259979248047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0375733375549316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0384206771850586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0375308990478516  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37798
output nodes number: 5684
edges number: 45968
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0378551483154297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.037855625152588  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0667572021484375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

pseudo mini batch 15 input nodes size: 97834
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0588688850402832  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10551977157592773  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.10556221008300781  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.058644771575927734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06116628646850586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06116628646850586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06116628646850586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([97834, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.06116628646850586  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([1668, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20508956909179688  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.20508956909179688  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1668, 128]), torch.Size([1, 1668, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2066802978515625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.21956539154052734  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1668, 128])
m.shape torch.Size([2042, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2207174301147461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2207174301147461  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2042, 128]), torch.Size([1, 2042, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.22266483306884766  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2519102096557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2042, 128])
m.shape torch.Size([2161, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2548656463623047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2548656463623047  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2161, 128]), torch.Size([1, 2161, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.2578310966491699  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30457258224487305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2161, 128])
m.shape torch.Size([2105, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3071732521057129  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3071732521057129  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2105, 128]), torch.Size([1, 2105, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.30959129333496094  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.36995792388916016  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2105, 128])
m.shape torch.Size([2003, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3737297058105469  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3737297058105469  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 2003, 128]), torch.Size([1, 2003, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.3756399154663086  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4454374313354492  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 2003, 128])
m.shape torch.Size([1885, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4498753547668457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4498753547668457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1885, 128]), torch.Size([1, 1885, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.4516730308532715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5317883491516113  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1885, 128])
m.shape torch.Size([1693, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5365405082702637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5365405082702637  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1693, 128]), torch.Size([1, 1693, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.5381550788879395  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6199502944946289  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1693, 128])
m.shape torch.Size([1528, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.624971866607666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.624971866607666  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1528, 128]), torch.Size([1, 1528, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.6264290809631348  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7096986770629883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1528, 128])
m.shape torch.Size([1460, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.715235710144043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.715235710144043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 1460, 128]), torch.Size([1, 1460, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.7166280746459961  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.8058538436889648  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 1460, 128])
m.shape torch.Size([21254, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9067201614379883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9067201614379883  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 21254, 128]), torch.Size([1, 21254, 128])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.9269895553588867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3804216384887695  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 21254, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.247812271118164  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.283860206604004  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3199081420898438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.283578395843506  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([37799, 256])
first layer input nodes number: 97834
first layer output nodes number: 37799
edges number: 291735
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.320639133453369  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.356687068939209  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3660836219787598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.3660836219787598  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

m.shape torch.Size([886, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4124341011047363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4124341011047363  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 886, 256]), torch.Size([1, 886, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.414124011993408  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.427643299102783  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 886, 256])
m.shape torch.Size([705, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.428316593170166  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.428316593170166  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 705, 256]), torch.Size([1, 705, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.429661273956299  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4499878883361816  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 705, 256])
m.shape torch.Size([586, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4513258934020996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4513258934020996  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4524435997009277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4783926010131836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([457, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4798922538757324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4798922538757324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.4807639122009277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5079970359802246  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([366, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5093202590942383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5093202590942383  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5100183486938477  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5352606773376465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([315, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5367283821105957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5367283821105957  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5373291969299316  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5635228157043457  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([238, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.564824104309082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.564824104309082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5652780532836914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.58797550201416  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([207, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5893402099609375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5893402099609375  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.5897350311279297  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6122398376464844  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([175, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.613556385040283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.613556385040283  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6138901710510254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6352524757385254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([175, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.636767864227295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.636767864227295  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.637101650238037  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6608004570007324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([130, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6620664596557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6620664596557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6623144149780273  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.681654930114746  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([124, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6829614639282227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6829614639282227  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.6831979751586914  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.703301429748535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([95, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7043704986572266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7043704986572266  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7045516967773438  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.721221923828125  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([107, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.72257137298584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.72257137298584  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.722775459289551  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7429800033569336  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([80, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7440314292907715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7440314292907715  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7441840171813965  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7603583335876465  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([79, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7614970207214355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7614970207214355  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7616477012634277  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.778674602508545  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7795796394348145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7795796394348145  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.779694080352783  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.793426990509033  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7945637702941895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7945637702941895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.7946953773498535  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8114094734191895  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([52, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.812293529510498  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.812293529510498  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8123927116394043  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.825683116912842  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.826575756072998  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.826575756072998  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.826669216156006  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8398470878601074  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8406481742858887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8406481742858887  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.840728282928467  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8525843620300293  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8532209396362305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8532209396362305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8532819747924805  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8627424240112305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.863308906555176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.863308906555176  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8633604049682617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8717031478881836  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8723926544189453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8723926544189453  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8724517822265625  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.882444381713867  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([597, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8967599868774414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8967599868774414  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 2.8978986740112305  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.1015214920043945  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

rst.shape  torch.Size([1, 597, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0613274574279785  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0621747970581055  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0630221366882324  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0621323585510254  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

torch.Size([5684, 40])
input nodes number: 37799
output nodes number: 5684
edges number: 46470
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0624566078186035  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 3.0624570846557617  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0661015510559082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0661015510559082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9197998046875 GB
    Memory Allocated: 0.0661015510559082  GigaBytes
Max Memory Allocated: 3.1636643409729004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027519583702087402 |0.0025861263275146484 |0.12323440611362457 |9.325146675109863e-05 |0.07364223897457123 |0.003594636917114258 |
----------------------------------------------------------pseudo_mini_loss sum 3.0822038650512695
Total (block generation + training)time/epoch 20.67192554473877
Training time/epoch 3.7052690982818604
Training time without block to device /epoch 3.663891077041626
Training time without total dataloading part /epoch 3.1551129817962646
load block tensor time/epoch 0.44031333923339844
block to device time/epoch 0.041378021240234375
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2165236
Number of first layer input nodes during this epoch:  1560912
Number of first layer output nodes during this epoch:  604324
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
